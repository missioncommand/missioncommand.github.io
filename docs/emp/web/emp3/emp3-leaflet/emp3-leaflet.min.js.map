{"version":3,"sources":["../../../src/mapengine/leaflet/js/lib/leaflet-src.js","../../../src/mapengine/leaflet/js/lib/KML.js","../../../src/mapengine/leaflet/js/lib/leaflet.markercluster-src.js","../../../src/mapengine/leaflet/js/utils/emp.typeLibrary.utils.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.js","../../../src/mapengine/leaflet/js/lib/leaflet-eng.leaflet.extensions.js","../../../src/mapengine/leaflet/js/lib/KML.extensions.js","../../../src/mapengine/leaflet/js/lib/leaflet-eng.markerCluster.extensions.js","../../../src/mapengine/leaflet/js/lib/leaflet-eng.leaflet.extension.Ellipse.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.selectionManager.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.empObject.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.DisplayableObject.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.EmpClusterGroup.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.overlay.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.wms.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.EmpBoundary.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.milstd.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.kml.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.geojson.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.airspace.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.image.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.AOI.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.milstdmodifiers.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.text.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.GeoRectangle.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.GeoSquare.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.GeoCircle.js","../../../src/mapengine/leaflet/js/typeLibrary/leaflet-eng.typeLibrary.feature.GeoEllipse.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.attributes.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.cylinder.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.polygon.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.curtain.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.orbit.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.route.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.track.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.radarc.js","../../../src/mapengine/leaflet/js/typeLibrary/airspace/leaflet-eng.typeLibrary.airspace.polyarc.js","../../../src/mapengine/leaflet/js/utils/leaflet-eng.utils.js","../../../src/mapengine/leaflet/js/utils/leaflet-eng.utils.geoJson.js","../../../src/mapengine/leaflet/js/utils/leaflet-eng.utils.milstd.js","../../../src/mapengine/leaflet/js/utils/leaflet-eng.utils.kml.js","../../../src/mapengine/leaflet/js/utils/leaflet-eng.utils.airspace.js","../../../src/mapengine/leaflet/js/utils/leaflet-eng.utils.oval.js","../../../src/mapengine/leaflet/js/utils/leaflet-eng-renderer-PointConverter.js","../../../src/mapengine/leaflet/js/editor/leaflet-eng.editor.controlpoint.js","../../../src/mapengine/leaflet/js/editor/leaflet-eng.editor.AbstractEditor.js","../../../src/mapengine/leaflet/js/editor/leaflet-eng.editor.GeoJson.js","../../../src/mapengine/leaflet/js/editor/leaflet-eng.editor.MilStd.js","../../../src/mapengine/leaflet/js/editor/leaflet-eng.editor.AOI.js","../../../src/mapengine/leaflet/js/editor/leaflet-eng.editor.KML.js","../../../src/mapengine/leaflet/js/editor/leaflet-eng.editor.airspace.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dcautoshape.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dccircularautoshape.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dccircularrangefan.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dcline.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dcpolygon.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dcrectparamautoshape.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dcroute.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dcsectorparamautoshape.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dcsuperautoshape.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dctwopointline.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.dctwopointrectas.js","../../../src/mapengine/leaflet/js/editor/milstd/leaflet-eng.editor.milstd.singlepoint.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.curtain.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.polygon.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.cylinder.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.orbit.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.route.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.track.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.radarc.js","../../../src/mapengine/leaflet/js/editor/airspace/leaflet-eng.editor.airspace.polyarc.js","../../../src/mapengine/leaflet/js/leaflet-map-engine.debug.js"],"names":["window","document","undefined","oldL","L","version","noConflict","this","Util","extend","dest","i","j","len","src","sources","Array","prototype","slice","call","arguments","length","hasOwnProperty","bind","fn","obj","args","apply","stamp","lastId","key","invokeEach","method","context","concat","limitExecByInterval","time","lock","execOnUnlock","wrapperFn","setTimeout","falseFn","formatNum","num","digits","pow","Math","round","trim","str","replace","splitWords","split","setOptions","options","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","template","data","value","Error","isArray","Object","toString","emptyImageUrl","getPrefixed","name","prefixes","timeoutDefer","Date","timeToCall","max","lastTime","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","element","cancelAnimFrame","Class","props","NewClass","initialize","_initHooks","callInitHooks","F","proto","constructor","statics","includes","parent","__super__","_initHooksCalled","include","mergeOptions","addInitHook","init","eventsKey","Mixin","Events","addEventListener","types","event","type","indexKey","indexLenKey","typeIndex","events","contextId","action","hasEventListeners","removeEventListener","clearAllEventListeners","listeners","removed","splice","fireEvent","target","addOneTimeEventListener","handler","on","off","once","fire","ie","ielt9","ua","navigator","userAgent","toLowerCase","webkit","chrome","phantomjs","android","android23","search","gecko","mobile","orientation","msPointer","msPointerEnabled","msMaxTouchPoints","PointerEvent","pointer","pointerEnabled","maxTouchPoints","retina","devicePixelRatio","matchMedia","matches","doc","documentElement","ie3d","style","webkit3d","WebKitCSSMatrix","gecko3d","opera3d","any3d","L_DISABLE_3D","touch","L_NO_TOUCH","startName","div","createElement","supported","setAttribute","removeAttribute","Browser","opera","mobileWebkit","mobileWebkit3d","mobileOpera","Point","x","y","clone","add","point","_add","subtract","_subtract","divideBy","_divideBy","multiplyBy","_multiplyBy","_round","floor","_floor","distanceTo","sqrt","equals","contains","abs","Bounds","a","b","points","min","getCenter","getBottomLeft","getTopRight","getSize","bounds","intersects","min2","max2","xIntersects","yIntersects","isValid","Transformation","c","d","_a","_b","_c","_d","transform","scale","_transform","untransform","DomUtil","get","getElementById","getStyle","el","currentStyle","defaultView","css","getComputedStyle","getViewportOffset","pos","top","left","docBody","body","docEl","offsetTop","offsetLeft","parseInt","offsetParent","scrollTop","scrollLeft","width","maxWidth","r","getBoundingClientRect","clientLeft","parentNode","documentIsLtr","_docIsLtrCached","_docIsLtr","create","tagName","className","container","appendChild","hasClass","classList","_getClass","RegExp","test","addClass","classes","_setClass","removeClass","remove","baseVal","setOpacity","opacity","filter","filterName","filters","item","e","Enabled","Opacity","testProp","getTranslateString","is3d","open","close","getScaleString","origin","preTranslateStr","scaleStr","setPosition","disable3D","_leaflet_pos","TRANSFORM","getPosition","TRANSITION","TRANSITION_END","disableTextSelection","DomEvent","preventDefault","enableTextSelection","userSelectProperty","_userSelect","disableImageDrag","enableImageDrag","LatLng","lat","lng","alt","parseFloat","isNaN","DEG_TO_RAD","PI","RAD_TO_DEG","MAX_MARGIN","latLng","margin","precision","other","R","d2r","dLat","dLon","lat1","lat2","sin1","sin","sin2","cos","atan2","wrap","lon","LatLngBounds","southWest","northEast","latlngs","latLngBounds","_southWest","_northEast","pad","bufferRatio","sw","ne","heightBuffer","widthBuffer","getSouthWest","getNorthEast","getNorthWest","getNorth","getWest","getSouthEast","getSouth","getEast","sw2","ne2","latIntersects","lngIntersects","toBBoxString","Projection","SphericalMercator","MAX_LATITUDE","project","latlng","log","tan","unproject","atan","exp","LonLat","CRS","latLngToPoint","zoom","projectedPoint","projection","transformation","pointToLatLng","untransformedPoint","s","Simple","EPSG3857","code","earthRadius","EPSG900913","EPSG4326","Map","crs","fadeAnimation","trackResize","markerZoomAnimation","_initContainer","_initLayout","_onResize","_initEvents","maxBounds","setMaxBounds","center","setView","reset","_handlers","_layers","_zoomBoundLayers","_tileLayersNum","_addLayers","layers","getZoom","_resetView","_limitZoom","setZoom","_loaded","_zoom","zoomIn","delta","zoomOut","setZoomAround","getZoomScale","viewHalf","containerPoint","latLngToContainerPoint","centerOffset","newCenter","containerPointToLatLng","fitBounds","getBounds","paddingTL","paddingTopLeft","padding","paddingBR","paddingBottomRight","getBoundsZoom","paddingOffset","swPoint","nePoint","maxZoom","fitWorld","panTo","pan","panBy","offset","_rawPanBy","_panInsideMaxBounds","panInsideBounds","_limitCenter","addLayer","layer","minZoom","_updateZoomLevels","zoomAnimation","TileLayer","_tileLayersToLoad","_onTileLayerLoad","_layerAdd","removeLayer","onRemove","hasLayer","eachLayer","invalidateSize","animate","oldSize","_sizeChanged","_initialCenter","newSize","oldCenter","debounceMoveend","_sizeTimer","addHandler","HandlerClass","enable","_container","_leaflet","_clearPanes","_clearControlPos","_clearHandlers","_checkIfLoaded","_moved","layerPointToLatLng","_getCenterLayerPoint","getPixelBounds","getMinZoom","_layersMinZoom","getMaxZoom","_layersMaxZoom","Infinity","inside","boundsSize","size","nw","se","zoomNotFound","_size","clientWidth","clientHeight","topLeftPoint","_getTopLeftPoint","getPixelOrigin","_initialTopLeftPoint","getPanes","_panes","getContainer","toZoom","getScaleZoom","LN2","latLngToLayerPoint","containerPointToLayerPoint","_getMapPanePos","layerPointToContainerPoint","layerPoint","mouseEventToContainerPoint","getMousePosition","mouseEventToLayerPoint","mouseEventToLatLng","position","_initPanes","_initControlPos","panes","_mapPane","mapPane","_createPane","_tilePane","tilePane","objectsPane","shadowPane","overlayPane","markerPane","popupPane","zoomHide","removeChild","preserveMapOffset","afterZoomAnim","zoomChanged","_getNewTopLeftPoint","loading","hard","_getZoomSpan","oldZoomSpan","onOff","_onMouseClick","_fireMouseEvent","_resizeRequest","_simulated","dragging","moved","boxZoom","_skipped","originalEvent","disable","whenReady","callback","onAdd","_latLngToNewLayerPoint","newZoom","topLeft","_getCenterOffset","centerPoint","viewBounds","_getBoundsOffset","_limitOffset","newBounds","pxBounds","nwOffset","seOffset","dx","_rebound","dy","right","ceil","map","Mercator","R_MINOR","R_MAJOR","r2","tmp","eccent","con","ts","phi","numIter","tol","dphi","EPSG3395","m","tileSize","subdomains","errorTileUrl","attribution","zoomOffset","unloadInvisibleTiles","updateWhenIdle","url","detectRetina","_url","_map","_animated","_zoomAnimated","viewreset","_reset","moveend","_update","zoomanim","_animateZoom","zoomend","_endZoomAnim","_limitedUpdate","addTo","bringToFront","pane","_setAutoZIndex","bringToBack","insertBefore","firstChild","getAttribution","_updateOpacity","setZIndex","zIndex","_updateZIndex","setUrl","noRedraw","redraw","compare","children","edgeZIndex","isFinite","tiles","_tiles","_bgBuffer","_tileContainer","tile","_tilesToLoad","reuseTiles","_unusedTiles","innerHTML","_clearBgBuffer","_getTileSize","zoomN","maxNativeZoom","tileBounds","_addTilesFromCenterOut","_removeOtherTiles","queue","_tileShouldBeLoaded","tilesToLoad","sort","fragment","createDocumentFragment","_addTile","tilePoint","continuousWorld","limit","_getWrapTileNum","noWrap","nwPoint","sePoint","kArr","_removeTile","onload","tilePos","_getTilePos","_getTile","_loadTile","_getZoomForUrl","zoomReverse","getTileUrl","_getSubdomain","z","_adjustTilePoint","tms","index","pop","_resetTile","_createTile","height","galleryimg","onselectstart","onmousemove","WebkitBackfaceVisibility","_layer","_tileOnLoad","onerror","_tileOnError","_tileLoaded","_clearBgBufferTimer","newUrl","tileLayer","WMS","defaultWmsParams","service","request","styles","format","transparent","wmsParams","_crs","_wmsVersion","projectionKey","bbox","setParams","wms","Canvas","async","_redrawTile","drawTile","_tilePoint","tileDrawn","canvas","ImageOverlay","_bounds","_image","_initImage","_onImageLoad","image","imageOverlay","Icon","createIcon","oldIcon","_createIcon","createShadow","_getIconUrl","img","_createImg","_setIconStyles","anchor","shadowAnchor","iconAnchor","marginLeft","marginTop","icon","Default","iconSize","popupAnchor","shadowSize","path","imagePath","scripts","getElementsByTagName","leafletRe","match","Marker","title","clickable","draggable","keyboard","zIndexOffset","riseOnHover","riseOffset","_latlng","update","_initIcon","_removeIcon","_removeShadow","getLatLng","setLatLng","setZIndexOffset","setIcon","_popup","bindPopup","_icon","_setPos","animation","classToAdd","addIcon","tabIndex","_initInteraction","_bringToFront","_resetZIndex","newShadow","_shadow","addShadow","_zIndex","opt","_onKeyPress","Handler","MarkerDrag","wasDragged","stopPropagation","_enabled","keyCode","marker","DivIcon","html","bgPos","backgroundPosition","divIcon","closePopupOnClick","Popup","minWidth","autoPan","closeButton","autoPanPadding","keepInView","source","_source","_isOpen","animFade","_getEvents","popup","openOn","openPopup","offsetWidth","_updatePosition","_adjustPan","getContent","_content","setContent","content","visibility","_updateContent","_updateLayout","_zoomAnimation","closeOnClick","preclick","_close","closePopup","prefix","containerClass","_closeButton","href","disableClickPropagation","_onCloseButtonClick","wrapper","_wrapper","_contentNode","disableScrollPropagation","_tipContainer","_tip","hasChildNodes","whiteSpace","offsetHeight","maxHeight","scrolledClass","_containerWidth","animated","_containerBottom","_containerLeft","bottom","containerHeight","containerWidth","layerPos","containerPos","autoPanPaddingTopLeft","autoPanPaddingBottomRight","stop","togglePopup","_popupHandlersAdded","_movePopup","setPopupContent","unbindPopup","getPopup","LayerGroup","getLayerId","clearLayers","invoke","methodName","getLayer","getLayers","layerGroup","FeatureGroup","EVENTS","_propagateEvent","_popupContent","_popupOptions","setStyle","featureGroup","Path","CLIP_PADDING","outerWidth","outerHeight","stroke","color","dashArray","lineCap","lineJoin","weight","fill","fillColor","fillOpacity","_initElements","projectLatlngs","_updatePath","_pathRoot","vml","_stroke","_fill","_updateStyle","_updatePathViewport","p","panePos","_pathViewport","SVG_NS","svg","createElementNS","createSVGRect","SVG","root","lastChild","first","getPathString","_createElement","_initPathRoot","_initPath","_initStyle","_path","pointerEvents","_animatePathZoom","_endPathZoom","_updateSvgViewport","_pathZooming","vp","_openPopup","_latlngs","shape","behavior","adj","VML","namespaces","coordsize","stroked","filled","endcap","dashStyle","joinstyle","display","v","getContext","L_PREFER_CANVAS","CANVAS","_requestUpdate","_onClick","_onMouseMove","_updateRequest","_fireMapMoveEnd","_ctx","_canvasCtx","lineWidth","strokeStyle","fillStyle","_drawPath","len2","drawMethod","beginPath","_parts","Polygon","closePath","_checkIfEmpty","ctx","save","globalAlpha","restore","_containsPoint","_animatingZoom","cursor","_mouseInside","_updateCanvasViewport","translate","LineUtil","simplify","tolerance","sqTolerance","_reducePoints","_simplifyDP","pointToSegmentDistance","p1","p2","_sqClosestPointOnSegment","closestPointOnSegment","ArrayConstructor","Uint8Array","markers","_simplifyDPStep","newPoints","last","sqDist","maxSqDist","reducedPoints","prev","_sqDist","clipSegment","useLastCode","codeOut","newCode","codeA","_lastCode","_getBitCode","codeB","_getEdgeIntersection","t","dot","Polyline","_convertLatLngs","smoothFactor","noClip","_originalPoints","_getPathPartStr","getLatLngs","setLatLngs","addLatLng","spliceLatLngs","closestLayerPoint","minDistance","parts","minPoint","jLen","distance","overwrite","_clipPoints","k","segment","lu","_simplifyPoints","polyline","PolyUtil","clipPolygon","clippedPoints","edge","edges","_code","_initWithHoles","hole","_holes","_holePoints","newParts","clipped","polygon","createMulti","Klass","_options","MultiPolyline","MultiPolygon","multiPolyline","multiPolygon","Rectangle","_boundsToLatLngs","setBounds","rectangle","Circle","radius","_mRadius","setRadius","lngRadius","_getLngRadius","pointLeft","_point","_radius","latRadius","getRadius","_getLatRadius","circle","CircleMarker","circleMarker","closed","dist","part","w","arc","w2","GeoJSON","geojson","addData","feature","features","geometries","geometry","coordinates","geometryToLayer","pointToLayer","coordsToLatLng","asFeature","defaultOptions","resetStyle","onEachFeature","_setLayerStyle","vectorOptions","coords","coordsToLatLngs","properties","levelsDeep","latLngToCoords","latLngsToCoords","latLngs","getFeature","newGeometry","geoJSON","PointToGeoJSON","toGeoJSON","multiToGeoJSON","json","jsons","isGeometryCollection","geoJson","addListener","originalHandler","newType","_getEvent","addPointerListener","addDoubleTapListener","_checkMouse","_filterClick","attachEvent","removeListener","removePointerListener","removeDoubleTapListener","detachEvent","cancelBubble","Draggable","START","_fakeStop","returnValue","clientX","clientY","rect","clientTop","getWheelDelta","wheelDelta","detail","_skipEvents","skipped","related","relatedTarget","err","caller","callee","Event","timeStamp","elapsed","_lastClick","_simulatedClick","END","mousedown","touchstart","pointerdown","MSPointerDown","MOVE","dragStartTarget","_element","_dragStartTarget","_onDown","shiftKey","which","button","touches","_disabled","_moving","_startPoint","_startPos","_newPos","_onMove","_onUp","newPoint","_lastTarget","srcElement","_animRequest","addHooks","removeHooks","enabled","inertia","inertiaDeceleration","inertiaMaxSpeed","inertiaThreshold","easeLinearity","worldCopyJump","Drag","_draggable","dragstart","_onDragStart","drag","_onDrag","dragend","_onDragEnd","_onPreDrag","_onViewReset","_panAnim","_positions","_times","_lastTime","_lastPos","shift","pxCenter","pxWorldCenter","_initialWorldOffset","_worldWidth","worldWidth","halfWidth","newX1","newX2","newX","delay","noInertia","direction","duration","ease","speedVector","speed","limitedSpeed","limitedSpeedVector","decelerationDuration","noMoveStart","doubleClickZoom","DoubleClickZoom","_onDoubleClick","scrollWheelZoom","ScrollWheelZoom","_onWheelScroll","_delta","_lastMousePos","_startTime","_timer","_performZoom","_touchstart","_touchend","onTouchStart","count","trackedTouches","pointerId","now","doubleTap","onTouchEnd","idx","prop","newTouch","pre","touchend","endElement","POINTER_CANCEL","POINTER_DOWN","POINTER_MOVE","POINTER_UP","_pointers","_pointerDocumentListener","addPointerListenerStart","addPointerListenerEnd","addPointerListenerMove","pointers","cb","alreadyInArray","changedTouches","internalCb","pointerType","MSPOINTER_TYPE_MOUSE","buttons","touchZoom","bounceAtZoomLimits","TouchZoom","_onTouchStart","_zooming","viewCenter","_startCenter","_startDist","_centerOffset","_onTouchMove","_onTouchEnd","_scale","_updateOnMove","_getScaleOrigin","oldZoom","floatZoomDelta","roundZoomDelta","tap","tapTolerance","Tap","_fireClick","_holdTimeout","_isTapValid","_simulateEvent","simulatedEvent","createEvent","initMouseEvent","screenX","screenY","dispatchEvent","BoxZoom","_pane","_onMouseDown","_startLayerPoint","_onMouseUp","_onKeyDown","_box","startPoint","box","newPos","_finish","boxZoomBounds","keyboardPanOffset","keyboardZoomOffset","Keyboard","keyCodes","down","up","_setPanOffset","_setZoomOffset","_onFocus","_onBlur","_addHooks","_removeHooks","_focused","focus","scrollTo","keys","_panKeys","codes","_zoomKeys","_inProgress","_marker","shadow","iconPos","Control","removeControl","addControl","corner","_controlCorners","removeFrom","_refocusOnMap","control","createCorner","vSide","hSide","l","corners","_controlContainer","Zoom","zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","zoomName","_zoomInButton","_createButton","_zoomIn","_zoomOutButton","_zoomOut","_updateDisabled","link","zoomControl","Attribution","_attributions","addAttribution","_onLayerAdd","_onLayerRemove","setPrefix","text","removeAttribution","attribs","prefixAndAttribs","attributionControl","Scale","metric","imperial","_addScales","_mScale","_iScale","centerLat","halfWorldMeters","maxMeters","_updateScales","_updateMetric","_updateImperial","meters","_getRoundNum","_getScaleWidth","maxMiles","miles","feet","maxFeet","ratio","pow10","Layers","collapsed","autoZIndex","baseLayers","overlays","_lastZIndex","_handlingClick","_addLayer","_onLayerChange","addBaseLayer","addOverlay","form","_form","_expand","_collapse","_layersLink","_onInputClick","_baseLayersList","_separator","_overlaysList","overlay","baseLayersPresent","overlaysPresent","_addItem","_createRadioElement","checked","radioHtml","radioFragment","input","label","defaultChecked","layerId","inputs","inputsLen","PosAnimation","run","_el","_onTransitionEnd","_stepTimer","setInterval","_onStep","_getPos","stepPos","_transformRe","clearInterval","_tryAnimatedZoom","_tryAnimatedPan","step","_onPanTransitionStep","end","_onPanTransitionEnd","_duration","_easeOutPower","_offset","_animate","_step","_complete","_animId","_runFrame","_easeOut","progress","zoomAnimationThreshold","_catchTransitionEnd","propertyName","_onZoomTransitionEnd","_nothingToAnimate","getElementsByClassName","backwards","forTouchZoom","_animateToCenter","_animateToZoom","_animating","_prepareBgBuffer","bg","initialTransform","front","bgLoaded","_getLoadedTilesPercentage","frontLoaded","_stopLoadingImages","complete","_defaultLocateOptions","watch","timeout","maximumAge","enableHighAccuracy","locate","_locateOptions","geolocation","_handleGeolocationError","message","onResponse","_handleGeolocationResponse","onError","_locationWatchId","watchPosition","getCurrentPosition","stopLocate","clearWatch","error","latitude","longitude","latAccuracy","accuracy","lngAccuracy","timestamp","KML","kml","_kml","addKML","loadXML","req","XMLHttpRequest","overrideMimeType","onreadystatechange","readyState","status","responseXML","send","_this","gpx","_addKML","xml","parseKML","parseStyle","parseStyleMap","_check_folder","parseFolder","parsePlacemark","parseGroundOverlay","folder","parentElement","_parse","childNodes","attributes","nodeValue","substring","ioptions","sl","hotSpot","poptions","KMLIcon","iconUrl","shadowUrl","iconAnchorRef","iconAnchorType","xunits","yunits","getAttribute","existingStyles","smKey","smStyleUrl","textContent","place","h","multi","parse","tag","descr","parseCoords","_read_coords","parseLineString","line","parseTrack","_read_gxcoords","parsePoint","ll","KMLMarker","parsePolygon","polys","inner","latlonbox","rotation","RotatedImageOverlay","angle","anchorType","_rotate","rad","costheta","sintheta","MarkerClusterGroup","maxClusterRadius","iconCreateFunction","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","singleMarkerMode","disableClusteringAtZoom","removeOutsideVisibleBounds","animateAddingMarkers","spiderfyDistanceMultiplier","spiderLegPolylineOptions","chunkedLoading","chunkInterval","chunkDelay","chunkProgress","polygonOptions","_defaultIconCreateFunction","_featureGroup","_nonPointGroup","_inZoomAnimation","_needsClustering","_needsRemoving","_currentShownBounds","_queue","array","addLayers","_unspiderfy","_maxZoom","visibleLayer","currentZoom","__parent","_animationAddLayer","_animationAddLayerNonAnimated","removeLayers","_unspiderfyLayer","_removeLayer","clusterShow","_arraySplice","layersArray","newMarkers","fg","npg","chunked","started","getTime","process","start","getChildCount","getAllChildMarkers","otherMarker","MarkerCluster","_iconNeedsUpdate","_updateIcon","_topClusterLevel","_recursivelyAddChildrenToMap","_gridClusters","_gridUnclustered","_noanimationUnspiderfy","_generateInitialClusters","result","anArray","_group","zoomToShowLayer","showMarker","afterSpiderfy","spiderfy","moveStart","zoomToBounds","_getExpandedVisibleBounds","_zoomEnd","_moveEnd","_spiderfierOnAdd","_bindEvents","_unbindEvents","_spiderfierOnRemove","_hideCoverage","getVisibleParent","vMarker","removeFromDistanceGrid","dontUpdateMap","gridClusters","gridUnclustered","removeObject","cluster","_markers","_childCount","_cLatLng","addObject","_childClusters","_recalculateBounds","_isOrIsParent","oel","childCount","_zoomOrSpiderfy","_showCoverage","_shownPolygon","_spiderfied","getConvexHull","_mergeSplitClusters","_recursivelyRemoveChildrenFromMap","radiusFn","DistanceGrid","markerPoint","closest","getNearObject","_addChild","newCluster","lastParent","_enqueue","_queueTimeout","_processQueue","_animationStart","_animationZoomIn","_animationZoomOut","latDiff","lngDiff","_addToMap","_animationEnd","previousZoomLevel","newZoomLevel","_recursively","startPos","_isSingleParent","clusterHide","_forceLayout","_recursivelyBecomeVisible","n","_recursivelyRestoreChildPositions","_animationZoomOutSingle","_recursivelyAnimateChildrenInAndAddSelfToMap","me","markerClusterGroup","group","storageArray","childClusters","boundsZoom","mapZoom","newClusters","_iconObj","new1","isNotificationFromChild","_expandBounds","addedCount","addedLatLng","_wLatLng","totalCount","_backupLatlng","_recursivelyAnimateChildrenIn","cm","zoomLevel","nm","_restorePosition","previousBounds","exceptBounds","boundsToApplyTo","zoomLevelToStart","zoomLevelToStop","runAtEveryLevel","runAtBottomLevel","opacityWhenUnclustered","ret","cellSize","_cellSize","_sqCellSize","_grid","_objectPoint","_getCoord","grid","row","cell","updateObject","eachObject","objectPoint","closestDistSq","QuickHull","getDistant","cpt","bl","vY","vX","findMostDistantPointFromBaseLine","baseLine","pt","maxD","maxPt","maxPoint","buildConvexHull","convexHullBaseLines","maxLat","minLat","minPt","ch","childMarkers","_2PI","_circleFootSeparation","_circleStartAngle","_spiralFootSeparation","_spiralLengthStart","_spiralLengthFactor","_circleSpiralSwitchover","positions","_generatePointsSpiral","_generatePointsCircle","_animationSpiderfy","unspiderfy","zoomDetails","_animationUnspiderfy","centerPt","circumference","legLength","angleStep","res","separation","lengthFactor","_preSpiderfyLatlng","_spiderLeg","SVG_ANIMATION","leg","thisLayerPos","initialLegOpacity","xmlns","legOptions","getTotalLength","anim","beginElement","stillThereChildCount","_unspiderfyWrapper","_unspiderfyZoomStart","_unspiderfyZoomAnim","emp","typeLibrary","utils","offsetUnit","FRACTION","PIXEL","INSETPIXELS","calculateOffset","iIconSize","sOffset","sOffsetType","iOffsetValue","dFraction","iOffset","leafLet","editor","airspace","internalPrivateClass","objectType","OVERLAY","FEATURE","LL_CONTROL","LL_DEFAULT_MAP","featureType","AOI","LEAFLET_DEFAULT_LINE_COLOR","LEAFLET_DEFAULT_LINE_WEIGHT","fromEmpLatLon","oEmpLatLon","_lat","_lon","toEmpLatLon","LatLon","oCoord","oThis","oThat","bearingTo","destinationPoint","brng","moveCoordinate","intersectLines","dBrng1","oCoord2","dBrng2","oResult","intersection","midPointTo","dBrng","dDist","pointAtFractionOfDistanceTo","pointAt3QtrDistanceTo","EmpIcon","publicInterface","oIconImag","_applyAnchorRef","oDefaultIcon","utilities","getDefaultIcon","basePath","xUnits","yUnits","oIconUtils","oImg","oOffset","oUnits","sXUnits","sYUnits","calculateXOffset","calculateYOffset","referencePoint","TOP_LEFT","iXOffset","iYOffset","BOTTOM_LEFT","sTemp","helpers","isEmptyString","heading","empSelect","labelStyle","oFeature","getEngineInstanceInterface","selectLabelStyle","getFormat","featureFormatType","MILSTD","isMultiPointTG","$","find","red","green","blue","empDeselect","getLabelStyle","oSelectAttributes","instanceInterface","selectAttributes","tempColor","tempWeight","oStyle","util","sURL","isDefaultMap","useProxyForDefault","config","getProxyUrl","useProxy","getCoreId","coreId","getObjectType","EmpKMLIcon","oMarker","_getRealScale","dKMLScale","dScale","naturalWidth","naturalHeight","_calculatXOffset","iIconWidth","_calculatYOffset","iIconHeight","dAngle","dTempX","dTempY","fHeading","iCenterX","iCenterY","referencePoin","dSin","dCos","dNewX","dNewY","EmpKMLMarker","KMLPluginExtension","isUrl","parseXML","getIconUrl","sKmlUrl","oFeatureProperties","getUseProxySetting","escape","kmlDoc","oIconOptions","sIndex","sID","kmlName","kmlDescription","sSubItemID","getOptions","sType","oOptions","oColor","oProperties","iconXOffset","iconYOffset","isSelected","convertColor","lineColor","sColor","EmpKmlObject","titleText","popupText","setPopupHeading","sText","getPopupHeading","setPopupText","getPopupText","setOverlay","oOverlay","getOverlayId","Overlay","getParentId","getFeatureId","EllipseObject","oMap","leafletMap","semiMajor","semiMinor","azimuth","centerLatLng","oCoordList","_generatePolygon","tempLatLng","angleTan","angleTan2","xyPoint","q1PointList","q2PointList","q3PointList","q4PointList","coordList","northCoord","eastCoord","northPoint","eastPoint","semiMajorPx","semiMinorPx","nPtePtDist","semiMajorPx2","semiMinorPx2","majorMinor","cosAzimuth","toRad","sinAzimuth","deltaRadian","maxRadian","SelectionManager","eventData","featureSelectedList","mapInstance","destroy","iIndex","oKeyList","associativeArray","getKeys","getKey","sSubFeatureID","sKey","_createSelectionObject","oSelectedListObject","oSelectionData","overlayId","parentId","featureId","select","selectedId","deselectAllFeatures","oFeatureSelection","isInEditMode","applyHighlight2LeafletObject","_removeFeatureFromSelectedList","_addFeatureToSelectedList","bSelected","selectFeature","deselectFeature","_removeFeaturesEntries","generateEvent","eventing","SelectionChange","resetEventData","_applyHighlight","oLeafletObj","oItemList","getLeafletObject","sCoreID","removeFeature","empObject","globalType","description","newGUID","parentCoreId","oClusteredParent","objectChildren","oParent","getParentObject","clearChildren","removeChildObject","removeEmpObject","aKeys","oCurrentEditor","cancelEdit","bInEditMode","bInDrawMode","oEditTransaction","removeChildObjectById","getRootOverlay","rootOverlay","getLeafletMap","leafletInstance","getEngObject","sCoreId","mapEngObjectList","getParentCoreId","getName","getDescription","setName","sValue","getChild","getChildList","getChildKeyList","getClusteredOverlay","isCurrentlyClustered","deactivateParentCluster","clusterDeactivate","activateParentCluster","clusterActivate","addChildObject","oChild","oClusteredOverlay","getClusterObject","hasChildren","isEmpty","DisplayableObject","visible","leafletObject","oLeafletObject","isVisible","setVisibility","oItem","oMapBounds","_updateLeafletObject","aKeyList","setFeatureStyle","EmpClusterGroup","oClusterDef","getClusterDef","getDistance","oCluster","_iconCreateFunction","getOverlay","_ParamReplacementCB","sParam","sRet","oFeatureList","oClusterStyle","getClusterStyle","getIconStyle","getPointStyle","_setClusterHeadingText","sPopupText","sTitle","getReplacementString","getTitle","_setClusterPopupText","sSummary","getSummary","sDescription","oClusterIcon","oIconStyle","oPointStyle","sStr","getLabel","getURL","sLabel","oImage","iRadius","toDataURL","createCircleCanvas","dOpacity","sStrokeColor","sFillColor","sTextColor","oEvent","handleFeatureClicked","Feature","Cluster","bClusterActive","oLeafletClusterObject","hasClusterDef","clusterRemove","hasFeatures","getFeatureBounds","oChildBounds","oBounds","oChildList","sKeys","addCoordinate","EmpBoundary","_setClusterDef","isClusterActive","activateCluster","clusterSet","_doClusterActivate","copyObject","defaultLabelStyle","selected","bEditable","isEditMode","originalStyle","setLeafletObject","_createFeature","oSelectionManager","getAzimuth","setEditMode","render","resetEditMode","oObject","getData","setData","oData","getProperties","setProperties","oProp","isEditable","isMilStd","isGeoJson","GEOJSON","isKML","isAirspace","AIRSPACE","isImage","IMAGE","isAOI","AOIFeature","isGeoEllipse","GeoEllipseFeature","getAngleUnits","AngleUnits","DEGREES","getAzimuthUnits","getAltitudeUnits","Units","FEET","METERS","oMilStdModifiers","SYMSTD","getUnits","getAltitudeModeAbbr","AltitudeModeAbbr","altitudeMode","_getAltUnitsAndModeText","aAltMode","_getPopupDescription","updateFeature","oNewLeafletObject","oArgs","oCoreFeature","bUpdateGraphic","_updateFeature","setSelection","bValue","bWrappedAlready","iLevel","oLatLngList","oNewLatLngList","bCoordWrapped","iCurrentLevel","wrapCoordinates","iList","bHasNotWrapped","updateCoordinates","getLineStyle","sEMPStyle","sLeaftletStyle","OutlineStyleType","DOT","DASH","DASH_DOT","LONG_DASH","LONG_DASH_DOT","SOLID","setFeatureStyleProperties","_getPolygonProperties","argsProperties","mergeGeoJSONProperties","strokeColor","defaultStrokeStyle","activeLayer","activeLayers","createWMS","addMapLayer","removeMapLayer","getId","oWMS","updateWMS","oSouthWest","oNorthEast","degNorth","degSouth","degWest","degEast","oSW","oNE","oCoordinate","degSE2Coord","geoLibrary","GetAzimuth","degSW2Coord","getCenterWest","dCenterLat","getCenterEast","containsCoordiante","containsIDL","contained","oBoundary","oBNorthEast","oSouthEast","oBNorthWest","getCenterWidth","oCenterWest","oCenterEast","setCenterWidth","dWidth","oCenter","oNewWestCoord","oNewEastCoord","MilStdFeature","sBasicSymbolCode","i2525Version","bIsMultiPointTG","getMilStdModifiers","getBasicSymbolCode","sUnits","RendererSettings","armyc2","c2sd","renderer","oBasicSymbolCode","milstd","basicSymbolCode","RECTANGULAR_TARGET","get2525Version","Symbology_2525Bch2_USAS_13_14","MILS","Symbology_2525C","retValue","cMilStdModifiers","Modifiers","oModifiers","UNIQUE_DESIGNATOR_1","getCoordinateList","symbolCode","toFixed","_createMultiPointFeature","oModifier","oEmpMapBounds","applyRequiredModifiers","renderMPGraphic","sName","sSymbolCode","oCoordData","empMapBounds","_createSinglePointFeature","oCoordinates","convertCoordinatesToLatLng","oMilStdIcon","_getSinglePointIcon","_modifierOnList","sModifier","oLabelList","oMainModifiers","oImageBounds","renderingOptimization","baseURL","sModifiers","svgColor","oModifierArray","sClassName","strippedSymbolCode","msa","MilStdAttributes","T","longModifiers","FILL_COLOR","FillColor","LINE_COLOR","LineColor","STANDARD","SIZE","iMilStdIconSize","MilStdIconRenderer","Render","toDataUrl","getCenterPoint","getImageBounds","viewInZone","charAt","farDistanceThreshold","RED","BLUE","GREEN","YELLOW","getSVG","engine","rendererUrl","location","protocol","host","_updateSinglePointFeature","bUpdateIcon","oIcon","convertModifiersTo2525","isMultiPoint","SymbolUtilities","getBasicSymbolID","oSymbolDef","SymbolDefTable","getSymbolDef","minPoints","MilStdModifiers","modifiers","toLongModifiers","oMapBoundry","setCoordinates","convertLatLngListToGeoJson","oEmpBoundary","_updateMilStdFeature","oNewFeafure","oMilStdUtil","areModifierValuesEqual","updateIconSize","toModifiers","KMLFeature","sKMLName","sKMLDesctiption","sKMLDescription","oLatLng","_getUrlViaProxy","proxyUrl","appSetup","urlProxy","_setKMLParameters","oKmlDoc","each","oNameElem","oDescElem","_createFeatureFromString","sProxyUrl","bUseProxy","getProxyURL","getBasePath","_createFeatureFromURL","bDoUpdate","bMultiGeometry","OverlayStyleType","POINT","LINE","POLYGON","MULTIGEOMETRY","GeoJsonFeature","_createGeoJSONPolygon","oGeoJSON","bIsSelected","_createGeoJSONLine","_getDefaultIcon","_createGeoJSONPoint","oLatLon","iconOptions","_createGeoJSONComplex","oGeoJSONData","oGeoJsonfeature","basPath","getGeometryType","sGeoJsonType","AirspaceFeature","iMinPoint","iMaxPoints","iMinPoints","oAirspaceAttributeList","AttributeList","getMinPoints","getMaxPoints","oAttributes","getAttributes","cAirspaceAttribute","AirspaceAttribute","getValue","AIRSPACE_ALTITUDE_MODE","getAttributeList","setAttributeList","oList","ImageFeature","_convertBBox","sImageURL","oBBox","getParams","oOriginalData","iBuffer","sAOIType","oGeoJson","setAOIType","aoi","setAOIBuffer","buffer","setAOISymbolCode","setModifiers","getAOISymbolCode","getModifiers","eAOIType","AOIType","getAOIType","POINT_RADIUS","BBOX","getAOIBuffer","setAOIBufferProperty","eMilStdModifiers","DISTANCE","sShortName","oMilStdFeature","o2525Modifiers","oStringModifiers","oLongToShortModifierName","stringToModifiers","o2525ModifierToLong","getAMValueCount","getAMValue","NaN","dValue","METERS_PER_FEET","setAMValue","FEET_PER_METERS","getANValueCount","AZIMUTH","getANValue","DEGREE_PER_MILS","setANValue","MILS_PER_DEGREE","getXValueCount","ALTITUDE_DEPTH","getXValue","setXValue","oNewModifiers","sLongModifier","featureMilStdVersionType","convertToString","sProp","X_OFFSET","X_UNITS","Y_OFFSET","Y_UNITS","LINE_THICKNESS","convertToNumeric","GeoTextFeature","myIcon","iTextPixelDim","oLeafletFeature","sLabelText","htmlFontStyle","htmlFontWeight","sCSSTextShadow","typeface","cmapi","enums","REGULAR","BOLD","ITALIC","BOLDITALIC","getStringPixelDimensions","family","justification","CENTER","LEFT","RIGHT","outlineColor","GeoRectangleFeature","newLatLng","angleOffset","toDeg","GeoSquareFeature","GeoCircleFeature","AIRSPACE_FILL_COLOR","AIRSPACE_LINE_COLOR","AIRSPACE_LINE_WIDTH","AIRSPACE_LEFT_WIDTH","AIRSPACE_RIGHT_WIDTH","AIRSPACE_WIDTH","AIRSPACE_HEIGHT","AIRSPACE_ALTITUDE","AIRSPACE_MIN_ALTITUDE","AIRSPACE_MAX_ALTITUDE","AIRSPACE_INNER_RADIUS","AIRSPACE_RADIUS","AIRSPACE_LEFT_AZIMUTH","AIRSPACE_RIGHT_AZIMUTH","AIRSPACE_ORBIT_TURN","AirspaceAttributes","sAttr","setValue","Value","setRequiredAttributes","sAirspaceType","cAirspaceType","airspaceSymbolCode","SHAPE3D_CURTAIN","SHAPE3D_CYLINDER","SHAPE3D_ORBIT","orbitTurnType","SHAPE3D_POLYARC","SHAPE3D_POLYGON","SHAPE3D_RADARC","SHAPE3D_ROUTE","SHAPE3D_TRACK","dMinAlt","getAirspaceAttributes","oAttr","duplicateAttribute","Attributes","AirspaceAttributeList","oAttrList","oAttributeList","insert","getAirspaceAttributeList","getMinAltitude","dMin","Number","MAX_VALUE","cAttributeConst","getMaxAltitude","dMax","MIN_VALUE","CylinderAirspace","oLineColor","oFillColor","iWidth","Cylinder","PolygonAirspace","oPolygonOptions","CurtainAirspace","Curtain","OrbitAirspace","sTurn","dBearing","dAnglePt1Pt2","OvalObject","Orbit","RouteAirspace","oOvalLeafletObject","oLegCoords","Route","TrackAirspace","dLeftWidth","dRightWidth","Bearing","dBearingPt1Pt2","Track","RadArcAirspace","oPartialCoordList","oCenterLatLng","dLeftAzimuth","dRightAzimuth","dInnerRadius","dOutterRadius","getEngineInstanceInterfacee","getArcCoordinates","RadArc","PolyArcAirspace","dRadius","PolyArc","sMode","featureAltitudeModeType","RELATIVE_TO_GROUND","ABSOLUTE","normilizeLongitude","convertViewBound","oView","west","south","east","north","isInt","anyCoordinateInBounds","bRet","oaCoordList","wrapLongitude","oMapCenter","oNewLatLng","oNorthEastBoundry","oNorthWestBoundry","tempLng","bLnginView","iCoorCnt","empBoundary","bIDLinView","dateLineInFeature","lng1","lng2","bDataLineInFeature","iCount","iCountMinus1","convertToColorString","sNewColor","iColor","mergeProperties","oProperties1","oProperties2","metersToFeet","iMeters","feetToMeters","iFeet","oRet","substr","angleBetween","oVertice","oPt1","oPt2","dAngleVPt1","dAngleVPt2","dStartAzimuth","dEndAzimuth","bClockwise","oNewPt","dNewAngleDelta","dAngleInc","oPoint1","oPoint2","dAngleVPt1Pt2","dPointDist","geoColorToHexColorString","geoColor","convertCoordinatesToString","convertCoordinateToLatLng","convertLatLngToGeoJson","oGeoJsonCoord","oGeoJSONProperties","sDefaultIconUrl","weigh","privateInterface","getAutoWidth","checkModifier","sBasicSymbol","sBaseModifier","sDigit","iDigit","oTGModifiers","ModifiersTG","oBasicCodes","T_UNIQUE_DESIGNATION_1","AM_DISTANCE","AN_AZIMUTH","S_OFFSET_INDICATOR","V_EQUIP_TYPE","W_DTG_1","H_ADDITIONAL_INFO_1","AIR_CORRIDOR","MINIMUM_RISK_ROUTE","STANDARD_ARMY_AIRCRAFT_FLIGHT_ROUTE","UBMANNED_AERIAL_VEHICLE_ROUTE","LOW_LEVEL_TRANSIT_ROUTE","X_ALTITUDE_DEPTH","dBaseValue","CIRCULAR_RANGE_FAN","SECTOR_RANGE_FAN","createMilStdEditor","oPrivateInterface","oTransaction","oEmpItem","oEditor","oSymbolDefTable","oParameters","transaction","EmpDrawEditItem","SymbolDef","multiPoint","drawCategory","DRAW_CATEGORY_LINE","DRAW_CATEGORY_ARROW","MilStdDCLine","DRAW_CATEGORY_AUTOSHAPE","MilStdDCAutoShape","DRAW_CATEGORY_POLYGON","MilStdDCPolygon","DRAW_CATEGORY_ROUTE","MilStdDCRoute","DRAW_CATEGORY_TWOPOINTLINE","DRAW_CATEGORY_TWOPOINTARROW","MilStdDC2PointLine","DRAW_CATEGORY_POINT","MilStdSinglePoint","DRAW_CATEGORY_SUPERAUTOSHAPE","MilStdDCSuperAutoShape","DRAW_CATEGORY_CIRCULAR_PARAMETERED_AUTOSHAPE","MilStdDCCircularAutoShape","DRAW_CATEGORY_RECTANGULAR_PARAMETERED_AUTOSHAPE","MilStdDCRectParamAutoShape","DRAW_CATEGORY_SECTOR_PARAMETERED_AUTOSHAPE","MilStdDCSectorParamAutoShape","DRAW_CATEGORY_CIRCULAR_RANGEFAN_AUTOSHAPE","MilStdDCCircularRangeFan","DRAW_CATEGORY_TWO_POINT_RECT_PARAMETERED_AUTOSHAPE","MilStdDC2PointRectAutoShape","DRAW_CATEGORY_3D_AIRSPACE","oValue1","oValue2","sValue1","JSON","stringify","sValue2","getRequiredModifiers","sReqModifiers","oSymDefTable","sRequiredModifiers","oRequiredModifiers","oPropModifiers","MILSTD_2525B","s2525Modifier","createEditor","symStd","iOutputFormat","mapBounds","oRenderer","sec","web","SECWebRenderer","sCoordinateStr","iZoom","getScale","dMaxLabelScale","sBBox","oDimension","pointConverter","PointConverter","sGeoJsonData","RenderSymbol2D","oLeaftletGeoJSON","lineOpacity","strokeWidth","fontFamily","fontSize","fontWeight","sTextAlignment","labelAlign","labelBaseline","fontColor","oNewChildren","FlantenGroup","oGroup","oChildren","Ex","console","createTGFromDraw","oEnginePrivateInterface","oLeafletMap","oDrawItem","dBrngInc","oMapSouthWest","oMapNorthEast","oMapCenterWest","oMapCenterEast","oMapCenterNorth","oMapCenterSouth","dViewWidth","dViewHeight","dQtrWidth","d3rdHeight","oGeoJsonData","TASK_ISOLATE","TASK_OCCUPY","TASK_RETIAN","TASK_SECURE","TASK_CORDON_SEARCH","TASK_CORDON_KNOCK","MINIMUM_SAFE_DISTANCE_ZONES","CCGM_OFFENCE_SUPPORT_BY_FIRE_POSITION","QUANTITY","REDUCED_OR_REINFORCED","STAFF_COMMENTS","ADDITIONAL_INFO_1","ADDITIONAL_INFO_2","ADDITIONAL_INFO_3","EVALUATION_RATING","COMBAT_EFFECTIVENESS","SIGNATURE_EQUIPMENT","HIGHER_FORMATION","HOSTILE","IFF_SIF","DIRECTION_OF_MOVEMENT","OFFSET_INDICATOR","UNIQUE_DESIGNATOR_2","EQUIPMENT_TYPE","DATE_TIME_GROUP","DATE_TIME_GROUP_2","LOCATION","SPEED","SPECIAL_C2_HEADQUARTERS","HEADING","mapping","s2525Modifiers","AIRSPACE_COORDINATION_AREA_IRREGULAR","AIRSPACE_COORDINATION_AREA_RECTANGULAR","AIRSPACE_COORDINATION_AREA_CIRCULAR","RESTRICTED_OPERATIONS_ZONE","HIGH_DENSITY_AIRSPACE_CONTROL_ZONE","MISSILE_ENGAGEMENT_ZONE","MISSILE_ENGAGEMENT_ZONE_LOW_ALTITUDE","MISSILE_ENGAGEMENT_ZONE_HIGH_ALTITUDE","CIRCULAR_TARGET","FORD_EASY","FORD_DIFFICULT","ROADBLOCK_COMPLETE_EXECUTED","SEIZE","AMBUSH","BLOCK_TASK","BRIDGE_OR_GAP","ASSAULT_CROSSING_AREA","FORWARD_AREA_AIR_DEFENSE_ZONE","SHORT_RANGE_AIR_DEFENSE_ENGAGEMENT_ZONE","KILL_BOX_PURPLE_CIRCULAR","KILL_BOX_PURPLE_RECTANGULAR","KILL_BOX_PURPLE_IRREGULAR","iValue","MILSTD_2525C","sKML","sCoordStr","bIsPolygon","aCoord","dLng","dAlt","aStrCoordList","convertLatLngListToKML","getXmlAsString","xmlDom","XMLSerializer","serializeToString","$oKmlDoc","bDone","createAirspace","oAirspace","oInstanceInterface","AirspaceCurtain","AirspacePolygon","AirspaceCylinder","AirspaceOrbit","AirspaceRoute","AirspaceTrack","AirspaceRadArc","AirspacePolyArc","oOvalCoordList","dLeftBearing","dRightBearing","pixelWidth","pixelHeight","normalize","containeIDL","rendererPointConverter","set_normalize","PixelsToGeo","pixel","leafletPoint","getX","getY","point2D","graphics2d","Point2D","setLocation","GeoToPixels","coord","inBoundingBox","coordLatLng","leafletLatLng","ControlPoint","Type","NEW_POSITION_CP","POSITION_CP","ALTITUDE_CP","RADIUS_CP","INNER_RADIUS_CP","WIDTH_CP","LEFT_WIDTH_CP","RIGHT_WIDTH_CP","RANGE_CP","LENGTH_CP","AZIMUTH_CP","LEFT_AZIMUTH_CP","RIGHT_AZIMUTH_CP","ATTITUDE_CP","SEGMENT_CP","AOI_BUFFER","CPIcon","CP_ICON_DEF","newCP","iLineWidth","positionCP","altitudeCP","radiusCP","innerRadiusCP","widthCP","leftWidthCP","rightWidthCP","rangeCP","lengthCP","azimuthCP","leftAzimuthCP","rightAzimuthCP","attitudeCP","segmentCP","aoiBufferCP","oIconDef","cpType","oCPIcons","oPosition","iSubIndex","cpIndex","cpSubIndex","cpValue","cpPopup","getType","_updateCoordinate","setParent","setType","getIndex","setIndex","getSubIndex","setSubIndex","setCPPosition","oValue","_getAngleValue","_getUnitValue","_getAltitudeValue","sAltMode","showPopup","oPopup","hidePopup","updatePopup","oOffsetPoint","StateType","IDLE","ADDING_CP","DELETE_CP","DRAGGING_CP","FEATURE_DRAG","AbstractEditor","bDestroyFeature","editorState","isDrawing","Draw","oEmpDrawEditItem","oCurrentCP","oControlPointList","featureStartLocation","updateIndex","oMarkerPopUp","bCPDragged","isDrawMode","preapareForDrawOperation","preapareForEditOperation","assembleControlPoints","onClickEvent","onFeatureMouseUpEvent","setLeafletObjectEvents","_issueStartEvent","removeLeafletObjectEvents","onCPMouseUpEvent","removeAllControlPoints","getMarkerObject","isMarker","setMarkerEvents","onFeatureMouseDown","removeMarkerEvents","removeCP","getMarkerPopupText","setMarkerPopup","oMarkerObject","bringCPForward","setFeature","getDrawEditItem","createEMPFeature","oEMPFeature","getCenterPT","getCP","iCPIndex","oCPList","doAddControlPoint","doDeleteControlPoint","oCP","doControlPointMoved","doFeatureMove","dDistance","getState","isIdle","isAddingCP","isDeletingCP","isDraggingCP","isDraggingFeature","_setState","eState","isCPAddEvent","altKey","ctrlKey","shiftkey","isCPDeleteEvent","isCPDragStartEvent","isFeatureDragStartEvent","updateCPIndex","addControlPoint","_issueCPAddEvent","onDblClick","_issueCPDeleteEvent","releaseCapture","onCPMouseMoveEvent","_issueCPUpdateEvent","UpdateEventType","UPDATE","aiIndex","onCPMouseDown","setCapture","onFeatureMouseMoveEvent","oOrgLL","oEventCoord","setCPEvents","removeCPEvents","removeAllCPByType","iStartIndex","iDelta","convertToUpdateCoordinates","oUpdateCoordList","empMapInstance","DrawStart","EditStart","oIndexArray","updateEventType","oUpdateEvent","plotFeature","updates","CoordinateUpdateType","indices","mapInstanceId","ADD","REMOVE","_issueEndEvent","COMPLETE","DrawEnd","EditEnd","_issueCancelEvent","oErrArray","level","failures","endEdit","updateLeafletObject","GeoJsonEditor","geoJsonType","_addNewCP","oNewCoord","_createLeafletObject","iNewIndex","iCoordIndex","GeoJson","MilStdEditor","bMultiPoint","oCurrentCoordianteList","oRendererUtils","oCList","MilStd","AOIEditor","dNorth","dSouth","dWest","dEast","oBufferCoord","oMidPointCoord","iMostEastCoord","oMostEastCoord","oNextCoord","aRet","oRefCoord","dMouseAngle","oTempCP","KMLEditor","AirspaceEditor","emp3","api","FeatureTypeEnum","GEO_ACM","Airspace","MilStdDCAutoShapeEditor","dDistC1","dDistC2","dDistC3","Temp","maxPoints","oCPPt2","oCPt","iIndex2","MilStdDCCircularAutoShapeEditor","_addRadiusCP","oCPPosition","dRange","oCPPos","MilStdDCCircularRangeFanEditor","_addRangeCPs","oAMList","iAMCnt","dNextRange","dPrevRange","MilStdDCLineEditor","MilStdDCPolygonEditor","MilStdDCRectParamAutoShapeEditor","_addWidthCP","oWidthPoint","_addLengthCP","oLengthPoint","dLength","_addAttitudeCP","oAttitudePoint","MilStdDCRouteEditor","MilStdDCSectorParamAutoShapeEditor","dMidAzimuth","oANList","iANIndex","bMinimumRange","_addAzimuthCPs","dAzimuthCPDist","iAzimuthIndex","MilStdDCSuperAutoShapeEditor","_createWidthCP","oBasicSymbolCodes","dBearingWLine","oIntPoint","_moveFordCP","oMidPoint","dBearingMidPt3","dNewBearingMidPt3","dNewBearingPt1Pt2","oCP3","Pt3Coord","dBearingMidMouse","_moveBlockCP","_moveAmbushCP","dBearingMidPt1","dNewBearingMidPt1","dBearingPt2Pt3","dNewBearingPt2Pt3","oCP1","Pt1Coord","_moveSeizeCP","oRendererSettings","_moveCP","oCPPt3","MilStdDC2PointLineEditor","MilStdDC2PointRectAutoShapeEditor","MilStdSinglePointEditor","AirspaceCurtainEditor","_addSegmentCP","oCPCoord","AirspacePolygonEditor","AirspaceCylinderEditor","AirspaceOrbitEditor","Pt1","Pt2","dMouseBearing","dDelatAngle","AirspaceRouteEditor","AirspaceTrackEditor","oMidCoord","AirspaceRadArcEditor","_addAzimuthCP","dAvgRadius","AirspacePolyArcEditor","milstdColorFix","engineDefs","leafletMapEngine","checkMapWidth","angularWidth","checkMapCenter","oNorthWest","oTopLeft","oBottomRight","$Container","iContainerHeight","setupEventListeners","onMouseMove","mgrs","ddToMGRS","Pointer","EventType","onMoveEnd","refreshZone","view","getView","lookAt","viewToLookAt","scheduleRendering","ViewChange","processViewSetTrans","onMapClick","generatePointerEvent","onZoomEnd","onViewReset","onMouseUpDown","engineInterface","createEngineTemplate","selectedGeoColor","IGeoColor","bIsV2Core","isV2Core","midDistanceThreshold","zoneChanged","renderList","removeFromRenderList","addToRenderList","isOnRenderList","isRenderListEmpty","getRenderList","altitude","engineParameters","IGeoLabelStyle","sContentCoreId","tacticalGraphics","rangeToScaleMultiplier","zoomScaleMap","rootOverlayId","oLayerControl","hTGRenderingTimer","oGraphicsInViewingArea","oTransactionList","oZoomControl","empProxyURL","engineBasePath","addEmpObject","oEmpObject","storeTransaction","transactionId","findTransaction","oTranID","findTransactionByIntent","sIntent","sTranID","aRetList","intent","removeTransaction","getEmpObject","sSelectedID","oPointerData","getAutoSelect","popupInfo","getLevel","tilt","range","constant","CLAMP_TO_GROUND","roll","oLL","elevation","SINGLE_CLICK","DBL_CLICK","MOUSEDOWN","MOUSEUP","oPoint","pageX","pageY","oFeatureBounds","RerenderingTimerHdlr","currentGraphic","removedGraphicId","oTrans","aViewSetTransList","intents","VIEW_SET","items","mapResizeFn","setLookAt","succeed","oLayerEntry","oControl","oLeafletContent","oLayerList","myElement","addResizeListener","Static","storage","getRootGuid","coreParent","oMainMap","StaticContent","StatusChange","states","READY","fail","MAP_INSTANCE_INIT_FAILED","Status","getStatus","state","removeResizeListener","set","oaItems","MAJOR","jsError","oNewOverlay","oParentOverlay","oNewParent","clear","MINOR","activate","deactivate","bZoom","oEmpBounds","failList","oNewFeature","GEO_POINT","GEO_PATH","GEO_POLYGON","GEO_TEXT","GEO_RECTANGLE","GEO_SQUARE","GEO_CIRCLE","GEO_ELLIPSE","destCoreParent","oOldParent","draw","begin","oOriginalFeature","originFeature","pause","cancel","edit","oEditItem","selection","navigation","settings","mil2525","labels","oNewWMS","createParent","getLatLonFromXY","getXYFromLatLon","newConfig","previousRenderSettings","implementation","displayName","sGenericHelpText","help","capabilities","flat","mapType","type2D","formats","GEOJSON_BASIC","plot","GEOJSON_FULL","version_1_1","version_1_3","KML_BASIC","KML_COMPLEX","version2525B","version2525C","ArcGIS","overlayClustering","labelOption","initialExtent","centerLon"],"mappings":"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","file":"emp3-leaflet.min.js","sourcesContent":["/*\n Leaflet, a JavaScript library for mobile-friendly interactive maps. http://leafletjs.com\n (c) 2010-2013, Vladimir Agafonkin\n (c) 2010-2011, CloudMade\n*/\n(function (window, document, undefined) {\nvar oldL = window.L,\n    L = {};\n\nL.version = '0.7.3';\n/*\n// define Leaflet for Node module pattern loaders, including Browserify\nif (typeof module === 'object' && typeof module.exports === 'object') {\n\tmodule.exports = L;\n\n// define Leaflet as an AMD module\n} else if (typeof define === 'function' && define.amd) {\n\tdefine(L);\n}\n*/\n\n// define Leaflet as a global L variable, saving the original L to restore later if needed\n\nL.noConflict = function () {\n\twindow.L = oldL;\n\treturn this;\n};\n\nwindow.L = L;\n\n\n/*\n * L.Util contains various utility functions used throughout Leaflet code.\n */\n\nL.Util = {\n\textend: function (dest) { // (Object[, Object, ...]) ->\n\t\tvar sources = Array.prototype.slice.call(arguments, 1),\n\t\t    i, j, len, src;\n\n\t\tfor (j = 0, len = sources.length; j < len; j++) {\n\t\t\tsrc = sources[j] || {};\n\t\t\tfor (i in src) {\n\t\t\t\tif (src.hasOwnProperty(i)) {\n\t\t\t\t\tdest[i] = src[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dest;\n\t},\n\n\tbind: function (fn, obj) { // (Function, Object) -> Function\n\t\tvar args = arguments.length > 2 ? Array.prototype.slice.call(arguments, 2) : null;\n\t\treturn function () {\n\t\t\treturn fn.apply(obj, args || arguments);\n\t\t};\n\t},\n\n\tstamp: (function () {\n\t\tvar lastId = 0,\n\t\t    key = '_leaflet_id';\n\t\treturn function (obj) {\n\t\t\tobj[key] = obj[key] || ++lastId;\n\t\t\treturn obj[key];\n\t\t};\n\t}()),\n\n\tinvokeEach: function (obj, method, context) {\n\t\tvar i, args;\n\n\t\tif (typeof obj === 'object') {\n\t\t\targs = Array.prototype.slice.call(arguments, 3);\n\n\t\t\tfor (i in obj) {\n\t\t\t\tmethod.apply(context, [i, obj[i]].concat(args));\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tlimitExecByInterval: function (fn, time, context) {\n\t\tvar lock, execOnUnlock;\n\n\t\treturn function wrapperFn() {\n\t\t\tvar args = arguments;\n\n\t\t\tif (lock) {\n\t\t\t\texecOnUnlock = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlock = true;\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tlock = false;\n\n\t\t\t\tif (execOnUnlock) {\n\t\t\t\t\twrapperFn.apply(context, args);\n\t\t\t\t\texecOnUnlock = false;\n\t\t\t\t}\n\t\t\t}, time);\n\n\t\t\tfn.apply(context, args);\n\t\t};\n\t},\n\n\tfalseFn: function () {\n\t\treturn false;\n\t},\n\n\tformatNum: function (num, digits) {\n\t\tvar pow = Math.pow(10, digits || 5);\n\t\treturn Math.round(num * pow) / pow;\n\t},\n\n\ttrim: function (str) {\n\t\treturn str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n\t},\n\n\tsplitWords: function (str) {\n\t\treturn L.Util.trim(str).split(/\\s+/);\n\t},\n\n\tsetOptions: function (obj, options) {\n\t\tobj.options = L.extend({}, obj.options, options);\n\t\treturn obj.options;\n\t},\n\n\tgetParamString: function (obj, existingUrl, uppercase) {\n\t\tvar params = [];\n\t\tfor (var i in obj) {\n\t\t\tparams.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n\t\t}\n\t\treturn ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n\t},\n\ttemplate: function (str, data) {\n\t\treturn str.replace(/\\{ *([\\w_]+) *\\}/g, function (str, key) {\n\t\t\tvar value = data[key];\n\t\t\tif (value === undefined) {\n\t\t\t\tthrow new Error('No value provided for variable ' + str);\n\t\t\t} else if (typeof value === 'function') {\n\t\t\t\tvalue = value(data);\n\t\t\t}\n\t\t\treturn value;\n\t\t});\n\t},\n\n\tisArray: Array.isArray || function (obj) {\n\t\treturn (Object.prototype.toString.call(obj) === '[object Array]');\n\t},\n\n\temptyImageUrl: 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='\n};\n\n(function () {\n\n\t// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\n\tfunction getPrefixed(name) {\n\t\tvar i, fn,\n\t\t    prefixes = ['webkit', 'moz', 'o', 'ms'];\n\n\t\tfor (i = 0; i < prefixes.length && !fn; i++) {\n\t\t\tfn = window[prefixes[i] + name];\n\t\t}\n\n\t\treturn fn;\n\t}\n\n\tvar lastTime = 0;\n\n\tfunction timeoutDefer(fn) {\n\t\tvar time = +new Date(),\n\t\t    timeToCall = Math.max(0, 16 - (time - lastTime));\n\n\t\tlastTime = time + timeToCall;\n\t\treturn window.setTimeout(fn, timeToCall);\n\t}\n\n\tvar requestFn = window.requestAnimationFrame ||\n\t        getPrefixed('RequestAnimationFrame') || timeoutDefer;\n\n\tvar cancelFn = window.cancelAnimationFrame ||\n\t        getPrefixed('CancelAnimationFrame') ||\n\t        getPrefixed('CancelRequestAnimationFrame') ||\n\t        function (id) { window.clearTimeout(id); };\n\n\n\tL.Util.requestAnimFrame = function (fn, context, immediate, element) {\n\t\tfn = L.bind(fn, context);\n\n\t\tif (immediate && requestFn === timeoutDefer) {\n\t\t\tfn();\n\t\t} else {\n\t\t\treturn requestFn.call(window, fn, element);\n\t\t}\n\t};\n\n\tL.Util.cancelAnimFrame = function (id) {\n\t\tif (id) {\n\t\t\tcancelFn.call(window, id);\n\t\t}\n\t};\n\n}());\n\n// shortcuts for most used utility functions\nL.extend = L.Util.extend;\nL.bind = L.Util.bind;\nL.stamp = L.Util.stamp;\nL.setOptions = L.Util.setOptions;\n\n\n/*\n * L.Class powers the OOP facilities of the library.\n * Thanks to John Resig and Dean Edwards for inspiration!\n */\n\nL.Class = function () {};\n\nL.Class.extend = function (props) {\n\n\t// extended class with the new prototype\n\tvar NewClass = function () {\n\n\t\t// call the constructor\n\t\tif (this.initialize) {\n\t\t\tthis.initialize.apply(this, arguments);\n\t\t}\n\n\t\t// call all constructor hooks\n\t\tif (this._initHooks) {\n\t\t\tthis.callInitHooks();\n\t\t}\n\t};\n\n\t// instantiate class without calling constructor\n\tvar F = function () {};\n\tF.prototype = this.prototype;\n\n\tvar proto = new F();\n\tproto.constructor = NewClass;\n\n\tNewClass.prototype = proto;\n\n\t//inherit parent's statics\n\tfor (var i in this) {\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\n\t\t\tNewClass[i] = this[i];\n\t\t}\n\t}\n\n\t// mix static properties into the class\n\tif (props.statics) {\n\t\tL.extend(NewClass, props.statics);\n\t\tdelete props.statics;\n\t}\n\n\t// mix includes into the prototype\n\tif (props.includes) {\n\t\tL.Util.extend.apply(null, [proto].concat(props.includes));\n\t\tdelete props.includes;\n\t}\n\n\t// merge options\n\tif (props.options && proto.options) {\n\t\tprops.options = L.extend({}, proto.options, props.options);\n\t}\n\n\t// mix given properties into the prototype\n\tL.extend(proto, props);\n\n\tproto._initHooks = [];\n\n\tvar parent = this;\n\t// jshint camelcase: false\n\tNewClass.__super__ = parent.prototype;\n\n\t// add method for calling all hooks\n\tproto.callInitHooks = function () {\n\n\t\tif (this._initHooksCalled) { return; }\n\n\t\tif (parent.prototype.callInitHooks) {\n\t\t\tparent.prototype.callInitHooks.call(this);\n\t\t}\n\n\t\tthis._initHooksCalled = true;\n\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\n\t\t\tproto._initHooks[i].call(this);\n\t\t}\n\t};\n\n\treturn NewClass;\n};\n\n\n// method for adding properties to prototype\nL.Class.include = function (props) {\n\tL.extend(this.prototype, props);\n};\n\n// merge new default options to the Class\nL.Class.mergeOptions = function (options) {\n\tL.extend(this.prototype.options, options);\n};\n\n// add a constructor hook\nL.Class.addInitHook = function (fn) { // (Function) || (String, args...)\n\tvar args = Array.prototype.slice.call(arguments, 1);\n\n\tvar init = typeof fn === 'function' ? fn : function () {\n\t\tthis[fn].apply(this, args);\n\t};\n\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\n\tthis.prototype._initHooks.push(init);\n};\n\n\n/*\n * L.Mixin.Events is used to add custom events functionality to Leaflet classes.\n */\n\nvar eventsKey = '_leaflet_events';\n\nL.Mixin = {};\n\nL.Mixin.Events = {\n\n\taddEventListener: function (types, fn, context) { // (String, Function[, Object]) or (Object[, Object])\n\n\t\t// types can be a map of types/handlers\n\t\tif (L.Util.invokeEach(types, this.addEventListener, this, fn, context)) { return this; }\n\n\t\tvar events = this[eventsKey] = this[eventsKey] || {},\n\t\t    contextId = context && context !== this && L.stamp(context),\n\t\t    i, len, event, type, indexKey, indexLenKey, typeIndex;\n\n\t\t// types can be a string of space-separated words\n\t\ttypes = L.Util.splitWords(types);\n\n\t\tfor (i = 0, len = types.length; i < len; i++) {\n\t\t\tevent = {\n\t\t\t\taction: fn,\n\t\t\t\tcontext: context || this\n\t\t\t};\n\t\t\ttype = types[i];\n\n\t\t\tif (contextId) {\n\t\t\t\t// store listeners of a particular context in a separate hash (if it has an id)\n\t\t\t\t// gives a major performance boost when removing thousands of map layers\n\n\t\t\t\tindexKey = type + '_idx';\n\t\t\t\tindexLenKey = indexKey + '_len';\n\n\t\t\t\ttypeIndex = events[indexKey] = events[indexKey] || {};\n\n\t\t\t\tif (!typeIndex[contextId]) {\n\t\t\t\t\ttypeIndex[contextId] = [];\n\n\t\t\t\t\t// keep track of the number of keys in the index to quickly check if it's empty\n\t\t\t\t\tevents[indexLenKey] = (events[indexLenKey] || 0) + 1;\n\t\t\t\t}\n\n\t\t\t\ttypeIndex[contextId].push(event);\n\n\n\t\t\t} else {\n\t\t\t\tevents[type] = events[type] || [];\n\t\t\t\tevents[type].push(event);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\thasEventListeners: function (type) { // (String) -> Boolean\n\t\tvar events = this[eventsKey];\n\t\treturn !!events && ((type in events && events[type].length > 0) ||\n\t\t                    (type + '_idx' in events && events[type + '_idx_len'] > 0));\n\t},\n\n\tremoveEventListener: function (types, fn, context) { // ([String, Function, Object]) or (Object[, Object])\n\n\t\tif (!this[eventsKey]) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif (!types) {\n\t\t\treturn this.clearAllEventListeners();\n\t\t}\n\n\t\tif (L.Util.invokeEach(types, this.removeEventListener, this, fn, context)) { return this; }\n\n\t\tvar events = this[eventsKey],\n\t\t    contextId = context && context !== this && L.stamp(context),\n\t\t    i, len, type, listeners, j, indexKey, indexLenKey, typeIndex, removed;\n\n\t\ttypes = L.Util.splitWords(types);\n\n\t\tfor (i = 0, len = types.length; i < len; i++) {\n\t\t\ttype = types[i];\n\t\t\tindexKey = type + '_idx';\n\t\t\tindexLenKey = indexKey + '_len';\n\n\t\t\ttypeIndex = events[indexKey];\n\n\t\t\tif (!fn) {\n\t\t\t\t// clear all listeners for a type if function isn't specified\n\t\t\t\tdelete events[type];\n\t\t\t\tdelete events[indexKey];\n\t\t\t\tdelete events[indexLenKey];\n\n\t\t\t} else {\n\t\t\t\tlisteners = contextId && typeIndex ? typeIndex[contextId] : events[type];\n\n\t\t\t\tif (listeners) {\n\t\t\t\t\tfor (j = listeners.length - 1; j >= 0; j--) {\n\t\t\t\t\t\tif ((listeners[j].action === fn) && (!context || (listeners[j].context === context))) {\n\t\t\t\t\t\t\tremoved = listeners.splice(j, 1);\n\t\t\t\t\t\t\t// set the old action to a no-op, because it is possible\n\t\t\t\t\t\t\t// that the listener is being iterated over as part of a dispatch\n\t\t\t\t\t\t\tremoved[0].action = L.Util.falseFn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (context && typeIndex && (listeners.length === 0)) {\n\t\t\t\t\t\tdelete typeIndex[contextId];\n\t\t\t\t\t\tevents[indexLenKey]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclearAllEventListeners: function () {\n\t\tdelete this[eventsKey];\n\t\treturn this;\n\t},\n\n\tfireEvent: function (type, data) { // (String[, Object])\n\t\tif (!this.hasEventListeners(type)) {\n\t\t\treturn this;\n\t\t}\n\n\t\tvar event = L.Util.extend({}, data, { type: type, target: this });\n\n\t\tvar events = this[eventsKey],\n\t\t    listeners, i, len, typeIndex, contextId;\n\n\t\tif (events[type]) {\n\t\t\t// make sure adding/removing listeners inside other listeners won't cause infinite loop\n\t\t\tlisteners = events[type].slice();\n\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\tlisteners[i].action.call(listeners[i].context, event);\n\t\t\t}\n\t\t}\n\n\t\t// fire event for the context-indexed listeners as well\n\t\ttypeIndex = events[type + '_idx'];\n\n\t\tfor (contextId in typeIndex) {\n\t\t\tlisteners = typeIndex[contextId].slice();\n\n\t\t\tif (listeners) {\n\t\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\t\tlisteners[i].action.call(listeners[i].context, event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\taddOneTimeEventListener: function (types, fn, context) {\n\n\t\tif (L.Util.invokeEach(types, this.addOneTimeEventListener, this, fn, context)) { return this; }\n\n\t\tvar handler = L.bind(function () {\n\t\t\tthis\n\t\t\t    .removeEventListener(types, fn, context)\n\t\t\t    .removeEventListener(types, handler, context);\n\t\t}, this);\n\n\t\treturn this\n\t\t    .addEventListener(types, fn, context)\n\t\t    .addEventListener(types, handler, context);\n\t}\n};\n\nL.Mixin.Events.on = L.Mixin.Events.addEventListener;\nL.Mixin.Events.off = L.Mixin.Events.removeEventListener;\nL.Mixin.Events.once = L.Mixin.Events.addOneTimeEventListener;\nL.Mixin.Events.fire = L.Mixin.Events.fireEvent;\n\n\n/*\n * L.Browser handles different browser and feature detections for internal Leaflet use.\n */\n\n(function () {\n\n\tvar ie = 'ActiveXObject' in window,\n\t\tielt9 = ie && !document.addEventListener,\n\n\t    // terrible browser detection to work around Safari / iOS / Android browser bugs\n\t    ua = navigator.userAgent.toLowerCase(),\n\t    webkit = ua.indexOf('webkit') !== -1,\n\t    chrome = ua.indexOf('chrome') !== -1,\n\t    phantomjs = ua.indexOf('phantom') !== -1,\n\t    android = ua.indexOf('android') !== -1,\n\t    android23 = ua.search('android [23]') !== -1,\n\t\tgecko = ua.indexOf('gecko') !== -1,\n\n\t    mobile = typeof orientation !== undefined + '',\n\t    msPointer = window.navigator && window.navigator.msPointerEnabled &&\n\t              window.navigator.msMaxTouchPoints && !window.PointerEvent,\n\t\tpointer = (window.PointerEvent && window.navigator.pointerEnabled && window.navigator.maxTouchPoints) ||\n\t\t\t\t  msPointer,\n\t    retina = ('devicePixelRatio' in window && window.devicePixelRatio > 1) ||\n\t             ('matchMedia' in window && window.matchMedia('(min-resolution:144dpi)') &&\n\t              window.matchMedia('(min-resolution:144dpi)').matches),\n\n\t    doc = document.documentElement,\n\t    ie3d = ie && ('transition' in doc.style),\n\t    webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23,\n\t    gecko3d = 'MozPerspective' in doc.style,\n\t    opera3d = 'OTransition' in doc.style,\n\t    any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d || opera3d) && !phantomjs;\n\n\n\t// PhantomJS has 'ontouchstart' in document.documentElement, but doesn't actually support touch.\n\t// https://github.com/Leaflet/Leaflet/pull/1434#issuecomment-13843151\n\n\tvar touch = !window.L_NO_TOUCH && !phantomjs && (function () {\n\n\t\tvar startName = 'ontouchstart';\n\n\t\t// IE10+ (We simulate these into touch* events in L.DomEvent and L.DomEvent.Pointer) or WebKit, etc.\n\t\tif (pointer || (startName in doc)) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Firefox/Gecko\n\t\tvar div = document.createElement('div'),\n\t\t    supported = false;\n\n\t\tif (!div.setAttribute) {\n\t\t\treturn false;\n\t\t}\n\t\tdiv.setAttribute(startName, 'return;');\n\n\t\tif (typeof div[startName] === 'function') {\n\t\t\tsupported = true;\n\t\t}\n\n\t\tdiv.removeAttribute(startName);\n\t\tdiv = null;\n\n\t\treturn supported;\n\t}());\n\n\n\tL.Browser = {\n\t\tie: ie,\n\t\tielt9: ielt9,\n\t\twebkit: webkit,\n\t\tgecko: gecko && !webkit && !window.opera && !ie,\n\n\t\tandroid: android,\n\t\tandroid23: android23,\n\n\t\tchrome: chrome,\n\n\t\tie3d: ie3d,\n\t\twebkit3d: webkit3d,\n\t\tgecko3d: gecko3d,\n\t\topera3d: opera3d,\n\t\tany3d: any3d,\n\n\t\tmobile: mobile,\n\t\tmobileWebkit: mobile && webkit,\n\t\tmobileWebkit3d: mobile && webkit3d,\n\t\tmobileOpera: mobile && window.opera,\n\n\t\ttouch: touch,\n\t\tmsPointer: msPointer,\n\t\tpointer: pointer,\n\n\t\tretina: retina\n\t};\n\n}());\n\n\n/*\n * L.Point represents a point with x and y coordinates.\n */\n\nL.Point = function (/*Number*/ x, /*Number*/ y, /*Boolean*/ round) {\n\tthis.x = (round ? Math.round(x) : x);\n\tthis.y = (round ? Math.round(y) : y);\n};\n\nL.Point.prototype = {\n\n\tclone: function () {\n\t\treturn new L.Point(this.x, this.y);\n\t},\n\n\t// non-destructive, returns a new point\n\tadd: function (point) {\n\t\treturn this.clone()._add(L.point(point));\n\t},\n\n\t// destructive, used directly for performance in situations where it's safe to modify existing point\n\t_add: function (point) {\n\t\tthis.x += point.x;\n\t\tthis.y += point.y;\n\t\treturn this;\n\t},\n\n\tsubtract: function (point) {\n\t\treturn this.clone()._subtract(L.point(point));\n\t},\n\n\t_subtract: function (point) {\n\t\tthis.x -= point.x;\n\t\tthis.y -= point.y;\n\t\treturn this;\n\t},\n\n\tdivideBy: function (num) {\n\t\treturn this.clone()._divideBy(num);\n\t},\n\n\t_divideBy: function (num) {\n\t\tthis.x /= num;\n\t\tthis.y /= num;\n\t\treturn this;\n\t},\n\n\tmultiplyBy: function (num) {\n\t\treturn this.clone()._multiplyBy(num);\n\t},\n\n\t_multiplyBy: function (num) {\n\t\tthis.x *= num;\n\t\tthis.y *= num;\n\t\treturn this;\n\t},\n\n\tround: function () {\n\t\treturn this.clone()._round();\n\t},\n\n\t_round: function () {\n\t\tthis.x = Math.round(this.x);\n\t\tthis.y = Math.round(this.y);\n\t\treturn this;\n\t},\n\n\tfloor: function () {\n\t\treturn this.clone()._floor();\n\t},\n\n\t_floor: function () {\n\t\tthis.x = Math.floor(this.x);\n\t\tthis.y = Math.floor(this.y);\n\t\treturn this;\n\t},\n\n\tdistanceTo: function (point) {\n\t\tpoint = L.point(point);\n\n\t\tvar x = point.x - this.x,\n\t\t    y = point.y - this.y;\n\n\t\treturn Math.sqrt(x * x + y * y);\n\t},\n\n\tequals: function (point) {\n\t\tpoint = L.point(point);\n\n\t\treturn point.x === this.x &&\n\t\t       point.y === this.y;\n\t},\n\n\tcontains: function (point) {\n\t\tpoint = L.point(point);\n\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\n\t},\n\n\ttoString: function () {\n\t\treturn 'Point(' +\n\t\t        L.Util.formatNum(this.x) + ', ' +\n\t\t        L.Util.formatNum(this.y) + ')';\n\t}\n};\n\nL.point = function (x, y, round) {\n\tif (x instanceof L.Point) {\n\t\treturn x;\n\t}\n\tif (L.Util.isArray(x)) {\n\t\treturn new L.Point(x[0], x[1]);\n\t}\n\tif (x === undefined || x === null) {\n\t\treturn x;\n\t}\n\treturn new L.Point(x, y, round);\n};\n\n\n/*\n * L.Bounds represents a rectangular area on the screen in pixel coordinates.\n */\n\nL.Bounds = function (a, b) { //(Point, Point) or Point[]\n\tif (!a) { return; }\n\n\tvar points = b ? [a, b] : a;\n\n\tfor (var i = 0, len = points.length; i < len; i++) {\n\t\tthis.extend(points[i]);\n\t}\n};\n\nL.Bounds.prototype = {\n\t// extend the bounds to contain the given point\n\textend: function (point) { // (Point)\n\t\tpoint = L.point(point);\n\n\t\tif (!this.min && !this.max) {\n\t\t\tthis.min = point.clone();\n\t\t\tthis.max = point.clone();\n\t\t} else {\n\t\t\tthis.min.x = Math.min(point.x, this.min.x);\n\t\t\tthis.max.x = Math.max(point.x, this.max.x);\n\t\t\tthis.min.y = Math.min(point.y, this.min.y);\n\t\t\tthis.max.y = Math.max(point.y, this.max.y);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetCenter: function (round) { // (Boolean) -> Point\n\t\treturn new L.Point(\n\t\t        (this.min.x + this.max.x) / 2,\n\t\t        (this.min.y + this.max.y) / 2, round);\n\t},\n\n\tgetBottomLeft: function () { // -> Point\n\t\treturn new L.Point(this.min.x, this.max.y);\n\t},\n\n\tgetTopRight: function () { // -> Point\n\t\treturn new L.Point(this.max.x, this.min.y);\n\t},\n\n\tgetSize: function () {\n\t\treturn this.max.subtract(this.min);\n\t},\n\n\tcontains: function (obj) { // (Bounds) or (Point) -> Boolean\n\t\tvar min, max;\n\n\t\tif (typeof obj[0] === 'number' || obj instanceof L.Point) {\n\t\t\tobj = L.point(obj);\n\t\t} else {\n\t\t\tobj = L.bounds(obj);\n\t\t}\n\n\t\tif (obj instanceof L.Bounds) {\n\t\t\tmin = obj.min;\n\t\t\tmax = obj.max;\n\t\t} else {\n\t\t\tmin = max = obj;\n\t\t}\n\n\t\treturn (min.x >= this.min.x) &&\n\t\t       (max.x <= this.max.x) &&\n\t\t       (min.y >= this.min.y) &&\n\t\t       (max.y <= this.max.y);\n\t},\n\n\tintersects: function (bounds) { // (Bounds) -> Boolean\n\t\tbounds = L.bounds(bounds);\n\n\t\tvar min = this.min,\n\t\t    max = this.max,\n\t\t    min2 = bounds.min,\n\t\t    max2 = bounds.max,\n\t\t    xIntersects = (max2.x >= min.x) && (min2.x <= max.x),\n\t\t    yIntersects = (max2.y >= min.y) && (min2.y <= max.y);\n\n\t\treturn xIntersects && yIntersects;\n\t},\n\n\tisValid: function () {\n\t\treturn !!(this.min && this.max);\n\t}\n};\n\nL.bounds = function (a, b) { // (Bounds) or (Point, Point) or (Point[])\n\tif (!a || a instanceof L.Bounds) {\n\t\treturn a;\n\t}\n\treturn new L.Bounds(a, b);\n};\n\n\n/*\n * L.Transformation is an utility class to perform simple point transformations through a 2d-matrix.\n */\n\nL.Transformation = function (a, b, c, d) {\n\tthis._a = a;\n\tthis._b = b;\n\tthis._c = c;\n\tthis._d = d;\n};\n\nL.Transformation.prototype = {\n\ttransform: function (point, scale) { // (Point, Number) -> Point\n\t\treturn this._transform(point.clone(), scale);\n\t},\n\n\t// destructive transform (faster)\n\t_transform: function (point, scale) {\n\t\tscale = scale || 1;\n\t\tpoint.x = scale * (this._a * point.x + this._b);\n\t\tpoint.y = scale * (this._c * point.y + this._d);\n\t\treturn point;\n\t},\n\n\tuntransform: function (point, scale) {\n\t\tscale = scale || 1;\n\t\treturn new L.Point(\n\t\t        (point.x / scale - this._b) / this._a,\n\t\t        (point.y / scale - this._d) / this._c);\n\t}\n};\n\n\n/*\n * L.DomUtil contains various utility functions for working with DOM.\n */\n\nL.DomUtil = {\n\tget: function (id) {\n\t\treturn (typeof id === 'string' ? document.getElementById(id) : id);\n\t},\n\n\tgetStyle: function (el, style) {\n\n\t\tvar value = el.style[style];\n\n\t\tif (!value && el.currentStyle) {\n\t\t\tvalue = el.currentStyle[style];\n\t\t}\n\n\t\tif ((!value || value === 'auto') && document.defaultView) {\n\t\t\tvar css = document.defaultView.getComputedStyle(el, null);\n\t\t\tvalue = css ? css[style] : null;\n\t\t}\n\n\t\treturn value === 'auto' ? null : value;\n\t},\n\n\tgetViewportOffset: function (element) {\n\n\t\tvar top = 0,\n\t\t    left = 0,\n\t\t    el = element,\n\t\t    docBody = document.body,\n\t\t    docEl = document.documentElement,\n\t\t    pos;\n\n\t\tdo {\n\t\t\ttop  += el.offsetTop  || 0;\n\t\t\tleft += el.offsetLeft || 0;\n\n\t\t\t//add borders\n\t\t\ttop += parseInt(L.DomUtil.getStyle(el, 'borderTopWidth'), 10) || 0;\n\t\t\tleft += parseInt(L.DomUtil.getStyle(el, 'borderLeftWidth'), 10) || 0;\n\n\t\t\tpos = L.DomUtil.getStyle(el, 'position');\n\n\t\t\tif (el.offsetParent === docBody && pos === 'absolute') { break; }\n\n\t\t\tif (pos === 'fixed') {\n\t\t\t\ttop  += docBody.scrollTop  || docEl.scrollTop  || 0;\n\t\t\t\tleft += docBody.scrollLeft || docEl.scrollLeft || 0;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (pos === 'relative' && !el.offsetLeft) {\n\t\t\t\tvar width = L.DomUtil.getStyle(el, 'width'),\n\t\t\t\t    maxWidth = L.DomUtil.getStyle(el, 'max-width'),\n\t\t\t\t    r = el.getBoundingClientRect();\n\n\t\t\t\tif (width !== 'none' || maxWidth !== 'none') {\n\t\t\t\t\tleft += r.left + el.clientLeft;\n\t\t\t\t}\n\n\t\t\t\t//calculate full y offset since we're breaking out of the loop\n\t\t\t\ttop += r.top + (docBody.scrollTop  || docEl.scrollTop  || 0);\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tel = el.offsetParent;\n\n\t\t} while (el);\n\n\t\tel = element;\n\n\t\tdo {\n\t\t\tif (el === docBody) { break; }\n\n\t\t\ttop  -= el.scrollTop  || 0;\n\t\t\tleft -= el.scrollLeft || 0;\n\n\t\t\tel = el.parentNode;\n\t\t} while (el);\n\n\t\treturn new L.Point(left, top);\n\t},\n\n\tdocumentIsLtr: function () {\n\t\tif (!L.DomUtil._docIsLtrCached) {\n\t\t\tL.DomUtil._docIsLtrCached = true;\n\t\t\tL.DomUtil._docIsLtr = L.DomUtil.getStyle(document.body, 'direction') === 'ltr';\n\t\t}\n\t\treturn L.DomUtil._docIsLtr;\n\t},\n\n\tcreate: function (tagName, className, container) {\n\n\t\tvar el = document.createElement(tagName);\n\t\tel.className = className;\n\n\t\tif (container) {\n\t\t\tcontainer.appendChild(el);\n\t\t}\n\n\t\treturn el;\n\t},\n\n\thasClass: function (el, name) {\n\t\tif (el.classList !== undefined) {\n\t\t\treturn el.classList.contains(name);\n\t\t}\n\t\tvar className = L.DomUtil._getClass(el);\n\t\treturn className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n\t},\n\n\taddClass: function (el, name) {\n\t\tif (el.classList !== undefined) {\n\t\t\tvar classes = L.Util.splitWords(name);\n\t\t\tfor (var i = 0, len = classes.length; i < len; i++) {\n\t\t\t\tel.classList.add(classes[i]);\n\t\t\t}\n\t\t} else if (!L.DomUtil.hasClass(el, name)) {\n\t\t\tvar className = L.DomUtil._getClass(el);\n\t\t\tL.DomUtil._setClass(el, (className ? className + ' ' : '') + name);\n\t\t}\n\t},\n\n\tremoveClass: function (el, name) {\n\t\tif (el.classList !== undefined) {\n\t\t\tel.classList.remove(name);\n\t\t} else {\n\t\t\tL.DomUtil._setClass(el, L.Util.trim((' ' + L.DomUtil._getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n\t\t}\n\t},\n\n\t_setClass: function (el, name) {\n\t\tif (el.className.baseVal === undefined) {\n\t\t\tel.className = name;\n\t\t} else {\n\t\t\t// in case of SVG element\n\t\t\tel.className.baseVal = name;\n\t\t}\n\t},\n\n\t_getClass: function (el) {\n\t\treturn el.className.baseVal === undefined ? el.className : el.className.baseVal;\n\t},\n\n\tsetOpacity: function (el, value) {\n\n\t\tif ('opacity' in el.style) {\n\t\t\tel.style.opacity = value;\n\n\t\t} else if ('filter' in el.style) {\n\n\t\t\tvar filter = false,\n\t\t\t    filterName = 'DXImageTransform.Microsoft.Alpha';\n\n\t\t\t// filters collection throws an error if we try to retrieve a filter that doesn't exist\n\t\t\ttry {\n\t\t\t\tfilter = el.filters.item(filterName);\n\t\t\t} catch (e) {\n\t\t\t\t// don't set opacity to 1 if we haven't already set an opacity,\n\t\t\t\t// it isn't needed and breaks transparent pngs.\n\t\t\t\tif (value === 1) { return; }\n\t\t\t}\n\n\t\t\tvalue = Math.round(value * 100);\n\n\t\t\tif (filter) {\n\t\t\t\tfilter.Enabled = (value !== 100);\n\t\t\t\tfilter.Opacity = value;\n\t\t\t} else {\n\t\t\t\tel.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n\t\t\t}\n\t\t}\n\t},\n\n\ttestProp: function (props) {\n\n\t\tvar style = document.documentElement.style;\n\n\t\tfor (var i = 0; i < props.length; i++) {\n\t\t\tif (props[i] in style) {\n\t\t\t\treturn props[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\tgetTranslateString: function (point) {\n\t\t// on WebKit browsers (Chrome/Safari/iOS Safari/Android) using translate3d instead of translate\n\t\t// makes animation smoother as it ensures HW accel is used. Firefox 13 doesn't care\n\t\t// (same speed either way), Opera 12 doesn't support translate3d\n\n\t\tvar is3d = L.Browser.webkit3d,\n\t\t    open = 'translate' + (is3d ? '3d' : '') + '(',\n\t\t    close = (is3d ? ',0' : '') + ')';\n\n\t\treturn open + point.x + 'px,' + point.y + 'px' + close;\n\t},\n\n\tgetScaleString: function (scale, origin) {\n\n\t\tvar preTranslateStr = L.DomUtil.getTranslateString(origin.add(origin.multiplyBy(-1 * scale))),\n\t\t    scaleStr = ' scale(' + scale + ') ';\n\n\t\treturn preTranslateStr + scaleStr;\n\t},\n\n\tsetPosition: function (el, point, disable3D) { // (HTMLElement, Point[, Boolean])\n\n\t\t// jshint camelcase: false\n\t\tel._leaflet_pos = point;\n\n\t\tif (!disable3D && L.Browser.any3d) {\n\t\t\tel.style[L.DomUtil.TRANSFORM] =  L.DomUtil.getTranslateString(point);\n\t\t} else {\n\t\t\tel.style.left = point.x + 'px';\n\t\t\tel.style.top = point.y + 'px';\n\t\t}\n\t},\n\n\tgetPosition: function (el) {\n\t\t// this method is only used for elements previously positioned using setPosition,\n\t\t// so it's safe to cache the position for performance\n\n\t\t// jshint camelcase: false\n\t\treturn el._leaflet_pos;\n\t}\n};\n\n\n// prefix style property names\n\nL.DomUtil.TRANSFORM = L.DomUtil.testProp(\n        ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\nL.DomUtil.TRANSITION = L.DomUtil.testProp(\n        ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nL.DomUtil.TRANSITION_END =\n        L.DomUtil.TRANSITION === 'webkitTransition' || L.DomUtil.TRANSITION === 'OTransition' ?\n        L.DomUtil.TRANSITION + 'End' : 'transitionend';\n\n(function () {\n    if ('onselectstart' in document) {\n        L.extend(L.DomUtil, {\n            disableTextSelection: function () {\n                L.DomEvent.on(window, 'selectstart', L.DomEvent.preventDefault);\n            },\n\n            enableTextSelection: function () {\n                L.DomEvent.off(window, 'selectstart', L.DomEvent.preventDefault);\n            }\n        });\n    } else {\n        var userSelectProperty = L.DomUtil.testProp(\n            ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n        L.extend(L.DomUtil, {\n            disableTextSelection: function () {\n                if (userSelectProperty) {\n                    var style = document.documentElement.style;\n                    this._userSelect = style[userSelectProperty];\n                    style[userSelectProperty] = 'none';\n                }\n            },\n\n            enableTextSelection: function () {\n                if (userSelectProperty) {\n                    document.documentElement.style[userSelectProperty] = this._userSelect;\n                    delete this._userSelect;\n                }\n            }\n        });\n    }\n\n\tL.extend(L.DomUtil, {\n\t\tdisableImageDrag: function () {\n\t\t\tL.DomEvent.on(window, 'dragstart', L.DomEvent.preventDefault);\n\t\t},\n\n\t\tenableImageDrag: function () {\n\t\t\tL.DomEvent.off(window, 'dragstart', L.DomEvent.preventDefault);\n\t\t}\n\t});\n})();\n\n\n/*\n * L.LatLng represents a geographical point with latitude and longitude coordinates.\n */\n\nL.LatLng = function (lat, lng, alt) { // (Number, Number, Number)\n\tlat = parseFloat(lat);\n\tlng = parseFloat(lng);\n\n\tif (isNaN(lat) || isNaN(lng)) {\n\t\tthrow new Error('Invalid LatLng object: (' + lat + ', ' + lng + ')');\n\t}\n\n\tthis.lat = lat;\n\tthis.lng = lng;\n\n\tif (alt !== undefined) {\n\t\tthis.alt = parseFloat(alt);\n\t}\n};\n\nL.extend(L.LatLng, {\n\tDEG_TO_RAD: Math.PI / 180,\n\tRAD_TO_DEG: 180 / Math.PI,\n\tMAX_MARGIN: 1.0E-9 // max margin of error for the \"equals\" check\n});\n\nL.LatLng.prototype = {\n\tequals: function (obj) { // (LatLng) -> Boolean\n\t\tif (!obj) { return false; }\n\n\t\tobj = L.latLng(obj);\n\n\t\tvar margin = Math.max(\n\t\t        Math.abs(this.lat - obj.lat),\n\t\t        Math.abs(this.lng - obj.lng));\n\n\t\treturn margin <= L.LatLng.MAX_MARGIN;\n\t},\n\n\ttoString: function (precision) { // (Number) -> String\n\t\treturn 'LatLng(' +\n\t\t        L.Util.formatNum(this.lat, precision) + ', ' +\n\t\t        L.Util.formatNum(this.lng, precision) + ')';\n\t},\n\n\t// Haversine distance formula, see http://en.wikipedia.org/wiki/Haversine_formula\n\t// TODO move to projection code, LatLng shouldn't know about Earth\n\tdistanceTo: function (other) { // (LatLng) -> Number\n\t\tother = L.latLng(other);\n\n\t\tvar R = 6378137, // earth radius in meters\n\t\t    d2r = L.LatLng.DEG_TO_RAD,\n\t\t    dLat = (other.lat - this.lat) * d2r,\n\t\t    dLon = (other.lng - this.lng) * d2r,\n\t\t    lat1 = this.lat * d2r,\n\t\t    lat2 = other.lat * d2r,\n\t\t    sin1 = Math.sin(dLat / 2),\n\t\t    sin2 = Math.sin(dLon / 2);\n\n\t\tvar a = sin1 * sin1 + sin2 * sin2 * Math.cos(lat1) * Math.cos(lat2);\n\n\t\treturn R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\t},\n\n\twrap: function (a, b) { // (Number, Number) -> LatLng\n\t\tvar lng = this.lng;\n\n\t\ta = a || -180;\n\t\tb = b ||  180;\n\n\t\tlng = (lng + b) % (b - a) + (lng < a || lng === b ? b : a);\n\n\t\treturn new L.LatLng(this.lat, lng);\n\t}\n};\n\nL.latLng = function (a, b) { // (LatLng) or ([Number, Number]) or (Number, Number)\n\tif (a instanceof L.LatLng) {\n\t\treturn a;\n\t}\n\tif (L.Util.isArray(a)) {\n\t\tif (typeof a[0] === 'number' || typeof a[0] === 'string') {\n\t\t\treturn new L.LatLng(a[0], a[1], a[2]);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\tif (a === undefined || a === null) {\n\t\treturn a;\n\t}\n\tif (typeof a === 'object' && 'lat' in a) {\n\t\treturn new L.LatLng(a.lat, 'lng' in a ? a.lng : a.lon);\n\t}\n\tif (b === undefined) {\n\t\treturn null;\n\t}\n\treturn new L.LatLng(a, b);\n};\n\n\n\n/*\n * L.LatLngBounds represents a rectangular area on the map in geographical coordinates.\n */\n\nL.LatLngBounds = function (southWest, northEast) { // (LatLng, LatLng) or (LatLng[])\n\tif (!southWest) { return; }\n\n\tvar latlngs = northEast ? [southWest, northEast] : southWest;\n\n\tfor (var i = 0, len = latlngs.length; i < len; i++) {\n\t\tthis.extend(latlngs[i]);\n\t}\n};\n\nL.LatLngBounds.prototype = {\n\t// extend the bounds to contain the given point or bounds\n\textend: function (obj) { // (LatLng) or (LatLngBounds)\n\t\tif (!obj) { return this; }\n\n\t\tvar latLng = L.latLng(obj);\n\t\tif (latLng !== null) {\n\t\t\tobj = latLng;\n\t\t} else {\n\t\t\tobj = L.latLngBounds(obj);\n\t\t}\n\n\t\tif (obj instanceof L.LatLng) {\n\t\t\tif (!this._southWest && !this._northEast) {\n\t\t\t\tthis._southWest = new L.LatLng(obj.lat, obj.lng);\n\t\t\t\tthis._northEast = new L.LatLng(obj.lat, obj.lng);\n\t\t\t} else {\n\t\t\t\tthis._southWest.lat = Math.min(obj.lat, this._southWest.lat);\n\t\t\t\tthis._southWest.lng = Math.min(obj.lng, this._southWest.lng);\n\n\t\t\t\tthis._northEast.lat = Math.max(obj.lat, this._northEast.lat);\n\t\t\t\tthis._northEast.lng = Math.max(obj.lng, this._northEast.lng);\n\t\t\t}\n\t\t} else if (obj instanceof L.LatLngBounds) {\n\t\t\tthis.extend(obj._southWest);\n\t\t\tthis.extend(obj._northEast);\n\t\t}\n\t\treturn this;\n\t},\n\n\t// extend the bounds by a percentage\n\tpad: function (bufferRatio) { // (Number) -> LatLngBounds\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    heightBuffer = Math.abs(sw.lat - ne.lat) * bufferRatio,\n\t\t    widthBuffer = Math.abs(sw.lng - ne.lng) * bufferRatio;\n\n\t\treturn new L.LatLngBounds(\n\t\t        new L.LatLng(sw.lat - heightBuffer, sw.lng - widthBuffer),\n\t\t        new L.LatLng(ne.lat + heightBuffer, ne.lng + widthBuffer));\n\t},\n\n\tgetCenter: function () { // -> LatLng\n\t\treturn new L.LatLng(\n\t\t        (this._southWest.lat + this._northEast.lat) / 2,\n\t\t        (this._southWest.lng + this._northEast.lng) / 2);\n\t},\n\n\tgetSouthWest: function () {\n\t\treturn this._southWest;\n\t},\n\n\tgetNorthEast: function () {\n\t\treturn this._northEast;\n\t},\n\n\tgetNorthWest: function () {\n\t\treturn new L.LatLng(this.getNorth(), this.getWest());\n\t},\n\n\tgetSouthEast: function () {\n\t\treturn new L.LatLng(this.getSouth(), this.getEast());\n\t},\n\n\tgetWest: function () {\n\t\treturn this._southWest.lng;\n\t},\n\n\tgetSouth: function () {\n\t\treturn this._southWest.lat;\n\t},\n\n\tgetEast: function () {\n\t\treturn this._northEast.lng;\n\t},\n\n\tgetNorth: function () {\n\t\treturn this._northEast.lat;\n\t},\n\n\tcontains: function (obj) { // (LatLngBounds) or (LatLng) -> Boolean\n\t\tif (typeof obj[0] === 'number' || obj instanceof L.LatLng) {\n\t\t\tobj = L.latLng(obj);\n\t\t} else {\n\t\t\tobj = L.latLngBounds(obj);\n\t\t}\n\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    sw2, ne2;\n\n\t\tif (obj instanceof L.LatLngBounds) {\n\t\t\tsw2 = obj.getSouthWest();\n\t\t\tne2 = obj.getNorthEast();\n\t\t} else {\n\t\t\tsw2 = ne2 = obj;\n\t\t}\n\n\t\treturn (sw2.lat >= sw.lat) && (ne2.lat <= ne.lat) &&\n\t\t       (sw2.lng >= sw.lng) && (ne2.lng <= ne.lng);\n\t},\n\n\tintersects: function (bounds) { // (LatLngBounds)\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    sw2 = bounds.getSouthWest(),\n\t\t    ne2 = bounds.getNorthEast(),\n\n\t\t    latIntersects = (ne2.lat >= sw.lat) && (sw2.lat <= ne.lat),\n\t\t    lngIntersects = (ne2.lng >= sw.lng) && (sw2.lng <= ne.lng);\n\n\t\treturn latIntersects && lngIntersects;\n\t},\n\n\ttoBBoxString: function () {\n\t\treturn [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(',');\n\t},\n\n\tequals: function (bounds) { // (LatLngBounds)\n\t\tif (!bounds) { return false; }\n\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\treturn this._southWest.equals(bounds.getSouthWest()) &&\n\t\t       this._northEast.equals(bounds.getNorthEast());\n\t},\n\n\tisValid: function () {\n\t\treturn !!(this._southWest && this._northEast);\n\t}\n};\n\n//TODO International date line?\n\nL.latLngBounds = function (a, b) { // (LatLngBounds) or (LatLng, LatLng)\n\tif (!a || a instanceof L.LatLngBounds) {\n\t\treturn a;\n\t}\n\treturn new L.LatLngBounds(a, b);\n};\n\n\n/*\n * L.Projection contains various geographical projections used by CRS classes.\n */\n\nL.Projection = {};\n\n\n/*\n * Spherical Mercator is the most popular map projection, used by EPSG:3857 CRS used by default.\n */\n\nL.Projection.SphericalMercator = {\n\tMAX_LATITUDE: 85.0511287798,\n\n\tproject: function (latlng) { // (LatLng) -> Point\n\t\tvar d = L.LatLng.DEG_TO_RAD,\n\t\t    max = this.MAX_LATITUDE,\n\t\t    lat = Math.max(Math.min(max, latlng.lat), -max),\n\t\t    x = latlng.lng * d,\n\t\t    y = lat * d;\n\n\t\ty = Math.log(Math.tan((Math.PI / 4) + (y / 2)));\n\n\t\treturn new L.Point(x, y);\n\t},\n\n\tunproject: function (point) { // (Point, Boolean) -> LatLng\n\t\tvar d = L.LatLng.RAD_TO_DEG,\n\t\t    lng = point.x * d,\n\t\t    lat = (2 * Math.atan(Math.exp(point.y)) - (Math.PI / 2)) * d;\n\n\t\treturn new L.LatLng(lat, lng);\n\t}\n};\n\n\n/*\n * Simple equirectangular (Plate Carree) projection, used by CRS like EPSG:4326 and Simple.\n */\n\nL.Projection.LonLat = {\n\tproject: function (latlng) {\n\t\treturn new L.Point(latlng.lng, latlng.lat);\n\t},\n\n\tunproject: function (point) {\n\t\treturn new L.LatLng(point.y, point.x);\n\t}\n};\n\n\n/*\n * L.CRS is a base object for all defined CRS (Coordinate Reference Systems) in Leaflet.\n */\n\nL.CRS = {\n\tlatLngToPoint: function (latlng, zoom) { // (LatLng, Number) -> Point\n\t\tvar projectedPoint = this.projection.project(latlng),\n\t\t    scale = this.scale(zoom);\n\n\t\treturn this.transformation._transform(projectedPoint, scale);\n\t},\n\n\tpointToLatLng: function (point, zoom) { // (Point, Number[, Boolean]) -> LatLng\n\t\tvar scale = this.scale(zoom),\n\t\t    untransformedPoint = this.transformation.untransform(point, scale);\n\n\t\treturn this.projection.unproject(untransformedPoint);\n\t},\n\n\tproject: function (latlng) {\n\t\treturn this.projection.project(latlng);\n\t},\n\n\tscale: function (zoom) {\n\t\treturn 256 * Math.pow(2, zoom);\n\t},\n\n\tgetSize: function (zoom) {\n\t\tvar s = this.scale(zoom);\n\t\treturn L.point(s, s);\n\t}\n};\n\n\n/*\n * A simple CRS that can be used for flat non-Earth maps like panoramas or game maps.\n */\n\nL.CRS.Simple = L.extend({}, L.CRS, {\n\tprojection: L.Projection.LonLat,\n\ttransformation: new L.Transformation(1, 0, -1, 0),\n\n\tscale: function (zoom) {\n\t\treturn Math.pow(2, zoom);\n\t}\n});\n\n\n/*\n * L.CRS.EPSG3857 (Spherical Mercator) is the most common CRS for web mapping\n * and is used by Leaflet by default.\n */\n\nL.CRS.EPSG3857 = L.extend({}, L.CRS, {\n\tcode: 'EPSG:3857',\n\n\tprojection: L.Projection.SphericalMercator,\n\ttransformation: new L.Transformation(0.5 / Math.PI, 0.5, -0.5 / Math.PI, 0.5),\n\n\tproject: function (latlng) { // (LatLng) -> Point\n\t\tvar projectedPoint = this.projection.project(latlng),\n\t\t    earthRadius = 6378137;\n\t\treturn projectedPoint.multiplyBy(earthRadius);\n\t}\n});\n\nL.CRS.EPSG900913 = L.extend({}, L.CRS.EPSG3857, {\n\tcode: 'EPSG:900913'\n});\n\n\n/*\n * L.CRS.EPSG4326 is a CRS popular among advanced GIS specialists.\n */\n\nL.CRS.EPSG4326 = L.extend({}, L.CRS, {\n\tcode: 'EPSG:4326',\n\n\tprojection: L.Projection.LonLat,\n\ttransformation: new L.Transformation(1 / 360, 0.5, -1 / 360, 0.5)\n});\n\n\n/*\n * L.Map is the central class of the API - it is used to create a map.\n */\n\nL.Map = L.Class.extend({\n\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tcrs: L.CRS.EPSG3857,\n\n\t\t/*\n\t\tcenter: LatLng,\n\t\tzoom: Number,\n\t\tlayers: Array,\n\t\t*/\n\n\t\tfadeAnimation: L.DomUtil.TRANSITION && !L.Browser.android23,\n\t\ttrackResize: true,\n\t\tmarkerZoomAnimation: L.DomUtil.TRANSITION && L.Browser.any3d\n\t},\n\n\tinitialize: function (id, options) { // (HTMLElement or String, Object)\n\t\toptions = L.setOptions(this, options);\n\n\n\t\tthis._initContainer(id);\n\t\tthis._initLayout();\n\n\t\t// hack for https://github.com/Leaflet/Leaflet/issues/1980\n\t\tthis._onResize = L.bind(this._onResize, this);\n\n\t\tthis._initEvents();\n\n\t\tif (options.maxBounds) {\n\t\t\tthis.setMaxBounds(options.maxBounds);\n\t\t}\n\n\t\tif (options.center && options.zoom !== undefined) {\n\t\t\tthis.setView(L.latLng(options.center), options.zoom, {reset: true});\n\t\t}\n\n\t\tthis._handlers = [];\n\n\t\tthis._layers = {};\n\t\tthis._zoomBoundLayers = {};\n\t\tthis._tileLayersNum = 0;\n\n\t\tthis.callInitHooks();\n\n\t\tthis._addLayers(options.layers);\n\t},\n\n\n\t// public methods that modify map state\n\n\t// replaced by animation-powered implementation in Map.PanAnimation.js\n\tsetView: function (center, zoom) {\n\t\tzoom = zoom === undefined ? this.getZoom() : zoom;\n\t\tthis._resetView(L.latLng(center), this._limitZoom(zoom));\n\t\treturn this;\n\t},\n\n\tsetZoom: function (zoom, options) {\n\t\tif (!this._loaded) {\n\t\t\tthis._zoom = this._limitZoom(zoom);\n\t\t\treturn this;\n\t\t}\n\t\treturn this.setView(this.getCenter(), zoom, {zoom: options});\n\t},\n\n\tzoomIn: function (delta, options) {\n\t\treturn this.setZoom(this._zoom + (delta || 1), options);\n\t},\n\n\tzoomOut: function (delta, options) {\n\t\treturn this.setZoom(this._zoom - (delta || 1), options);\n\t},\n\n\tsetZoomAround: function (latlng, zoom, options) {\n\t\tvar scale = this.getZoomScale(zoom),\n\t\t    viewHalf = this.getSize().divideBy(2),\n\t\t    containerPoint = latlng instanceof L.Point ? latlng : this.latLngToContainerPoint(latlng),\n\n\t\t    centerOffset = containerPoint.subtract(viewHalf).multiplyBy(1 - 1 / scale),\n\t\t    newCenter = this.containerPointToLatLng(viewHalf.add(centerOffset));\n\n\t\treturn this.setView(newCenter, zoom, {zoom: options});\n\t},\n\n\tfitBounds: function (bounds, options) {\n\n\t\toptions = options || {};\n\t\tbounds = bounds.getBounds ? bounds.getBounds() : L.latLngBounds(bounds);\n\n\t\tvar paddingTL = L.point(options.paddingTopLeft || options.padding || [0, 0]),\n\t\t    paddingBR = L.point(options.paddingBottomRight || options.padding || [0, 0]),\n\n\t\t    zoom = this.getBoundsZoom(bounds, false, paddingTL.add(paddingBR)),\n\t\t    paddingOffset = paddingBR.subtract(paddingTL).divideBy(2),\n\n\t\t    swPoint = this.project(bounds.getSouthWest(), zoom),\n\t\t    nePoint = this.project(bounds.getNorthEast(), zoom),\n\t\t    center = this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset), zoom);\n\n\t\tzoom = options && options.maxZoom ? Math.min(options.maxZoom, zoom) : zoom;\n\n\t\treturn this.setView(center, zoom, options);\n\t},\n\n\tfitWorld: function (options) {\n\t\treturn this.fitBounds([[-90, -180], [90, 180]], options);\n\t},\n\n\tpanTo: function (center, options) { // (LatLng)\n\t\treturn this.setView(center, this._zoom, {pan: options});\n\t},\n\n\tpanBy: function (offset) { // (Point)\n\t\t// replaced with animated panBy in Map.PanAnimation.js\n\t\tthis.fire('movestart');\n\n\t\tthis._rawPanBy(L.point(offset));\n\n\t\tthis.fire('move');\n\t\treturn this.fire('moveend');\n\t},\n\n\tsetMaxBounds: function (bounds) {\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tthis.options.maxBounds = bounds;\n\n\t\tif (!bounds) {\n\t\t\treturn this.off('moveend', this._panInsideMaxBounds, this);\n\t\t}\n\n\t\tif (this._loaded) {\n\t\t\tthis._panInsideMaxBounds();\n\t\t}\n\n\t\treturn this.on('moveend', this._panInsideMaxBounds, this);\n\t},\n\n\tpanInsideBounds: function (bounds, options) {\n\t\tvar center = this.getCenter(),\n\t\t\tnewCenter = this._limitCenter(center, this._zoom, bounds);\n\n\t\tif (center.equals(newCenter)) { return this; }\n\n\t\treturn this.panTo(newCenter, options);\n\t},\n\n\taddLayer: function (layer) {\n\t\t// TODO method is too big, refactor\n\n\t\tvar id = L.stamp(layer);\n\n\t\tif (this._layers[id]) { return this; }\n\n\t\tthis._layers[id] = layer;\n\n\t\t// TODO getMaxZoom, getMinZoom in ILayer (instead of options)\n\t\tif (layer.options && (!isNaN(layer.options.maxZoom) || !isNaN(layer.options.minZoom))) {\n\t\t\tthis._zoomBoundLayers[id] = layer;\n\t\t\tthis._updateZoomLevels();\n\t\t}\n\n\t\t// TODO looks ugly, refactor!!!\n\t\tif (this.options.zoomAnimation && L.TileLayer && (layer instanceof L.TileLayer)) {\n\t\t\tthis._tileLayersNum++;\n\t\t\tthis._tileLayersToLoad++;\n\t\t\tlayer.on('load', this._onTileLayerLoad, this);\n\t\t}\n\n\t\tif (this._loaded) {\n\t\t\tthis._layerAdd(layer);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tvar id = L.stamp(layer);\n\n\t\tif (!this._layers[id]) { return this; }\n\n\t\tif (this._loaded) {\n\t\t\tlayer.onRemove(this);\n\t\t}\n\n\t\tdelete this._layers[id];\n\n\t\tif (this._loaded) {\n\t\t\tthis.fire('layerremove', {layer: layer});\n\t\t}\n\n\t\tif (this._zoomBoundLayers[id]) {\n\t\t\tdelete this._zoomBoundLayers[id];\n\t\t\tthis._updateZoomLevels();\n\t\t}\n\n\t\t// TODO looks ugly, refactor\n\t\tif (this.options.zoomAnimation && L.TileLayer && (layer instanceof L.TileLayer)) {\n\t\t\tthis._tileLayersNum--;\n\t\t\tthis._tileLayersToLoad--;\n\t\t\tlayer.off('load', this._onTileLayerLoad, this);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\thasLayer: function (layer) {\n\t\tif (!layer) { return false; }\n\n\t\treturn (L.stamp(layer) in this._layers);\n\t},\n\n\teachLayer: function (method, context) {\n\t\tfor (var i in this._layers) {\n\t\t\tmethod.call(context, this._layers[i]);\n\t\t}\n\t\treturn this;\n\t},\n\n\tinvalidateSize: function (options) {\n\t\tif (!this._loaded) { return this; }\n\n\t\toptions = L.extend({\n\t\t\tanimate: false,\n\t\t\tpan: true\n\t\t}, options === true ? {animate: true} : options);\n\n\t\tvar oldSize = this.getSize();\n\t\tthis._sizeChanged = true;\n\t\tthis._initialCenter = null;\n\n\t\tvar newSize = this.getSize(),\n\t\t    oldCenter = oldSize.divideBy(2).round(),\n\t\t    newCenter = newSize.divideBy(2).round(),\n\t\t    offset = oldCenter.subtract(newCenter);\n\n\t\tif (!offset.x && !offset.y) { return this; }\n\n\t\tif (options.animate && options.pan) {\n\t\t\tthis.panBy(offset);\n\n\t\t} else {\n\t\t\tif (options.pan) {\n\t\t\t\tthis._rawPanBy(offset);\n\t\t\t}\n\n\t\t\tthis.fire('move');\n\n\t\t\tif (options.debounceMoveend) {\n\t\t\t\tclearTimeout(this._sizeTimer);\n\t\t\t\tthis._sizeTimer = setTimeout(L.bind(this.fire, this, 'moveend'), 200);\n\t\t\t} else {\n\t\t\t\tthis.fire('moveend');\n\t\t\t}\n\t\t}\n\n\t\treturn this.fire('resize', {\n\t\t\toldSize: oldSize,\n\t\t\tnewSize: newSize\n\t\t});\n\t},\n\n\t// TODO handler.addTo\n\taddHandler: function (name, HandlerClass) {\n\t\tif (!HandlerClass) { return this; }\n\n\t\tvar handler = this[name] = new HandlerClass(this);\n\n\t\tthis._handlers.push(handler);\n\n\t\tif (this.options[name]) {\n\t\t\thandler.enable();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremove: function () {\n\t\tif (this._loaded) {\n\t\t\tthis.fire('unload');\n\t\t}\n\n\t\tthis._initEvents('off');\n\n\t\ttry {\n\t\t\t// throws error in IE6-8\n\t\t\tdelete this._container._leaflet;\n\t\t} catch (e) {\n\t\t\tthis._container._leaflet = undefined;\n\t\t}\n\n\t\tthis._clearPanes();\n\t\tif (this._clearControlPos) {\n\t\t\tthis._clearControlPos();\n\t\t}\n\n\t\tthis._clearHandlers();\n\n\t\treturn this;\n\t},\n\n\n\t// public methods for getting map state\n\n\tgetCenter: function () { // (Boolean) -> LatLng\n\t\tthis._checkIfLoaded();\n\n\t\tif (this._initialCenter && !this._moved()) {\n\t\t\treturn this._initialCenter;\n\t\t}\n\t\treturn this.layerPointToLatLng(this._getCenterLayerPoint());\n\t},\n\n\tgetZoom: function () {\n\t\treturn this._zoom;\n\t},\n\n\tgetBounds: function () {\n\t\tvar bounds = this.getPixelBounds(),\n\t\t    sw = this.unproject(bounds.getBottomLeft()),\n\t\t    ne = this.unproject(bounds.getTopRight());\n\n\t\treturn new L.LatLngBounds(sw, ne);\n\t},\n\n\tgetMinZoom: function () {\n\t\treturn this.options.minZoom === undefined ?\n\t\t\t(this._layersMinZoom === undefined ? 0 : this._layersMinZoom) :\n\t\t\tthis.options.minZoom;\n\t},\n\n\tgetMaxZoom: function () {\n\t\treturn this.options.maxZoom === undefined ?\n\t\t\t(this._layersMaxZoom === undefined ? Infinity : this._layersMaxZoom) :\n\t\t\tthis.options.maxZoom;\n\t},\n\n\tgetBoundsZoom: function (bounds, inside, padding) { // (LatLngBounds[, Boolean, Point]) -> Number\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tvar zoom = this.getMinZoom() - (inside ? 1 : 0),\n\t\t    maxZoom = this.getMaxZoom(),\n\t\t    size = this.getSize(),\n\n\t\t    nw = bounds.getNorthWest(),\n\t\t    se = bounds.getSouthEast(),\n\n\t\t    zoomNotFound = true,\n\t\t    boundsSize;\n\n\t\tpadding = L.point(padding || [0, 0]);\n\n\t\tdo {\n\t\t\tzoom++;\n\t\t\tboundsSize = this.project(se, zoom).subtract(this.project(nw, zoom)).add(padding);\n\t\t\tzoomNotFound = !inside ? size.contains(boundsSize) : boundsSize.x < size.x || boundsSize.y < size.y;\n\n\t\t} while (zoomNotFound && zoom <= maxZoom);\n\n\t\tif (zoomNotFound && inside) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn inside ? zoom : zoom - 1;\n\t},\n\n\tgetSize: function () {\n\t\tif (!this._size || this._sizeChanged) {\n\t\t\tthis._size = new L.Point(\n\t\t\t\tthis._container.clientWidth,\n\t\t\t\tthis._container.clientHeight);\n\n\t\t\tthis._sizeChanged = false;\n\t\t}\n\t\treturn this._size.clone();\n\t},\n\n\tgetPixelBounds: function () {\n\t\tvar topLeftPoint = this._getTopLeftPoint();\n\t\treturn new L.Bounds(topLeftPoint, topLeftPoint.add(this.getSize()));\n\t},\n\n\tgetPixelOrigin: function () {\n\t\tthis._checkIfLoaded();\n\t\treturn this._initialTopLeftPoint;\n\t},\n\n\tgetPanes: function () {\n\t\treturn this._panes;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\n\t// TODO replace with universal implementation after refactoring projections\n\n\tgetZoomScale: function (toZoom) {\n\t\tvar crs = this.options.crs;\n\t\treturn crs.scale(toZoom) / crs.scale(this._zoom);\n\t},\n\n\tgetScaleZoom: function (scale) {\n\t\treturn this._zoom + (Math.log(scale) / Math.LN2);\n\t},\n\n\n\t// conversion methods\n\n\tproject: function (latlng, zoom) { // (LatLng[, Number]) -> Point\n\t\tzoom = zoom === undefined ? this._zoom : zoom;\n\t\treturn this.options.crs.latLngToPoint(L.latLng(latlng), zoom);\n\t},\n\n\tunproject: function (point, zoom) { // (Point[, Number]) -> LatLng\n\t\tzoom = zoom === undefined ? this._zoom : zoom;\n\t\treturn this.options.crs.pointToLatLng(L.point(point), zoom);\n\t},\n\n\tlayerPointToLatLng: function (point) { // (Point)\n\t\tvar projectedPoint = L.point(point).add(this.getPixelOrigin());\n\t\treturn this.unproject(projectedPoint);\n\t},\n\n\tlatLngToLayerPoint: function (latlng) { // (LatLng)\n\t\tvar projectedPoint = this.project(L.latLng(latlng))._round();\n\t\treturn projectedPoint._subtract(this.getPixelOrigin());\n\t},\n\n\tcontainerPointToLayerPoint: function (point) { // (Point)\n\t\treturn L.point(point).subtract(this._getMapPanePos());\n\t},\n\n\tlayerPointToContainerPoint: function (point) { // (Point)\n\t\treturn L.point(point).add(this._getMapPanePos());\n\t},\n\n\tcontainerPointToLatLng: function (point) {\n\t\tvar layerPoint = this.containerPointToLayerPoint(L.point(point));\n\t\treturn this.layerPointToLatLng(layerPoint);\n\t},\n\n\tlatLngToContainerPoint: function (latlng) {\n\t\treturn this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));\n\t},\n\n\tmouseEventToContainerPoint: function (e) { // (MouseEvent)\n\t\treturn L.DomEvent.getMousePosition(e, this._container);\n\t},\n\n\tmouseEventToLayerPoint: function (e) { // (MouseEvent)\n\t\treturn this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));\n\t},\n\n\tmouseEventToLatLng: function (e) { // (MouseEvent)\n\t\treturn this.layerPointToLatLng(this.mouseEventToLayerPoint(e));\n\t},\n\n\n\t// map initialization methods\n\n\t_initContainer: function (id) {\n\t\tvar container = this._container = L.DomUtil.get(id);\n\n\t\tif (!container) {\n\t\t\tthrow new Error('Map container not found.');\n\t\t} else if (container._leaflet) {\n\t\t\tthrow new Error('Map container is already initialized.');\n\t\t}\n\n\t\tcontainer._leaflet = true;\n\t},\n\n\t_initLayout: function () {\n\t\tvar container = this._container;\n\n\t\tL.DomUtil.addClass(container, 'leaflet-container' +\n\t\t\t(L.Browser.touch ? ' leaflet-touch' : '') +\n\t\t\t(L.Browser.retina ? ' leaflet-retina' : '') +\n\t\t\t(L.Browser.ielt9 ? ' leaflet-oldie' : '') +\n\t\t\t(this.options.fadeAnimation ? ' leaflet-fade-anim' : ''));\n\n\t\tvar position = L.DomUtil.getStyle(container, 'position');\n\n\t\tif (position !== 'absolute' && position !== 'relative' && position !== 'fixed') {\n\t\t\tcontainer.style.position = 'relative';\n\t\t}\n\n\t\tthis._initPanes();\n\n\t\tif (this._initControlPos) {\n\t\t\tthis._initControlPos();\n\t\t}\n\t},\n\n\t_initPanes: function () {\n\t\tvar panes = this._panes = {};\n\n\t\tthis._mapPane = panes.mapPane = this._createPane('leaflet-map-pane', this._container);\n\n\t\tthis._tilePane = panes.tilePane = this._createPane('leaflet-tile-pane', this._mapPane);\n\t\tpanes.objectsPane = this._createPane('leaflet-objects-pane', this._mapPane);\n\t\tpanes.shadowPane = this._createPane('leaflet-shadow-pane');\n\t\tpanes.overlayPane = this._createPane('leaflet-overlay-pane');\n\t\tpanes.markerPane = this._createPane('leaflet-marker-pane');\n\t\tpanes.popupPane = this._createPane('leaflet-popup-pane');\n\n\t\tvar zoomHide = ' leaflet-zoom-hide';\n\n\t\tif (!this.options.markerZoomAnimation) {\n\t\t\tL.DomUtil.addClass(panes.markerPane, zoomHide);\n\t\t\tL.DomUtil.addClass(panes.shadowPane, zoomHide);\n\t\t\tL.DomUtil.addClass(panes.popupPane, zoomHide);\n\t\t}\n\t},\n\n\t_createPane: function (className, container) {\n\t\treturn L.DomUtil.create('div', className, container || this._panes.objectsPane);\n\t},\n\n\t_clearPanes: function () {\n\t\tthis._container.removeChild(this._mapPane);\n\t},\n\n\t_addLayers: function (layers) {\n\t\tlayers = layers ? (L.Util.isArray(layers) ? layers : [layers]) : [];\n\n\t\tfor (var i = 0, len = layers.length; i < len; i++) {\n\t\t\tthis.addLayer(layers[i]);\n\t\t}\n\t},\n\n\n\t// private methods that modify map state\n\n\t_resetView: function (center, zoom, preserveMapOffset, afterZoomAnim) {\n\n\t\tvar zoomChanged = (this._zoom !== zoom);\n\n\t\tif (!afterZoomAnim) {\n\t\t\tthis.fire('movestart');\n\n\t\t\tif (zoomChanged) {\n\t\t\t\tthis.fire('zoomstart');\n\t\t\t}\n\t\t}\n\n\t\tthis._zoom = zoom;\n\t\tthis._initialCenter = center;\n\n\t\tthis._initialTopLeftPoint = this._getNewTopLeftPoint(center);\n\n\t\tif (!preserveMapOffset) {\n\t\t\tL.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));\n\t\t} else {\n\t\t\tthis._initialTopLeftPoint._add(this._getMapPanePos());\n\t\t}\n\n\t\tthis._tileLayersToLoad = this._tileLayersNum;\n\n\t\tvar loading = !this._loaded;\n\t\tthis._loaded = true;\n\n\t\tthis.fire('viewreset', {hard: !preserveMapOffset});\n\n\t\tif (loading) {\n\t\t\tthis.fire('load');\n\t\t\tthis.eachLayer(this._layerAdd, this);\n\t\t}\n\n\t\tthis.fire('move');\n\n\t\tif (zoomChanged || afterZoomAnim) {\n\t\t\tthis.fire('zoomend');\n\t\t}\n\n\t\tthis.fire('moveend', {hard: !preserveMapOffset});\n\t},\n\n\t_rawPanBy: function (offset) {\n\t\tL.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(offset));\n\t},\n\n\t_getZoomSpan: function () {\n\t\treturn this.getMaxZoom() - this.getMinZoom();\n\t},\n\n\t_updateZoomLevels: function () {\n\t\tvar i,\n\t\t\tminZoom = Infinity,\n\t\t\tmaxZoom = -Infinity,\n\t\t\toldZoomSpan = this._getZoomSpan();\n\n\t\tfor (i in this._zoomBoundLayers) {\n\t\t\tvar layer = this._zoomBoundLayers[i];\n\t\t\tif (!isNaN(layer.options.minZoom)) {\n\t\t\t\tminZoom = Math.min(minZoom, layer.options.minZoom);\n\t\t\t}\n\t\t\tif (!isNaN(layer.options.maxZoom)) {\n\t\t\t\tmaxZoom = Math.max(maxZoom, layer.options.maxZoom);\n\t\t\t}\n\t\t}\n\n\t\tif (i === undefined) { // we have no tilelayers\n\t\t\tthis._layersMaxZoom = this._layersMinZoom = undefined;\n\t\t} else {\n\t\t\tthis._layersMaxZoom = maxZoom;\n\t\t\tthis._layersMinZoom = minZoom;\n\t\t}\n\n\t\tif (oldZoomSpan !== this._getZoomSpan()) {\n\t\t\tthis.fire('zoomlevelschange');\n\t\t}\n\t},\n\n\t_panInsideMaxBounds: function () {\n\t\tthis.panInsideBounds(this.options.maxBounds);\n\t},\n\n\t_checkIfLoaded: function () {\n\t\tif (!this._loaded) {\n\t\t\tthrow new Error('Set map center and zoom first.');\n\t\t}\n\t},\n\n\t// map events\n\n\t_initEvents: function (onOff) {\n\t\tif (!L.DomEvent) { return; }\n\n\t\tonOff = onOff || 'on';\n\n\t\tL.DomEvent[onOff](this._container, 'click', this._onMouseClick, this);\n\n\t\tvar events = ['dblclick', 'mousedown', 'mouseup', 'mouseenter',\n\t\t              'mouseleave', 'mousemove', 'contextmenu'],\n\t\t    i, len;\n\n\t\tfor (i = 0, len = events.length; i < len; i++) {\n\t\t\tL.DomEvent[onOff](this._container, events[i], this._fireMouseEvent, this);\n\t\t}\n\n\t\tif (this.options.trackResize) {\n\t\t\tL.DomEvent[onOff](window, 'resize', this._onResize, this);\n\t\t}\n\t},\n\n\t_onResize: function () {\n\t\tL.Util.cancelAnimFrame(this._resizeRequest);\n\t\tthis._resizeRequest = L.Util.requestAnimFrame(\n\t\t        function () { this.invalidateSize({debounceMoveend: true}); }, this, false, this._container);\n\t},\n\n\t_onMouseClick: function (e) {\n\t\tif (!this._loaded || (!e._simulated &&\n\t\t        ((this.dragging && this.dragging.moved()) ||\n\t\t         (this.boxZoom  && this.boxZoom.moved()))) ||\n\t\t            L.DomEvent._skipped(e)) { return; }\n\n\t\tthis.fire('preclick');\n\t\tthis._fireMouseEvent(e);\n\t},\n\n\t_fireMouseEvent: function (e) {\n\t\tif (!this._loaded || L.DomEvent._skipped(e)) { return; }\n\n\t\tvar type = e.type;\n\n\t\ttype = (type === 'mouseenter' ? 'mouseover' : (type === 'mouseleave' ? 'mouseout' : type));\n\n\t\tif (!this.hasEventListeners(type)) { return; }\n\n\t\tif (type === 'contextmenu') {\n\t\t\tL.DomEvent.preventDefault(e);\n\t\t}\n\n\t\tvar containerPoint = this.mouseEventToContainerPoint(e),\n\t\t    layerPoint = this.containerPointToLayerPoint(containerPoint),\n\t\t    latlng = this.layerPointToLatLng(layerPoint);\n\n\t\tthis.fire(type, {\n\t\t\tlatlng: latlng,\n\t\t\tlayerPoint: layerPoint,\n\t\t\tcontainerPoint: containerPoint,\n\t\t\toriginalEvent: e\n\t\t});\n\t},\n\n\t_onTileLayerLoad: function () {\n\t\tthis._tileLayersToLoad--;\n\t\tif (this._tileLayersNum && !this._tileLayersToLoad) {\n\t\t\tthis.fire('tilelayersload');\n\t\t}\n\t},\n\n\t_clearHandlers: function () {\n\t\tfor (var i = 0, len = this._handlers.length; i < len; i++) {\n\t\t\tthis._handlers[i].disable();\n\t\t}\n\t},\n\n\twhenReady: function (callback, context) {\n\t\tif (this._loaded) {\n\t\t\tcallback.call(context || this, this);\n\t\t} else {\n\t\t\tthis.on('load', callback, context);\n\t\t}\n\t\treturn this;\n\t},\n\n\t_layerAdd: function (layer) {\n\t\tlayer.onAdd(this);\n\t\tthis.fire('layeradd', {layer: layer});\n\t},\n\n\n\t// private methods for getting map state\n\n\t_getMapPanePos: function () {\n\t\treturn L.DomUtil.getPosition(this._mapPane);\n\t},\n\n\t_moved: function () {\n\t\tvar pos = this._getMapPanePos();\n\t\treturn pos && !pos.equals([0, 0]);\n\t},\n\n\t_getTopLeftPoint: function () {\n\t\treturn this.getPixelOrigin().subtract(this._getMapPanePos());\n\t},\n\n\t_getNewTopLeftPoint: function (center, zoom) {\n\t\tvar viewHalf = this.getSize()._divideBy(2);\n\t\t// TODO round on display, not calculation to increase precision?\n\t\treturn this.project(center, zoom)._subtract(viewHalf)._round();\n\t},\n\n\t_latLngToNewLayerPoint: function (latlng, newZoom, newCenter) {\n\t\tvar topLeft = this._getNewTopLeftPoint(newCenter, newZoom).add(this._getMapPanePos());\n\t\treturn this.project(latlng, newZoom)._subtract(topLeft);\n\t},\n\n\t// layer point of the current center\n\t_getCenterLayerPoint: function () {\n\t\treturn this.containerPointToLayerPoint(this.getSize()._divideBy(2));\n\t},\n\n\t// offset of the specified place to the current center in pixels\n\t_getCenterOffset: function (latlng) {\n\t\treturn this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());\n\t},\n\n\t// adjust center for view to get inside bounds\n\t_limitCenter: function (center, zoom, bounds) {\n\n\t\tif (!bounds) { return center; }\n\n\t\tvar centerPoint = this.project(center, zoom),\n\t\t    viewHalf = this.getSize().divideBy(2),\n\t\t    viewBounds = new L.Bounds(centerPoint.subtract(viewHalf), centerPoint.add(viewHalf)),\n\t\t    offset = this._getBoundsOffset(viewBounds, bounds, zoom);\n\n\t\treturn this.unproject(centerPoint.add(offset), zoom);\n\t},\n\n\t// adjust offset for view to get inside bounds\n\t_limitOffset: function (offset, bounds) {\n\t\tif (!bounds) { return offset; }\n\n\t\tvar viewBounds = this.getPixelBounds(),\n\t\t    newBounds = new L.Bounds(viewBounds.min.add(offset), viewBounds.max.add(offset));\n\n\t\treturn offset.add(this._getBoundsOffset(newBounds, bounds));\n\t},\n\n\t// returns offset needed for pxBounds to get inside maxBounds at a specified zoom\n\t_getBoundsOffset: function (pxBounds, maxBounds, zoom) {\n\t\tvar nwOffset = this.project(maxBounds.getNorthWest(), zoom).subtract(pxBounds.min),\n\t\t    seOffset = this.project(maxBounds.getSouthEast(), zoom).subtract(pxBounds.max),\n\n\t\t    dx = this._rebound(nwOffset.x, -seOffset.x),\n\t\t    dy = this._rebound(nwOffset.y, -seOffset.y);\n\n\t\treturn new L.Point(dx, dy);\n\t},\n\n\t_rebound: function (left, right) {\n\t\treturn left + right > 0 ?\n\t\t\tMath.round(left - right) / 2 :\n\t\t\tMath.max(0, Math.ceil(left)) - Math.max(0, Math.floor(right));\n\t},\n\n\t_limitZoom: function (zoom) {\n\t\tvar min = this.getMinZoom(),\n\t\t    max = this.getMaxZoom();\n\n\t\treturn Math.max(min, Math.min(max, zoom));\n\t}\n});\n\nL.map = function (id, options) {\n\treturn new L.Map(id, options);\n};\n\n\n/*\n * Mercator projection that takes into account that the Earth is not a perfect sphere.\n * Less popular than spherical mercator; used by projections like EPSG:3395.\n */\n\nL.Projection.Mercator = {\n\tMAX_LATITUDE: 85.0840591556,\n\n\tR_MINOR: 6356752.314245179,\n\tR_MAJOR: 6378137,\n\n\tproject: function (latlng) { // (LatLng) -> Point\n\t\tvar d = L.LatLng.DEG_TO_RAD,\n\t\t    max = this.MAX_LATITUDE,\n\t\t    lat = Math.max(Math.min(max, latlng.lat), -max),\n\t\t    r = this.R_MAJOR,\n\t\t    r2 = this.R_MINOR,\n\t\t    x = latlng.lng * d * r,\n\t\t    y = lat * d,\n\t\t    tmp = r2 / r,\n\t\t    eccent = Math.sqrt(1.0 - tmp * tmp),\n\t\t    con = eccent * Math.sin(y);\n\n\t\tcon = Math.pow((1 - con) / (1 + con), eccent * 0.5);\n\n\t\tvar ts = Math.tan(0.5 * ((Math.PI * 0.5) - y)) / con;\n\t\ty = -r * Math.log(ts);\n\n\t\treturn new L.Point(x, y);\n\t},\n\n\tunproject: function (point) { // (Point, Boolean) -> LatLng\n\t\tvar d = L.LatLng.RAD_TO_DEG,\n\t\t    r = this.R_MAJOR,\n\t\t    r2 = this.R_MINOR,\n\t\t    lng = point.x * d / r,\n\t\t    tmp = r2 / r,\n\t\t    eccent = Math.sqrt(1 - (tmp * tmp)),\n\t\t    ts = Math.exp(- point.y / r),\n\t\t    phi = (Math.PI / 2) - 2 * Math.atan(ts),\n\t\t    numIter = 15,\n\t\t    tol = 1e-7,\n\t\t    i = numIter,\n\t\t    dphi = 0.1,\n\t\t    con;\n\n\t\twhile ((Math.abs(dphi) > tol) && (--i > 0)) {\n\t\t\tcon = eccent * Math.sin(phi);\n\t\t\tdphi = (Math.PI / 2) - 2 * Math.atan(ts *\n\t\t\t            Math.pow((1.0 - con) / (1.0 + con), 0.5 * eccent)) - phi;\n\t\t\tphi += dphi;\n\t\t}\n\n\t\treturn new L.LatLng(phi * d, lng);\n\t}\n};\n\n\n\nL.CRS.EPSG3395 = L.extend({}, L.CRS, {\n\tcode: 'EPSG:3395',\n\n\tprojection: L.Projection.Mercator,\n\n\ttransformation: (function () {\n\t\tvar m = L.Projection.Mercator,\n\t\t    r = m.R_MAJOR,\n\t\t    scale = 0.5 / (Math.PI * r);\n\n\t\treturn new L.Transformation(scale, 0.5, -scale, 0.5);\n\t}())\n});\n\n\n/*\n * L.TileLayer is used for standard xyz-numbered tile layers.\n */\n\nL.TileLayer = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tminZoom: 0,\n\t\tmaxZoom: 18,\n\t\ttileSize: 256,\n\t\tsubdomains: 'abc',\n\t\terrorTileUrl: '',\n\t\tattribution: '',\n\t\tzoomOffset: 0,\n\t\topacity: 1,\n\t\t/*\n\t\tmaxNativeZoom: null,\n\t\tzIndex: null,\n\t\ttms: false,\n\t\tcontinuousWorld: false,\n\t\tnoWrap: false,\n\t\tzoomReverse: false,\n\t\tdetectRetina: false,\n\t\treuseTiles: false,\n\t\tbounds: false,\n\t\t*/\n\t\tunloadInvisibleTiles: L.Browser.mobile,\n\t\tupdateWhenIdle: L.Browser.mobile\n\t},\n\n\tinitialize: function (url, options) {\n\t\toptions = L.setOptions(this, options);\n\n\t\t// detecting retina displays, adjusting tileSize and zoom levels\n\t\tif (options.detectRetina && L.Browser.retina && options.maxZoom > 0) {\n\n\t\t\toptions.tileSize = Math.floor(options.tileSize / 2);\n\t\t\toptions.zoomOffset++;\n\n\t\t\tif (options.minZoom > 0) {\n\t\t\t\toptions.minZoom--;\n\t\t\t}\n\t\t\tthis.options.maxZoom--;\n\t\t}\n\n\t\tif (options.bounds) {\n\t\t\toptions.bounds = L.latLngBounds(options.bounds);\n\t\t}\n\n\t\tthis._url = url;\n\n\t\tvar subdomains = this.options.subdomains;\n\n\t\tif (typeof subdomains === 'string') {\n\t\t\tthis.options.subdomains = subdomains.split('');\n\t\t}\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\t\tthis._animated = map._zoomAnimated;\n\n\t\t// create a container div for tiles\n\t\tthis._initContainer();\n\n\t\t// set up events\n\t\tmap.on({\n\t\t\t'viewreset': this._reset,\n\t\t\t'moveend': this._update\n\t\t}, this);\n\n\t\tif (this._animated) {\n\t\t\tmap.on({\n\t\t\t\t'zoomanim': this._animateZoom,\n\t\t\t\t'zoomend': this._endZoomAnim\n\t\t\t}, this);\n\t\t}\n\n\t\tif (!this.options.updateWhenIdle) {\n\t\t\tthis._limitedUpdate = L.Util.limitExecByInterval(this._update, 150, this);\n\t\t\tmap.on('move', this._limitedUpdate, this);\n\t\t}\n\n\t\tthis._reset();\n\t\tthis._update();\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\tthis._container.parentNode.removeChild(this._container);\n\n\t\tmap.off({\n\t\t\t'viewreset': this._reset,\n\t\t\t'moveend': this._update\n\t\t}, this);\n\n\t\tif (this._animated) {\n\t\t\tmap.off({\n\t\t\t\t'zoomanim': this._animateZoom,\n\t\t\t\t'zoomend': this._endZoomAnim\n\t\t\t}, this);\n\t\t}\n\n\t\tif (!this.options.updateWhenIdle) {\n\t\t\tmap.off('move', this._limitedUpdate, this);\n\t\t}\n\n\t\tthis._container = null;\n\t\tthis._map = null;\n\t},\n\n\tbringToFront: function () {\n\t\tvar pane = this._map._panes.tilePane;\n\n\t\tif (this._container) {\n\t\t\tpane.appendChild(this._container);\n\t\t\tthis._setAutoZIndex(pane, Math.max);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tvar pane = this._map._panes.tilePane;\n\n\t\tif (this._container) {\n\t\t\tpane.insertBefore(this._container, pane.firstChild);\n\t\t\tthis._setAutoZIndex(pane, Math.min);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tgetAttribution: function () {\n\t\treturn this.options.attribution;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\tsetOpacity: function (opacity) {\n\t\tthis.options.opacity = opacity;\n\n\t\tif (this._map) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tsetZIndex: function (zIndex) {\n\t\tthis.options.zIndex = zIndex;\n\t\tthis._updateZIndex();\n\n\t\treturn this;\n\t},\n\n\tsetUrl: function (url, noRedraw) {\n\t\tthis._url = url;\n\n\t\tif (!noRedraw) {\n\t\t\tthis.redraw();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis._reset({hard: true});\n\t\t\tthis._update();\n\t\t}\n\t\treturn this;\n\t},\n\n\t_updateZIndex: function () {\n\t\tif (this._container && this.options.zIndex !== undefined) {\n\t\t\tthis._container.style.zIndex = this.options.zIndex;\n\t\t}\n\t},\n\n\t_setAutoZIndex: function (pane, compare) {\n\n\t\tvar layers = pane.children,\n\t\t    edgeZIndex = -compare(Infinity, -Infinity), // -Infinity for max, Infinity for min\n\t\t    zIndex, i, len;\n\n\t\tfor (i = 0, len = layers.length; i < len; i++) {\n\n\t\t\tif (layers[i] !== this._container) {\n\t\t\t\tzIndex = parseInt(layers[i].style.zIndex, 10);\n\n\t\t\t\tif (!isNaN(zIndex)) {\n\t\t\t\t\tedgeZIndex = compare(edgeZIndex, zIndex);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.options.zIndex = this._container.style.zIndex =\n\t\t        (isFinite(edgeZIndex) ? edgeZIndex : 0) + compare(1, -1);\n\t},\n\n\t_updateOpacity: function () {\n\t\tvar i,\n\t\t    tiles = this._tiles;\n\n\t\tif (L.Browser.ielt9) {\n\t\t\tfor (i in tiles) {\n\t\t\t\tL.DomUtil.setOpacity(tiles[i], this.options.opacity);\n\t\t\t}\n\t\t} else {\n\t\t\tL.DomUtil.setOpacity(this._container, this.options.opacity);\n\t\t}\n\t},\n\n\t_initContainer: function () {\n\t\tvar tilePane = this._map._panes.tilePane;\n\n\t\tif (!this._container) {\n\t\t\tthis._container = L.DomUtil.create('div', 'leaflet-layer');\n\n\t\t\tthis._updateZIndex();\n\n\t\t\tif (this._animated) {\n\t\t\t\tvar className = 'leaflet-tile-container';\n\n\t\t\t\tthis._bgBuffer = L.DomUtil.create('div', className, this._container);\n\t\t\t\tthis._tileContainer = L.DomUtil.create('div', className, this._container);\n\n\t\t\t} else {\n\t\t\t\tthis._tileContainer = this._container;\n\t\t\t}\n\n\t\t\ttilePane.appendChild(this._container);\n\n\t\t\tif (this.options.opacity < 1) {\n\t\t\t\tthis._updateOpacity();\n\t\t\t}\n\t\t}\n\t},\n\n\t_reset: function (e) {\n\t\tfor (var key in this._tiles) {\n\t\t\tthis.fire('tileunload', {tile: this._tiles[key]});\n\t\t}\n\n\t\tthis._tiles = {};\n\t\tthis._tilesToLoad = 0;\n\n\t\tif (this.options.reuseTiles) {\n\t\t\tthis._unusedTiles = [];\n\t\t}\n\n\t\tthis._tileContainer.innerHTML = '';\n\n\t\tif (this._animated && e && e.hard) {\n\t\t\tthis._clearBgBuffer();\n\t\t}\n\n\t\tthis._initContainer();\n\t},\n\n\t_getTileSize: function () {\n\t\tvar map = this._map,\n\t\t    zoom = map.getZoom() + this.options.zoomOffset,\n\t\t    zoomN = this.options.maxNativeZoom,\n\t\t    tileSize = this.options.tileSize;\n\n\t\tif (zoomN && zoom > zoomN) {\n\t\t\ttileSize = Math.round(map.getZoomScale(zoom) / map.getZoomScale(zoomN) * tileSize);\n\t\t}\n\n\t\treturn tileSize;\n\t},\n\n\t_update: function () {\n\n\t\tif (!this._map) { return; }\n\n\t\tvar map = this._map,\n\t\t    bounds = map.getPixelBounds(),\n\t\t    zoom = map.getZoom(),\n\t\t    tileSize = this._getTileSize();\n\n\t\tif (zoom > this.options.maxZoom || zoom < this.options.minZoom) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tileBounds = L.bounds(\n\t\t        bounds.min.divideBy(tileSize)._floor(),\n\t\t        bounds.max.divideBy(tileSize)._floor());\n\n\t\tthis._addTilesFromCenterOut(tileBounds);\n\n\t\tif (this.options.unloadInvisibleTiles || this.options.reuseTiles) {\n\t\t\tthis._removeOtherTiles(tileBounds);\n\t\t}\n\t},\n\n\t_addTilesFromCenterOut: function (bounds) {\n\t\tvar queue = [],\n\t\t    center = bounds.getCenter();\n\n\t\tvar j, i, point;\n\n\t\tfor (j = bounds.min.y; j <= bounds.max.y; j++) {\n\t\t\tfor (i = bounds.min.x; i <= bounds.max.x; i++) {\n\t\t\t\tpoint = new L.Point(i, j);\n\n\t\t\t\tif (this._tileShouldBeLoaded(point)) {\n\t\t\t\t\tqueue.push(point);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar tilesToLoad = queue.length;\n\n\t\tif (tilesToLoad === 0) { return; }\n\n\t\t// load tiles in order of their distance to center\n\t\tqueue.sort(function (a, b) {\n\t\t\treturn a.distanceTo(center) - b.distanceTo(center);\n\t\t});\n\n\t\tvar fragment = document.createDocumentFragment();\n\n\t\t// if its the first batch of tiles to load\n\t\tif (!this._tilesToLoad) {\n\t\t\tthis.fire('loading');\n\t\t}\n\n\t\tthis._tilesToLoad += tilesToLoad;\n\n\t\tfor (i = 0; i < tilesToLoad; i++) {\n\t\t\tthis._addTile(queue[i], fragment);\n\t\t}\n\n\t\tthis._tileContainer.appendChild(fragment);\n\t},\n\n\t_tileShouldBeLoaded: function (tilePoint) {\n\t\tif ((tilePoint.x + ':' + tilePoint.y) in this._tiles) {\n\t\t\treturn false; // already loaded\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\tif (!options.continuousWorld) {\n\t\t\tvar limit = this._getWrapTileNum();\n\n\t\t\t// don't load if exceeds world bounds\n\t\t\tif ((options.noWrap && (tilePoint.x < 0 || tilePoint.x >= limit.x)) ||\n\t\t\t\ttilePoint.y < 0 || tilePoint.y >= limit.y) { return false; }\n\t\t}\n\n\t\tif (options.bounds) {\n\t\t\tvar tileSize = options.tileSize,\n\t\t\t    nwPoint = tilePoint.multiplyBy(tileSize),\n\t\t\t    sePoint = nwPoint.add([tileSize, tileSize]),\n\t\t\t    nw = this._map.unproject(nwPoint),\n\t\t\t    se = this._map.unproject(sePoint);\n\n\t\t\t// TODO temporary hack, will be removed after refactoring projections\n\t\t\t// https://github.com/Leaflet/Leaflet/issues/1618\n\t\t\tif (!options.continuousWorld && !options.noWrap) {\n\t\t\t\tnw = nw.wrap();\n\t\t\t\tse = se.wrap();\n\t\t\t}\n\n\t\t\tif (!options.bounds.intersects([nw, se])) { return false; }\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t_removeOtherTiles: function (bounds) {\n\t\tvar kArr, x, y, key;\n\n\t\tfor (key in this._tiles) {\n\t\t\tkArr = key.split(':');\n\t\t\tx = parseInt(kArr[0], 10);\n\t\t\ty = parseInt(kArr[1], 10);\n\n\t\t\t// remove tile if it's out of bounds\n\t\t\tif (x < bounds.min.x || x > bounds.max.x || y < bounds.min.y || y > bounds.max.y) {\n\t\t\t\tthis._removeTile(key);\n\t\t\t}\n\t\t}\n\t},\n\n\t_removeTile: function (key) {\n\t\tvar tile = this._tiles[key];\n\n\t\tthis.fire('tileunload', {tile: tile, url: tile.src});\n\n\t\tif (this.options.reuseTiles) {\n\t\t\tL.DomUtil.removeClass(tile, 'leaflet-tile-loaded');\n\t\t\tthis._unusedTiles.push(tile);\n\n\t\t} else if (tile.parentNode === this._tileContainer) {\n\t\t\tthis._tileContainer.removeChild(tile);\n\t\t}\n\n\t\t// for https://github.com/CloudMade/Leaflet/issues/137\n\t\tif (!L.Browser.android) {\n\t\t\ttile.onload = null;\n\t\t\ttile.src = L.Util.emptyImageUrl;\n\t\t}\n\n\t\tdelete this._tiles[key];\n\t},\n\n\t_addTile: function (tilePoint, container) {\n\t\tvar tilePos = this._getTilePos(tilePoint);\n\n\t\t// get unused tile - or create a new tile\n\t\tvar tile = this._getTile();\n\n\t\t/*\n\t\tChrome 20 layouts much faster with top/left (verify with timeline, frames)\n\t\tAndroid 4 browser has display issues with top/left and requires transform instead\n\t\t(other browsers don't currently care) - see debug/hacks/jitter.html for an example\n\t\t*/\n\t\tL.DomUtil.setPosition(tile, tilePos, L.Browser.chrome);\n\n\t\tthis._tiles[tilePoint.x + ':' + tilePoint.y] = tile;\n\n\t\tthis._loadTile(tile, tilePoint);\n\n\t\tif (tile.parentNode !== this._tileContainer) {\n\t\t\tcontainer.appendChild(tile);\n\t\t}\n\t},\n\n\t_getZoomForUrl: function () {\n\n\t\tvar options = this.options,\n\t\t    zoom = this._map.getZoom();\n\n\t\tif (options.zoomReverse) {\n\t\t\tzoom = options.maxZoom - zoom;\n\t\t}\n\n\t\tzoom += options.zoomOffset;\n\n\t\treturn options.maxNativeZoom ? Math.min(zoom, options.maxNativeZoom) : zoom;\n\t},\n\n\t_getTilePos: function (tilePoint) {\n\t\tvar origin = this._map.getPixelOrigin(),\n\t\t    tileSize = this._getTileSize();\n\n\t\treturn tilePoint.multiplyBy(tileSize).subtract(origin);\n\t},\n\n\t// image-specific code (override to implement e.g. Canvas or SVG tile layer)\n\n\tgetTileUrl: function (tilePoint) {\n\t\treturn L.Util.template(this._url, L.extend({\n\t\t\ts: this._getSubdomain(tilePoint),\n\t\t\tz: tilePoint.z,\n\t\t\tx: tilePoint.x,\n\t\t\ty: tilePoint.y\n\t\t}, this.options));\n\t},\n\n\t_getWrapTileNum: function () {\n\t\tvar crs = this._map.options.crs,\n\t\t    size = crs.getSize(this._map.getZoom());\n\t\treturn size.divideBy(this._getTileSize())._floor();\n\t},\n\n\t_adjustTilePoint: function (tilePoint) {\n\n\t\tvar limit = this._getWrapTileNum();\n\n\t\t// wrap tile coordinates\n\t\tif (!this.options.continuousWorld && !this.options.noWrap) {\n\t\t\ttilePoint.x = ((tilePoint.x % limit.x) + limit.x) % limit.x;\n\t\t}\n\n\t\tif (this.options.tms) {\n\t\t\ttilePoint.y = limit.y - tilePoint.y - 1;\n\t\t}\n\n\t\ttilePoint.z = this._getZoomForUrl();\n\t},\n\n\t_getSubdomain: function (tilePoint) {\n\t\tvar index = Math.abs(tilePoint.x + tilePoint.y) % this.options.subdomains.length;\n\t\treturn this.options.subdomains[index];\n\t},\n\n\t_getTile: function () {\n\t\tif (this.options.reuseTiles && this._unusedTiles.length > 0) {\n\t\t\tvar tile = this._unusedTiles.pop();\n\t\t\tthis._resetTile(tile);\n\t\t\treturn tile;\n\t\t}\n\t\treturn this._createTile();\n\t},\n\n\t// Override if data stored on a tile needs to be cleaned up before reuse\n\t_resetTile: function (/*tile*/) {},\n\n\t_createTile: function () {\n\t\tvar tile = L.DomUtil.create('img', 'leaflet-tile');\n\t\ttile.style.width = tile.style.height = this._getTileSize() + 'px';\n\t\ttile.galleryimg = 'no';\n\n\t\ttile.onselectstart = tile.onmousemove = L.Util.falseFn;\n\n\t\tif (L.Browser.ielt9 && this.options.opacity !== undefined) {\n\t\t\tL.DomUtil.setOpacity(tile, this.options.opacity);\n\t\t}\n\t\t// without this hack, tiles disappear after zoom on Chrome for Android\n\t\t// https://github.com/Leaflet/Leaflet/issues/2078\n\t\tif (L.Browser.mobileWebkit3d) {\n\t\t\ttile.style.WebkitBackfaceVisibility = 'hidden';\n\t\t}\n\t\treturn tile;\n\t},\n\n\t_loadTile: function (tile, tilePoint) {\n\t\ttile._layer  = this;\n\t\ttile.onload  = this._tileOnLoad;\n\t\ttile.onerror = this._tileOnError;\n\n\t\tthis._adjustTilePoint(tilePoint);\n\t\ttile.src     = this.getTileUrl(tilePoint);\n\n\t\tthis.fire('tileloadstart', {\n\t\t\ttile: tile,\n\t\t\turl: tile.src\n\t\t});\n\t},\n\n\t_tileLoaded: function () {\n\t\tthis._tilesToLoad--;\n\n\t\tif (this._animated) {\n\t\t\tL.DomUtil.addClass(this._tileContainer, 'leaflet-zoom-animated');\n\t\t}\n\n\t\tif (!this._tilesToLoad) {\n\t\t\tthis.fire('load');\n\n\t\t\tif (this._animated) {\n\t\t\t\t// clear scaled tiles after all new tiles are loaded (for performance)\n\t\t\t\tclearTimeout(this._clearBgBufferTimer);\n\t\t\t\tthis._clearBgBufferTimer = setTimeout(L.bind(this._clearBgBuffer, this), 500);\n\t\t\t}\n\t\t}\n\t},\n\n\t_tileOnLoad: function () {\n\t\tvar layer = this._layer;\n\n\t\t//Only if we are loading an actual image\n\t\tif (this.src !== L.Util.emptyImageUrl) {\n\t\t\tL.DomUtil.addClass(this, 'leaflet-tile-loaded');\n\n\t\t\tlayer.fire('tileload', {\n\t\t\t\ttile: this,\n\t\t\t\turl: this.src\n\t\t\t});\n\t\t}\n\n\t\tlayer._tileLoaded();\n\t},\n\n\t_tileOnError: function () {\n\t\tvar layer = this._layer;\n\n\t\tlayer.fire('tileerror', {\n\t\t\ttile: this,\n\t\t\turl: this.src\n\t\t});\n\n\t\tvar newUrl = layer.options.errorTileUrl;\n\t\tif (newUrl) {\n\t\t\tthis.src = newUrl;\n\t\t}\n\n\t\tlayer._tileLoaded();\n\t}\n});\n\nL.tileLayer = function (url, options) {\n\treturn new L.TileLayer(url, options);\n};\n\n\n/*\n * L.TileLayer.WMS is used for putting WMS tile layers on the map.\n */\n\nL.TileLayer.WMS = L.TileLayer.extend({\n\n\tdefaultWmsParams: {\n\t\tservice: 'WMS',\n\t\trequest: 'GetMap',\n\t\tversion: '1.1.1',\n\t\tlayers: '',\n\t\tstyles: '',\n\t\tformat: 'image/jpeg',\n\t\ttransparent: false\n\t},\n\n\tinitialize: function (url, options) { // (String, Object)\n\n\t\tthis._url = url;\n\n\t\tvar wmsParams = L.extend({}, this.defaultWmsParams),\n\t\t    tileSize = options.tileSize || this.options.tileSize;\n\n\t\tif (options.detectRetina && L.Browser.retina) {\n\t\t\twmsParams.width = wmsParams.height = tileSize * 2;\n\t\t} else {\n\t\t\twmsParams.width = wmsParams.height = tileSize;\n\t\t}\n\n\t\tfor (var i in options) {\n\t\t\t// all keys that are not TileLayer options go to WMS params\n\t\t\tif (!this.options.hasOwnProperty(i) && i !== 'crs') {\n\t\t\t\twmsParams[i] = options[i];\n\t\t\t}\n\t\t}\n\n\t\tthis.wmsParams = wmsParams;\n\n\t\tL.setOptions(this, options);\n\t},\n\n\tonAdd: function (map) {\n\n\t\tthis._crs = this.options.crs || map.options.crs;\n\n\t\tthis._wmsVersion = parseFloat(this.wmsParams.version);\n\n\t\tvar projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n\t\tthis.wmsParams[projectionKey] = this._crs.code;\n\n\t\tL.TileLayer.prototype.onAdd.call(this, map);\n\t},\n\n\tgetTileUrl: function (tilePoint) { // (Point, Number) -> String\n\n\t\tvar map = this._map,\n\t\t    tileSize = this.options.tileSize,\n\n\t\t    nwPoint = tilePoint.multiplyBy(tileSize),\n\t\t    sePoint = nwPoint.add([tileSize, tileSize]),\n\n\t\t    nw = this._crs.project(map.unproject(nwPoint, tilePoint.z)),\n\t\t    se = this._crs.project(map.unproject(sePoint, tilePoint.z)),\n\t\t    bbox = this._wmsVersion >= 1.3 && this._crs === L.CRS.EPSG4326 ?\n\t\t        [se.y, nw.x, nw.y, se.x].join(',') :\n\t\t        [nw.x, se.y, se.x, nw.y].join(','),\n\n\t\t    url = L.Util.template(this._url, {s: this._getSubdomain(tilePoint)});\n\n\t\treturn url + L.Util.getParamString(this.wmsParams, url, true) + '&BBOX=' + bbox;\n\t},\n\n\tsetParams: function (params, noRedraw) {\n\n\t\tL.extend(this.wmsParams, params);\n\n\t\tif (!noRedraw) {\n\t\t\tthis.redraw();\n\t\t}\n\n\t\treturn this;\n\t}\n});\n\nL.tileLayer.wms = function (url, options) {\n\treturn new L.TileLayer.WMS(url, options);\n};\n\n\n/*\n * L.TileLayer.Canvas is a class that you can use as a base for creating\n * dynamically drawn Canvas-based tile layers.\n */\n\nL.TileLayer.Canvas = L.TileLayer.extend({\n\toptions: {\n\t\tasync: false\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis._reset({hard: true});\n\t\t\tthis._update();\n\t\t}\n\n\t\tfor (var i in this._tiles) {\n\t\t\tthis._redrawTile(this._tiles[i]);\n\t\t}\n\t\treturn this;\n\t},\n\n\t_redrawTile: function (tile) {\n\t\tthis.drawTile(tile, tile._tilePoint, this._map._zoom);\n\t},\n\n\t_createTile: function () {\n\t\tvar tile = L.DomUtil.create('canvas', 'leaflet-tile');\n\t\ttile.width = tile.height = this.options.tileSize;\n\t\ttile.onselectstart = tile.onmousemove = L.Util.falseFn;\n\t\treturn tile;\n\t},\n\n\t_loadTile: function (tile, tilePoint) {\n\t\ttile._layer = this;\n\t\ttile._tilePoint = tilePoint;\n\n\t\tthis._redrawTile(tile);\n\n\t\tif (!this.options.async) {\n\t\t\tthis.tileDrawn(tile);\n\t\t}\n\t},\n\n\tdrawTile: function (/*tile, tilePoint*/) {\n\t\t// override with rendering code\n\t},\n\n\ttileDrawn: function (tile) {\n\t\tthis._tileOnLoad.call(tile);\n\t}\n});\n\n\nL.tileLayer.canvas = function (options) {\n\treturn new L.TileLayer.Canvas(options);\n};\n\n\n/*\n * L.ImageOverlay is used to overlay images over the map (to specific geographical bounds).\n */\n\nL.ImageOverlay = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\topacity: 1\n\t},\n\n\tinitialize: function (url, bounds, options) { // (String, LatLngBounds, Object)\n\t\tthis._url = url;\n\t\tthis._bounds = L.latLngBounds(bounds);\n\n\t\tL.setOptions(this, options);\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\n\t\tif (!this._image) {\n\t\t\tthis._initImage();\n\t\t}\n\n\t\tmap._panes.overlayPane.appendChild(this._image);\n\n\t\tmap.on('viewreset', this._reset, this);\n\n\t\tif (map.options.zoomAnimation && L.Browser.any3d) {\n\t\t\tmap.on('zoomanim', this._animateZoom, this);\n\t\t}\n\n\t\tthis._reset();\n\t},\n\n\tonRemove: function (map) {\n\t\tmap.getPanes().overlayPane.removeChild(this._image);\n\n\t\tmap.off('viewreset', this._reset, this);\n\n\t\tif (map.options.zoomAnimation) {\n\t\t\tmap.off('zoomanim', this._animateZoom, this);\n\t\t}\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tsetOpacity: function (opacity) {\n\t\tthis.options.opacity = opacity;\n\t\tthis._updateOpacity();\n\t\treturn this;\n\t},\n\n\t// TODO remove bringToFront/bringToBack duplication from TileLayer/Path\n\tbringToFront: function () {\n\t\tif (this._image) {\n\t\t\tthis._map._panes.overlayPane.appendChild(this._image);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tvar pane = this._map._panes.overlayPane;\n\t\tif (this._image) {\n\t\t\tpane.insertBefore(this._image, pane.firstChild);\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetUrl: function (url) {\n\t\tthis._url = url;\n\t\tthis._image.src = this._url;\n\t},\n\n\tgetAttribution: function () {\n\t\treturn this.options.attribution;\n\t},\n\n\t_initImage: function () {\n\t\tthis._image = L.DomUtil.create('img', 'leaflet-image-layer');\n\n\t\tif (this._map.options.zoomAnimation && L.Browser.any3d) {\n\t\t\tL.DomUtil.addClass(this._image, 'leaflet-zoom-animated');\n\t\t} else {\n\t\t\tL.DomUtil.addClass(this._image, 'leaflet-zoom-hide');\n\t\t}\n\n\t\tthis._updateOpacity();\n\n\t\t//TODO createImage util method to remove duplication\n\t\tL.extend(this._image, {\n\t\t\tgalleryimg: 'no',\n\t\t\tonselectstart: L.Util.falseFn,\n\t\t\tonmousemove: L.Util.falseFn,\n\t\t\tonload: L.bind(this._onImageLoad, this),\n\t\t\tsrc: this._url\n\t\t});\n\t},\n\n\t_animateZoom: function (e) {\n\t\tvar map = this._map,\n\t\t    image = this._image,\n\t\t    scale = map.getZoomScale(e.zoom),\n\t\t    nw = this._bounds.getNorthWest(),\n\t\t    se = this._bounds.getSouthEast(),\n\n\t\t    topLeft = map._latLngToNewLayerPoint(nw, e.zoom, e.center),\n\t\t    size = map._latLngToNewLayerPoint(se, e.zoom, e.center)._subtract(topLeft),\n\t\t    origin = topLeft._add(size._multiplyBy((1 / 2) * (1 - 1 / scale)));\n\n\t\timage.style[L.DomUtil.TRANSFORM] =\n\t\t        L.DomUtil.getTranslateString(origin) + ' scale(' + scale + ') ';\n\t},\n\n\t_reset: function () {\n\t\tvar image   = this._image,\n\t\t    topLeft = this._map.latLngToLayerPoint(this._bounds.getNorthWest()),\n\t\t    size = this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(topLeft);\n\n\t\tL.DomUtil.setPosition(image, topLeft);\n\n\t\timage.style.width  = size.x + 'px';\n\t\timage.style.height = size.y + 'px';\n\t},\n\n\t_onImageLoad: function () {\n\t\tthis.fire('load');\n\t},\n\n\t_updateOpacity: function () {\n\t\tL.DomUtil.setOpacity(this._image, this.options.opacity);\n\t}\n});\n\nL.imageOverlay = function (url, bounds, options) {\n\treturn new L.ImageOverlay(url, bounds, options);\n};\n\n\n/*\n * L.Icon is an image-based icon class that you can use with L.Marker for custom markers.\n */\n\nL.Icon = L.Class.extend({\n\toptions: {\n\t\t/*\n\t\ticonUrl: (String) (required)\n\t\ticonRetinaUrl: (String) (optional, used for retina devices if detected)\n\t\ticonSize: (Point) (can be set through CSS)\n\t\ticonAnchor: (Point) (centered by default, can be set in CSS with negative margins)\n\t\tpopupAnchor: (Point) (if not specified, popup opens in the anchor point)\n\t\tshadowUrl: (String) (no shadow by default)\n\t\tshadowRetinaUrl: (String) (optional, used for retina devices if detected)\n\t\tshadowSize: (Point)\n\t\tshadowAnchor: (Point)\n\t\t*/\n\t\tclassName: ''\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\tcreateIcon: function (oldIcon) {\n\t\treturn this._createIcon('icon', oldIcon);\n\t},\n\n\tcreateShadow: function (oldIcon) {\n\t\treturn this._createIcon('shadow', oldIcon);\n\t},\n\n\t_createIcon: function (name, oldIcon) {\n\t\tvar src = this._getIconUrl(name);\n\n\t\tif (!src) {\n\t\t\tif (name === 'icon') {\n\t\t\t\tthrow new Error('iconUrl not set in Icon options (see the docs).');\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tvar img;\n\t\tif (!oldIcon || oldIcon.tagName !== 'IMG') {\n\t\t\timg = this._createImg(src);\n\t\t} else {\n\t\t\timg = this._createImg(src, oldIcon);\n\t\t}\n\t\tthis._setIconStyles(img, name);\n\n\t\treturn img;\n\t},\n\n\t_setIconStyles: function (img, name) {\n\t\tvar options = this.options,\n\t\t    size = L.point(options[name + 'Size']),\n\t\t    anchor;\n\n\t\tif (name === 'shadow') {\n\t\t\tanchor = L.point(options.shadowAnchor || options.iconAnchor);\n\t\t} else {\n\t\t\tanchor = L.point(options.iconAnchor);\n\t\t}\n\n\t\tif (!anchor && size) {\n\t\t\tanchor = size.divideBy(2, true);\n\t\t}\n\n\t\timg.className = 'leaflet-marker-' + name + ' ' + options.className;\n\n\t\tif (anchor) {\n\t\t\timg.style.marginLeft = (-anchor.x) + 'px';\n\t\t\timg.style.marginTop  = (-anchor.y) + 'px';\n\t\t}\n\n\t\tif (size) {\n\t\t\timg.style.width  = size.x + 'px';\n\t\t\timg.style.height = size.y + 'px';\n\t\t}\n\t},\n\n\t_createImg: function (src, el) {\n\t\tel = el || document.createElement('img');\n\t\tel.src = src;\n\t\treturn el;\n\t},\n\n\t_getIconUrl: function (name) {\n\t\tif (L.Browser.retina && this.options[name + 'RetinaUrl']) {\n\t\t\treturn this.options[name + 'RetinaUrl'];\n\t\t}\n\t\treturn this.options[name + 'Url'];\n\t}\n});\n\nL.icon = function (options) {\n\treturn new L.Icon(options);\n};\n\n\n/*\n * L.Icon.Default is the blue marker icon used by default in Leaflet.\n */\n\nL.Icon.Default = L.Icon.extend({\n\n\toptions: {\n\t\ticonSize: [25, 41],\n\t\ticonAnchor: [12, 41],\n\t\tpopupAnchor: [1, -34],\n\n\t\tshadowSize: [41, 41]\n\t},\n\n\t_getIconUrl: function (name) {\n\t\tvar key = name + 'Url';\n\n\t\tif (this.options[key]) {\n\t\t\treturn this.options[key];\n\t\t}\n\n\t\tif (L.Browser.retina && name === 'icon') {\n\t\t\tname += '-2x';\n\t\t}\n\n\t\tvar path = L.Icon.Default.imagePath;\n\n\t\tif (!path) {\n\t\t\tthrow new Error('Couldn\\'t autodetect L.Icon.Default.imagePath, set it manually.');\n\t\t}\n\n\t\treturn path + '/marker-' + name + '.png';\n\t}\n});\n\nL.Icon.Default.imagePath = (function () {\n\tvar scripts = document.getElementsByTagName('script'),\n\t    leafletRe = /[\\/^]leaflet[\\-\\._]?([\\w\\-\\._]*)\\.js\\??/;\n\n\tvar i, len, src, matches, path;\n\n\tfor (i = 0, len = scripts.length; i < len; i++) {\n\t\tsrc = scripts[i].src;\n\t\tmatches = src.match(leafletRe);\n\n\t\tif (matches) {\n\t\t\tpath = src.split(leafletRe)[0];\n\t\t\treturn (path ? path + '/' : '') + 'images';\n\t\t}\n\t}\n}());\n\n\n/*\n * L.Marker is used to display clickable/draggable icons on the map.\n */\n\nL.Marker = L.Class.extend({\n\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\ticon: new L.Icon.Default(),\n\t\ttitle: '',\n\t\talt: '',\n\t\tclickable: true,\n\t\tdraggable: false,\n\t\tkeyboard: true,\n\t\tzIndexOffset: 0,\n\t\topacity: 1,\n\t\triseOnHover: false,\n\t\triseOffset: 250\n\t},\n\n\tinitialize: function (latlng, options) {\n\t\tL.setOptions(this, options);\n\t\tthis._latlng = L.latLng(latlng);\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\n\t\tmap.on('viewreset', this.update, this);\n\n\t\tthis._initIcon();\n\t\tthis.update();\n\t\tthis.fire('add');\n\n\t\tif (map.options.zoomAnimation && map.options.markerZoomAnimation) {\n\t\t\tmap.on('zoomanim', this._animateZoom, this);\n\t\t}\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\tif (this.dragging) {\n\t\t\tthis.dragging.disable();\n\t\t}\n\n\t\tthis._removeIcon();\n\t\tthis._removeShadow();\n\n\t\tthis.fire('remove');\n\n\t\tmap.off({\n\t\t\t'viewreset': this.update,\n\t\t\t'zoomanim': this._animateZoom\n\t\t}, this);\n\n\t\tthis._map = null;\n\t},\n\n\tgetLatLng: function () {\n\t\treturn this._latlng;\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tthis._latlng = L.latLng(latlng);\n\n\t\tthis.update();\n\n\t\treturn this.fire('move', { latlng: this._latlng });\n\t},\n\n\tsetZIndexOffset: function (offset) {\n\t\tthis.options.zIndexOffset = offset;\n\t\tthis.update();\n\n\t\treturn this;\n\t},\n\n\tsetIcon: function (icon) {\n\n\t\tthis.options.icon = icon;\n\n\t\tif (this._map) {\n\t\t\tthis._initIcon();\n\t\t\tthis.update();\n\t\t}\n\n\t\tif (this._popup) {\n\t\t\tthis.bindPopup(this._popup);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tupdate: function () {\n\t\tif (this._icon) {\n\t\t\tvar pos = this._map.latLngToLayerPoint(this._latlng).round();\n\t\t\tthis._setPos(pos);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_initIcon: function () {\n\t\tvar options = this.options,\n\t\t    map = this._map,\n\t\t    animation = (map.options.zoomAnimation && map.options.markerZoomAnimation),\n\t\t    classToAdd = animation ? 'leaflet-zoom-animated' : 'leaflet-zoom-hide';\n\n\t\tvar icon = options.icon.createIcon(this._icon),\n\t\t\taddIcon = false;\n\n\t\t// if we're not reusing the icon, remove the old one and init new one\n\t\tif (icon !== this._icon) {\n\t\t\tif (this._icon) {\n\t\t\t\tthis._removeIcon();\n\t\t\t}\n\t\t\taddIcon = true;\n\n\t\t\tif (options.title) {\n\t\t\t\ticon.title = options.title;\n\t\t\t}\n\t\t\t\n\t\t\tif (options.alt) {\n\t\t\t\ticon.alt = options.alt;\n\t\t\t}\n\t\t}\n\n\t\tL.DomUtil.addClass(icon, classToAdd);\n\n\t\tif (options.keyboard) {\n\t\t\ticon.tabIndex = '0';\n\t\t}\n\n\t\tthis._icon = icon;\n\n\t\tthis._initInteraction();\n\n\t\tif (options.riseOnHover) {\n\t\t\tL.DomEvent\n\t\t\t\t.on(icon, 'mouseover', this._bringToFront, this)\n\t\t\t\t.on(icon, 'mouseout', this._resetZIndex, this);\n\t\t}\n\n\t\tvar newShadow = options.icon.createShadow(this._shadow),\n\t\t\taddShadow = false;\n\n\t\tif (newShadow !== this._shadow) {\n\t\t\tthis._removeShadow();\n\t\t\taddShadow = true;\n\t\t}\n\n\t\tif (newShadow) {\n\t\t\tL.DomUtil.addClass(newShadow, classToAdd);\n\t\t}\n\t\tthis._shadow = newShadow;\n\n\n\t\tif (options.opacity < 1) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\n\n\t\tvar panes = this._map._panes;\n\n\t\tif (addIcon) {\n\t\t\tpanes.markerPane.appendChild(this._icon);\n\t\t}\n\n\t\tif (newShadow && addShadow) {\n\t\t\tpanes.shadowPane.appendChild(this._shadow);\n\t\t}\n\t},\n\n\t_removeIcon: function () {\n\t\tif (this.options.riseOnHover) {\n\t\t\tL.DomEvent\n\t\t\t    .off(this._icon, 'mouseover', this._bringToFront)\n\t\t\t    .off(this._icon, 'mouseout', this._resetZIndex);\n\t\t}\n\n\t\tthis._map._panes.markerPane.removeChild(this._icon);\n\n\t\tthis._icon = null;\n\t},\n\n\t_removeShadow: function () {\n\t\tif (this._shadow) {\n\t\t\tthis._map._panes.shadowPane.removeChild(this._shadow);\n\t\t}\n\t\tthis._shadow = null;\n\t},\n\n\t_setPos: function (pos) {\n\t\tL.DomUtil.setPosition(this._icon, pos);\n\n\t\tif (this._shadow) {\n\t\t\tL.DomUtil.setPosition(this._shadow, pos);\n\t\t}\n\n\t\tthis._zIndex = pos.y + this.options.zIndexOffset;\n\n\t\tthis._resetZIndex();\n\t},\n\n\t_updateZIndex: function (offset) {\n\t\tthis._icon.style.zIndex = this._zIndex + offset;\n\t},\n\n\t_animateZoom: function (opt) {\n\t\tvar pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center).round();\n\n\t\tthis._setPos(pos);\n\t},\n\n\t_initInteraction: function () {\n\n\t\tif (!this.options.clickable) { return; }\n\n\t\t// TODO refactor into something shared with Map/Path/etc. to DRY it up\n\n\t\tvar icon = this._icon,\n\t\t    events = ['dblclick', 'mousedown', 'mouseover', 'mouseout', 'contextmenu'];\n\n\t\tL.DomUtil.addClass(icon, 'leaflet-clickable');\n\t\tL.DomEvent.on(icon, 'click', this._onMouseClick, this);\n\t\tL.DomEvent.on(icon, 'keypress', this._onKeyPress, this);\n\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tL.DomEvent.on(icon, events[i], this._fireMouseEvent, this);\n\t\t}\n\n\t\tif (L.Handler.MarkerDrag) {\n\t\t\tthis.dragging = new L.Handler.MarkerDrag(this);\n\n\t\t\tif (this.options.draggable) {\n\t\t\t\tthis.dragging.enable();\n\t\t\t}\n\t\t}\n\t},\n\n\t_onMouseClick: function (e) {\n\t\tvar wasDragged = this.dragging && this.dragging.moved();\n\n\t\tif (this.hasEventListeners(e.type) || wasDragged) {\n\t\t\tL.DomEvent.stopPropagation(e);\n\t\t}\n\n\t\tif (wasDragged) { return; }\n\n\t\tif ((!this.dragging || !this.dragging._enabled) && this._map.dragging && this._map.dragging.moved()) { return; }\n\n\t\tthis.fire(e.type, {\n\t\t\toriginalEvent: e,\n\t\t\tlatlng: this._latlng\n\t\t});\n\t},\n\n\t_onKeyPress: function (e) {\n\t\tif (e.keyCode === 13) {\n\t\t\tthis.fire('click', {\n\t\t\t\toriginalEvent: e,\n\t\t\t\tlatlng: this._latlng\n\t\t\t});\n\t\t}\n\t},\n\n\t_fireMouseEvent: function (e) {\n\n\t\tthis.fire(e.type, {\n\t\t\toriginalEvent: e,\n\t\t\tlatlng: this._latlng\n\t\t});\n\n\t\t// TODO proper custom event propagation\n\t\t// this line will always be called if marker is in a FeatureGroup\n\t\tif (e.type === 'contextmenu' && this.hasEventListeners(e.type)) {\n\t\t\tL.DomEvent.preventDefault(e);\n\t\t}\n\t\tif (e.type !== 'mousedown') {\n\t\t\tL.DomEvent.stopPropagation(e);\n\t\t} else {\n\t\t\tL.DomEvent.preventDefault(e);\n\t\t}\n\t},\n\n\tsetOpacity: function (opacity) {\n\t\tthis.options.opacity = opacity;\n\t\tif (this._map) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_updateOpacity: function () {\n\t\tL.DomUtil.setOpacity(this._icon, this.options.opacity);\n\t\tif (this._shadow) {\n\t\t\tL.DomUtil.setOpacity(this._shadow, this.options.opacity);\n\t\t}\n\t},\n\n\t_bringToFront: function () {\n\t\tthis._updateZIndex(this.options.riseOffset);\n\t},\n\n\t_resetZIndex: function () {\n\t\tthis._updateZIndex(0);\n\t}\n});\n\nL.marker = function (latlng, options) {\n\treturn new L.Marker(latlng, options);\n};\n\n\n/*\n * L.DivIcon is a lightweight HTML-based icon class (as opposed to the image-based L.Icon)\n * to use with L.Marker.\n */\n\nL.DivIcon = L.Icon.extend({\n\toptions: {\n\t\ticonSize: [12, 12], // also can be set through CSS\n\t\t/*\n\t\ticonAnchor: (Point)\n\t\tpopupAnchor: (Point)\n\t\thtml: (String)\n\t\tbgPos: (Point)\n\t\t*/\n\t\tclassName: 'leaflet-div-icon',\n\t\thtml: false\n\t},\n\n\tcreateIcon: function (oldIcon) {\n\t\tvar div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div'),\n\t\t    options = this.options;\n\n\t\tif (options.html !== false) {\n\t\t\tdiv.innerHTML = options.html;\n\t\t} else {\n\t\t\tdiv.innerHTML = '';\n\t\t}\n\n\t\tif (options.bgPos) {\n\t\t\tdiv.style.backgroundPosition =\n\t\t\t        (-options.bgPos.x) + 'px ' + (-options.bgPos.y) + 'px';\n\t\t}\n\n\t\tthis._setIconStyles(div, 'icon');\n\t\treturn div;\n\t},\n\n\tcreateShadow: function () {\n\t\treturn null;\n\t}\n});\n\nL.divIcon = function (options) {\n\treturn new L.DivIcon(options);\n};\n\n\n/*\n * L.Popup is used for displaying popups on the map.\n */\n\nL.Map.mergeOptions({\n\tclosePopupOnClick: true\n});\n\nL.Popup = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tminWidth: 50,\n\t\tmaxWidth: 300,\n\t\t// maxHeight: null,\n\t\tautoPan: true,\n\t\tcloseButton: true,\n\t\toffset: [0, 7],\n\t\tautoPanPadding: [5, 5],\n\t\t// autoPanPaddingTopLeft: null,\n\t\t// autoPanPaddingBottomRight: null,\n\t\tkeepInView: false,\n\t\tclassName: '',\n\t\tzoomAnimation: true\n\t},\n\n\tinitialize: function (options, source) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._source = source;\n\t\tthis._animated = L.Browser.any3d && this.options.zoomAnimation;\n\t\tthis._isOpen = false;\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\n\t\tif (!this._container) {\n\t\t\tthis._initLayout();\n\t\t}\n\n\t\tvar animFade = map.options.fadeAnimation;\n\n\t\tif (animFade) {\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\n\t\t}\n\t\tmap._panes.popupPane.appendChild(this._container);\n\n\t\tmap.on(this._getEvents(), this);\n\n\t\tthis.update();\n\n\t\tif (animFade) {\n\t\t\tL.DomUtil.setOpacity(this._container, 1);\n\t\t}\n\n\t\tthis.fire('open');\n\n\t\tmap.fire('popupopen', {popup: this});\n\n\t\tif (this._source) {\n\t\t\tthis._source.fire('popupopen', {popup: this});\n\t\t}\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\topenOn: function (map) {\n\t\tmap.openPopup(this);\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap._panes.popupPane.removeChild(this._container);\n\n\t\tL.Util.falseFn(this._container.offsetWidth); // force reflow\n\n\t\tmap.off(this._getEvents(), this);\n\n\t\tif (map.options.fadeAnimation) {\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\n\t\t}\n\n\t\tthis._map = null;\n\n\t\tthis.fire('close');\n\n\t\tmap.fire('popupclose', {popup: this});\n\n\t\tif (this._source) {\n\t\t\tthis._source.fire('popupclose', {popup: this});\n\t\t}\n\t},\n\n\tgetLatLng: function () {\n\t\treturn this._latlng;\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tthis._latlng = L.latLng(latlng);\n\t\tif (this._map) {\n\t\t\tthis._updatePosition();\n\t\t\tthis._adjustPan();\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetContent: function () {\n\t\treturn this._content;\n\t},\n\n\tsetContent: function (content) {\n\t\tthis._content = content;\n\t\tthis.update();\n\t\treturn this;\n\t},\n\n\tupdate: function () {\n\t\tif (!this._map) { return; }\n\n\t\tthis._container.style.visibility = 'hidden';\n\n\t\tthis._updateContent();\n\t\tthis._updateLayout();\n\t\tthis._updatePosition();\n\n\t\tthis._container.style.visibility = '';\n\n\t\tthis._adjustPan();\n\t},\n\n\t_getEvents: function () {\n\t\tvar events = {\n\t\t\tviewreset: this._updatePosition\n\t\t};\n\n\t\tif (this._animated) {\n\t\t\tevents.zoomanim = this._zoomAnimation;\n\t\t}\n\t\tif ('closeOnClick' in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) {\n\t\t\tevents.preclick = this._close;\n\t\t}\n\t\tif (this.options.keepInView) {\n\t\t\tevents.moveend = this._adjustPan;\n\t\t}\n\n\t\treturn events;\n\t},\n\n\t_close: function () {\n\t\tif (this._map) {\n\t\t\tthis._map.closePopup(this);\n\t\t}\n\t},\n\n\t_initLayout: function () {\n\t\tvar prefix = 'leaflet-popup',\n\t\t\tcontainerClass = prefix + ' ' + this.options.className + ' leaflet-zoom-' +\n\t\t\t        (this._animated ? 'animated' : 'hide'),\n\t\t\tcontainer = this._container = L.DomUtil.create('div', containerClass),\n\t\t\tcloseButton;\n\n\t\tif (this.options.closeButton) {\n\t\t\tcloseButton = this._closeButton =\n\t\t\t        L.DomUtil.create('a', prefix + '-close-button', container);\n\t\t\tcloseButton.href = '#close';\n\t\t\tcloseButton.innerHTML = '&#215;';\n\t\t\tL.DomEvent.disableClickPropagation(closeButton);\n\n\t\t\tL.DomEvent.on(closeButton, 'click', this._onCloseButtonClick, this);\n\t\t}\n\n\t\tvar wrapper = this._wrapper =\n\t\t        L.DomUtil.create('div', prefix + '-content-wrapper', container);\n\t\tL.DomEvent.disableClickPropagation(wrapper);\n\n\t\tthis._contentNode = L.DomUtil.create('div', prefix + '-content', wrapper);\n\n\t\tL.DomEvent.disableScrollPropagation(this._contentNode);\n\t\tL.DomEvent.on(wrapper, 'contextmenu', L.DomEvent.stopPropagation);\n\n\t\tthis._tipContainer = L.DomUtil.create('div', prefix + '-tip-container', container);\n\t\tthis._tip = L.DomUtil.create('div', prefix + '-tip', this._tipContainer);\n\t},\n\n\t_updateContent: function () {\n\t\tif (!this._content) { return; }\n\n\t\tif (typeof this._content === 'string') {\n\t\t\tthis._contentNode.innerHTML = this._content;\n\t\t} else {\n\t\t\twhile (this._contentNode.hasChildNodes()) {\n\t\t\t\tthis._contentNode.removeChild(this._contentNode.firstChild);\n\t\t\t}\n\t\t\tthis._contentNode.appendChild(this._content);\n\t\t}\n\t\tthis.fire('contentupdate');\n\t},\n\n\t_updateLayout: function () {\n\t\tvar container = this._contentNode,\n\t\t    style = container.style;\n\n\t\tstyle.width = '';\n\t\tstyle.whiteSpace = 'nowrap';\n\n\t\tvar width = container.offsetWidth;\n\t\twidth = Math.min(width, this.options.maxWidth);\n\t\twidth = Math.max(width, this.options.minWidth);\n\n\t\tstyle.width = (width + 1) + 'px';\n\t\tstyle.whiteSpace = '';\n\n\t\tstyle.height = '';\n\n\t\tvar height = container.offsetHeight,\n\t\t    maxHeight = this.options.maxHeight,\n\t\t    scrolledClass = 'leaflet-popup-scrolled';\n\n\t\tif (maxHeight && height > maxHeight) {\n\t\t\tstyle.height = maxHeight + 'px';\n\t\t\tL.DomUtil.addClass(container, scrolledClass);\n\t\t} else {\n\t\t\tL.DomUtil.removeClass(container, scrolledClass);\n\t\t}\n\n\t\tthis._containerWidth = this._container.offsetWidth;\n\t},\n\n\t_updatePosition: function () {\n\t\tif (!this._map) { return; }\n\n\t\tvar pos = this._map.latLngToLayerPoint(this._latlng),\n\t\t    animated = this._animated,\n\t\t    offset = L.point(this.options.offset);\n\n\t\tif (animated) {\n\t\t\tL.DomUtil.setPosition(this._container, pos);\n\t\t}\n\n\t\tthis._containerBottom = -offset.y - (animated ? 0 : pos.y);\n\t\tthis._containerLeft = -Math.round(this._containerWidth / 2) + offset.x + (animated ? 0 : pos.x);\n\n\t\t// bottom position the popup in case the height of the popup changes (images loading etc)\n\t\tthis._container.style.bottom = this._containerBottom + 'px';\n\t\tthis._container.style.left = this._containerLeft + 'px';\n\t},\n\n\t_zoomAnimation: function (opt) {\n\t\tvar pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center);\n\n\t\tL.DomUtil.setPosition(this._container, pos);\n\t},\n\n\t_adjustPan: function () {\n\t\tif (!this.options.autoPan) { return; }\n\n\t\tvar map = this._map,\n\t\t    containerHeight = this._container.offsetHeight,\n\t\t    containerWidth = this._containerWidth,\n\n\t\t    layerPos = new L.Point(this._containerLeft, -containerHeight - this._containerBottom);\n\n\t\tif (this._animated) {\n\t\t\tlayerPos._add(L.DomUtil.getPosition(this._container));\n\t\t}\n\n\t\tvar containerPos = map.layerPointToContainerPoint(layerPos),\n\t\t    padding = L.point(this.options.autoPanPadding),\n\t\t    paddingTL = L.point(this.options.autoPanPaddingTopLeft || padding),\n\t\t    paddingBR = L.point(this.options.autoPanPaddingBottomRight || padding),\n\t\t    size = map.getSize(),\n\t\t    dx = 0,\n\t\t    dy = 0;\n\n\t\tif (containerPos.x + containerWidth + paddingBR.x > size.x) { // right\n\t\t\tdx = containerPos.x + containerWidth - size.x + paddingBR.x;\n\t\t}\n\t\tif (containerPos.x - dx - paddingTL.x < 0) { // left\n\t\t\tdx = containerPos.x - paddingTL.x;\n\t\t}\n\t\tif (containerPos.y + containerHeight + paddingBR.y > size.y) { // bottom\n\t\t\tdy = containerPos.y + containerHeight - size.y + paddingBR.y;\n\t\t}\n\t\tif (containerPos.y - dy - paddingTL.y < 0) { // top\n\t\t\tdy = containerPos.y - paddingTL.y;\n\t\t}\n\n\t\tif (dx || dy) {\n\t\t\tmap\n\t\t\t    .fire('autopanstart')\n\t\t\t    .panBy([dx, dy]);\n\t\t}\n\t},\n\n\t_onCloseButtonClick: function (e) {\n\t\tthis._close();\n\t\tL.DomEvent.stop(e);\n\t}\n});\n\nL.popup = function (options, source) {\n\treturn new L.Popup(options, source);\n};\n\n\nL.Map.include({\n\topenPopup: function (popup, latlng, options) { // (Popup) or (String || HTMLElement, LatLng[, Object])\n\t\tthis.closePopup();\n\n\t\tif (!(popup instanceof L.Popup)) {\n\t\t\tvar content = popup;\n\n\t\t\tpopup = new L.Popup(options)\n\t\t\t    .setLatLng(latlng)\n\t\t\t    .setContent(content);\n\t\t}\n\t\tpopup._isOpen = true;\n\n\t\tthis._popup = popup;\n\t\treturn this.addLayer(popup);\n\t},\n\n\tclosePopup: function (popup) {\n\t\tif (!popup || popup === this._popup) {\n\t\t\tpopup = this._popup;\n\t\t\tthis._popup = null;\n\t\t}\n\t\tif (popup) {\n\t\t\tthis.removeLayer(popup);\n\t\t\tpopup._isOpen = false;\n\t\t}\n\t\treturn this;\n\t}\n});\n\n\n/*\n * Popup extension to L.Marker, adding popup-related methods.\n */\n\nL.Marker.include({\n\topenPopup: function () {\n\t\tif (this._popup && this._map && !this._map.hasLayer(this._popup)) {\n\t\t\tthis._popup.setLatLng(this._latlng);\n\t\t\tthis._map.openPopup(this._popup);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclosePopup: function () {\n\t\tif (this._popup) {\n\t\t\tthis._popup._close();\n\t\t}\n\t\treturn this;\n\t},\n\n\ttogglePopup: function () {\n\t\tif (this._popup) {\n\t\t\tif (this._popup._isOpen) {\n\t\t\t\tthis.closePopup();\n\t\t\t} else {\n\t\t\t\tthis.openPopup();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\tbindPopup: function (content, options) {\n\t\tvar anchor = L.point(this.options.icon.options.popupAnchor || [0, 0]);\n\n\t\tanchor = anchor.add(L.Popup.prototype.options.offset);\n\n\t\tif (options && options.offset) {\n\t\t\tanchor = anchor.add(options.offset);\n\t\t}\n\n\t\toptions = L.extend({offset: anchor}, options);\n\n\t\tif (!this._popupHandlersAdded) {\n\t\t\tthis\n\t\t\t    .on('click', this.togglePopup, this)\n\t\t\t    .on('remove', this.closePopup, this)\n\t\t\t    .on('move', this._movePopup, this);\n\t\t\tthis._popupHandlersAdded = true;\n\t\t}\n\n\t\tif (content instanceof L.Popup) {\n\t\t\tL.setOptions(content, options);\n\t\t\tthis._popup = content;\n\t\t} else {\n\t\t\tthis._popup = new L.Popup(options, this)\n\t\t\t\t.setContent(content);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tsetPopupContent: function (content) {\n\t\tif (this._popup) {\n\t\t\tthis._popup.setContent(content);\n\t\t}\n\t\treturn this;\n\t},\n\n\tunbindPopup: function () {\n\t\tif (this._popup) {\n\t\t\tthis._popup = null;\n\t\t\tthis\n\t\t\t    .off('click', this.togglePopup, this)\n\t\t\t    .off('remove', this.closePopup, this)\n\t\t\t    .off('move', this._movePopup, this);\n\t\t\tthis._popupHandlersAdded = false;\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetPopup: function () {\n\t\treturn this._popup;\n\t},\n\n\t_movePopup: function (e) {\n\t\tthis._popup.setLatLng(e.latlng);\n\t}\n});\n\n\n/*\n * L.LayerGroup is a class to combine several layers into one so that\n * you can manipulate the group (e.g. add/remove it) as one layer.\n */\n\nL.LayerGroup = L.Class.extend({\n\tinitialize: function (layers) {\n\t\tthis._layers = {};\n\n\t\tvar i, len;\n\n\t\tif (layers) {\n\t\t\tfor (i = 0, len = layers.length; i < len; i++) {\n\t\t\t\tthis.addLayer(layers[i]);\n\t\t\t}\n\t\t}\n\t},\n\n\taddLayer: function (layer) {\n\t\tvar id = this.getLayerId(layer);\n\n\t\tthis._layers[id] = layer;\n\n\t\tif (this._map) {\n\t\t\tthis._map.addLayer(layer);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tvar id = layer in this._layers ? layer : this.getLayerId(layer);\n\n\t\tif (this._map && this._layers[id]) {\n\t\t\tthis._map.removeLayer(this._layers[id]);\n\t\t}\n\n\t\tdelete this._layers[id];\n\n\t\treturn this;\n\t},\n\n\thasLayer: function (layer) {\n\t\tif (!layer) { return false; }\n\n\t\treturn (layer in this._layers || this.getLayerId(layer) in this._layers);\n\t},\n\n\tclearLayers: function () {\n\t\tthis.eachLayer(this.removeLayer, this);\n\t\treturn this;\n\t},\n\n\tinvoke: function (methodName) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1),\n\t\t    i, layer;\n\n\t\tfor (i in this._layers) {\n\t\t\tlayer = this._layers[i];\n\n\t\t\tif (layer[methodName]) {\n\t\t\t\tlayer[methodName].apply(layer, args);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\t\tthis.eachLayer(map.addLayer, map);\n\t},\n\n\tonRemove: function (map) {\n\t\tthis.eachLayer(map.removeLayer, map);\n\t\tthis._map = null;\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\teachLayer: function (method, context) {\n\t\tfor (var i in this._layers) {\n\t\t\tmethod.call(context, this._layers[i]);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetLayer: function (id) {\n\t\treturn this._layers[id];\n\t},\n\n\tgetLayers: function () {\n\t\tvar layers = [];\n\n\t\tfor (var i in this._layers) {\n\t\t\tlayers.push(this._layers[i]);\n\t\t}\n\t\treturn layers;\n\t},\n\n\tsetZIndex: function (zIndex) {\n\t\treturn this.invoke('setZIndex', zIndex);\n\t},\n\n\tgetLayerId: function (layer) {\n\t\treturn L.stamp(layer);\n\t}\n});\n\nL.layerGroup = function (layers) {\n\treturn new L.LayerGroup(layers);\n};\n\n\n/*\n * L.FeatureGroup extends L.LayerGroup by introducing mouse events and additional methods\n * shared between a group of interactive layers (like vectors or markers).\n */\n\nL.FeatureGroup = L.LayerGroup.extend({\n\tincludes: L.Mixin.Events,\n\n\tstatics: {\n\t\tEVENTS: 'click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose'\n\t},\n\n\taddLayer: function (layer) {\n\t\tif (this.hasLayer(layer)) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif ('on' in layer) {\n\t\t\tlayer.on(L.FeatureGroup.EVENTS, this._propagateEvent, this);\n\t\t}\n\n\t\tL.LayerGroup.prototype.addLayer.call(this, layer);\n\n\t\tif (this._popupContent && layer.bindPopup) {\n\t\t\tlayer.bindPopup(this._popupContent, this._popupOptions);\n\t\t}\n\n\t\treturn this.fire('layeradd', {layer: layer});\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tif (!this.hasLayer(layer)) {\n\t\t\treturn this;\n\t\t}\n\t\tif (layer in this._layers) {\n\t\t\tlayer = this._layers[layer];\n\t\t}\n\n\t\tlayer.off(L.FeatureGroup.EVENTS, this._propagateEvent, this);\n\n\t\tL.LayerGroup.prototype.removeLayer.call(this, layer);\n\n\t\tif (this._popupContent) {\n\t\t\tthis.invoke('unbindPopup');\n\t\t}\n\n\t\treturn this.fire('layerremove', {layer: layer});\n\t},\n\n\tbindPopup: function (content, options) {\n\t\tthis._popupContent = content;\n\t\tthis._popupOptions = options;\n\t\treturn this.invoke('bindPopup', content, options);\n\t},\n\n\topenPopup: function (latlng) {\n\t\t// open popup on the first layer\n\t\tfor (var id in this._layers) {\n\t\t\tthis._layers[id].openPopup(latlng);\n\t\t\tbreak;\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetStyle: function (style) {\n\t\treturn this.invoke('setStyle', style);\n\t},\n\n\tbringToFront: function () {\n\t\treturn this.invoke('bringToFront');\n\t},\n\n\tbringToBack: function () {\n\t\treturn this.invoke('bringToBack');\n\t},\n\n\tgetBounds: function () {\n\t\tvar bounds = new L.LatLngBounds();\n\n\t\tthis.eachLayer(function (layer) {\n\t\t\tbounds.extend(layer instanceof L.Marker ? layer.getLatLng() : layer.getBounds());\n\t\t});\n\n\t\treturn bounds;\n\t},\n\n\t_propagateEvent: function (e) {\n\t\te = L.extend({\n\t\t\tlayer: e.target,\n\t\t\ttarget: this\n\t\t}, e);\n\t\tthis.fire(e.type, e);\n\t}\n});\n\nL.featureGroup = function (layers) {\n\treturn new L.FeatureGroup(layers);\n};\n\n\n/*\n * L.Path is a base class for rendering vector paths on a map. Inherited by Polyline, Circle, etc.\n */\n\nL.Path = L.Class.extend({\n\tincludes: [L.Mixin.Events],\n\n\tstatics: {\n\t\t// how much to extend the clip area around the map view\n\t\t// (relative to its size, e.g. 0.5 is half the screen in each direction)\n\t\t// set it so that SVG element doesn't exceed 1280px (vectors flicker on dragend if it is)\n\t\tCLIP_PADDING: (function () {\n\t\t\tvar max = L.Browser.mobile ? 1280 : 2000,\n\t\t\t    target = (max / Math.max(window.outerWidth, window.outerHeight) - 1) / 2;\n\t\t\treturn Math.max(0, Math.min(0.5, target));\n\t\t})()\n\t},\n\n\toptions: {\n\t\tstroke: true,\n\t\tcolor: '#0033ff',\n\t\tdashArray: null,\n\t\tlineCap: null,\n\t\tlineJoin: null,\n\t\tweight: 5,\n\t\topacity: 0.5,\n\n\t\tfill: false,\n\t\tfillColor: null, //same as color by default\n\t\tfillOpacity: 0.2,\n\n\t\tclickable: true\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\n\t\tif (!this._container) {\n\t\t\tthis._initElements();\n\t\t\tthis._initEvents();\n\t\t}\n\n\t\tthis.projectLatlngs();\n\t\tthis._updatePath();\n\n\t\tif (this._container) {\n\t\t\tthis._map._pathRoot.appendChild(this._container);\n\t\t}\n\n\t\tthis.fire('add');\n\n\t\tmap.on({\n\t\t\t'viewreset': this.projectLatlngs,\n\t\t\t'moveend': this._updatePath\n\t\t}, this);\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap._pathRoot.removeChild(this._container);\n\n\t\t// Need to fire remove event before we set _map to null as the event hooks might need the object\n\t\tthis.fire('remove');\n\t\tthis._map = null;\n\n\t\tif (L.Browser.vml) {\n\t\t\tthis._container = null;\n\t\t\tthis._stroke = null;\n\t\t\tthis._fill = null;\n\t\t}\n\n\t\tmap.off({\n\t\t\t'viewreset': this.projectLatlngs,\n\t\t\t'moveend': this._updatePath\n\t\t}, this);\n\t},\n\n\tprojectLatlngs: function () {\n\t\t// do all projection stuff here\n\t},\n\n\tsetStyle: function (style) {\n\t\tL.setOptions(this, style);\n\n\t\tif (this._container) {\n\t\t\tthis._updateStyle();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis.projectLatlngs();\n\t\t\tthis._updatePath();\n\t\t}\n\t\treturn this;\n\t}\n});\n\nL.Map.include({\n\t_updatePathViewport: function () {\n\t\tvar p = L.Path.CLIP_PADDING,\n\t\t    size = this.getSize(),\n\t\t    panePos = L.DomUtil.getPosition(this._mapPane),\n\t\t    min = panePos.multiplyBy(-1)._subtract(size.multiplyBy(p)._round()),\n\t\t    max = min.add(size.multiplyBy(1 + p * 2)._round());\n\n\t\tthis._pathViewport = new L.Bounds(min, max);\n\t}\n});\n\n\n/*\n * Extends L.Path with SVG-specific rendering code.\n */\n\nL.Path.SVG_NS = 'http://www.w3.org/2000/svg';\n\nL.Browser.svg = !!(document.createElementNS && document.createElementNS(L.Path.SVG_NS, 'svg').createSVGRect);\n\nL.Path = L.Path.extend({\n\tstatics: {\n\t\tSVG: L.Browser.svg\n\t},\n\n\tbringToFront: function () {\n\t\tvar root = this._map._pathRoot,\n\t\t    path = this._container;\n\n\t\tif (path && root.lastChild !== path) {\n\t\t\troot.appendChild(path);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tvar root = this._map._pathRoot,\n\t\t    path = this._container,\n\t\t    first = root.firstChild;\n\n\t\tif (path && first !== path) {\n\t\t\troot.insertBefore(path, first);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetPathString: function () {\n\t\t// form path string here\n\t},\n\n\t_createElement: function (name) {\n\t\treturn document.createElementNS(L.Path.SVG_NS, name);\n\t},\n\n\t_initElements: function () {\n\t\tthis._map._initPathRoot();\n\t\tthis._initPath();\n\t\tthis._initStyle();\n\t},\n\n\t_initPath: function () {\n\t\tthis._container = this._createElement('g');\n\n\t\tthis._path = this._createElement('path');\n\n\t\tif (this.options.className) {\n\t\t\tL.DomUtil.addClass(this._path, this.options.className);\n\t\t}\n\n\t\tthis._container.appendChild(this._path);\n\t},\n\n\t_initStyle: function () {\n\t\tif (this.options.stroke) {\n\t\t\tthis._path.setAttribute('stroke-linejoin', 'round');\n\t\t\tthis._path.setAttribute('stroke-linecap', 'round');\n\t\t}\n\t\tif (this.options.fill) {\n\t\t\tthis._path.setAttribute('fill-rule', 'evenodd');\n\t\t}\n\t\tif (this.options.pointerEvents) {\n\t\t\tthis._path.setAttribute('pointer-events', this.options.pointerEvents);\n\t\t}\n\t\tif (!this.options.clickable && !this.options.pointerEvents) {\n\t\t\tthis._path.setAttribute('pointer-events', 'none');\n\t\t}\n\t\tthis._updateStyle();\n\t},\n\n\t_updateStyle: function () {\n\t\tif (this.options.stroke) {\n\t\t\tthis._path.setAttribute('stroke', this.options.color);\n\t\t\tthis._path.setAttribute('stroke-opacity', this.options.opacity);\n\t\t\tthis._path.setAttribute('stroke-width', this.options.weight);\n\t\t\tif (this.options.dashArray) {\n\t\t\t\tthis._path.setAttribute('stroke-dasharray', this.options.dashArray);\n\t\t\t} else {\n\t\t\t\tthis._path.removeAttribute('stroke-dasharray');\n\t\t\t}\n\t\t\tif (this.options.lineCap) {\n\t\t\t\tthis._path.setAttribute('stroke-linecap', this.options.lineCap);\n\t\t\t}\n\t\t\tif (this.options.lineJoin) {\n\t\t\t\tthis._path.setAttribute('stroke-linejoin', this.options.lineJoin);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._path.setAttribute('stroke', 'none');\n\t\t}\n\t\tif (this.options.fill) {\n\t\t\tthis._path.setAttribute('fill', this.options.fillColor || this.options.color);\n\t\t\tthis._path.setAttribute('fill-opacity', this.options.fillOpacity);\n\t\t} else {\n\t\t\tthis._path.setAttribute('fill', 'none');\n\t\t}\n\t},\n\n\t_updatePath: function () {\n\t\tvar str = this.getPathString();\n\t\tif (!str) {\n\t\t\t// fix webkit empty string parsing bug\n\t\t\tstr = 'M0 0';\n\t\t}\n\t\tthis._path.setAttribute('d', str);\n\t},\n\n\t// TODO remove duplication with L.Map\n\t_initEvents: function () {\n\t\tif (this.options.clickable) {\n\t\t\tif (L.Browser.svg || !L.Browser.vml) {\n\t\t\t\tL.DomUtil.addClass(this._path, 'leaflet-clickable');\n\t\t\t}\n\n\t\t\tL.DomEvent.on(this._container, 'click', this._onMouseClick, this);\n\n\t\t\tvar events = ['dblclick', 'mousedown', 'mouseover',\n\t\t\t              'mouseout', 'mousemove', 'contextmenu'];\n\t\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\t\tL.DomEvent.on(this._container, events[i], this._fireMouseEvent, this);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onMouseClick: function (e) {\n\t\tif (this._map.dragging && this._map.dragging.moved()) { return; }\n\n\t\tthis._fireMouseEvent(e);\n\t},\n\n\t_fireMouseEvent: function (e) {\n\t\tif (!this.hasEventListeners(e.type)) { return; }\n\n\t\tvar map = this._map,\n\t\t    containerPoint = map.mouseEventToContainerPoint(e),\n\t\t    layerPoint = map.containerPointToLayerPoint(containerPoint),\n\t\t    latlng = map.layerPointToLatLng(layerPoint);\n\n\t\tthis.fire(e.type, {\n\t\t\tlatlng: latlng,\n\t\t\tlayerPoint: layerPoint,\n\t\t\tcontainerPoint: containerPoint,\n\t\t\toriginalEvent: e\n\t\t});\n\n\t\tif (e.type === 'contextmenu') {\n\t\t\tL.DomEvent.preventDefault(e);\n\t\t}\n\t\tif (e.type !== 'mousemove') {\n\t\t\tL.DomEvent.stopPropagation(e);\n\t\t}\n\t}\n});\n\nL.Map.include({\n\t_initPathRoot: function () {\n\t\tif (!this._pathRoot) {\n\t\t\tthis._pathRoot = L.Path.prototype._createElement('svg');\n\t\t\tthis._panes.overlayPane.appendChild(this._pathRoot);\n\n\t\t\tif (this.options.zoomAnimation && L.Browser.any3d) {\n\t\t\t\tL.DomUtil.addClass(this._pathRoot, 'leaflet-zoom-animated');\n\n\t\t\t\tthis.on({\n\t\t\t\t\t'zoomanim': this._animatePathZoom,\n\t\t\t\t\t'zoomend': this._endPathZoom\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tL.DomUtil.addClass(this._pathRoot, 'leaflet-zoom-hide');\n\t\t\t}\n\n\t\t\tthis.on('moveend', this._updateSvgViewport);\n\t\t\tthis._updateSvgViewport();\n\t\t}\n\t},\n\n\t_animatePathZoom: function (e) {\n\t\tvar scale = this.getZoomScale(e.zoom),\n\t\t    offset = this._getCenterOffset(e.center)._multiplyBy(-scale)._add(this._pathViewport.min);\n\n\t\tthis._pathRoot.style[L.DomUtil.TRANSFORM] =\n\t\t        L.DomUtil.getTranslateString(offset) + ' scale(' + scale + ') ';\n\n\t\tthis._pathZooming = true;\n\t},\n\n\t_endPathZoom: function () {\n\t\tthis._pathZooming = false;\n\t},\n\n\t_updateSvgViewport: function () {\n\n\t\tif (this._pathZooming) {\n\t\t\t// Do not update SVGs while a zoom animation is going on otherwise the animation will break.\n\t\t\t// When the zoom animation ends we will be updated again anyway\n\t\t\t// This fixes the case where you do a momentum move and zoom while the move is still ongoing.\n\t\t\treturn;\n\t\t}\n\n\t\tthis._updatePathViewport();\n\n\t\tvar vp = this._pathViewport,\n\t\t    min = vp.min,\n\t\t    max = vp.max,\n\t\t    width = max.x - min.x,\n\t\t    height = max.y - min.y,\n\t\t    root = this._pathRoot,\n\t\t    pane = this._panes.overlayPane;\n\n\t\t// Hack to make flicker on drag end on mobile webkit less irritating\n\t\tif (L.Browser.mobileWebkit) {\n\t\t\tpane.removeChild(root);\n\t\t}\n\n\t\tL.DomUtil.setPosition(root, min);\n\t\troot.setAttribute('width', width);\n\t\troot.setAttribute('height', height);\n\t\troot.setAttribute('viewBox', [min.x, min.y, width, height].join(' '));\n\n\t\tif (L.Browser.mobileWebkit) {\n\t\t\tpane.appendChild(root);\n\t\t}\n\t}\n});\n\n\n/*\n * Popup extension to L.Path (polylines, polygons, circles), adding popup-related methods.\n */\n\nL.Path.include({\n\n\tbindPopup: function (content, options) {\n\n\t\tif (content instanceof L.Popup) {\n\t\t\tthis._popup = content;\n\t\t} else {\n\t\t\tif (!this._popup || options) {\n\t\t\t\tthis._popup = new L.Popup(options, this);\n\t\t\t}\n\t\t\tthis._popup.setContent(content);\n\t\t}\n\n\t\tif (!this._popupHandlersAdded) {\n\t\t\tthis\n\t\t\t    .on('click', this._openPopup, this)\n\t\t\t    .on('remove', this.closePopup, this);\n\n\t\t\tthis._popupHandlersAdded = true;\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tunbindPopup: function () {\n\t\tif (this._popup) {\n\t\t\tthis._popup = null;\n\t\t\tthis\n\t\t\t    .off('click', this._openPopup)\n\t\t\t    .off('remove', this.closePopup);\n\n\t\t\tthis._popupHandlersAdded = false;\n\t\t}\n\t\treturn this;\n\t},\n\n\topenPopup: function (latlng) {\n\n\t\tif (this._popup) {\n\t\t\t// open the popup from one of the path's points if not specified\n\t\t\tlatlng = latlng || this._latlng ||\n\t\t\t         this._latlngs[Math.floor(this._latlngs.length / 2)];\n\n\t\t\tthis._openPopup({latlng: latlng});\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclosePopup: function () {\n\t\tif (this._popup) {\n\t\t\tthis._popup._close();\n\t\t}\n\t\treturn this;\n\t},\n\n\t_openPopup: function (e) {\n\t\tthis._popup.setLatLng(e.latlng);\n\t\tthis._map.openPopup(this._popup);\n\t}\n});\n\n\n/*\n * Vector rendering for IE6-8 through VML.\n * Thanks to Dmitry Baranovsky and his Raphael library for inspiration!\n */\n\nL.Browser.vml = !L.Browser.svg && (function () {\n\ttry {\n\t\tvar div = document.createElement('div');\n\t\tdiv.innerHTML = '<v:shape adj=\"1\"/>';\n\n\t\tvar shape = div.firstChild;\n\t\tshape.style.behavior = 'url(#default#VML)';\n\n\t\treturn shape && (typeof shape.adj === 'object');\n\n\t} catch (e) {\n\t\treturn false;\n\t}\n}());\n\nL.Path = L.Browser.svg || !L.Browser.vml ? L.Path : L.Path.extend({\n\tstatics: {\n\t\tVML: true,\n\t\tCLIP_PADDING: 0.02\n\t},\n\n\t_createElement: (function () {\n\t\ttry {\n\t\t\tdocument.namespaces.add('lvml', 'urn:schemas-microsoft-com:vml');\n\t\t\treturn function (name) {\n\t\t\t\treturn document.createElement('<lvml:' + name + ' class=\"lvml\">');\n\t\t\t};\n\t\t} catch (e) {\n\t\t\treturn function (name) {\n\t\t\t\treturn document.createElement(\n\t\t\t\t        '<' + name + ' xmlns=\"urn:schemas-microsoft.com:vml\" class=\"lvml\">');\n\t\t\t};\n\t\t}\n\t}()),\n\n\t_initPath: function () {\n\t\tvar container = this._container = this._createElement('shape');\n\n\t\tL.DomUtil.addClass(container, 'leaflet-vml-shape' +\n\t\t\t(this.options.className ? ' ' + this.options.className : ''));\n\n\t\tif (this.options.clickable) {\n\t\t\tL.DomUtil.addClass(container, 'leaflet-clickable');\n\t\t}\n\n\t\tcontainer.coordsize = '1 1';\n\n\t\tthis._path = this._createElement('path');\n\t\tcontainer.appendChild(this._path);\n\n\t\tthis._map._pathRoot.appendChild(container);\n\t},\n\n\t_initStyle: function () {\n\t\tthis._updateStyle();\n\t},\n\n\t_updateStyle: function () {\n\t\tvar stroke = this._stroke,\n\t\t    fill = this._fill,\n\t\t    options = this.options,\n\t\t    container = this._container;\n\n\t\tcontainer.stroked = options.stroke;\n\t\tcontainer.filled = options.fill;\n\n\t\tif (options.stroke) {\n\t\t\tif (!stroke) {\n\t\t\t\tstroke = this._stroke = this._createElement('stroke');\n\t\t\t\tstroke.endcap = 'round';\n\t\t\t\tcontainer.appendChild(stroke);\n\t\t\t}\n\t\t\tstroke.weight = options.weight + 'px';\n\t\t\tstroke.color = options.color;\n\t\t\tstroke.opacity = options.opacity;\n\n\t\t\tif (options.dashArray) {\n\t\t\t\tstroke.dashStyle = L.Util.isArray(options.dashArray) ?\n\t\t\t\t    options.dashArray.join(' ') :\n\t\t\t\t    options.dashArray.replace(/( *, *)/g, ' ');\n\t\t\t} else {\n\t\t\t\tstroke.dashStyle = '';\n\t\t\t}\n\t\t\tif (options.lineCap) {\n\t\t\t\tstroke.endcap = options.lineCap.replace('butt', 'flat');\n\t\t\t}\n\t\t\tif (options.lineJoin) {\n\t\t\t\tstroke.joinstyle = options.lineJoin;\n\t\t\t}\n\n\t\t} else if (stroke) {\n\t\t\tcontainer.removeChild(stroke);\n\t\t\tthis._stroke = null;\n\t\t}\n\n\t\tif (options.fill) {\n\t\t\tif (!fill) {\n\t\t\t\tfill = this._fill = this._createElement('fill');\n\t\t\t\tcontainer.appendChild(fill);\n\t\t\t}\n\t\t\tfill.color = options.fillColor || options.color;\n\t\t\tfill.opacity = options.fillOpacity;\n\n\t\t} else if (fill) {\n\t\t\tcontainer.removeChild(fill);\n\t\t\tthis._fill = null;\n\t\t}\n\t},\n\n\t_updatePath: function () {\n\t\tvar style = this._container.style;\n\n\t\tstyle.display = 'none';\n\t\tthis._path.v = this.getPathString() + ' '; // the space fixes IE empty path string bug\n\t\tstyle.display = '';\n\t}\n});\n\nL.Map.include(L.Browser.svg || !L.Browser.vml ? {} : {\n\t_initPathRoot: function () {\n\t\tif (this._pathRoot) { return; }\n\n\t\tvar root = this._pathRoot = document.createElement('div');\n\t\troot.className = 'leaflet-vml-container';\n\t\tthis._panes.overlayPane.appendChild(root);\n\n\t\tthis.on('moveend', this._updatePathViewport);\n\t\tthis._updatePathViewport();\n\t}\n});\n\n\n/*\n * Vector rendering for all browsers that support canvas.\n */\n\nL.Browser.canvas = (function () {\n\treturn !!document.createElement('canvas').getContext;\n}());\n\nL.Path = (L.Path.SVG && !window.L_PREFER_CANVAS) || !L.Browser.canvas ? L.Path : L.Path.extend({\n\tstatics: {\n\t\t//CLIP_PADDING: 0.02, // not sure if there's a need to set it to a small value\n\t\tCANVAS: true,\n\t\tSVG: false\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis.projectLatlngs();\n\t\t\tthis._requestUpdate();\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetStyle: function (style) {\n\t\tL.setOptions(this, style);\n\n\t\tif (this._map) {\n\t\t\tthis._updateStyle();\n\t\t\tthis._requestUpdate();\n\t\t}\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap\n\t\t    .off('viewreset', this.projectLatlngs, this)\n\t\t    .off('moveend', this._updatePath, this);\n\n\t\tif (this.options.clickable) {\n\t\t\tthis._map.off('click', this._onClick, this);\n\t\t\tthis._map.off('mousemove', this._onMouseMove, this);\n\t\t}\n\n\t\tthis._requestUpdate();\n\t\t\n\t\tthis.fire('remove');\n\t\tthis._map = null;\n\t},\n\n\t_requestUpdate: function () {\n\t\tif (this._map && !L.Path._updateRequest) {\n\t\t\tL.Path._updateRequest = L.Util.requestAnimFrame(this._fireMapMoveEnd, this._map);\n\t\t}\n\t},\n\n\t_fireMapMoveEnd: function () {\n\t\tL.Path._updateRequest = null;\n\t\tthis.fire('moveend');\n\t},\n\n\t_initElements: function () {\n\t\tthis._map._initPathRoot();\n\t\tthis._ctx = this._map._canvasCtx;\n\t},\n\n\t_updateStyle: function () {\n\t\tvar options = this.options;\n\n\t\tif (options.stroke) {\n\t\t\tthis._ctx.lineWidth = options.weight;\n\t\t\tthis._ctx.strokeStyle = options.color;\n\t\t}\n\t\tif (options.fill) {\n\t\t\tthis._ctx.fillStyle = options.fillColor || options.color;\n\t\t}\n\t},\n\n\t_drawPath: function () {\n\t\tvar i, j, len, len2, point, drawMethod;\n\n\t\tthis._ctx.beginPath();\n\n\t\tfor (i = 0, len = this._parts.length; i < len; i++) {\n\t\t\tfor (j = 0, len2 = this._parts[i].length; j < len2; j++) {\n\t\t\t\tpoint = this._parts[i][j];\n\t\t\t\tdrawMethod = (j === 0 ? 'move' : 'line') + 'To';\n\n\t\t\t\tthis._ctx[drawMethod](point.x, point.y);\n\t\t\t}\n\t\t\t// TODO refactor ugly hack\n\t\t\tif (this instanceof L.Polygon) {\n\t\t\t\tthis._ctx.closePath();\n\t\t\t}\n\t\t}\n\t},\n\n\t_checkIfEmpty: function () {\n\t\treturn !this._parts.length;\n\t},\n\n\t_updatePath: function () {\n\t\tif (this._checkIfEmpty()) { return; }\n\n\t\tvar ctx = this._ctx,\n\t\t    options = this.options;\n\n\t\tthis._drawPath();\n\t\tctx.save();\n\t\tthis._updateStyle();\n\n\t\tif (options.fill) {\n\t\t\tctx.globalAlpha = options.fillOpacity;\n\t\t\tctx.fill();\n\t\t}\n\n\t\tif (options.stroke) {\n\t\t\tctx.globalAlpha = options.opacity;\n\t\t\tctx.stroke();\n\t\t}\n\n\t\tctx.restore();\n\n\t\t// TODO optimization: 1 fill/stroke for all features with equal style instead of 1 for each feature\n\t},\n\n\t_initEvents: function () {\n\t\tif (this.options.clickable) {\n\t\t\t// TODO dblclick\n\t\t\tthis._map.on('mousemove', this._onMouseMove, this);\n\t\t\tthis._map.on('click', this._onClick, this);\n\t\t}\n\t},\n\n\t_onClick: function (e) {\n\t\tif (this._containsPoint(e.layerPoint)) {\n\t\t\tthis.fire('click', e);\n\t\t}\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tif (!this._map || this._map._animatingZoom) { return; }\n\n\t\t// TODO don't do on each move\n\t\tif (this._containsPoint(e.layerPoint)) {\n\t\t\tthis._ctx.canvas.style.cursor = 'pointer';\n\t\t\tthis._mouseInside = true;\n\t\t\tthis.fire('mouseover', e);\n\n\t\t} else if (this._mouseInside) {\n\t\t\tthis._ctx.canvas.style.cursor = '';\n\t\t\tthis._mouseInside = false;\n\t\t\tthis.fire('mouseout', e);\n\t\t}\n\t}\n});\n\nL.Map.include((L.Path.SVG && !window.L_PREFER_CANVAS) || !L.Browser.canvas ? {} : {\n\t_initPathRoot: function () {\n\t\tvar root = this._pathRoot,\n\t\t    ctx;\n\n\t\tif (!root) {\n\t\t\troot = this._pathRoot = document.createElement('canvas');\n\t\t\troot.style.position = 'absolute';\n\t\t\tctx = this._canvasCtx = root.getContext('2d');\n\n\t\t\tctx.lineCap = 'round';\n\t\t\tctx.lineJoin = 'round';\n\n\t\t\tthis._panes.overlayPane.appendChild(root);\n\n\t\t\tif (this.options.zoomAnimation) {\n\t\t\t\tthis._pathRoot.className = 'leaflet-zoom-animated';\n\t\t\t\tthis.on('zoomanim', this._animatePathZoom);\n\t\t\t\tthis.on('zoomend', this._endPathZoom);\n\t\t\t}\n\t\t\tthis.on('moveend', this._updateCanvasViewport);\n\t\t\tthis._updateCanvasViewport();\n\t\t}\n\t},\n\n\t_updateCanvasViewport: function () {\n\t\t// don't redraw while zooming. See _updateSvgViewport for more details\n\t\tif (this._pathZooming) { return; }\n\t\tthis._updatePathViewport();\n\n\t\tvar vp = this._pathViewport,\n\t\t    min = vp.min,\n\t\t    size = vp.max.subtract(min),\n\t\t    root = this._pathRoot;\n\n\t\t//TODO check if this works properly on mobile webkit\n\t\tL.DomUtil.setPosition(root, min);\n\t\troot.width = size.x;\n\t\troot.height = size.y;\n\t\troot.getContext('2d').translate(-min.x, -min.y);\n\t}\n});\n\n\n/*\n * L.LineUtil contains different utility functions for line segments\n * and polylines (clipping, simplification, distances, etc.)\n */\n\n/*jshint bitwise:false */ // allow bitwise operations for this file\n\nL.LineUtil = {\n\n\t// Simplify polyline with vertex reduction and Douglas-Peucker simplification.\n\t// Improves rendering performance dramatically by lessening the number of points to draw.\n\n\tsimplify: function (/*Point[]*/ points, /*Number*/ tolerance) {\n\t\tif (!tolerance || !points.length) {\n\t\t\treturn points.slice();\n\t\t}\n\n\t\tvar sqTolerance = tolerance * tolerance;\n\n\t\t// stage 1: vertex reduction\n\t\tpoints = this._reducePoints(points, sqTolerance);\n\n\t\t// stage 2: Douglas-Peucker simplification\n\t\tpoints = this._simplifyDP(points, sqTolerance);\n\n\t\treturn points;\n\t},\n\n\t// distance from a point to a segment between two points\n\tpointToSegmentDistance:  function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2) {\n\t\treturn Math.sqrt(this._sqClosestPointOnSegment(p, p1, p2, true));\n\t},\n\n\tclosestPointOnSegment: function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2) {\n\t\treturn this._sqClosestPointOnSegment(p, p1, p2);\n\t},\n\n\t// Douglas-Peucker simplification, see http://en.wikipedia.org/wiki/Douglas-Peucker_algorithm\n\t_simplifyDP: function (points, sqTolerance) {\n\n\t\tvar len = points.length,\n\t\t    ArrayConstructor = typeof Uint8Array !== undefined + '' ? Uint8Array : Array,\n\t\t    markers = new ArrayConstructor(len);\n\n\t\tmarkers[0] = markers[len - 1] = 1;\n\n\t\tthis._simplifyDPStep(points, markers, sqTolerance, 0, len - 1);\n\n\t\tvar i,\n\t\t    newPoints = [];\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (markers[i]) {\n\t\t\t\tnewPoints.push(points[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn newPoints;\n\t},\n\n\t_simplifyDPStep: function (points, markers, sqTolerance, first, last) {\n\n\t\tvar maxSqDist = 0,\n\t\t    index, i, sqDist;\n\n\t\tfor (i = first + 1; i <= last - 1; i++) {\n\t\t\tsqDist = this._sqClosestPointOnSegment(points[i], points[first], points[last], true);\n\n\t\t\tif (sqDist > maxSqDist) {\n\t\t\t\tindex = i;\n\t\t\t\tmaxSqDist = sqDist;\n\t\t\t}\n\t\t}\n\n\t\tif (maxSqDist > sqTolerance) {\n\t\t\tmarkers[index] = 1;\n\n\t\t\tthis._simplifyDPStep(points, markers, sqTolerance, first, index);\n\t\t\tthis._simplifyDPStep(points, markers, sqTolerance, index, last);\n\t\t}\n\t},\n\n\t// reduce points that are too close to each other to a single point\n\t_reducePoints: function (points, sqTolerance) {\n\t\tvar reducedPoints = [points[0]];\n\n\t\tfor (var i = 1, prev = 0, len = points.length; i < len; i++) {\n\t\t\tif (this._sqDist(points[i], points[prev]) > sqTolerance) {\n\t\t\t\treducedPoints.push(points[i]);\n\t\t\t\tprev = i;\n\t\t\t}\n\t\t}\n\t\tif (prev < len - 1) {\n\t\t\treducedPoints.push(points[len - 1]);\n\t\t}\n\t\treturn reducedPoints;\n\t},\n\n\t// Cohen-Sutherland line clipping algorithm.\n\t// Used to avoid rendering parts of a polyline that are not currently visible.\n\n\tclipSegment: function (a, b, bounds, useLastCode) {\n\t\tvar codeA = useLastCode ? this._lastCode : this._getBitCode(a, bounds),\n\t\t    codeB = this._getBitCode(b, bounds),\n\n\t\t    codeOut, p, newCode;\n\n\t\t// save 2nd code to avoid calculating it on the next segment\n\t\tthis._lastCode = codeB;\n\n\t\twhile (true) {\n\t\t\t// if a,b is inside the clip window (trivial accept)\n\t\t\tif (!(codeA | codeB)) {\n\t\t\t\treturn [a, b];\n\t\t\t// if a,b is outside the clip window (trivial reject)\n\t\t\t} else if (codeA & codeB) {\n\t\t\t\treturn false;\n\t\t\t// other cases\n\t\t\t} else {\n\t\t\t\tcodeOut = codeA || codeB;\n\t\t\t\tp = this._getEdgeIntersection(a, b, codeOut, bounds);\n\t\t\t\tnewCode = this._getBitCode(p, bounds);\n\n\t\t\t\tif (codeOut === codeA) {\n\t\t\t\t\ta = p;\n\t\t\t\t\tcodeA = newCode;\n\t\t\t\t} else {\n\t\t\t\t\tb = p;\n\t\t\t\t\tcodeB = newCode;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_getEdgeIntersection: function (a, b, code, bounds) {\n\t\tvar dx = b.x - a.x,\n\t\t    dy = b.y - a.y,\n\t\t    min = bounds.min,\n\t\t    max = bounds.max;\n\n\t\tif (code & 8) { // top\n\t\t\treturn new L.Point(a.x + dx * (max.y - a.y) / dy, max.y);\n\t\t} else if (code & 4) { // bottom\n\t\t\treturn new L.Point(a.x + dx * (min.y - a.y) / dy, min.y);\n\t\t} else if (code & 2) { // right\n\t\t\treturn new L.Point(max.x, a.y + dy * (max.x - a.x) / dx);\n\t\t} else if (code & 1) { // left\n\t\t\treturn new L.Point(min.x, a.y + dy * (min.x - a.x) / dx);\n\t\t}\n\t},\n\n\t_getBitCode: function (/*Point*/ p, bounds) {\n\t\tvar code = 0;\n\n\t\tif (p.x < bounds.min.x) { // left\n\t\t\tcode |= 1;\n\t\t} else if (p.x > bounds.max.x) { // right\n\t\t\tcode |= 2;\n\t\t}\n\t\tif (p.y < bounds.min.y) { // bottom\n\t\t\tcode |= 4;\n\t\t} else if (p.y > bounds.max.y) { // top\n\t\t\tcode |= 8;\n\t\t}\n\n\t\treturn code;\n\t},\n\n\t// square distance (to avoid unnecessary Math.sqrt calls)\n\t_sqDist: function (p1, p2) {\n\t\tvar dx = p2.x - p1.x,\n\t\t    dy = p2.y - p1.y;\n\t\treturn dx * dx + dy * dy;\n\t},\n\n\t// return closest point on segment or distance to that point\n\t_sqClosestPointOnSegment: function (p, p1, p2, sqDist) {\n\t\tvar x = p1.x,\n\t\t    y = p1.y,\n\t\t    dx = p2.x - x,\n\t\t    dy = p2.y - y,\n\t\t    dot = dx * dx + dy * dy,\n\t\t    t;\n\n\t\tif (dot > 0) {\n\t\t\tt = ((p.x - x) * dx + (p.y - y) * dy) / dot;\n\n\t\t\tif (t > 1) {\n\t\t\t\tx = p2.x;\n\t\t\t\ty = p2.y;\n\t\t\t} else if (t > 0) {\n\t\t\t\tx += dx * t;\n\t\t\t\ty += dy * t;\n\t\t\t}\n\t\t}\n\n\t\tdx = p.x - x;\n\t\tdy = p.y - y;\n\n\t\treturn sqDist ? dx * dx + dy * dy : new L.Point(x, y);\n\t}\n};\n\n\n/*\n * L.Polyline is used to display polylines on a map.\n */\n\nL.Polyline = L.Path.extend({\n\tinitialize: function (latlngs, options) {\n\t\tL.Path.prototype.initialize.call(this, options);\n\n\t\tthis._latlngs = this._convertLatLngs(latlngs);\n\t},\n\n\toptions: {\n\t\t// how much to simplify the polyline on each zoom level\n\t\t// more = better performance and smoother look, less = more accurate\n\t\tsmoothFactor: 1.0,\n\t\tnoClip: false\n\t},\n\n\tprojectLatlngs: function () {\n\t\tthis._originalPoints = [];\n\n\t\tfor (var i = 0, len = this._latlngs.length; i < len; i++) {\n\t\t\tthis._originalPoints[i] = this._map.latLngToLayerPoint(this._latlngs[i]);\n\t\t}\n\t},\n\n\tgetPathString: function () {\n\t\tfor (var i = 0, len = this._parts.length, str = ''; i < len; i++) {\n\t\t\tstr += this._getPathPartStr(this._parts[i]);\n\t\t}\n\t\treturn str;\n\t},\n\n\tgetLatLngs: function () {\n\t\treturn this._latlngs;\n\t},\n\n\tsetLatLngs: function (latlngs) {\n\t\tthis._latlngs = this._convertLatLngs(latlngs);\n\t\treturn this.redraw();\n\t},\n\n\taddLatLng: function (latlng) {\n\t\tthis._latlngs.push(L.latLng(latlng));\n\t\treturn this.redraw();\n\t},\n\n\tspliceLatLngs: function () { // (Number index, Number howMany)\n\t\tvar removed = [].splice.apply(this._latlngs, arguments);\n\t\tthis._convertLatLngs(this._latlngs, true);\n\t\tthis.redraw();\n\t\treturn removed;\n\t},\n\n\tclosestLayerPoint: function (p) {\n\t\tvar minDistance = Infinity, parts = this._parts, p1, p2, minPoint = null;\n\n\t\tfor (var j = 0, jLen = parts.length; j < jLen; j++) {\n\t\t\tvar points = parts[j];\n\t\t\tfor (var i = 1, len = points.length; i < len; i++) {\n\t\t\t\tp1 = points[i - 1];\n\t\t\t\tp2 = points[i];\n\t\t\t\tvar sqDist = L.LineUtil._sqClosestPointOnSegment(p, p1, p2, true);\n\t\t\t\tif (sqDist < minDistance) {\n\t\t\t\t\tminDistance = sqDist;\n\t\t\t\t\tminPoint = L.LineUtil._sqClosestPointOnSegment(p, p1, p2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (minPoint) {\n\t\t\tminPoint.distance = Math.sqrt(minDistance);\n\t\t}\n\t\treturn minPoint;\n\t},\n\n\tgetBounds: function () {\n\t\treturn new L.LatLngBounds(this.getLatLngs());\n\t},\n\n\t_convertLatLngs: function (latlngs, overwrite) {\n\t\tvar i, len, target = overwrite ? latlngs : [];\n\n\t\tfor (i = 0, len = latlngs.length; i < len; i++) {\n\t\t\tif (L.Util.isArray(latlngs[i]) && typeof latlngs[i][0] !== 'number') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttarget[i] = L.latLng(latlngs[i]);\n\t\t}\n\t\treturn target;\n\t},\n\n\t_initEvents: function () {\n\t\tL.Path.prototype._initEvents.call(this);\n\t},\n\n\t_getPathPartStr: function (points) {\n\t\tvar round = L.Path.VML;\n\n\t\tfor (var j = 0, len2 = points.length, str = '', p; j < len2; j++) {\n\t\t\tp = points[j];\n\t\t\tif (round) {\n\t\t\t\tp._round();\n\t\t\t}\n\t\t\tstr += (j ? 'L' : 'M') + p.x + ' ' + p.y;\n\t\t}\n\t\treturn str;\n\t},\n\n\t_clipPoints: function () {\n\t\tvar points = this._originalPoints,\n\t\t    len = points.length,\n\t\t    i, k, segment;\n\n\t\tif (this.options.noClip) {\n\t\t\tthis._parts = [points];\n\t\t\treturn;\n\t\t}\n\n\t\tthis._parts = [];\n\n\t\tvar parts = this._parts,\n\t\t    vp = this._map._pathViewport,\n\t\t    lu = L.LineUtil;\n\n\t\tfor (i = 0, k = 0; i < len - 1; i++) {\n\t\t\tsegment = lu.clipSegment(points[i], points[i + 1], vp, i);\n\t\t\tif (!segment) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tparts[k] = parts[k] || [];\n\t\t\tparts[k].push(segment[0]);\n\n\t\t\t// if segment goes out of screen, or it's the last one, it's the end of the line part\n\t\t\tif ((segment[1] !== points[i + 1]) || (i === len - 2)) {\n\t\t\t\tparts[k].push(segment[1]);\n\t\t\t\tk++;\n\t\t\t}\n\t\t}\n\t},\n\n\t// simplify each clipped part of the polyline\n\t_simplifyPoints: function () {\n\t\tvar parts = this._parts,\n\t\t    lu = L.LineUtil;\n\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\n\t\t\tparts[i] = lu.simplify(parts[i], this.options.smoothFactor);\n\t\t}\n\t},\n\n\t_updatePath: function () {\n\t\tif (!this._map) { return; }\n\n\t\tthis._clipPoints();\n\t\tthis._simplifyPoints();\n\n\t\tL.Path.prototype._updatePath.call(this);\n\t}\n});\n\nL.polyline = function (latlngs, options) {\n\treturn new L.Polyline(latlngs, options);\n};\n\n\n/*\n * L.PolyUtil contains utility functions for polygons (clipping, etc.).\n */\n\n/*jshint bitwise:false */ // allow bitwise operations here\n\nL.PolyUtil = {};\n\n/*\n * Sutherland-Hodgeman polygon clipping algorithm.\n * Used to avoid rendering parts of a polygon that are not currently visible.\n */\nL.PolyUtil.clipPolygon = function (points, bounds) {\n\tvar clippedPoints,\n\t    edges = [1, 4, 2, 8],\n\t    i, j, k,\n\t    a, b,\n\t    len, edge, p,\n\t    lu = L.LineUtil;\n\n\tfor (i = 0, len = points.length; i < len; i++) {\n\t\tpoints[i]._code = lu._getBitCode(points[i], bounds);\n\t}\n\n\t// for each edge (left, bottom, right, top)\n\tfor (k = 0; k < 4; k++) {\n\t\tedge = edges[k];\n\t\tclippedPoints = [];\n\n\t\tfor (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n\t\t\ta = points[i];\n\t\t\tb = points[j];\n\n\t\t\t// if a is inside the clip window\n\t\t\tif (!(a._code & edge)) {\n\t\t\t\t// if b is outside the clip window (a->b goes out of screen)\n\t\t\t\tif (b._code & edge) {\n\t\t\t\t\tp = lu._getEdgeIntersection(b, a, edge, bounds);\n\t\t\t\t\tp._code = lu._getBitCode(p, bounds);\n\t\t\t\t\tclippedPoints.push(p);\n\t\t\t\t}\n\t\t\t\tclippedPoints.push(a);\n\n\t\t\t// else if b is inside the clip window (a->b enters the screen)\n\t\t\t} else if (!(b._code & edge)) {\n\t\t\t\tp = lu._getEdgeIntersection(b, a, edge, bounds);\n\t\t\t\tp._code = lu._getBitCode(p, bounds);\n\t\t\t\tclippedPoints.push(p);\n\t\t\t}\n\t\t}\n\t\tpoints = clippedPoints;\n\t}\n\n\treturn points;\n};\n\n\n/*\n * L.Polygon is used to display polygons on a map.\n */\n\nL.Polygon = L.Polyline.extend({\n\toptions: {\n\t\tfill: true\n\t},\n\n\tinitialize: function (latlngs, options) {\n\t\tL.Polyline.prototype.initialize.call(this, latlngs, options);\n\t\tthis._initWithHoles(latlngs);\n\t},\n\n\t_initWithHoles: function (latlngs) {\n\t\tvar i, len, hole;\n\t\tif (latlngs && L.Util.isArray(latlngs[0]) && (typeof latlngs[0][0] !== 'number')) {\n\t\t\tthis._latlngs = this._convertLatLngs(latlngs[0]);\n\t\t\tthis._holes = latlngs.slice(1);\n\n\t\t\tfor (i = 0, len = this._holes.length; i < len; i++) {\n\t\t\t\thole = this._holes[i] = this._convertLatLngs(this._holes[i]);\n\t\t\t\tif (hole[0].equals(hole[hole.length - 1])) {\n\t\t\t\t\thole.pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// filter out last point if its equal to the first one\n\t\tlatlngs = this._latlngs;\n\n\t\tif (latlngs.length >= 2 && latlngs[0].equals(latlngs[latlngs.length - 1])) {\n\t\t\tlatlngs.pop();\n\t\t}\n\t},\n\n\tprojectLatlngs: function () {\n\t\tL.Polyline.prototype.projectLatlngs.call(this);\n\n\t\t// project polygon holes points\n\t\t// TODO move this logic to Polyline to get rid of duplication\n\t\tthis._holePoints = [];\n\n\t\tif (!this._holes) { return; }\n\n\t\tvar i, j, len, len2;\n\n\t\tfor (i = 0, len = this._holes.length; i < len; i++) {\n\t\t\tthis._holePoints[i] = [];\n\n\t\t\tfor (j = 0, len2 = this._holes[i].length; j < len2; j++) {\n\t\t\t\tthis._holePoints[i][j] = this._map.latLngToLayerPoint(this._holes[i][j]);\n\t\t\t}\n\t\t}\n\t},\n\n\tsetLatLngs: function (latlngs) {\n\t\tif (latlngs && L.Util.isArray(latlngs[0]) && (typeof latlngs[0][0] !== 'number')) {\n\t\t\tthis._initWithHoles(latlngs);\n\t\t\treturn this.redraw();\n\t\t} else {\n\t\t\treturn L.Polyline.prototype.setLatLngs.call(this, latlngs);\n\t\t}\n\t},\n\n\t_clipPoints: function () {\n\t\tvar points = this._originalPoints,\n\t\t    newParts = [];\n\n\t\tthis._parts = [points].concat(this._holePoints);\n\n\t\tif (this.options.noClip) { return; }\n\n\t\tfor (var i = 0, len = this._parts.length; i < len; i++) {\n\t\t\tvar clipped = L.PolyUtil.clipPolygon(this._parts[i], this._map._pathViewport);\n\t\t\tif (clipped.length) {\n\t\t\t\tnewParts.push(clipped);\n\t\t\t}\n\t\t}\n\n\t\tthis._parts = newParts;\n\t},\n\n\t_getPathPartStr: function (points) {\n\t\tvar str = L.Polyline.prototype._getPathPartStr.call(this, points);\n\t\treturn str + (L.Browser.svg ? 'z' : 'x');\n\t}\n});\n\nL.polygon = function (latlngs, options) {\n\treturn new L.Polygon(latlngs, options);\n};\n\n\n/*\n * Contains L.MultiPolyline and L.MultiPolygon layers.\n */\n\n(function () {\n\tfunction createMulti(Klass) {\n\n\t\treturn L.FeatureGroup.extend({\n\n\t\t\tinitialize: function (latlngs, options) {\n\t\t\t\tthis._layers = {};\n\t\t\t\tthis._options = options;\n\t\t\t\tthis.setLatLngs(latlngs);\n\t\t\t},\n\n\t\t\tsetLatLngs: function (latlngs) {\n\t\t\t\tvar i = 0,\n\t\t\t\t    len = latlngs.length;\n\n\t\t\t\tthis.eachLayer(function (layer) {\n\t\t\t\t\tif (i < len) {\n\t\t\t\t\t\tlayer.setLatLngs(latlngs[i++]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.removeLayer(layer);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\n\t\t\t\twhile (i < len) {\n\t\t\t\t\tthis.addLayer(new Klass(latlngs[i++], this._options));\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tgetLatLngs: function () {\n\t\t\t\tvar latlngs = [];\n\n\t\t\t\tthis.eachLayer(function (layer) {\n\t\t\t\t\tlatlngs.push(layer.getLatLngs());\n\t\t\t\t});\n\n\t\t\t\treturn latlngs;\n\t\t\t}\n\t\t});\n\t}\n\n\tL.MultiPolyline = createMulti(L.Polyline);\n\tL.MultiPolygon = createMulti(L.Polygon);\n\n\tL.multiPolyline = function (latlngs, options) {\n\t\treturn new L.MultiPolyline(latlngs, options);\n\t};\n\n\tL.multiPolygon = function (latlngs, options) {\n\t\treturn new L.MultiPolygon(latlngs, options);\n\t};\n}());\n\n\n/*\n * L.Rectangle extends Polygon and creates a rectangle when passed a LatLngBounds object.\n */\n\nL.Rectangle = L.Polygon.extend({\n\tinitialize: function (latLngBounds, options) {\n\t\tL.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(latLngBounds), options);\n\t},\n\n\tsetBounds: function (latLngBounds) {\n\t\tthis.setLatLngs(this._boundsToLatLngs(latLngBounds));\n\t},\n\n\t_boundsToLatLngs: function (latLngBounds) {\n\t\tlatLngBounds = L.latLngBounds(latLngBounds);\n\t\treturn [\n\t\t\tlatLngBounds.getSouthWest(),\n\t\t\tlatLngBounds.getNorthWest(),\n\t\t\tlatLngBounds.getNorthEast(),\n\t\t\tlatLngBounds.getSouthEast()\n\t\t];\n\t}\n});\n\nL.rectangle = function (latLngBounds, options) {\n\treturn new L.Rectangle(latLngBounds, options);\n};\n\n\n/*\n * L.Circle is a circle overlay (with a certain radius in meters).\n */\n\nL.Circle = L.Path.extend({\n\tinitialize: function (latlng, radius, options) {\n\t\tL.Path.prototype.initialize.call(this, options);\n\n\t\tthis._latlng = L.latLng(latlng);\n\t\tthis._mRadius = radius;\n\t},\n\n\toptions: {\n\t\tfill: true\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tthis._latlng = L.latLng(latlng);\n\t\treturn this.redraw();\n\t},\n\n\tsetRadius: function (radius) {\n\t\tthis._mRadius = radius;\n\t\treturn this.redraw();\n\t},\n\n\tprojectLatlngs: function () {\n\t\tvar lngRadius = this._getLngRadius(),\n\t\t    latlng = this._latlng,\n\t\t    pointLeft = this._map.latLngToLayerPoint([latlng.lat, latlng.lng - lngRadius]);\n\n\t\tthis._point = this._map.latLngToLayerPoint(latlng);\n\t\tthis._radius = Math.max(this._point.x - pointLeft.x, 1);\n\t},\n\n\tgetBounds: function () {\n\t\tvar lngRadius = this._getLngRadius(),\n\t\t    latRadius = (this._mRadius / 40075017) * 360,\n\t\t    latlng = this._latlng;\n\n\t\treturn new L.LatLngBounds(\n\t\t        [latlng.lat - latRadius, latlng.lng - lngRadius],\n\t\t        [latlng.lat + latRadius, latlng.lng + lngRadius]);\n\t},\n\n\tgetLatLng: function () {\n\t\treturn this._latlng;\n\t},\n\n\tgetPathString: function () {\n\t\tvar p = this._point,\n\t\t    r = this._radius;\n\n\t\tif (this._checkIfEmpty()) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (L.Browser.svg) {\n\t\t\treturn 'M' + p.x + ',' + (p.y - r) +\n\t\t\t       'A' + r + ',' + r + ',0,1,1,' +\n\t\t\t       (p.x - 0.1) + ',' + (p.y - r) + ' z';\n\t\t} else {\n\t\t\tp._round();\n\t\t\tr = Math.round(r);\n\t\t\treturn 'AL ' + p.x + ',' + p.y + ' ' + r + ',' + r + ' 0,' + (65535 * 360);\n\t\t}\n\t},\n\n\tgetRadius: function () {\n\t\treturn this._mRadius;\n\t},\n\n\t// TODO Earth hardcoded, move into projection code!\n\n\t_getLatRadius: function () {\n\t\treturn (this._mRadius / 40075017) * 360;\n\t},\n\n\t_getLngRadius: function () {\n\t\treturn this._getLatRadius() / Math.cos(L.LatLng.DEG_TO_RAD * this._latlng.lat);\n\t},\n\n\t_checkIfEmpty: function () {\n\t\tif (!this._map) {\n\t\t\treturn false;\n\t\t}\n\t\tvar vp = this._map._pathViewport,\n\t\t    r = this._radius,\n\t\t    p = this._point;\n\n\t\treturn p.x - r > vp.max.x || p.y - r > vp.max.y ||\n\t\t       p.x + r < vp.min.x || p.y + r < vp.min.y;\n\t}\n});\n\nL.circle = function (latlng, radius, options) {\n\treturn new L.Circle(latlng, radius, options);\n};\n\n\n/*\n * L.CircleMarker is a circle overlay with a permanent pixel radius.\n */\n\nL.CircleMarker = L.Circle.extend({\n\toptions: {\n\t\tradius: 10,\n\t\tweight: 2\n\t},\n\n\tinitialize: function (latlng, options) {\n\t\tL.Circle.prototype.initialize.call(this, latlng, null, options);\n\t\tthis._radius = this.options.radius;\n\t},\n\n\tprojectLatlngs: function () {\n\t\tthis._point = this._map.latLngToLayerPoint(this._latlng);\n\t},\n\n\t_updateStyle : function () {\n\t\tL.Circle.prototype._updateStyle.call(this);\n\t\tthis.setRadius(this.options.radius);\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tL.Circle.prototype.setLatLng.call(this, latlng);\n\t\tif (this._popup && this._popup._isOpen) {\n\t\t\tthis._popup.setLatLng(latlng);\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetRadius: function (radius) {\n\t\tthis.options.radius = this._radius = radius;\n\t\treturn this.redraw();\n\t},\n\n\tgetRadius: function () {\n\t\treturn this._radius;\n\t}\n});\n\nL.circleMarker = function (latlng, options) {\n\treturn new L.CircleMarker(latlng, options);\n};\n\n\n/*\n * Extends L.Polyline to be able to manually detect clicks on Canvas-rendered polylines.\n */\n\nL.Polyline.include(!L.Path.CANVAS ? {} : {\n\t_containsPoint: function (p, closed) {\n\t\tvar i, j, k, len, len2, dist, part,\n\t\t    w = this.options.weight / 2;\n\n\t\tif (L.Browser.touch) {\n\t\t\tw += 10; // polyline click tolerance on touch devices\n\t\t}\n\n\t\tfor (i = 0, len = this._parts.length; i < len; i++) {\n\t\t\tpart = this._parts[i];\n\t\t\tfor (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {\n\t\t\t\tif (!closed && (j === 0)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tdist = L.LineUtil.pointToSegmentDistance(p, part[k], part[j]);\n\n\t\t\t\tif (dist <= w) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n});\n\n\n/*\n * Extends L.Polygon to be able to manually detect clicks on Canvas-rendered polygons.\n */\n\nL.Polygon.include(!L.Path.CANVAS ? {} : {\n\t_containsPoint: function (p) {\n\t\tvar inside = false,\n\t\t    part, p1, p2,\n\t\t    i, j, k,\n\t\t    len, len2;\n\n\t\t// TODO optimization: check if within bounds first\n\n\t\tif (L.Polyline.prototype._containsPoint.call(this, p, true)) {\n\t\t\t// click on polygon border\n\t\t\treturn true;\n\t\t}\n\n\t\t// ray casting algorithm for detecting if point is in polygon\n\n\t\tfor (i = 0, len = this._parts.length; i < len; i++) {\n\t\t\tpart = this._parts[i];\n\n\t\t\tfor (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {\n\t\t\t\tp1 = part[j];\n\t\t\t\tp2 = part[k];\n\n\t\t\t\tif (((p1.y > p.y) !== (p2.y > p.y)) &&\n\t\t\t\t\t\t(p.x < (p2.x - p1.x) * (p.y - p1.y) / (p2.y - p1.y) + p1.x)) {\n\t\t\t\t\tinside = !inside;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn inside;\n\t}\n});\n\n\n/*\n * Extends L.Circle with Canvas-specific code.\n */\n\nL.Circle.include(!L.Path.CANVAS ? {} : {\n\t_drawPath: function () {\n\t\tvar p = this._point;\n\t\tthis._ctx.beginPath();\n\t\tthis._ctx.arc(p.x, p.y, this._radius, 0, Math.PI * 2, false);\n\t},\n\n\t_containsPoint: function (p) {\n\t\tvar center = this._point,\n\t\t    w2 = this.options.stroke ? this.options.weight / 2 : 0;\n\n\t\treturn (p.distanceTo(center) <= this._radius + w2);\n\t}\n});\n\n\n/*\n * CircleMarker canvas specific drawing parts.\n */\n\nL.CircleMarker.include(!L.Path.CANVAS ? {} : {\n\t_updateStyle: function () {\n\t\tL.Path.prototype._updateStyle.call(this);\n\t}\n});\n\n\n/*\n * L.GeoJSON turns any GeoJSON data into a Leaflet layer.\n */\n\nL.GeoJSON = L.FeatureGroup.extend({\n\n\tinitialize: function (geojson, options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._layers = {};\n\n\t\tif (geojson) {\n\t\t\tthis.addData(geojson);\n\t\t}\n\t},\n\n\taddData: function (geojson) {\n\t\tvar features = L.Util.isArray(geojson) ? geojson : geojson.features,\n\t\t    i, len, feature;\n\n\t\tif (features) {\n\t\t\tfor (i = 0, len = features.length; i < len; i++) {\n\t\t\t\t// Only add this if geometry or geometries are set and not null\n\t\t\t\tfeature = features[i];\n\t\t\t\tif (feature.geometries || feature.geometry || feature.features || feature.coordinates) {\n\t\t\t\t\tthis.addData(features[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\tif (options.filter && !options.filter(geojson)) { return; }\n\n\t\tvar layer = L.GeoJSON.geometryToLayer(geojson, options.pointToLayer, options.coordsToLatLng, options);\n\t\tlayer.feature = L.GeoJSON.asFeature(geojson);\n\n\t\tlayer.defaultOptions = layer.options;\n\t\tthis.resetStyle(layer);\n\n\t\tif (options.onEachFeature) {\n\t\t\toptions.onEachFeature(geojson, layer);\n\t\t}\n\n\t\treturn this.addLayer(layer);\n\t},\n\n\tresetStyle: function (layer) {\n\t\tvar style = this.options.style;\n\t\tif (style) {\n\t\t\t// reset any custom styles\n\t\t\tL.Util.extend(layer.options, layer.defaultOptions);\n\n\t\t\tthis._setLayerStyle(layer, style);\n\t\t}\n\t},\n\n\tsetStyle: function (style) {\n\t\tthis.eachLayer(function (layer) {\n\t\t\tthis._setLayerStyle(layer, style);\n\t\t}, this);\n\t},\n\n\t_setLayerStyle: function (layer, style) {\n\t\tif (typeof style === 'function') {\n\t\t\tstyle = style(layer.feature);\n\t\t}\n\t\tif (layer.setStyle) {\n\t\t\tlayer.setStyle(style);\n\t\t}\n\t}\n});\n\nL.extend(L.GeoJSON, {\n\tgeometryToLayer: function (geojson, pointToLayer, coordsToLatLng, vectorOptions) {\n\t\tvar geometry = geojson.type === 'Feature' ? geojson.geometry : geojson,\n\t\t    coords = geometry.coordinates,\n\t\t    layers = [],\n\t\t    latlng, latlngs, i, len;\n\n\t\tcoordsToLatLng = coordsToLatLng || this.coordsToLatLng;\n\n\t\tswitch (geometry.type) {\n\t\tcase 'Point':\n\t\t\tlatlng = coordsToLatLng(coords);\n\t\t\treturn pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng);\n\n\t\tcase 'MultiPoint':\n\t\t\tfor (i = 0, len = coords.length; i < len; i++) {\n\t\t\t\tlatlng = coordsToLatLng(coords[i]);\n\t\t\t\tlayers.push(pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng));\n\t\t\t}\n\t\t\treturn new L.FeatureGroup(layers);\n\n\t\tcase 'LineString':\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 0, coordsToLatLng);\n\t\t\treturn new L.Polyline(latlngs, vectorOptions);\n\n\t\tcase 'Polygon':\n\t\t\tif (coords.length === 2 && !coords[1].length) {\n\t\t\t\tthrow new Error('Invalid GeoJSON object.');\n\t\t\t}\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 1, coordsToLatLng);\n\t\t\treturn new L.Polygon(latlngs, vectorOptions);\n\n\t\tcase 'MultiLineString':\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 1, coordsToLatLng);\n\t\t\treturn new L.MultiPolyline(latlngs, vectorOptions);\n\n\t\tcase 'MultiPolygon':\n\t\t\tlatlngs = this.coordsToLatLngs(coords, 2, coordsToLatLng);\n\t\t\treturn new L.MultiPolygon(latlngs, vectorOptions);\n\n\t\tcase 'GeometryCollection':\n\t\t\tfor (i = 0, len = geometry.geometries.length; i < len; i++) {\n\n\t\t\t\tlayers.push(this.geometryToLayer({\n\t\t\t\t\tgeometry: geometry.geometries[i],\n\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\tproperties: geojson.properties\n\t\t\t\t}, pointToLayer, coordsToLatLng, vectorOptions));\n\t\t\t}\n\t\t\treturn new L.FeatureGroup(layers);\n\n\t\tdefault:\n\t\t\tthrow new Error('Invalid GeoJSON object.');\n\t\t}\n\t},\n\n\tcoordsToLatLng: function (coords) { // (Array[, Boolean]) -> LatLng\n\t\treturn new L.LatLng(coords[1], coords[0], coords[2]);\n\t},\n\n\tcoordsToLatLngs: function (coords, levelsDeep, coordsToLatLng) { // (Array[, Number, Function]) -> Array\n\t\tvar latlng, i, len,\n\t\t    latlngs = [];\n\n\t\tfor (i = 0, len = coords.length; i < len; i++) {\n\t\t\tlatlng = levelsDeep ?\n\t\t\t        this.coordsToLatLngs(coords[i], levelsDeep - 1, coordsToLatLng) :\n\t\t\t        (coordsToLatLng || this.coordsToLatLng)(coords[i]);\n\n\t\t\tlatlngs.push(latlng);\n\t\t}\n\n\t\treturn latlngs;\n\t},\n\n\tlatLngToCoords: function (latlng) {\n\t\tvar coords = [latlng.lng, latlng.lat];\n\n\t\tif (latlng.alt !== undefined) {\n\t\t\tcoords.push(latlng.alt);\n\t\t}\n\t\treturn coords;\n\t},\n\n\tlatLngsToCoords: function (latLngs) {\n\t\tvar coords = [];\n\n\t\tfor (var i = 0, len = latLngs.length; i < len; i++) {\n\t\t\tcoords.push(L.GeoJSON.latLngToCoords(latLngs[i]));\n\t\t}\n\n\t\treturn coords;\n\t},\n\n\tgetFeature: function (layer, newGeometry) {\n\t\treturn layer.feature ? L.extend({}, layer.feature, {geometry: newGeometry}) : L.GeoJSON.asFeature(newGeometry);\n\t},\n\n\tasFeature: function (geoJSON) {\n\t\tif (geoJSON.type === 'Feature') {\n\t\t\treturn geoJSON;\n\t\t}\n\n\t\treturn {\n\t\t\ttype: 'Feature',\n\t\t\tproperties: {},\n\t\t\tgeometry: geoJSON\n\t\t};\n\t}\n});\n\nvar PointToGeoJSON = {\n\ttoGeoJSON: function () {\n\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\ttype: 'Point',\n\t\t\tcoordinates: L.GeoJSON.latLngToCoords(this.getLatLng())\n\t\t});\n\t}\n};\n\nL.Marker.include(PointToGeoJSON);\nL.Circle.include(PointToGeoJSON);\nL.CircleMarker.include(PointToGeoJSON);\n\nL.Polyline.include({\n\ttoGeoJSON: function () {\n\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\ttype: 'LineString',\n\t\t\tcoordinates: L.GeoJSON.latLngsToCoords(this.getLatLngs())\n\t\t});\n\t}\n});\n\nL.Polygon.include({\n\ttoGeoJSON: function () {\n\t\tvar coords = [L.GeoJSON.latLngsToCoords(this.getLatLngs())],\n\t\t    i, len, hole;\n\n\t\tcoords[0].push(coords[0][0]);\n\n\t\tif (this._holes) {\n\t\t\tfor (i = 0, len = this._holes.length; i < len; i++) {\n\t\t\t\thole = L.GeoJSON.latLngsToCoords(this._holes[i]);\n\t\t\t\thole.push(hole[0]);\n\t\t\t\tcoords.push(hole);\n\t\t\t}\n\t\t}\n\n\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\ttype: 'Polygon',\n\t\t\tcoordinates: coords\n\t\t});\n\t}\n});\n\n(function () {\n\tfunction multiToGeoJSON(type) {\n\t\treturn function () {\n\t\t\tvar coords = [];\n\n\t\t\tthis.eachLayer(function (layer) {\n\t\t\t\tcoords.push(layer.toGeoJSON().geometry.coordinates);\n\t\t\t});\n\n\t\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\t\ttype: type,\n\t\t\t\tcoordinates: coords\n\t\t\t});\n\t\t};\n\t}\n\n\tL.MultiPolyline.include({toGeoJSON: multiToGeoJSON('MultiLineString')});\n\tL.MultiPolygon.include({toGeoJSON: multiToGeoJSON('MultiPolygon')});\n\n\tL.LayerGroup.include({\n\t\ttoGeoJSON: function () {\n\n\t\t\tvar geometry = this.feature && this.feature.geometry,\n\t\t\t\tjsons = [],\n\t\t\t\tjson;\n\n\t\t\tif (geometry && geometry.type === 'MultiPoint') {\n\t\t\t\treturn multiToGeoJSON('MultiPoint').call(this);\n\t\t\t}\n\n\t\t\tvar isGeometryCollection = geometry && geometry.type === 'GeometryCollection';\n\n\t\t\tthis.eachLayer(function (layer) {\n\t\t\t\tif (layer.toGeoJSON) {\n\t\t\t\t\tjson = layer.toGeoJSON();\n\t\t\t\t\tjsons.push(isGeometryCollection ? json.geometry : L.GeoJSON.asFeature(json));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (isGeometryCollection) {\n\t\t\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\t\t\tgeometries: jsons,\n\t\t\t\t\ttype: 'GeometryCollection'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttype: 'FeatureCollection',\n\t\t\t\tfeatures: jsons\n\t\t\t};\n\t\t}\n\t});\n}());\n\nL.geoJson = function (geojson, options) {\n\treturn new L.GeoJSON(geojson, options);\n};\n\n\n/*\n * L.DomEvent contains functions for working with DOM events.\n */\n\nL.DomEvent = {\n\t/* inspired by John Resig, Dean Edwards and YUI addEvent implementations */\n\taddListener: function (obj, type, fn, context) { // (HTMLElement, String, Function[, Object])\n\n\t\tvar id = L.stamp(fn),\n\t\t    key = '_leaflet_' + type + id,\n\t\t    handler, originalHandler, newType;\n\n\t\tif (obj[key]) { return this; }\n\n\t\thandler = function (e) {\n\t\t\treturn fn.call(context || obj, e || L.DomEvent._getEvent());\n\t\t};\n\n\t\tif (L.Browser.pointer && type.indexOf('touch') === 0) {\n\t\t\treturn this.addPointerListener(obj, type, handler, id);\n\t\t}\n\t\tif (L.Browser.touch && (type === 'dblclick') && this.addDoubleTapListener) {\n\t\t\tthis.addDoubleTapListener(obj, handler, id);\n\t\t}\n\n\t\tif ('addEventListener' in obj) {\n\n\t\t\tif (type === 'mousewheel') {\n\t\t\t\tobj.addEventListener('DOMMouseScroll', handler, false);\n\t\t\t\tobj.addEventListener(type, handler, false);\n\n\t\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\n\n\t\t\t\toriginalHandler = handler;\n\t\t\t\tnewType = (type === 'mouseenter' ? 'mouseover' : 'mouseout');\n\n\t\t\t\thandler = function (e) {\n\t\t\t\t\tif (!L.DomEvent._checkMouse(obj, e)) { return; }\n\t\t\t\t\treturn originalHandler(e);\n\t\t\t\t};\n\n\t\t\t\tobj.addEventListener(newType, handler, false);\n\n\t\t\t} else if (type === 'click' && L.Browser.android) {\n\t\t\t\toriginalHandler = handler;\n\t\t\t\thandler = function (e) {\n\t\t\t\t\treturn L.DomEvent._filterClick(e, originalHandler);\n\t\t\t\t};\n\n\t\t\t\tobj.addEventListener(type, handler, false);\n\t\t\t} else {\n\t\t\t\tobj.addEventListener(type, handler, false);\n\t\t\t}\n\n\t\t} else if ('attachEvent' in obj) {\n\t\t\tobj.attachEvent('on' + type, handler);\n\t\t}\n\n\t\tobj[key] = handler;\n\n\t\treturn this;\n\t},\n\n\tremoveListener: function (obj, type, fn) {  // (HTMLElement, String, Function)\n\n\t\tvar id = L.stamp(fn),\n\t\t    key = '_leaflet_' + type + id,\n\t\t    handler = obj[key];\n\n\t\tif (!handler) { return this; }\n\n\t\tif (L.Browser.pointer && type.indexOf('touch') === 0) {\n\t\t\tthis.removePointerListener(obj, type, id);\n\t\t} else if (L.Browser.touch && (type === 'dblclick') && this.removeDoubleTapListener) {\n\t\t\tthis.removeDoubleTapListener(obj, id);\n\n\t\t} else if ('removeEventListener' in obj) {\n\n\t\t\tif (type === 'mousewheel') {\n\t\t\t\tobj.removeEventListener('DOMMouseScroll', handler, false);\n\t\t\t\tobj.removeEventListener(type, handler, false);\n\n\t\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\n\t\t\t\tobj.removeEventListener((type === 'mouseenter' ? 'mouseover' : 'mouseout'), handler, false);\n\t\t\t} else {\n\t\t\t\tobj.removeEventListener(type, handler, false);\n\t\t\t}\n\t\t} else if ('detachEvent' in obj) {\n\t\t\tobj.detachEvent('on' + type, handler);\n\t\t}\n\n\t\tobj[key] = null;\n\n\t\treturn this;\n\t},\n\n\tstopPropagation: function (e) {\n\n\t\tif (e.stopPropagation) {\n\t\t\te.stopPropagation();\n\t\t} else {\n\t\t\te.cancelBubble = true;\n\t\t}\n\t\tL.DomEvent._skipped(e);\n\n\t\treturn this;\n\t},\n\n\tdisableScrollPropagation: function (el) {\n\t\tvar stop = L.DomEvent.stopPropagation;\n\n\t\treturn L.DomEvent\n\t\t\t.on(el, 'mousewheel', stop)\n\t\t\t.on(el, 'MozMousePixelScroll', stop);\n\t},\n\n\tdisableClickPropagation: function (el) {\n\t\tvar stop = L.DomEvent.stopPropagation;\n\n\t\tfor (var i = L.Draggable.START.length - 1; i >= 0; i--) {\n\t\t\tL.DomEvent.on(el, L.Draggable.START[i], stop);\n\t\t}\n\n\t\treturn L.DomEvent\n\t\t\t.on(el, 'click', L.DomEvent._fakeStop)\n\t\t\t.on(el, 'dblclick', stop);\n\t},\n\n\tpreventDefault: function (e) {\n\n\t\tif (e.preventDefault) {\n\t\t\te.preventDefault();\n\t\t} else {\n\t\t\te.returnValue = false;\n\t\t}\n\t\treturn this;\n\t},\n\n\tstop: function (e) {\n\t\treturn L.DomEvent\n\t\t\t.preventDefault(e)\n\t\t\t.stopPropagation(e);\n\t},\n\n\tgetMousePosition: function (e, container) {\n\t\tif (!container) {\n\t\t\treturn new L.Point(e.clientX, e.clientY);\n\t\t}\n\n\t\tvar rect = container.getBoundingClientRect();\n\n\t\treturn new L.Point(\n\t\t\te.clientX - rect.left - container.clientLeft,\n\t\t\te.clientY - rect.top - container.clientTop);\n\t},\n\n\tgetWheelDelta: function (e) {\n\n\t\tvar delta = 0;\n\n\t\tif (e.wheelDelta) {\n\t\t\tdelta = e.wheelDelta / 120;\n\t\t}\n\t\tif (e.detail) {\n\t\t\tdelta = -e.detail / 3;\n\t\t}\n\t\treturn delta;\n\t},\n\n\t_skipEvents: {},\n\n\t_fakeStop: function (e) {\n\t\t// fakes stopPropagation by setting a special event flag, checked/reset with L.DomEvent._skipped(e)\n\t\tL.DomEvent._skipEvents[e.type] = true;\n\t},\n\n\t_skipped: function (e) {\n\t\tvar skipped = this._skipEvents[e.type];\n\t\t// reset when checking, as it's only used in map container and propagates outside of the map\n\t\tthis._skipEvents[e.type] = false;\n\t\treturn skipped;\n\t},\n\n\t// check if element really left/entered the event target (for mouseenter/mouseleave)\n\t_checkMouse: function (el, e) {\n\n\t\tvar related = e.relatedTarget;\n\n\t\tif (!related) { return true; }\n\n\t\ttry {\n\t\t\twhile (related && (related !== el)) {\n\t\t\t\trelated = related.parentNode;\n\t\t\t}\n\t\t} catch (err) {\n\t\t\treturn false;\n\t\t}\n\t\treturn (related !== el);\n\t},\n\n\t_getEvent: function () { // evil magic for IE\n\t\t/*jshint noarg:false */\n\t\tvar e = window.event;\n\t\tif (!e) {\n\t\t\tvar caller = arguments.callee.caller;\n\t\t\twhile (caller) {\n\t\t\t\te = caller['arguments'][0];\n\t\t\t\tif (e && window.Event === e.constructor) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcaller = caller.caller;\n\t\t\t}\n\t\t}\n\t\treturn e;\n\t},\n\n\t// this is a horrible workaround for a bug in Android where a single touch triggers two click events\n\t_filterClick: function (e, handler) {\n\t\tvar timeStamp = (e.timeStamp || e.originalEvent.timeStamp),\n\t\t\telapsed = L.DomEvent._lastClick && (timeStamp - L.DomEvent._lastClick);\n\n\t\t// are they closer together than 500ms yet more than 100ms?\n\t\t// Android typically triggers them ~300ms apart while multiple listeners\n\t\t// on the same event should be triggered far faster;\n\t\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\n\n\t\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\n\t\t\tL.DomEvent.stop(e);\n\t\t\treturn;\n\t\t}\n\t\tL.DomEvent._lastClick = timeStamp;\n\n\t\treturn handler(e);\n\t}\n};\n\nL.DomEvent.on = L.DomEvent.addListener;\nL.DomEvent.off = L.DomEvent.removeListener;\n\n\n/*\n * L.Draggable allows you to add dragging capabilities to any element. Supports mobile devices too.\n */\n\nL.Draggable = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\tstatics: {\n\t\tSTART: L.Browser.touch ? ['touchstart', 'mousedown'] : ['mousedown'],\n\t\tEND: {\n\t\t\tmousedown: 'mouseup',\n\t\t\ttouchstart: 'touchend',\n\t\t\tpointerdown: 'touchend',\n\t\t\tMSPointerDown: 'touchend'\n\t\t},\n\t\tMOVE: {\n\t\t\tmousedown: 'mousemove',\n\t\t\ttouchstart: 'touchmove',\n\t\t\tpointerdown: 'touchmove',\n\t\t\tMSPointerDown: 'touchmove'\n\t\t}\n\t},\n\n\tinitialize: function (element, dragStartTarget) {\n\t\tthis._element = element;\n\t\tthis._dragStartTarget = dragStartTarget || element;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled) { return; }\n\n\t\tfor (var i = L.Draggable.START.length - 1; i >= 0; i--) {\n\t\t\tL.DomEvent.on(this._dragStartTarget, L.Draggable.START[i], this._onDown, this);\n\t\t}\n\n\t\tthis._enabled = true;\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tfor (var i = L.Draggable.START.length - 1; i >= 0; i--) {\n\t\t\tL.DomEvent.off(this._dragStartTarget, L.Draggable.START[i], this._onDown, this);\n\t\t}\n\n\t\tthis._enabled = false;\n\t\tthis._moved = false;\n\t},\n\n\t_onDown: function (e) {\n\t\tthis._moved = false;\n\n\t\tif (e.shiftKey || ((e.which !== 1) && (e.button !== 1) && !e.touches)) { return; }\n\n\t\tL.DomEvent.stopPropagation(e);\n\n\t\tif (L.Draggable._disabled) { return; }\n\n\t\tL.DomUtil.disableImageDrag();\n\t\tL.DomUtil.disableTextSelection();\n\n\t\tif (this._moving) { return; }\n\n\t\tvar first = e.touches ? e.touches[0] : e;\n\n\t\tthis._startPoint = new L.Point(first.clientX, first.clientY);\n\t\tthis._startPos = this._newPos = L.DomUtil.getPosition(this._element);\n\n\t\tL.DomEvent\n\t\t    .on(document, L.Draggable.MOVE[e.type], this._onMove, this)\n\t\t    .on(document, L.Draggable.END[e.type], this._onUp, this);\n\t},\n\n\t_onMove: function (e) {\n\t\tif (e.touches && e.touches.length > 1) {\n\t\t\tthis._moved = true;\n\t\t\treturn;\n\t\t}\n\n\t\tvar first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),\n\t\t    newPoint = new L.Point(first.clientX, first.clientY),\n\t\t    offset = newPoint.subtract(this._startPoint);\n\n\t\tif (!offset.x && !offset.y) { return; }\n\t\tif (L.Browser.touch && Math.abs(offset.x) + Math.abs(offset.y) < 3) { return; }\n\n\t\tL.DomEvent.preventDefault(e);\n\n\t\tif (!this._moved) {\n\t\t\tthis.fire('dragstart');\n\n\t\t\tthis._moved = true;\n\t\t\tthis._startPos = L.DomUtil.getPosition(this._element).subtract(offset);\n\n\t\t\tL.DomUtil.addClass(document.body, 'leaflet-dragging');\n\t\t\tthis._lastTarget = e.target || e.srcElement;\n\t\t\tL.DomUtil.addClass(this._lastTarget, 'leaflet-drag-target');\n\t\t}\n\n\t\tthis._newPos = this._startPos.add(offset);\n\t\tthis._moving = true;\n\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\t\tthis._animRequest = L.Util.requestAnimFrame(this._updatePosition, this, true, this._dragStartTarget);\n\t},\n\n\t_updatePosition: function () {\n\t\tthis.fire('predrag');\n\t\tL.DomUtil.setPosition(this._element, this._newPos);\n\t\tthis.fire('drag');\n\t},\n\n\t_onUp: function () {\n\t\tL.DomUtil.removeClass(document.body, 'leaflet-dragging');\n\n\t\tif (this._lastTarget) {\n\t\t\tL.DomUtil.removeClass(this._lastTarget, 'leaflet-drag-target');\n\t\t\tthis._lastTarget = null;\n\t\t}\n\n\t\tfor (var i in L.Draggable.MOVE) {\n\t\t\tL.DomEvent\n\t\t\t    .off(document, L.Draggable.MOVE[i], this._onMove)\n\t\t\t    .off(document, L.Draggable.END[i], this._onUp);\n\t\t}\n\n\t\tL.DomUtil.enableImageDrag();\n\t\tL.DomUtil.enableTextSelection();\n\n\t\tif (this._moved && this._moving) {\n\t\t\t// ensure drag is not fired after dragend\n\t\t\tL.Util.cancelAnimFrame(this._animRequest);\n\n\t\t\tthis.fire('dragend', {\n\t\t\t\tdistance: this._newPos.distanceTo(this._startPos)\n\t\t\t});\n\t\t}\n\n\t\tthis._moving = false;\n\t}\n});\n\n\n/*\n\tL.Handler is a base class for handler classes that are used internally to inject\n\tinteraction features like dragging to classes like Map and Marker.\n*/\n\nL.Handler = L.Class.extend({\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled) { return; }\n\n\t\tthis._enabled = true;\n\t\tthis.addHooks();\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tthis._enabled = false;\n\t\tthis.removeHooks();\n\t},\n\n\tenabled: function () {\n\t\treturn !!this._enabled;\n\t}\n});\n\n\n/*\n * L.Handler.MapDrag is used to make the map draggable (with panning inertia), enabled by default.\n */\n\nL.Map.mergeOptions({\n\tdragging: true,\n\n\tinertia: !L.Browser.android23,\n\tinertiaDeceleration: 3400, // px/s^2\n\tinertiaMaxSpeed: Infinity, // px/s\n\tinertiaThreshold: L.Browser.touch ? 32 : 18, // ms\n\teaseLinearity: 0.25,\n\n\t// TODO refactor, move to CRS\n\tworldCopyJump: false\n});\n\nL.Map.Drag = L.Handler.extend({\n\taddHooks: function () {\n\t\tif (!this._draggable) {\n\t\t\tvar map = this._map;\n\n\t\t\tthis._draggable = new L.Draggable(map._mapPane, map._container);\n\n\t\t\tthis._draggable.on({\n\t\t\t\t'dragstart': this._onDragStart,\n\t\t\t\t'drag': this._onDrag,\n\t\t\t\t'dragend': this._onDragEnd\n\t\t\t}, this);\n\n\t\t\tif (map.options.worldCopyJump) {\n\t\t\t\tthis._draggable.on('predrag', this._onPreDrag, this);\n\t\t\t\tmap.on('viewreset', this._onViewReset, this);\n\n\t\t\t\tmap.whenReady(this._onViewReset, this);\n\t\t\t}\n\t\t}\n\t\tthis._draggable.enable();\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._draggable.disable();\n\t},\n\n\tmoved: function () {\n\t\treturn this._draggable && this._draggable._moved;\n\t},\n\n\t_onDragStart: function () {\n\t\tvar map = this._map;\n\n\t\tif (map._panAnim) {\n\t\t\tmap._panAnim.stop();\n\t\t}\n\n\t\tmap\n\t\t    .fire('movestart')\n\t\t    .fire('dragstart');\n\n\t\tif (map.options.inertia) {\n\t\t\tthis._positions = [];\n\t\t\tthis._times = [];\n\t\t}\n\t},\n\n\t_onDrag: function () {\n\t\tif (this._map.options.inertia) {\n\t\t\tvar time = this._lastTime = +new Date(),\n\t\t\t    pos = this._lastPos = this._draggable._newPos;\n\n\t\t\tthis._positions.push(pos);\n\t\t\tthis._times.push(time);\n\n\t\t\tif (time - this._times[0] > 200) {\n\t\t\t\tthis._positions.shift();\n\t\t\t\tthis._times.shift();\n\t\t\t}\n\t\t}\n\n\t\tthis._map\n\t\t    .fire('move')\n\t\t    .fire('drag');\n\t},\n\n\t_onViewReset: function () {\n\t\t// TODO fix hardcoded Earth values\n\t\tvar pxCenter = this._map.getSize()._divideBy(2),\n\t\t    pxWorldCenter = this._map.latLngToLayerPoint([0, 0]);\n\n\t\tthis._initialWorldOffset = pxWorldCenter.subtract(pxCenter).x;\n\t\tthis._worldWidth = this._map.project([0, 180]).x;\n\t},\n\n\t_onPreDrag: function () {\n\t\t// TODO refactor to be able to adjust map pane position after zoom\n\t\tvar worldWidth = this._worldWidth,\n\t\t    halfWidth = Math.round(worldWidth / 2),\n\t\t    dx = this._initialWorldOffset,\n\t\t    x = this._draggable._newPos.x,\n\t\t    newX1 = (x - halfWidth + dx) % worldWidth + halfWidth - dx,\n\t\t    newX2 = (x + halfWidth + dx) % worldWidth - halfWidth - dx,\n\t\t    newX = Math.abs(newX1 + dx) < Math.abs(newX2 + dx) ? newX1 : newX2;\n\n\t\tthis._draggable._newPos.x = newX;\n\t},\n\n\t_onDragEnd: function (e) {\n\t\tvar map = this._map,\n\t\t    options = map.options,\n\t\t    delay = +new Date() - this._lastTime,\n\n\t\t    noInertia = !options.inertia || delay > options.inertiaThreshold || !this._positions[0];\n\n\t\tmap.fire('dragend', e);\n\n\t\tif (noInertia) {\n\t\t\tmap.fire('moveend');\n\n\t\t} else {\n\n\t\t\tvar direction = this._lastPos.subtract(this._positions[0]),\n\t\t\t    duration = (this._lastTime + delay - this._times[0]) / 1000,\n\t\t\t    ease = options.easeLinearity,\n\n\t\t\t    speedVector = direction.multiplyBy(ease / duration),\n\t\t\t    speed = speedVector.distanceTo([0, 0]),\n\n\t\t\t    limitedSpeed = Math.min(options.inertiaMaxSpeed, speed),\n\t\t\t    limitedSpeedVector = speedVector.multiplyBy(limitedSpeed / speed),\n\n\t\t\t    decelerationDuration = limitedSpeed / (options.inertiaDeceleration * ease),\n\t\t\t    offset = limitedSpeedVector.multiplyBy(-decelerationDuration / 2).round();\n\n\t\t\tif (!offset.x || !offset.y) {\n\t\t\t\tmap.fire('moveend');\n\n\t\t\t} else {\n\t\t\t\toffset = map._limitOffset(offset, map.options.maxBounds);\n\n\t\t\t\tL.Util.requestAnimFrame(function () {\n\t\t\t\t\tmap.panBy(offset, {\n\t\t\t\t\t\tduration: decelerationDuration,\n\t\t\t\t\t\teaseLinearity: ease,\n\t\t\t\t\t\tnoMoveStart: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'dragging', L.Map.Drag);\n\n\n/*\n * L.Handler.DoubleClickZoom is used to handle double-click zoom on the map, enabled by default.\n */\n\nL.Map.mergeOptions({\n\tdoubleClickZoom: true\n});\n\nL.Map.DoubleClickZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tthis._map.on('dblclick', this._onDoubleClick, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._map.off('dblclick', this._onDoubleClick, this);\n\t},\n\n\t_onDoubleClick: function (e) {\n\t\tvar map = this._map,\n\t\t    zoom = map.getZoom() + (e.originalEvent.shiftKey ? -1 : 1);\n\n\t\tif (map.options.doubleClickZoom === 'center') {\n\t\t\tmap.setZoom(zoom);\n\t\t} else {\n\t\t\tmap.setZoomAround(e.containerPoint, zoom);\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'doubleClickZoom', L.Map.DoubleClickZoom);\n\n\n/*\n * L.Handler.ScrollWheelZoom is used by L.Map to enable mouse scroll wheel zoom on the map.\n */\n\nL.Map.mergeOptions({\n\tscrollWheelZoom: true\n});\n\nL.Map.ScrollWheelZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'mousewheel', this._onWheelScroll, this);\n\t\tL.DomEvent.on(this._map._container, 'MozMousePixelScroll', L.DomEvent.preventDefault);\n\t\tthis._delta = 0;\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'mousewheel', this._onWheelScroll);\n\t\tL.DomEvent.off(this._map._container, 'MozMousePixelScroll', L.DomEvent.preventDefault);\n\t},\n\n\t_onWheelScroll: function (e) {\n\t\tvar delta = L.DomEvent.getWheelDelta(e);\n\n\t\tthis._delta += delta;\n\t\tthis._lastMousePos = this._map.mouseEventToContainerPoint(e);\n\n\t\tif (!this._startTime) {\n\t\t\tthis._startTime = +new Date();\n\t\t}\n\n\t\tvar left = Math.max(40 - (+new Date() - this._startTime), 0);\n\n\t\tclearTimeout(this._timer);\n\t\tthis._timer = setTimeout(L.bind(this._performZoom, this), left);\n\n\t\tL.DomEvent.preventDefault(e);\n\t\tL.DomEvent.stopPropagation(e);\n\t},\n\n\t_performZoom: function () {\n\t\tvar map = this._map,\n\t\t    delta = this._delta,\n\t\t    zoom = map.getZoom();\n\n\t\tdelta = delta > 0 ? Math.ceil(delta) : Math.floor(delta);\n\t\tdelta = Math.max(Math.min(delta, 4), -4);\n\t\tdelta = map._limitZoom(zoom + delta) - zoom;\n\n\t\tthis._delta = 0;\n\t\tthis._startTime = null;\n\n\t\tif (!delta) { return; }\n\n\t\tif (map.options.scrollWheelZoom === 'center') {\n\t\t\tmap.setZoom(zoom + delta);\n\t\t} else {\n\t\t\tmap.setZoomAround(this._lastMousePos, zoom + delta);\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'scrollWheelZoom', L.Map.ScrollWheelZoom);\n\n\n/*\n * Extends the event handling code with double tap support for mobile browsers.\n */\n\nL.extend(L.DomEvent, {\n\n\t_touchstart: L.Browser.msPointer ? 'MSPointerDown' : L.Browser.pointer ? 'pointerdown' : 'touchstart',\n\t_touchend: L.Browser.msPointer ? 'MSPointerUp' : L.Browser.pointer ? 'pointerup' : 'touchend',\n\n\t// inspired by Zepto touch code by Thomas Fuchs\n\taddDoubleTapListener: function (obj, handler, id) {\n\t\tvar last,\n\t\t    doubleTap = false,\n\t\t    delay = 250,\n\t\t    touch,\n\t\t    pre = '_leaflet_',\n\t\t    touchstart = this._touchstart,\n\t\t    touchend = this._touchend,\n\t\t    trackedTouches = [];\n\n\t\tfunction onTouchStart(e) {\n\t\t\tvar count;\n\n\t\t\tif (L.Browser.pointer) {\n\t\t\t\ttrackedTouches.push(e.pointerId);\n\t\t\t\tcount = trackedTouches.length;\n\t\t\t} else {\n\t\t\t\tcount = e.touches.length;\n\t\t\t}\n\t\t\tif (count > 1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar now = Date.now(),\n\t\t\t\tdelta = now - (last || now);\n\n\t\t\ttouch = e.touches ? e.touches[0] : e;\n\t\t\tdoubleTap = (delta > 0 && delta <= delay);\n\t\t\tlast = now;\n\t\t}\n\n\t\tfunction onTouchEnd(e) {\n\t\t\tif (L.Browser.pointer) {\n\t\t\t\tvar idx = trackedTouches.indexOf(e.pointerId);\n\t\t\t\tif (idx === -1) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttrackedTouches.splice(idx, 1);\n\t\t\t}\n\n\t\t\tif (doubleTap) {\n\t\t\t\tif (L.Browser.pointer) {\n\t\t\t\t\t// work around .type being readonly with MSPointer* events\n\t\t\t\t\tvar newTouch = { },\n\t\t\t\t\t\tprop;\n\n\t\t\t\t\t// jshint forin:false\n\t\t\t\t\tfor (var i in touch) {\n\t\t\t\t\t\tprop = touch[i];\n\t\t\t\t\t\tif (typeof prop === 'function') {\n\t\t\t\t\t\t\tnewTouch[i] = prop.bind(touch);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnewTouch[i] = prop;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttouch = newTouch;\n\t\t\t\t}\n\t\t\t\ttouch.type = 'dblclick';\n\t\t\t\thandler(touch);\n\t\t\t\tlast = null;\n\t\t\t}\n\t\t}\n\t\tobj[pre + touchstart + id] = onTouchStart;\n\t\tobj[pre + touchend + id] = onTouchEnd;\n\n\t\t// on pointer we need to listen on the document, otherwise a drag starting on the map and moving off screen\n\t\t// will not come through to us, so we will lose track of how many touches are ongoing\n\t\tvar endElement = L.Browser.pointer ? document.documentElement : obj;\n\n\t\tobj.addEventListener(touchstart, onTouchStart, false);\n\t\tendElement.addEventListener(touchend, onTouchEnd, false);\n\n\t\tif (L.Browser.pointer) {\n\t\t\tendElement.addEventListener(L.DomEvent.POINTER_CANCEL, onTouchEnd, false);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveDoubleTapListener: function (obj, id) {\n\t\tvar pre = '_leaflet_';\n\n\t\tobj.removeEventListener(this._touchstart, obj[pre + this._touchstart + id], false);\n\t\t(L.Browser.pointer ? document.documentElement : obj).removeEventListener(\n\t\t        this._touchend, obj[pre + this._touchend + id], false);\n\n\t\tif (L.Browser.pointer) {\n\t\t\tdocument.documentElement.removeEventListener(L.DomEvent.POINTER_CANCEL, obj[pre + this._touchend + id],\n\t\t\t\tfalse);\n\t\t}\n\n\t\treturn this;\n\t}\n});\n\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\nL.extend(L.DomEvent, {\n\n\t//static\n\tPOINTER_DOWN: L.Browser.msPointer ? 'MSPointerDown' : 'pointerdown',\n\tPOINTER_MOVE: L.Browser.msPointer ? 'MSPointerMove' : 'pointermove',\n\tPOINTER_UP: L.Browser.msPointer ? 'MSPointerUp' : 'pointerup',\n\tPOINTER_CANCEL: L.Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n\n\t_pointers: [],\n\t_pointerDocumentListener: false,\n\n\t// Provides a touch events wrapper for (ms)pointer events.\n\t// Based on changes by veproza https://github.com/CloudMade/Leaflet/pull/1019\n\t//ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\n\taddPointerListener: function (obj, type, handler, id) {\n\n\t\tswitch (type) {\n\t\tcase 'touchstart':\n\t\t\treturn this.addPointerListenerStart(obj, type, handler, id);\n\t\tcase 'touchend':\n\t\t\treturn this.addPointerListenerEnd(obj, type, handler, id);\n\t\tcase 'touchmove':\n\t\t\treturn this.addPointerListenerMove(obj, type, handler, id);\n\t\tdefault:\n\t\t\tthrow 'Unknown touch event type';\n\t\t}\n\t},\n\n\taddPointerListenerStart: function (obj, type, handler, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    pointers = this._pointers;\n\n\t\tvar cb = function (e) {\n\n\t\t\tL.DomEvent.preventDefault(e);\n\n\t\t\tvar alreadyInArray = false;\n\t\t\tfor (var i = 0; i < pointers.length; i++) {\n\t\t\t\tif (pointers[i].pointerId === e.pointerId) {\n\t\t\t\t\talreadyInArray = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!alreadyInArray) {\n\t\t\t\tpointers.push(e);\n\t\t\t}\n\n\t\t\te.touches = pointers.slice();\n\t\t\te.changedTouches = [e];\n\n\t\t\thandler(e);\n\t\t};\n\n\t\tobj[pre + 'touchstart' + id] = cb;\n\t\tobj.addEventListener(this.POINTER_DOWN, cb, false);\n\n\t\t// need to also listen for end events to keep the _pointers list accurate\n\t\t// this needs to be on the body and never go away\n\t\tif (!this._pointerDocumentListener) {\n\t\t\tvar internalCb = function (e) {\n\t\t\t\tfor (var i = 0; i < pointers.length; i++) {\n\t\t\t\t\tif (pointers[i].pointerId === e.pointerId) {\n\t\t\t\t\t\tpointers.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\t//We listen on the documentElement as any drags that end by moving the touch off the screen get fired there\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_UP, internalCb, false);\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_CANCEL, internalCb, false);\n\n\t\t\tthis._pointerDocumentListener = true;\n\t\t}\n\n\t\treturn this;\n\t},\n\n\taddPointerListenerMove: function (obj, type, handler, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    touches = this._pointers;\n\n\t\tfunction cb(e) {\n\n\t\t\t// don't fire touch moves when mouse isn't down\n\t\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t\tfor (var i = 0; i < touches.length; i++) {\n\t\t\t\tif (touches[i].pointerId === e.pointerId) {\n\t\t\t\t\ttouches[i] = e;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\te.touches = touches.slice();\n\t\t\te.changedTouches = [e];\n\n\t\t\thandler(e);\n\t\t}\n\n\t\tobj[pre + 'touchmove' + id] = cb;\n\t\tobj.addEventListener(this.POINTER_MOVE, cb, false);\n\n\t\treturn this;\n\t},\n\n\taddPointerListenerEnd: function (obj, type, handler, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    touches = this._pointers;\n\n\t\tvar cb = function (e) {\n\t\t\tfor (var i = 0; i < touches.length; i++) {\n\t\t\t\tif (touches[i].pointerId === e.pointerId) {\n\t\t\t\t\ttouches.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\te.touches = touches.slice();\n\t\t\te.changedTouches = [e];\n\n\t\t\thandler(e);\n\t\t};\n\n\t\tobj[pre + 'touchend' + id] = cb;\n\t\tobj.addEventListener(this.POINTER_UP, cb, false);\n\t\tobj.addEventListener(this.POINTER_CANCEL, cb, false);\n\n\t\treturn this;\n\t},\n\n\tremovePointerListener: function (obj, type, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    cb = obj[pre + type + id];\n\n\t\tswitch (type) {\n\t\tcase 'touchstart':\n\t\t\tobj.removeEventListener(this.POINTER_DOWN, cb, false);\n\t\t\tbreak;\n\t\tcase 'touchmove':\n\t\t\tobj.removeEventListener(this.POINTER_MOVE, cb, false);\n\t\t\tbreak;\n\t\tcase 'touchend':\n\t\t\tobj.removeEventListener(this.POINTER_UP, cb, false);\n\t\t\tobj.removeEventListener(this.POINTER_CANCEL, cb, false);\n\t\t\tbreak;\n\t\t}\n\n\t\treturn this;\n\t}\n});\n\n\n/*\n * L.Handler.TouchZoom is used by L.Map to add pinch zoom on supported mobile browsers.\n */\n\nL.Map.mergeOptions({\n\ttouchZoom: L.Browser.touch && !L.Browser.android23,\n\tbounceAtZoomLimits: true\n});\n\nL.Map.TouchZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'touchstart', this._onTouchStart, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'touchstart', this._onTouchStart, this);\n\t},\n\n\t_onTouchStart: function (e) {\n\t\tvar map = this._map;\n\n\t\tif (!e.touches || e.touches.length !== 2 || map._animatingZoom || this._zooming) { return; }\n\n\t\tvar p1 = map.mouseEventToLayerPoint(e.touches[0]),\n\t\t    p2 = map.mouseEventToLayerPoint(e.touches[1]),\n\t\t    viewCenter = map._getCenterLayerPoint();\n\n\t\tthis._startCenter = p1.add(p2)._divideBy(2);\n\t\tthis._startDist = p1.distanceTo(p2);\n\n\t\tthis._moved = false;\n\t\tthis._zooming = true;\n\n\t\tthis._centerOffset = viewCenter.subtract(this._startCenter);\n\n\t\tif (map._panAnim) {\n\t\t\tmap._panAnim.stop();\n\t\t}\n\n\t\tL.DomEvent\n\t\t    .on(document, 'touchmove', this._onTouchMove, this)\n\t\t    .on(document, 'touchend', this._onTouchEnd, this);\n\n\t\tL.DomEvent.preventDefault(e);\n\t},\n\n\t_onTouchMove: function (e) {\n\t\tvar map = this._map;\n\n\t\tif (!e.touches || e.touches.length !== 2 || !this._zooming) { return; }\n\n\t\tvar p1 = map.mouseEventToLayerPoint(e.touches[0]),\n\t\t    p2 = map.mouseEventToLayerPoint(e.touches[1]);\n\n\t\tthis._scale = p1.distanceTo(p2) / this._startDist;\n\t\tthis._delta = p1._add(p2)._divideBy(2)._subtract(this._startCenter);\n\n\t\tif (this._scale === 1) { return; }\n\n\t\tif (!map.options.bounceAtZoomLimits) {\n\t\t\tif ((map.getZoom() === map.getMinZoom() && this._scale < 1) ||\n\t\t\t    (map.getZoom() === map.getMaxZoom() && this._scale > 1)) { return; }\n\t\t}\n\n\t\tif (!this._moved) {\n\t\t\tL.DomUtil.addClass(map._mapPane, 'leaflet-touching');\n\n\t\t\tmap\n\t\t\t    .fire('movestart')\n\t\t\t    .fire('zoomstart');\n\n\t\t\tthis._moved = true;\n\t\t}\n\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\t\tthis._animRequest = L.Util.requestAnimFrame(\n\t\t        this._updateOnMove, this, true, this._map._container);\n\n\t\tL.DomEvent.preventDefault(e);\n\t},\n\n\t_updateOnMove: function () {\n\t\tvar map = this._map,\n\t\t    origin = this._getScaleOrigin(),\n\t\t    center = map.layerPointToLatLng(origin),\n\t\t    zoom = map.getScaleZoom(this._scale);\n\n\t\tmap._animateZoom(center, zoom, this._startCenter, this._scale, this._delta, false, true);\n\t},\n\n\t_onTouchEnd: function () {\n\t\tif (!this._moved || !this._zooming) {\n\t\t\tthis._zooming = false;\n\t\t\treturn;\n\t\t}\n\n\t\tvar map = this._map;\n\n\t\tthis._zooming = false;\n\t\tL.DomUtil.removeClass(map._mapPane, 'leaflet-touching');\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\n\t\tL.DomEvent\n\t\t    .off(document, 'touchmove', this._onTouchMove)\n\t\t    .off(document, 'touchend', this._onTouchEnd);\n\n\t\tvar origin = this._getScaleOrigin(),\n\t\t    center = map.layerPointToLatLng(origin),\n\n\t\t    oldZoom = map.getZoom(),\n\t\t    floatZoomDelta = map.getScaleZoom(this._scale) - oldZoom,\n\t\t    roundZoomDelta = (floatZoomDelta > 0 ?\n\t\t            Math.ceil(floatZoomDelta) : Math.floor(floatZoomDelta)),\n\n\t\t    zoom = map._limitZoom(oldZoom + roundZoomDelta),\n\t\t    scale = map.getZoomScale(zoom) / this._scale;\n\n\t\tmap._animateZoom(center, zoom, origin, scale);\n\t},\n\n\t_getScaleOrigin: function () {\n\t\tvar centerOffset = this._centerOffset.subtract(this._delta).divideBy(this._scale);\n\t\treturn this._startCenter.add(centerOffset);\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'touchZoom', L.Map.TouchZoom);\n\n\n/*\n * L.Map.Tap is used to enable mobile hacks like quick taps and long hold.\n */\n\nL.Map.mergeOptions({\n\ttap: true,\n\ttapTolerance: 15\n});\n\nL.Map.Tap = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'touchstart', this._onDown, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'touchstart', this._onDown, this);\n\t},\n\n\t_onDown: function (e) {\n\t\tif (!e.touches) { return; }\n\n\t\tL.DomEvent.preventDefault(e);\n\n\t\tthis._fireClick = true;\n\n\t\t// don't simulate click or track longpress if more than 1 touch\n\t\tif (e.touches.length > 1) {\n\t\t\tthis._fireClick = false;\n\t\t\tclearTimeout(this._holdTimeout);\n\t\t\treturn;\n\t\t}\n\n\t\tvar first = e.touches[0],\n\t\t    el = first.target;\n\n\t\tthis._startPos = this._newPos = new L.Point(first.clientX, first.clientY);\n\n\t\t// if touching a link, highlight it\n\t\tif (el.tagName && el.tagName.toLowerCase() === 'a') {\n\t\t\tL.DomUtil.addClass(el, 'leaflet-active');\n\t\t}\n\n\t\t// simulate long hold but setting a timeout\n\t\tthis._holdTimeout = setTimeout(L.bind(function () {\n\t\t\tif (this._isTapValid()) {\n\t\t\t\tthis._fireClick = false;\n\t\t\t\tthis._onUp();\n\t\t\t\tthis._simulateEvent('contextmenu', first);\n\t\t\t}\n\t\t}, this), 1000);\n\n\t\tL.DomEvent\n\t\t\t.on(document, 'touchmove', this._onMove, this)\n\t\t\t.on(document, 'touchend', this._onUp, this);\n\t},\n\n\t_onUp: function (e) {\n\t\tclearTimeout(this._holdTimeout);\n\n\t\tL.DomEvent\n\t\t\t.off(document, 'touchmove', this._onMove, this)\n\t\t\t.off(document, 'touchend', this._onUp, this);\n\n\t\tif (this._fireClick && e && e.changedTouches) {\n\n\t\t\tvar first = e.changedTouches[0],\n\t\t\t    el = first.target;\n\n\t\t\tif (el && el.tagName && el.tagName.toLowerCase() === 'a') {\n\t\t\t\tL.DomUtil.removeClass(el, 'leaflet-active');\n\t\t\t}\n\n\t\t\t// simulate click if the touch didn't move too much\n\t\t\tif (this._isTapValid()) {\n\t\t\t\tthis._simulateEvent('click', first);\n\t\t\t}\n\t\t}\n\t},\n\n\t_isTapValid: function () {\n\t\treturn this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance;\n\t},\n\n\t_onMove: function (e) {\n\t\tvar first = e.touches[0];\n\t\tthis._newPos = new L.Point(first.clientX, first.clientY);\n\t},\n\n\t_simulateEvent: function (type, e) {\n\t\tvar simulatedEvent = document.createEvent('MouseEvents');\n\n\t\tsimulatedEvent._simulated = true;\n\t\te.target._simulatedClick = true;\n\n\t\tsimulatedEvent.initMouseEvent(\n\t\t        type, true, true, window, 1,\n\t\t        e.screenX, e.screenY,\n\t\t        e.clientX, e.clientY,\n\t\t        false, false, false, false, 0, null);\n\n\t\te.target.dispatchEvent(simulatedEvent);\n\t}\n});\n\nif (L.Browser.touch && !L.Browser.pointer) {\n\tL.Map.addInitHook('addHandler', 'tap', L.Map.Tap);\n}\n\n\n/*\n * L.Handler.ShiftDragZoom is used to add shift-drag zoom interaction to the map\n  * (zoom to a selected bounding box), enabled by default.\n */\n\nL.Map.mergeOptions({\n\tboxZoom: true\n});\n\nL.Map.BoxZoom = L.Handler.extend({\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t\tthis._container = map._container;\n\t\tthis._pane = map._panes.overlayPane;\n\t\tthis._moved = false;\n\t},\n\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._container, 'mousedown', this._onMouseDown, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._container, 'mousedown', this._onMouseDown);\n\t\tthis._moved = false;\n\t},\n\n\tmoved: function () {\n\t\treturn this._moved;\n\t},\n\n\t_onMouseDown: function (e) {\n\t\tthis._moved = false;\n\n\t\tif (!e.shiftKey || ((e.which !== 1) && (e.button !== 1))) { return false; }\n\n\t\tL.DomUtil.disableTextSelection();\n\t\tL.DomUtil.disableImageDrag();\n\n\t\tthis._startLayerPoint = this._map.mouseEventToLayerPoint(e);\n\n\t\tL.DomEvent\n\t\t    .on(document, 'mousemove', this._onMouseMove, this)\n\t\t    .on(document, 'mouseup', this._onMouseUp, this)\n\t\t    .on(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tif (!this._moved) {\n\t\t\tthis._box = L.DomUtil.create('div', 'leaflet-zoom-box', this._pane);\n\t\t\tL.DomUtil.setPosition(this._box, this._startLayerPoint);\n\n\t\t\t//TODO refactor: move cursor to styles\n\t\t\tthis._container.style.cursor = 'crosshair';\n\t\t\tthis._map.fire('boxzoomstart');\n\t\t}\n\n\t\tvar startPoint = this._startLayerPoint,\n\t\t    box = this._box,\n\n\t\t    layerPoint = this._map.mouseEventToLayerPoint(e),\n\t\t    offset = layerPoint.subtract(startPoint),\n\n\t\t    newPos = new L.Point(\n\t\t        Math.min(layerPoint.x, startPoint.x),\n\t\t        Math.min(layerPoint.y, startPoint.y));\n\n\t\tL.DomUtil.setPosition(box, newPos);\n\n\t\tthis._moved = true;\n\n\t\t// TODO refactor: remove hardcoded 4 pixels\n\t\tbox.style.width  = (Math.max(0, Math.abs(offset.x) - 4)) + 'px';\n\t\tbox.style.height = (Math.max(0, Math.abs(offset.y) - 4)) + 'px';\n\t},\n\n\t_finish: function () {\n\t\tif (this._moved) {\n\t\t\tthis._pane.removeChild(this._box);\n\t\t\tthis._container.style.cursor = '';\n\t\t}\n\n\t\tL.DomUtil.enableTextSelection();\n\t\tL.DomUtil.enableImageDrag();\n\n\t\tL.DomEvent\n\t\t    .off(document, 'mousemove', this._onMouseMove)\n\t\t    .off(document, 'mouseup', this._onMouseUp)\n\t\t    .off(document, 'keydown', this._onKeyDown);\n\t},\n\n\t_onMouseUp: function (e) {\n\n\t\tthis._finish();\n\n\t\tvar map = this._map,\n\t\t    layerPoint = map.mouseEventToLayerPoint(e);\n\n\t\tif (this._startLayerPoint.equals(layerPoint)) { return; }\n\n\t\tvar bounds = new L.LatLngBounds(\n\t\t        map.layerPointToLatLng(this._startLayerPoint),\n\t\t        map.layerPointToLatLng(layerPoint));\n\n\t\tmap.fitBounds(bounds);\n\n\t\tmap.fire('boxzoomend', {\n\t\t\tboxZoomBounds: bounds\n\t\t});\n\t},\n\n\t_onKeyDown: function (e) {\n\t\tif (e.keyCode === 27) {\n\t\t\tthis._finish();\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'boxZoom', L.Map.BoxZoom);\n\n\n/*\n * L.Map.Keyboard is handling keyboard interaction with the map, enabled by default.\n */\n\nL.Map.mergeOptions({\n\tkeyboard: true,\n\tkeyboardPanOffset: 80,\n\tkeyboardZoomOffset: 1\n});\n\nL.Map.Keyboard = L.Handler.extend({\n\n\tkeyCodes: {\n\t\tleft:    [37],\n\t\tright:   [39],\n\t\tdown:    [40],\n\t\tup:      [38],\n\t\tzoomIn:  [187, 107, 61, 171],\n\t\tzoomOut: [189, 109, 173]\n\t},\n\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\n\t\tthis._setPanOffset(map.options.keyboardPanOffset);\n\t\tthis._setZoomOffset(map.options.keyboardZoomOffset);\n\t},\n\n\taddHooks: function () {\n\t\tvar container = this._map._container;\n\n\t\t// make the container focusable by tabbing\n\t\tif (container.tabIndex === -1) {\n\t\t\tcontainer.tabIndex = '0';\n\t\t}\n\n\t\tL.DomEvent\n\t\t    .on(container, 'focus', this._onFocus, this)\n\t\t    .on(container, 'blur', this._onBlur, this)\n\t\t    .on(container, 'mousedown', this._onMouseDown, this);\n\n\t\tthis._map\n\t\t    .on('focus', this._addHooks, this)\n\t\t    .on('blur', this._removeHooks, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._removeHooks();\n\n\t\tvar container = this._map._container;\n\n\t\tL.DomEvent\n\t\t    .off(container, 'focus', this._onFocus, this)\n\t\t    .off(container, 'blur', this._onBlur, this)\n\t\t    .off(container, 'mousedown', this._onMouseDown, this);\n\n\t\tthis._map\n\t\t    .off('focus', this._addHooks, this)\n\t\t    .off('blur', this._removeHooks, this);\n\t},\n\n\t_onMouseDown: function () {\n\t\tif (this._focused) { return; }\n\n\t\tvar body = document.body,\n\t\t    docEl = document.documentElement,\n\t\t    top = body.scrollTop || docEl.scrollTop,\n\t\t    left = body.scrollLeft || docEl.scrollLeft;\n\n\t\tthis._map._container.focus();\n\n\t\twindow.scrollTo(left, top);\n\t},\n\n\t_onFocus: function () {\n\t\tthis._focused = true;\n\t\tthis._map.fire('focus');\n\t},\n\n\t_onBlur: function () {\n\t\tthis._focused = false;\n\t\tthis._map.fire('blur');\n\t},\n\n\t_setPanOffset: function (pan) {\n\t\tvar keys = this._panKeys = {},\n\t\t    codes = this.keyCodes,\n\t\t    i, len;\n\n\t\tfor (i = 0, len = codes.left.length; i < len; i++) {\n\t\t\tkeys[codes.left[i]] = [-1 * pan, 0];\n\t\t}\n\t\tfor (i = 0, len = codes.right.length; i < len; i++) {\n\t\t\tkeys[codes.right[i]] = [pan, 0];\n\t\t}\n\t\tfor (i = 0, len = codes.down.length; i < len; i++) {\n\t\t\tkeys[codes.down[i]] = [0, pan];\n\t\t}\n\t\tfor (i = 0, len = codes.up.length; i < len; i++) {\n\t\t\tkeys[codes.up[i]] = [0, -1 * pan];\n\t\t}\n\t},\n\n\t_setZoomOffset: function (zoom) {\n\t\tvar keys = this._zoomKeys = {},\n\t\t    codes = this.keyCodes,\n\t\t    i, len;\n\n\t\tfor (i = 0, len = codes.zoomIn.length; i < len; i++) {\n\t\t\tkeys[codes.zoomIn[i]] = zoom;\n\t\t}\n\t\tfor (i = 0, len = codes.zoomOut.length; i < len; i++) {\n\t\t\tkeys[codes.zoomOut[i]] = -zoom;\n\t\t}\n\t},\n\n\t_addHooks: function () {\n\t\tL.DomEvent.on(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_removeHooks: function () {\n\t\tL.DomEvent.off(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_onKeyDown: function (e) {\n\t\tvar key = e.keyCode,\n\t\t    map = this._map;\n\n\t\tif (key in this._panKeys) {\n\n\t\t\tif (map._panAnim && map._panAnim._inProgress) { return; }\n\n\t\t\tmap.panBy(this._panKeys[key]);\n\n\t\t\tif (map.options.maxBounds) {\n\t\t\t\tmap.panInsideBounds(map.options.maxBounds);\n\t\t\t}\n\n\t\t} else if (key in this._zoomKeys) {\n\t\t\tmap.setZoom(map.getZoom() + this._zoomKeys[key]);\n\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tL.DomEvent.stop(e);\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'keyboard', L.Map.Keyboard);\n\n\n/*\n * L.Handler.MarkerDrag is used internally by L.Marker to make the markers draggable.\n */\n\nL.Handler.MarkerDrag = L.Handler.extend({\n\tinitialize: function (marker) {\n\t\tthis._marker = marker;\n\t},\n\n\taddHooks: function () {\n\t\tvar icon = this._marker._icon;\n\t\tif (!this._draggable) {\n\t\t\tthis._draggable = new L.Draggable(icon, icon);\n\t\t}\n\n\t\tthis._draggable\n\t\t\t.on('dragstart', this._onDragStart, this)\n\t\t\t.on('drag', this._onDrag, this)\n\t\t\t.on('dragend', this._onDragEnd, this);\n\t\tthis._draggable.enable();\n\t\tL.DomUtil.addClass(this._marker._icon, 'leaflet-marker-draggable');\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._draggable\n\t\t\t.off('dragstart', this._onDragStart, this)\n\t\t\t.off('drag', this._onDrag, this)\n\t\t\t.off('dragend', this._onDragEnd, this);\n\n\t\tthis._draggable.disable();\n\t\tL.DomUtil.removeClass(this._marker._icon, 'leaflet-marker-draggable');\n\t},\n\n\tmoved: function () {\n\t\treturn this._draggable && this._draggable._moved;\n\t},\n\n\t_onDragStart: function () {\n\t\tthis._marker\n\t\t    .closePopup()\n\t\t    .fire('movestart')\n\t\t    .fire('dragstart');\n\t},\n\n\t_onDrag: function () {\n\t\tvar marker = this._marker,\n\t\t    shadow = marker._shadow,\n\t\t    iconPos = L.DomUtil.getPosition(marker._icon),\n\t\t    latlng = marker._map.layerPointToLatLng(iconPos);\n\n\t\t// update shadow position\n\t\tif (shadow) {\n\t\t\tL.DomUtil.setPosition(shadow, iconPos);\n\t\t}\n\n\t\tmarker._latlng = latlng;\n\n\t\tmarker\n\t\t    .fire('move', {latlng: latlng})\n\t\t    .fire('drag');\n\t},\n\n\t_onDragEnd: function (e) {\n\t\tthis._marker\n\t\t    .fire('moveend')\n\t\t    .fire('dragend', e);\n\t}\n});\n\n\n/*\n * L.Control is a base class for implementing map controls. Handles positioning.\n * All other controls extend from this class.\n */\n\nL.Control = L.Class.extend({\n\toptions: {\n\t\tposition: 'topright'\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\tgetPosition: function () {\n\t\treturn this.options.position;\n\t},\n\n\tsetPosition: function (position) {\n\t\tvar map = this._map;\n\n\t\tif (map) {\n\t\t\tmap.removeControl(this);\n\t\t}\n\n\t\tthis.options.position = position;\n\n\t\tif (map) {\n\t\t\tmap.addControl(this);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\taddTo: function (map) {\n\t\tthis._map = map;\n\n\t\tvar container = this._container = this.onAdd(map),\n\t\t    pos = this.getPosition(),\n\t\t    corner = map._controlCorners[pos];\n\n\t\tL.DomUtil.addClass(container, 'leaflet-control');\n\n\t\tif (pos.indexOf('bottom') !== -1) {\n\t\t\tcorner.insertBefore(container, corner.firstChild);\n\t\t} else {\n\t\t\tcorner.appendChild(container);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveFrom: function (map) {\n\t\tvar pos = this.getPosition(),\n\t\t    corner = map._controlCorners[pos];\n\n\t\tcorner.removeChild(this._container);\n\t\tthis._map = null;\n\n\t\tif (this.onRemove) {\n\t\t\tthis.onRemove(map);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_refocusOnMap: function () {\n\t\tif (this._map) {\n\t\t\tthis._map.getContainer().focus();\n\t\t}\n\t}\n});\n\nL.control = function (options) {\n\treturn new L.Control(options);\n};\n\n\n// adds control-related methods to L.Map\n\nL.Map.include({\n\taddControl: function (control) {\n\t\tcontrol.addTo(this);\n\t\treturn this;\n\t},\n\n\tremoveControl: function (control) {\n\t\tcontrol.removeFrom(this);\n\t\treturn this;\n\t},\n\n\t_initControlPos: function () {\n\t\tvar corners = this._controlCorners = {},\n\t\t    l = 'leaflet-',\n\t\t    container = this._controlContainer =\n\t\t            L.DomUtil.create('div', l + 'control-container', this._container);\n\n\t\tfunction createCorner(vSide, hSide) {\n\t\t\tvar className = l + vSide + ' ' + l + hSide;\n\n\t\t\tcorners[vSide + hSide] = L.DomUtil.create('div', className, container);\n\t\t}\n\n\t\tcreateCorner('top', 'left');\n\t\tcreateCorner('top', 'right');\n\t\tcreateCorner('bottom', 'left');\n\t\tcreateCorner('bottom', 'right');\n\t},\n\n\t_clearControlPos: function () {\n\t\tthis._container.removeChild(this._controlContainer);\n\t}\n});\n\n\n/*\n * L.Control.Zoom is used for the default zoom buttons on the map.\n */\n\nL.Control.Zoom = L.Control.extend({\n\toptions: {\n\t\tposition: 'topleft',\n\t\tzoomInText: '+',\n\t\tzoomInTitle: 'Zoom in',\n\t\tzoomOutText: '-',\n\t\tzoomOutTitle: 'Zoom out'\n\t},\n\n\tonAdd: function (map) {\n\t\tvar zoomName = 'leaflet-control-zoom',\n\t\t    container = L.DomUtil.create('div', zoomName + ' leaflet-bar');\n\n\t\tthis._map = map;\n\n\t\tthis._zoomInButton  = this._createButton(\n\t\t        this.options.zoomInText, this.options.zoomInTitle,\n\t\t        zoomName + '-in',  container, this._zoomIn,  this);\n\t\tthis._zoomOutButton = this._createButton(\n\t\t        this.options.zoomOutText, this.options.zoomOutTitle,\n\t\t        zoomName + '-out', container, this._zoomOut, this);\n\n\t\tthis._updateDisabled();\n\t\tmap.on('zoomend zoomlevelschange', this._updateDisabled, this);\n\n\t\treturn container;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap.off('zoomend zoomlevelschange', this._updateDisabled, this);\n\t},\n\n\t_zoomIn: function (e) {\n\t\tthis._map.zoomIn(e.shiftKey ? 3 : 1);\n\t},\n\n\t_zoomOut: function (e) {\n\t\tthis._map.zoomOut(e.shiftKey ? 3 : 1);\n\t},\n\n\t_createButton: function (html, title, className, container, fn, context) {\n\t\tvar link = L.DomUtil.create('a', className, container);\n\t\tlink.innerHTML = html;\n\t\tlink.href = '#';\n\t\tlink.title = title;\n\n\t\tvar stop = L.DomEvent.stopPropagation;\n\n\t\tL.DomEvent\n\t\t    .on(link, 'click', stop)\n\t\t    .on(link, 'mousedown', stop)\n\t\t    .on(link, 'dblclick', stop)\n\t\t    .on(link, 'click', L.DomEvent.preventDefault)\n\t\t    .on(link, 'click', fn, context)\n\t\t    .on(link, 'click', this._refocusOnMap, context);\n\n\t\treturn link;\n\t},\n\n\t_updateDisabled: function () {\n\t\tvar map = this._map,\n\t\t\tclassName = 'leaflet-disabled';\n\n\t\tL.DomUtil.removeClass(this._zoomInButton, className);\n\t\tL.DomUtil.removeClass(this._zoomOutButton, className);\n\n\t\tif (map._zoom === map.getMinZoom()) {\n\t\t\tL.DomUtil.addClass(this._zoomOutButton, className);\n\t\t}\n\t\tif (map._zoom === map.getMaxZoom()) {\n\t\t\tL.DomUtil.addClass(this._zoomInButton, className);\n\t\t}\n\t}\n});\n\nL.Map.mergeOptions({\n\tzoomControl: true\n});\n\nL.Map.addInitHook(function () {\n\tif (this.options.zoomControl) {\n\t\tthis.zoomControl = new L.Control.Zoom();\n\t\tthis.addControl(this.zoomControl);\n\t}\n});\n\nL.control.zoom = function (options) {\n\treturn new L.Control.Zoom(options);\n};\n\n\n\n/*\n * L.Control.Attribution is used for displaying attribution on the map (added by default).\n */\n\nL.Control.Attribution = L.Control.extend({\n\toptions: {\n\t\tposition: 'bottomright',\n\t\tprefix: '<a href=\"http://leafletjs.com\" title=\"A JS library for interactive maps\">Leaflet</a>'\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._attributions = {};\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-control-attribution');\n\t\tL.DomEvent.disableClickPropagation(this._container);\n\n\t\tfor (var i in map._layers) {\n\t\t\tif (map._layers[i].getAttribution) {\n\t\t\t\tthis.addAttribution(map._layers[i].getAttribution());\n\t\t\t}\n\t\t}\n\t\t\n\t\tmap\n\t\t    .on('layeradd', this._onLayerAdd, this)\n\t\t    .on('layerremove', this._onLayerRemove, this);\n\n\t\tthis._update();\n\n\t\treturn this._container;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap\n\t\t    .off('layeradd', this._onLayerAdd)\n\t\t    .off('layerremove', this._onLayerRemove);\n\n\t},\n\n\tsetPrefix: function (prefix) {\n\t\tthis.options.prefix = prefix;\n\t\tthis._update();\n\t\treturn this;\n\t},\n\n\taddAttribution: function (text) {\n\t\tif (!text) { return; }\n\n\t\tif (!this._attributions[text]) {\n\t\t\tthis._attributions[text] = 0;\n\t\t}\n\t\tthis._attributions[text]++;\n\n\t\tthis._update();\n\n\t\treturn this;\n\t},\n\n\tremoveAttribution: function (text) {\n\t\tif (!text) { return; }\n\n\t\tif (this._attributions[text]) {\n\t\t\tthis._attributions[text]--;\n\t\t\tthis._update();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_update: function () {\n\t\tif (!this._map) { return; }\n\n\t\tvar attribs = [];\n\n\t\tfor (var i in this._attributions) {\n\t\t\tif (this._attributions[i]) {\n\t\t\t\tattribs.push(i);\n\t\t\t}\n\t\t}\n\n\t\tvar prefixAndAttribs = [];\n\n\t\tif (this.options.prefix) {\n\t\t\tprefixAndAttribs.push(this.options.prefix);\n\t\t}\n\t\tif (attribs.length) {\n\t\t\tprefixAndAttribs.push(attribs.join(', '));\n\t\t}\n\n\t\tthis._container.innerHTML = prefixAndAttribs.join(' | ');\n\t},\n\n\t_onLayerAdd: function (e) {\n\t\tif (e.layer.getAttribution) {\n\t\t\tthis.addAttribution(e.layer.getAttribution());\n\t\t}\n\t},\n\n\t_onLayerRemove: function (e) {\n\t\tif (e.layer.getAttribution) {\n\t\t\tthis.removeAttribution(e.layer.getAttribution());\n\t\t}\n\t}\n});\n\nL.Map.mergeOptions({\n\tattributionControl: true\n});\n\nL.Map.addInitHook(function () {\n\tif (this.options.attributionControl) {\n\t\tthis.attributionControl = (new L.Control.Attribution()).addTo(this);\n\t}\n});\n\nL.control.attribution = function (options) {\n\treturn new L.Control.Attribution(options);\n};\n\n\n/*\n * L.Control.Scale is used for displaying metric/imperial scale on the map.\n */\n\nL.Control.Scale = L.Control.extend({\n\toptions: {\n\t\tposition: 'bottomleft',\n\t\tmaxWidth: 100,\n\t\tmetric: true,\n\t\timperial: true,\n\t\tupdateWhenIdle: false\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\n\t\tvar className = 'leaflet-control-scale',\n\t\t    container = L.DomUtil.create('div', className),\n\t\t    options = this.options;\n\n\t\tthis._addScales(options, className, container);\n\n\t\tmap.on(options.updateWhenIdle ? 'moveend' : 'move', this._update, this);\n\t\tmap.whenReady(this._update, this);\n\n\t\treturn container;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap.off(this.options.updateWhenIdle ? 'moveend' : 'move', this._update, this);\n\t},\n\n\t_addScales: function (options, className, container) {\n\t\tif (options.metric) {\n\t\t\tthis._mScale = L.DomUtil.create('div', className + '-line', container);\n\t\t}\n\t\tif (options.imperial) {\n\t\t\tthis._iScale = L.DomUtil.create('div', className + '-line', container);\n\t\t}\n\t},\n\n\t_update: function () {\n\t\tvar bounds = this._map.getBounds(),\n\t\t    centerLat = bounds.getCenter().lat,\n\t\t    halfWorldMeters = 6378137 * Math.PI * Math.cos(centerLat * Math.PI / 180),\n\t\t    dist = halfWorldMeters * (bounds.getNorthEast().lng - bounds.getSouthWest().lng) / 180,\n\n\t\t    size = this._map.getSize(),\n\t\t    options = this.options,\n\t\t    maxMeters = 0;\n\n\t\tif (size.x > 0) {\n\t\t\tmaxMeters = dist * (options.maxWidth / size.x);\n\t\t}\n\n\t\tthis._updateScales(options, maxMeters);\n\t},\n\n\t_updateScales: function (options, maxMeters) {\n\t\tif (options.metric && maxMeters) {\n\t\t\tthis._updateMetric(maxMeters);\n\t\t}\n\n\t\tif (options.imperial && maxMeters) {\n\t\t\tthis._updateImperial(maxMeters);\n\t\t}\n\t},\n\n\t_updateMetric: function (maxMeters) {\n\t\tvar meters = this._getRoundNum(maxMeters);\n\n\t\tthis._mScale.style.width = this._getScaleWidth(meters / maxMeters) + 'px';\n\t\tthis._mScale.innerHTML = meters < 1000 ? meters + ' m' : (meters / 1000) + ' km';\n\t},\n\n\t_updateImperial: function (maxMeters) {\n\t\tvar maxFeet = maxMeters * 3.2808399,\n\t\t    scale = this._iScale,\n\t\t    maxMiles, miles, feet;\n\n\t\tif (maxFeet > 5280) {\n\t\t\tmaxMiles = maxFeet / 5280;\n\t\t\tmiles = this._getRoundNum(maxMiles);\n\n\t\t\tscale.style.width = this._getScaleWidth(miles / maxMiles) + 'px';\n\t\t\tscale.innerHTML = miles + ' mi';\n\n\t\t} else {\n\t\t\tfeet = this._getRoundNum(maxFeet);\n\n\t\t\tscale.style.width = this._getScaleWidth(feet / maxFeet) + 'px';\n\t\t\tscale.innerHTML = feet + ' ft';\n\t\t}\n\t},\n\n\t_getScaleWidth: function (ratio) {\n\t\treturn Math.round(this.options.maxWidth * ratio) - 10;\n\t},\n\n\t_getRoundNum: function (num) {\n\t\tvar pow10 = Math.pow(10, (Math.floor(num) + '').length - 1),\n\t\t    d = num / pow10;\n\n\t\td = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;\n\n\t\treturn pow10 * d;\n\t}\n});\n\nL.control.scale = function (options) {\n\treturn new L.Control.Scale(options);\n};\n\n\n/*\n * L.Control.Layers is a control to allow users to switch between different layers on the map.\n */\n\nL.Control.Layers = L.Control.extend({\n\toptions: {\n\t\tcollapsed: true,\n\t\tposition: 'topright',\n\t\tautoZIndex: true\n\t},\n\n\tinitialize: function (baseLayers, overlays, options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._layers = {};\n\t\tthis._lastZIndex = 0;\n\t\tthis._handlingClick = false;\n\n\t\tfor (var i in baseLayers) {\n\t\t\tthis._addLayer(baseLayers[i], i);\n\t\t}\n\n\t\tfor (i in overlays) {\n\t\t\tthis._addLayer(overlays[i], i, true);\n\t\t}\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._initLayout();\n\t\tthis._update();\n\n\t\tmap\n\t\t    .on('layeradd', this._onLayerChange, this)\n\t\t    .on('layerremove', this._onLayerChange, this);\n\n\t\treturn this._container;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap\n\t\t    .off('layeradd', this._onLayerChange, this)\n\t\t    .off('layerremove', this._onLayerChange, this);\n\t},\n\n\taddBaseLayer: function (layer, name) {\n\t\tthis._addLayer(layer, name);\n\t\tthis._update();\n\t\treturn this;\n\t},\n\n\taddOverlay: function (layer, name) {\n\t\tthis._addLayer(layer, name, true);\n\t\tthis._update();\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tvar id = L.stamp(layer);\n\t\tdelete this._layers[id];\n\t\tthis._update();\n\t\treturn this;\n\t},\n\n\t_initLayout: function () {\n\t\tvar className = 'leaflet-control-layers',\n\t\t    container = this._container = L.DomUtil.create('div', className);\n\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\n\t\tcontainer.setAttribute('aria-haspopup', true);\n\n\t\tif (!L.Browser.touch) {\n\t\t\tL.DomEvent\n\t\t\t\t.disableClickPropagation(container)\n\t\t\t\t.disableScrollPropagation(container);\n\t\t} else {\n\t\t\tL.DomEvent.on(container, 'click', L.DomEvent.stopPropagation);\n\t\t}\n\n\t\tvar form = this._form = L.DomUtil.create('form', className + '-list');\n\n\t\tif (this.options.collapsed) {\n\t\t\tif (!L.Browser.android) {\n\t\t\t\tL.DomEvent\n\t\t\t\t    .on(container, 'mouseover', this._expand, this)\n\t\t\t\t    .on(container, 'mouseout', this._collapse, this);\n\t\t\t}\n\t\t\tvar link = this._layersLink = L.DomUtil.create('a', className + '-toggle', container);\n\t\t\tlink.href = '#';\n\t\t\tlink.title = 'Layers';\n\n\t\t\tif (L.Browser.touch) {\n\t\t\t\tL.DomEvent\n\t\t\t\t    .on(link, 'click', L.DomEvent.stop)\n\t\t\t\t    .on(link, 'click', this._expand, this);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tL.DomEvent.on(link, 'focus', this._expand, this);\n\t\t\t}\n\t\t\t//Work around for Firefox android issue https://github.com/Leaflet/Leaflet/issues/2033\n\t\t\tL.DomEvent.on(form, 'click', function () {\n\t\t\t\tsetTimeout(L.bind(this._onInputClick, this), 0);\n\t\t\t}, this);\n\n\t\t\tthis._map.on('click', this._collapse, this);\n\t\t\t// TODO keyboard accessibility\n\t\t} else {\n\t\t\tthis._expand();\n\t\t}\n\n\t\tthis._baseLayersList = L.DomUtil.create('div', className + '-base', form);\n\t\tthis._separator = L.DomUtil.create('div', className + '-separator', form);\n\t\tthis._overlaysList = L.DomUtil.create('div', className + '-overlays', form);\n\n\t\tcontainer.appendChild(form);\n\t},\n\n\t_addLayer: function (layer, name, overlay) {\n\t\tvar id = L.stamp(layer);\n\n\t\tthis._layers[id] = {\n\t\t\tlayer: layer,\n\t\t\tname: name,\n\t\t\toverlay: overlay\n\t\t};\n\n\t\tif (this.options.autoZIndex && layer.setZIndex) {\n\t\t\tthis._lastZIndex++;\n\t\t\tlayer.setZIndex(this._lastZIndex);\n\t\t}\n\t},\n\n\t_update: function () {\n\t\tif (!this._container) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._baseLayersList.innerHTML = '';\n\t\tthis._overlaysList.innerHTML = '';\n\n\t\tvar baseLayersPresent = false,\n\t\t    overlaysPresent = false,\n\t\t    i, obj;\n\n\t\tfor (i in this._layers) {\n\t\t\tobj = this._layers[i];\n\t\t\tthis._addItem(obj);\n\t\t\toverlaysPresent = overlaysPresent || obj.overlay;\n\t\t\tbaseLayersPresent = baseLayersPresent || !obj.overlay;\n\t\t}\n\n\t\tthis._separator.style.display = overlaysPresent && baseLayersPresent ? '' : 'none';\n\t},\n\n\t_onLayerChange: function (e) {\n\t\tvar obj = this._layers[L.stamp(e.layer)];\n\n\t\tif (!obj) { return; }\n\n\t\tif (!this._handlingClick) {\n\t\t\tthis._update();\n\t\t}\n\n\t\tvar type = obj.overlay ?\n\t\t\t(e.type === 'layeradd' ? 'overlayadd' : 'overlayremove') :\n\t\t\t(e.type === 'layeradd' ? 'baselayerchange' : null);\n\n\t\tif (type) {\n\t\t\tthis._map.fire(type, obj);\n\t\t}\n\t},\n\n\t// IE7 bugs out if you create a radio dynamically, so you have to do it this hacky way (see http://bit.ly/PqYLBe)\n\t_createRadioElement: function (name, checked) {\n\n\t\tvar radioHtml = '<input type=\"radio\" class=\"leaflet-control-layers-selector\" name=\"' + name + '\"';\n\t\tif (checked) {\n\t\t\tradioHtml += ' checked=\"checked\"';\n\t\t}\n\t\tradioHtml += '/>';\n\n\t\tvar radioFragment = document.createElement('div');\n\t\tradioFragment.innerHTML = radioHtml;\n\n\t\treturn radioFragment.firstChild;\n\t},\n\n\t_addItem: function (obj) {\n\t\tvar label = document.createElement('label'),\n\t\t    input,\n\t\t    checked = this._map.hasLayer(obj.layer);\n\n\t\tif (obj.overlay) {\n\t\t\tinput = document.createElement('input');\n\t\t\tinput.type = 'checkbox';\n\t\t\tinput.className = 'leaflet-control-layers-selector';\n\t\t\tinput.defaultChecked = checked;\n\t\t} else {\n\t\t\tinput = this._createRadioElement('leaflet-base-layers', checked);\n\t\t}\n\n\t\tinput.layerId = L.stamp(obj.layer);\n\n\t\tL.DomEvent.on(input, 'click', this._onInputClick, this);\n\n\t\tvar name = document.createElement('span');\n\t\tname.innerHTML = ' ' + obj.name;\n\n\t\tlabel.appendChild(input);\n\t\tlabel.appendChild(name);\n\n\t\tvar container = obj.overlay ? this._overlaysList : this._baseLayersList;\n\t\tcontainer.appendChild(label);\n\n\t\treturn label;\n\t},\n\n\t_onInputClick: function () {\n\t\tvar i, input, obj,\n\t\t    inputs = this._form.getElementsByTagName('input'),\n\t\t    inputsLen = inputs.length;\n\n\t\tthis._handlingClick = true;\n\n\t\tfor (i = 0; i < inputsLen; i++) {\n\t\t\tinput = inputs[i];\n\t\t\tobj = this._layers[input.layerId];\n\n\t\t\tif (input.checked && !this._map.hasLayer(obj.layer)) {\n\t\t\t\tthis._map.addLayer(obj.layer);\n\n\t\t\t} else if (!input.checked && this._map.hasLayer(obj.layer)) {\n\t\t\t\tthis._map.removeLayer(obj.layer);\n\t\t\t}\n\t\t}\n\n\t\tthis._handlingClick = false;\n\n\t\tthis._refocusOnMap();\n\t},\n\n\t_expand: function () {\n\t\tL.DomUtil.addClass(this._container, 'leaflet-control-layers-expanded');\n\t},\n\n\t_collapse: function () {\n\t\tthis._container.className = this._container.className.replace(' leaflet-control-layers-expanded', '');\n\t}\n});\n\nL.control.layers = function (baseLayers, overlays, options) {\n\treturn new L.Control.Layers(baseLayers, overlays, options);\n};\n\n\n/*\n * L.PosAnimation is used by Leaflet internally for pan animations.\n */\n\nL.PosAnimation = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\trun: function (el, newPos, duration, easeLinearity) { // (HTMLElement, Point[, Number, Number])\n\t\tthis.stop();\n\n\t\tthis._el = el;\n\t\tthis._inProgress = true;\n\t\tthis._newPos = newPos;\n\n\t\tthis.fire('start');\n\n\t\tel.style[L.DomUtil.TRANSITION] = 'all ' + (duration || 0.25) +\n\t\t        's cubic-bezier(0,0,' + (easeLinearity || 0.5) + ',1)';\n\n\t\tL.DomEvent.on(el, L.DomUtil.TRANSITION_END, this._onTransitionEnd, this);\n\t\tL.DomUtil.setPosition(el, newPos);\n\n\t\t// toggle reflow, Chrome flickers for some reason if you don't do this\n\t\tL.Util.falseFn(el.offsetWidth);\n\n\t\t// there's no native way to track value updates of transitioned properties, so we imitate this\n\t\tthis._stepTimer = setInterval(L.bind(this._onStep, this), 50);\n\t},\n\n\tstop: function () {\n\t\tif (!this._inProgress) { return; }\n\n\t\t// if we just removed the transition property, the element would jump to its final position,\n\t\t// so we need to make it stay at the current position\n\n\t\tL.DomUtil.setPosition(this._el, this._getPos());\n\t\tthis._onTransitionEnd();\n\t\tL.Util.falseFn(this._el.offsetWidth); // force reflow in case we are about to start a new animation\n\t},\n\n\t_onStep: function () {\n\t\tvar stepPos = this._getPos();\n\t\tif (!stepPos) {\n\t\t\tthis._onTransitionEnd();\n\t\t\treturn;\n\t\t}\n\t\t// jshint camelcase: false\n\t\t// make L.DomUtil.getPosition return intermediate position value during animation\n\t\tthis._el._leaflet_pos = stepPos;\n\n\t\tthis.fire('step');\n\t},\n\n\t// you can't easily get intermediate values of properties animated with CSS3 Transitions,\n\t// we need to parse computed style (in case of transform it returns matrix string)\n\n\t_transformRe: /([-+]?(?:\\d*\\.)?\\d+)\\D*, ([-+]?(?:\\d*\\.)?\\d+)\\D*\\)/,\n\n\t_getPos: function () {\n\t\tvar left, top, matches,\n\t\t    el = this._el,\n\t\t    style = window.getComputedStyle(el);\n\n\t\tif (L.Browser.any3d) {\n\t\t\tmatches = style[L.DomUtil.TRANSFORM].match(this._transformRe);\n\t\t\tif (!matches) { return; }\n\t\t\tleft = parseFloat(matches[1]);\n\t\t\ttop  = parseFloat(matches[2]);\n\t\t} else {\n\t\t\tleft = parseFloat(style.left);\n\t\t\ttop  = parseFloat(style.top);\n\t\t}\n\n\t\treturn new L.Point(left, top, true);\n\t},\n\n\t_onTransitionEnd: function () {\n\t\tL.DomEvent.off(this._el, L.DomUtil.TRANSITION_END, this._onTransitionEnd, this);\n\n\t\tif (!this._inProgress) { return; }\n\t\tthis._inProgress = false;\n\n\t\tthis._el.style[L.DomUtil.TRANSITION] = '';\n\n\t\t// jshint camelcase: false\n\t\t// make sure L.DomUtil.getPosition returns the final position value after animation\n\t\tthis._el._leaflet_pos = this._newPos;\n\n\t\tclearInterval(this._stepTimer);\n\n\t\tthis.fire('step').fire('end');\n\t}\n\n});\n\n\n/*\n * Extends L.Map to handle panning animations.\n */\n\nL.Map.include({\n\n\tsetView: function (center, zoom, options) {\n\n\t\tzoom = zoom === undefined ? this._zoom : this._limitZoom(zoom);\n\t\tcenter = this._limitCenter(L.latLng(center), zoom, this.options.maxBounds);\n\t\toptions = options || {};\n\n\t\tif (this._panAnim) {\n\t\t\tthis._panAnim.stop();\n\t\t}\n\n\t\tif (this._loaded && !options.reset && options !== true) {\n\n\t\t\tif (options.animate !== undefined) {\n\t\t\t\toptions.zoom = L.extend({animate: options.animate}, options.zoom);\n\t\t\t\toptions.pan = L.extend({animate: options.animate}, options.pan);\n\t\t\t}\n\n\t\t\t// try animating pan or zoom\n\t\t\tvar animated = (this._zoom !== zoom) ?\n\t\t\t\tthis._tryAnimatedZoom && this._tryAnimatedZoom(center, zoom, options.zoom) :\n\t\t\t\tthis._tryAnimatedPan(center, options.pan);\n\n\t\t\tif (animated) {\n\t\t\t\t// prevent resize handler call, the view will refresh after animation anyway\n\t\t\t\tclearTimeout(this._sizeTimer);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\n\t\t// animation didn't start, just reset the map view\n\t\tthis._resetView(center, zoom);\n\n\t\treturn this;\n\t},\n\n\tpanBy: function (offset, options) {\n\t\toffset = L.point(offset).round();\n\t\toptions = options || {};\n\n\t\tif (!offset.x && !offset.y) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif (!this._panAnim) {\n\t\t\tthis._panAnim = new L.PosAnimation();\n\n\t\t\tthis._panAnim.on({\n\t\t\t\t'step': this._onPanTransitionStep,\n\t\t\t\t'end': this._onPanTransitionEnd\n\t\t\t}, this);\n\t\t}\n\n\t\t// don't fire movestart if animating inertia\n\t\tif (!options.noMoveStart) {\n\t\t\tthis.fire('movestart');\n\t\t}\n\n\t\t// animate pan unless animate: false specified\n\t\tif (options.animate !== false) {\n\t\t\tL.DomUtil.addClass(this._mapPane, 'leaflet-pan-anim');\n\n\t\t\tvar newPos = this._getMapPanePos().subtract(offset);\n\t\t\tthis._panAnim.run(this._mapPane, newPos, options.duration || 0.25, options.easeLinearity);\n\t\t} else {\n\t\t\tthis._rawPanBy(offset);\n\t\t\tthis.fire('move').fire('moveend');\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_onPanTransitionStep: function () {\n\t\tthis.fire('move');\n\t},\n\n\t_onPanTransitionEnd: function () {\n\t\tL.DomUtil.removeClass(this._mapPane, 'leaflet-pan-anim');\n\t\tthis.fire('moveend');\n\t},\n\n\t_tryAnimatedPan: function (center, options) {\n\t\t// difference between the new and current centers in pixels\n\t\tvar offset = this._getCenterOffset(center)._floor();\n\n\t\t// don't animate too far unless animate: true specified in options\n\t\tif ((options && options.animate) !== true && !this.getSize().contains(offset)) { return false; }\n\n\t\tthis.panBy(offset, options);\n\n\t\treturn true;\n\t}\n});\n\n\n/*\n * L.PosAnimation fallback implementation that powers Leaflet pan animations\n * in browsers that don't support CSS3 Transitions.\n */\n\nL.PosAnimation = L.DomUtil.TRANSITION ? L.PosAnimation : L.PosAnimation.extend({\n\n\trun: function (el, newPos, duration, easeLinearity) { // (HTMLElement, Point[, Number, Number])\n\t\tthis.stop();\n\n\t\tthis._el = el;\n\t\tthis._inProgress = true;\n\t\tthis._duration = duration || 0.25;\n\t\tthis._easeOutPower = 1 / Math.max(easeLinearity || 0.5, 0.2);\n\n\t\tthis._startPos = L.DomUtil.getPosition(el);\n\t\tthis._offset = newPos.subtract(this._startPos);\n\t\tthis._startTime = +new Date();\n\n\t\tthis.fire('start');\n\n\t\tthis._animate();\n\t},\n\n\tstop: function () {\n\t\tif (!this._inProgress) { return; }\n\n\t\tthis._step();\n\t\tthis._complete();\n\t},\n\n\t_animate: function () {\n\t\t// animation loop\n\t\tthis._animId = L.Util.requestAnimFrame(this._animate, this);\n\t\tthis._step();\n\t},\n\n\t_step: function () {\n\t\tvar elapsed = (+new Date()) - this._startTime,\n\t\t    duration = this._duration * 1000;\n\n\t\tif (elapsed < duration) {\n\t\t\tthis._runFrame(this._easeOut(elapsed / duration));\n\t\t} else {\n\t\t\tthis._runFrame(1);\n\t\t\tthis._complete();\n\t\t}\n\t},\n\n\t_runFrame: function (progress) {\n\t\tvar pos = this._startPos.add(this._offset.multiplyBy(progress));\n\t\tL.DomUtil.setPosition(this._el, pos);\n\n\t\tthis.fire('step');\n\t},\n\n\t_complete: function () {\n\t\tL.Util.cancelAnimFrame(this._animId);\n\n\t\tthis._inProgress = false;\n\t\tthis.fire('end');\n\t},\n\n\t_easeOut: function (t) {\n\t\treturn 1 - Math.pow(1 - t, this._easeOutPower);\n\t}\n});\n\n\n/*\n * Extends L.Map to handle zoom animations.\n */\n\nL.Map.mergeOptions({\n\tzoomAnimation: true,\n\tzoomAnimationThreshold: 4\n});\n\nif (L.DomUtil.TRANSITION) {\n\n\tL.Map.addInitHook(function () {\n\t\t// don't animate on browsers without hardware-accelerated transitions or old Android/Opera\n\t\tthis._zoomAnimated = this.options.zoomAnimation && L.DomUtil.TRANSITION &&\n\t\t\t\tL.Browser.any3d && !L.Browser.android23 && !L.Browser.mobileOpera;\n\n\t\t// zoom transitions run with the same duration for all layers, so if one of transitionend events\n\t\t// happens after starting zoom animation (propagating to the map pane), we know that it ended globally\n\t\tif (this._zoomAnimated) {\n\t\t\tL.DomEvent.on(this._mapPane, L.DomUtil.TRANSITION_END, this._catchTransitionEnd, this);\n\t\t}\n\t});\n}\n\nL.Map.include(!L.DomUtil.TRANSITION ? {} : {\n\n\t_catchTransitionEnd: function (e) {\n\t\tif (this._animatingZoom && e.propertyName.indexOf('transform') >= 0) {\n\t\t\tthis._onZoomTransitionEnd();\n\t\t}\n\t},\n\n\t_nothingToAnimate: function () {\n\t\treturn !this._container.getElementsByClassName('leaflet-zoom-animated').length;\n\t},\n\n\t_tryAnimatedZoom: function (center, zoom, options) {\n\n\t\tif (this._animatingZoom) { return true; }\n\n\t\toptions = options || {};\n\n\t\t// don't animate if disabled, not supported or zoom difference is too large\n\t\tif (!this._zoomAnimated || options.animate === false || this._nothingToAnimate() ||\n\t\t        Math.abs(zoom - this._zoom) > this.options.zoomAnimationThreshold) { return false; }\n\n\t\t// offset is the pixel coords of the zoom origin relative to the current center\n\t\tvar scale = this.getZoomScale(zoom),\n\t\t    offset = this._getCenterOffset(center)._divideBy(1 - 1 / scale),\n\t\t\torigin = this._getCenterLayerPoint()._add(offset);\n\n\t\t// don't animate if the zoom origin isn't within one screen from the current center, unless forced\n\t\tif (options.animate !== true && !this.getSize().contains(offset)) { return false; }\n\n\t\tthis\n\t\t    .fire('movestart')\n\t\t    .fire('zoomstart');\n\n\t\tthis._animateZoom(center, zoom, origin, scale, null, true);\n\n\t\treturn true;\n\t},\n\n\t_animateZoom: function (center, zoom, origin, scale, delta, backwards, forTouchZoom) {\n\n\t\tif (!forTouchZoom) {\n\t\t\tthis._animatingZoom = true;\n\t\t}\n\n\t\t// put transform transition on all layers with leaflet-zoom-animated class\n\t\tL.DomUtil.addClass(this._mapPane, 'leaflet-zoom-anim');\n\n\t\t// remember what center/zoom to set after animation\n\t\tthis._animateToCenter = center;\n\t\tthis._animateToZoom = zoom;\n\n\t\t// disable any dragging during animation\n\t\tif (L.Draggable) {\n\t\t\tL.Draggable._disabled = true;\n\t\t}\n\n\t\tL.Util.requestAnimFrame(function () {\n\t\t\tthis.fire('zoomanim', {\n\t\t\t\tcenter: center,\n\t\t\t\tzoom: zoom,\n\t\t\t\torigin: origin,\n\t\t\t\tscale: scale,\n\t\t\t\tdelta: delta,\n\t\t\t\tbackwards: backwards\n\t\t\t});\n\t\t}, this);\n\t},\n\n\t_onZoomTransitionEnd: function () {\n\n\t\tthis._animatingZoom = false;\n\n\t\tL.DomUtil.removeClass(this._mapPane, 'leaflet-zoom-anim');\n\n\t\tthis._resetView(this._animateToCenter, this._animateToZoom, true, true);\n\n\t\tif (L.Draggable) {\n\t\t\tL.Draggable._disabled = false;\n\t\t}\n\t}\n});\n\n\n/*\n\tZoom animation logic for L.TileLayer.\n*/\n\nL.TileLayer.include({\n\t_animateZoom: function (e) {\n\t\tif (!this._animating) {\n\t\t\tthis._animating = true;\n\t\t\tthis._prepareBgBuffer();\n\t\t}\n\n\t\tvar bg = this._bgBuffer,\n\t\t    transform = L.DomUtil.TRANSFORM,\n\t\t    initialTransform = e.delta ? L.DomUtil.getTranslateString(e.delta) : bg.style[transform],\n\t\t    scaleStr = L.DomUtil.getScaleString(e.scale, e.origin);\n\n\t\tbg.style[transform] = e.backwards ?\n\t\t\t\tscaleStr + ' ' + initialTransform :\n\t\t\t\tinitialTransform + ' ' + scaleStr;\n\t},\n\n\t_endZoomAnim: function () {\n\t\tvar front = this._tileContainer,\n\t\t    bg = this._bgBuffer;\n\n\t\tfront.style.visibility = '';\n\t\tfront.parentNode.appendChild(front); // Bring to fore\n\n\t\t// force reflow\n\t\tL.Util.falseFn(bg.offsetWidth);\n\n\t\tthis._animating = false;\n\t},\n\n\t_clearBgBuffer: function () {\n\t\tvar map = this._map;\n\n\t\tif (map && !map._animatingZoom && !map.touchZoom._zooming) {\n\t\t\tthis._bgBuffer.innerHTML = '';\n\t\t\tthis._bgBuffer.style[L.DomUtil.TRANSFORM] = '';\n\t\t}\n\t},\n\n\t_prepareBgBuffer: function () {\n\n\t\tvar front = this._tileContainer,\n\t\t    bg = this._bgBuffer;\n\n\t\t// if foreground layer doesn't have many tiles but bg layer does,\n\t\t// keep the existing bg layer and just zoom it some more\n\n\t\tvar bgLoaded = this._getLoadedTilesPercentage(bg),\n\t\t    frontLoaded = this._getLoadedTilesPercentage(front);\n\n\t\tif (bg && bgLoaded > 0.5 && frontLoaded < 0.5) {\n\n\t\t\tfront.style.visibility = 'hidden';\n\t\t\tthis._stopLoadingImages(front);\n\t\t\treturn;\n\t\t}\n\n\t\t// prepare the buffer to become the front tile pane\n\t\tbg.style.visibility = 'hidden';\n\t\tbg.style[L.DomUtil.TRANSFORM] = '';\n\n\t\t// switch out the current layer to be the new bg layer (and vice-versa)\n\t\tthis._tileContainer = bg;\n\t\tbg = this._bgBuffer = front;\n\n\t\tthis._stopLoadingImages(bg);\n\n\t\t//prevent bg buffer from clearing right after zoom\n\t\tclearTimeout(this._clearBgBufferTimer);\n\t},\n\n\t_getLoadedTilesPercentage: function (container) {\n\t\tvar tiles = container.getElementsByTagName('img'),\n\t\t    i, len, count = 0;\n\n\t\tfor (i = 0, len = tiles.length; i < len; i++) {\n\t\t\tif (tiles[i].complete) {\n\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\t\treturn count / len;\n\t},\n\n\t// stops loading all tiles in the background layer\n\t_stopLoadingImages: function (container) {\n\t\tvar tiles = Array.prototype.slice.call(container.getElementsByTagName('img')),\n\t\t    i, len, tile;\n\n\t\tfor (i = 0, len = tiles.length; i < len; i++) {\n\t\t\ttile = tiles[i];\n\n\t\t\tif (!tile.complete) {\n\t\t\t\ttile.onload = L.Util.falseFn;\n\t\t\t\ttile.onerror = L.Util.falseFn;\n\t\t\t\ttile.src = L.Util.emptyImageUrl;\n\n\t\t\t\ttile.parentNode.removeChild(tile);\n\t\t\t}\n\t\t}\n\t}\n});\n\n\n/*\n * Provides L.Map with convenient shortcuts for using browser geolocation features.\n */\n\nL.Map.include({\n\t_defaultLocateOptions: {\n\t\twatch: false,\n\t\tsetView: false,\n\t\tmaxZoom: Infinity,\n\t\ttimeout: 10000,\n\t\tmaximumAge: 0,\n\t\tenableHighAccuracy: false\n\t},\n\n\tlocate: function (/*Object*/ options) {\n\n\t\toptions = this._locateOptions = L.extend(this._defaultLocateOptions, options);\n\n\t\tif (!navigator.geolocation) {\n\t\t\tthis._handleGeolocationError({\n\t\t\t\tcode: 0,\n\t\t\t\tmessage: 'Geolocation not supported.'\n\t\t\t});\n\t\t\treturn this;\n\t\t}\n\n\t\tvar onResponse = L.bind(this._handleGeolocationResponse, this),\n\t\t\tonError = L.bind(this._handleGeolocationError, this);\n\n\t\tif (options.watch) {\n\t\t\tthis._locationWatchId =\n\t\t\t        navigator.geolocation.watchPosition(onResponse, onError, options);\n\t\t} else {\n\t\t\tnavigator.geolocation.getCurrentPosition(onResponse, onError, options);\n\t\t}\n\t\treturn this;\n\t},\n\n\tstopLocate: function () {\n\t\tif (navigator.geolocation) {\n\t\t\tnavigator.geolocation.clearWatch(this._locationWatchId);\n\t\t}\n\t\tif (this._locateOptions) {\n\t\t\tthis._locateOptions.setView = false;\n\t\t}\n\t\treturn this;\n\t},\n\n\t_handleGeolocationError: function (error) {\n\t\tvar c = error.code,\n\t\t    message = error.message ||\n\t\t            (c === 1 ? 'permission denied' :\n\t\t            (c === 2 ? 'position unavailable' : 'timeout'));\n\n\t\tif (this._locateOptions.setView && !this._loaded) {\n\t\t\tthis.fitWorld();\n\t\t}\n\n\t\tthis.fire('locationerror', {\n\t\t\tcode: c,\n\t\t\tmessage: 'Geolocation error: ' + message + '.'\n\t\t});\n\t},\n\n\t_handleGeolocationResponse: function (pos) {\n\t\tvar lat = pos.coords.latitude,\n\t\t    lng = pos.coords.longitude,\n\t\t    latlng = new L.LatLng(lat, lng),\n\n\t\t    latAccuracy = 180 * pos.coords.accuracy / 40075017,\n\t\t    lngAccuracy = latAccuracy / Math.cos(L.LatLng.DEG_TO_RAD * lat),\n\n\t\t    bounds = L.latLngBounds(\n\t\t            [lat - latAccuracy, lng - lngAccuracy],\n\t\t            [lat + latAccuracy, lng + lngAccuracy]),\n\n\t\t    options = this._locateOptions;\n\n\t\tif (options.setView) {\n\t\t\tvar zoom = Math.min(this.getBoundsZoom(bounds), options.maxZoom);\n\t\t\tthis.setView(latlng, zoom);\n\t\t}\n\n\t\tvar data = {\n\t\t\tlatlng: latlng,\n\t\t\tbounds: bounds,\n\t\t\ttimestamp: pos.timestamp\n\t\t};\n\n\t\tfor (var i in pos.coords) {\n\t\t\tif (typeof pos.coords[i] === 'number') {\n\t\t\t\tdata[i] = pos.coords[i];\n\t\t\t}\n\t\t}\n\n\t\tthis.fire('locationfound', data);\n\t}\n});\n\n\n}(window, document));","L.KML = L.FeatureGroup.extend({\n\toptions: {\n\t\tasync: true\n\t},\n\n\tinitialize: function(kml, options) {\n\t\tL.Util.setOptions(this, options);\n\t\tthis._kml = kml;\n\t\tthis._layers = {};\n\n\t\tif (kml) {\n\t\t\tthis.addKML(kml, options, this.options.async);\n\t\t}\n\t},\n\n\tloadXML: function(url, cb, options, async) {\n\t\tif (async === undefined) async = this.options.async;\n\t\tif (options === undefined) options = this.options;\n\n\t\tvar req = new window.XMLHttpRequest();\n\t\treq.open('GET', url, async);\n\t\ttry {\n\t\t\treq.overrideMimeType('text/xml'); // unsupported by IE\n\t\t} catch(e) {}\n\t\treq.onreadystatechange = function() {\n\t\t\tif (req.readyState !== 4) return;\n\t\t\tif (req.status === 200) cb(req.responseXML, options);\n\t\t};\n\t\treq.send(null);\n\t},\n\n\taddKML: function(url, options, async) {\n\t\tvar _this = this;\n\t\tvar cb = function(gpx, options) { _this._addKML(gpx, options); };\n\t\tthis.loadXML(url, cb, options, async);\n\t},\n\n\t_addKML: function(xml, options) {\n\t\tvar layers = this.parseKML(xml);\n\t\tif (!layers || !layers.length) return;\n\t\tfor (var i = 0; i < layers.length; i++) {\n\t\t\tthis.fire('addlayer', {\n\t\t\t\tlayer: layers[i]\n\t\t\t});\n\t\t\tthis.addLayer(layers[i]);\n\t\t}\n\t\tthis.latLngs = this.getLatLngs(xml);\n\t\tthis.fire('loaded');\n\t},\n\n\tlatLngs: []\n});\n\nL.KML = L.KML.extend({\n\n\tparseKML: function (xml) {\n\t\tvar style = this.parseStyle(xml);\n\t\tthis.parseStyleMap(xml, style);\n\t\tvar el = xml.getElementsByTagName('Folder');\n\t\tvar layers = [], l;\n\t\tfor (var i = 0; i < el.length; i++) {\n\t\t\tif (!this._check_folder(el[i])) { continue; }\n\t\t\tl = this.parseFolder(el[i], style);\n\t\t\tif (l) { layers.push(l); }\n\t\t}\n\t\tel = xml.getElementsByTagName('Placemark');\n\t\tfor (var j = 0; j < el.length; j++) {\n\t\t\tif (!this._check_folder(el[j])) { continue; }\n\t\t\tl = this.parsePlacemark(el[j], xml, style);\n\t\t\tif (l) { layers.push(l); }\n\t\t}\n\t\tel = xml.getElementsByTagName('GroundOverlay');\n\t\tfor (var k = 0; k < el.length; k++) {\n\t\t\tl = this.parseGroundOverlay(el[k]);\n\t\t\tif (l) { layers.push(l); }\n\t\t}\n\t\treturn layers;\n\t},\n\n\t// Return false if e's first parent Folder is not [folder]\n\t// - returns true if no parent Folders\n\t_check_folder: function (e, folder) {\n\t\te = e.parentElement;\n\t\twhile (e && e.tagName !== 'Folder')\n\t\t{\n\t\t\te = e.parentElement;\n\t\t}\n\t\treturn !e || e === folder;\n\t},\n\n\tparseStyle: function (xml) {\n\t\tvar style = {};\n\t\tvar sl = xml.getElementsByTagName('Style');\n\n\t\t//for (var i = 0; i < sl.length; i++) {\n\t\tvar attributes = {color: true, width: true, Icon: true, href: true,\n\t\t\t\t\t\t  hotSpot: true};\n\n\t\tfunction _parse(xml) {\n\t\t\tvar options = {};\n\t\t\tfor (var i = 0; i < xml.childNodes.length; i++) {\n\t\t\t\tvar e = xml.childNodes[i];\n\t\t\t\tvar key = e.tagName;\n\t\t\t\tif (!attributes[key]) { continue; }\n\t\t\t\tif (key === 'hotSpot')\n\t\t\t\t{\n\t\t\t\t\tfor (var j = 0; j < e.attributes.length; j++) {\n\t\t\t\t\t\toptions[e.attributes[j].name] = e.attributes[j].nodeValue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar value = e.childNodes[0].nodeValue;\n\t\t\t\t\tif (key === 'color') {\n\t\t\t\t\t\toptions.opacity = parseInt(value.substring(0, 2), 16) / 255.0;\n\t\t\t\t\t\toptions.color = '#' + value.substring(6, 8) + value.substring(4, 6) + value.substring(2, 4);\n\t\t\t\t\t} else if (key === 'width') {\n\t\t\t\t\t\toptions.weight = value;\n\t\t\t\t\t} else if (key === 'Icon') {\n\t\t\t\t\t\tioptions = _parse(e);\n\t\t\t\t\t\tif (ioptions.href) { options.href = ioptions.href; }\n\t\t\t\t\t} else if (key === 'href') {\n\t\t\t\t\t\toptions.href = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\n\t\tfor (var i = 0; i < sl.length; i++) {\n\t\t\tvar e = sl[i], el;\n\t\t\tvar options = {}, poptions = {}, ioptions = {};\n\t\t\tel = e.getElementsByTagName('LineStyle');\n\t\t\tif (el && el[0]) { options = _parse(el[0]); }\n\t\t\tel = e.getElementsByTagName('PolyStyle');\n\t\t\tif (el && el[0]) { poptions = _parse(el[0]); }\n\t\t\tif (poptions.color) { options.fillColor = poptions.color; }\n\t\t\tif (poptions.opacity) { options.fillOpacity = poptions.opacity; }\n\t\t\tel = e.getElementsByTagName('IconStyle');\n\t\t\tif (el && el[0]) { ioptions = _parse(el[0]); }\n\t\t\tif (ioptions.href) {\n\t\t\t\t// save anchor info until the image is loaded\n\t\t\t\toptions.icon = new L.KMLIcon({\n\t\t\t\t\ticonUrl: ioptions.href,\n\t\t\t\t\tshadowUrl: null,\n\t\t\t\t\ticonAnchorRef: {x: ioptions.x, y: ioptions.y},\n\t\t\t\t\ticonAnchorType:\t{x: ioptions.xunits, y: ioptions.yunits}\n\t\t\t\t});\n\t\t\t}\n\t\t\tstyle['#' + e.getAttribute('id')] = options;\n\t\t}\n\t\treturn style;\n\t},\n\t\n\tparseStyleMap: function (xml, existingStyles) {\n\t\tvar sl = xml.getElementsByTagName('StyleMap');\n\t\t\n\t\tfor (var i = 0; i < sl.length; i++) {\n\t\t\tvar e = sl[i], el;\n\t\t\tvar smKey, smStyleUrl;\n\t\t\t\n\t\t\tel = e.getElementsByTagName('key');\n\t\t\tif (el && el[0]) { smKey = el[0].textContent; }\n\t\t\tel = e.getElementsByTagName('styleUrl');\n\t\t\tif (el && el[0]) { smStyleUrl = el[0].textContent; }\n\t\t\t\n\t\t\tif (smKey === 'normal')\n\t\t\t{\n\t\t\t\texistingStyles['#' + e.getAttribute('id')] = existingStyles[smStyleUrl];\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn;\n\t},\n\n\tparseFolder: function (xml, style) {\n\t\tvar el, layers = [], l;\n\t\tel = xml.getElementsByTagName('Folder');\n\t\tfor (var i = 0; i < el.length; i++) {\n\t\t\tif (!this._check_folder(el[i], xml)) { continue; }\n\t\t\tl = this.parseFolder(el[i], style);\n\t\t\tif (l) { layers.push(l); }\n\t\t}\n\t\tel = xml.getElementsByTagName('Placemark');\n\t\tfor (var j = 0; j < el.length; j++) {\n\t\t\tif (!this._check_folder(el[j], xml)) { continue; }\n\t\t\tl = this.parsePlacemark(el[j], xml, style);\n\t\t\tif (l) { layers.push(l); }\n\t\t}\n\t\tel = xml.getElementsByTagName('GroundOverlay');\n\t\tfor (var k = 0; k < el.length; k++) {\n\t\t\tif (!this._check_folder(el[k], xml)) { continue; }\n\t\t\tl = this.parseGroundOverlay(el[k]);\n\t\t\tif (l) { layers.push(l); }\n\t\t}\n\t\tif (!layers.length) { return; }\n\t\tif (layers.length === 1) { return layers[0]; }\n\t\treturn new L.FeatureGroup(layers);\n\t},\n\n\tparsePlacemark: function (place, xml, style) {\n\t\tvar h, i, j, el, options = {};\n\n\t\tvar multi = ['MultiGeometry', 'gx:MultiTrack'];\n\t\tfor (h in multi) {\n                    if (!multi.hasOwnProperty(h)) {\n                        continue;\n                    }\n                    el = place.getElementsByTagName(multi[h]);\n                    for (i = 0; i < el.length; i++) {\n                            return this.parsePlacemark(el[i], xml, style);\n                    }\n\t\t}\n\n\t\tel = place.getElementsByTagName('styleUrl');\n\t\tfor (i = 0; i < el.length; i++) {\n\t\t\tvar url = el[i].childNodes[0].nodeValue;\n\t\t\tfor (var a in style[url]) {\n                            if (!style[url].hasOwnProperty(a)) {\n                                continue;\n                            }\n                            options[a] = style[url][a];\n\t\t\t}\n\t\t}\n\t\tvar layers = [];\n\n\t\tvar parse = ['LineString', 'Polygon', 'Point', 'gx:Track'];\n\t\tfor (j in parse) {\n                    if (!parse.hasOwnProperty(j)) {\n                        continue;\n                    }\n                    var tag = parse[j];\n                    el = place.getElementsByTagName(tag);\n                    for (i = 0; i < el.length; i++) {\n                            var l = this['parse' + tag.replace(/gx:/, '')](el[i], xml, options);\n                            if (l) { layers.push(l); }\n                    }\n\t\t}\n\n\t\tif (!layers.length) {\n\t\t\treturn;\n\t\t}\n\t\tvar layer = layers[0];\n\t\tif (layers.length > 1) {\n\t\t\tlayer = new L.FeatureGroup(layers);\n\t\t}\n\n\t\tvar name, descr = '';\n\t\tel = place.getElementsByTagName('name');\n\t\tif (el.length && el[0].childNodes.length) {\n\t\t\tname = el[0].childNodes[0].nodeValue;\n\t\t}\n\t\tel = place.getElementsByTagName('description');\n\t\tfor (i = 0; i < el.length; i++) {\n\t\t\tfor (j = 0; j < el[i].childNodes.length; j++) {\n\t\t\t\tdescr = descr + el[i].childNodes[j].nodeValue;\n\t\t\t}\n\t\t}\n\n\t\tif (name) {\n\t\t\tlayer.bindPopup('<h2>' + name + '</h2>' + descr);\n\t\t}\n\n\t\treturn layer;\n\t},\n\n\tparseCoords: function (xml) {\n\t\tvar el = xml.getElementsByTagName('coordinates');\n\t\treturn this._read_coords(el[0]);\n\t},\n\n\tparseLineString: function (line, xml, options) {\n\t\tvar coords = this.parseCoords(line);\n\t\tif (!coords.length) { return; }\n\t\treturn new L.Polyline(coords, options);\n\t},\n\n\tparseTrack: function (line, xml, options) {\n\t\tvar el = xml.getElementsByTagName('gx:coord');\n\t\tvar coords = [];\n\t\tfor (var j = 0; j < el.length; j++) {\n\t\t\tcoords = coords.concat(this._read_gxcoords(el[j]));\n\t\t}\n\t\tif (!coords.length) { return; }\n\t\treturn new L.Polyline(coords, options);\n\t},\n\n\tparsePoint: function (line, xml, options) {\n\t\tvar el = line.getElementsByTagName('coordinates');\n\t\tif (!el.length) {\n\t\t\treturn;\n\t\t}\n\t\tvar ll = el[0].childNodes[0].nodeValue.split(',');\n\t\treturn new L.KMLMarker(new L.LatLng(ll[1], ll[0]), options);\n\t},\n\n\tparsePolygon: function (line, xml, options) {\n\t\tvar el, polys = [], inner = [], i, coords;\n\t\tel = line.getElementsByTagName('outerBoundaryIs');\n\t\tfor (i = 0; i < el.length; i++) {\n\t\t\tcoords = this.parseCoords(el[i]);\n\t\t\tif (coords) {\n\t\t\t\tpolys.push(coords);\n\t\t\t}\n\t\t}\n\t\tel = line.getElementsByTagName('innerBoundaryIs');\n\t\tfor (i = 0; i < el.length; i++) {\n\t\t\tcoords = this.parseCoords(el[i]);\n\t\t\tif (coords) {\n\t\t\t\tinner.push(coords);\n\t\t\t}\n\t\t}\n\t\tif (!polys.length) {\n\t\t\treturn;\n\t\t}\n\t\tif (options.fillColor) {\n\t\t\toptions.fill = true;\n\t\t}\n\t\tif (polys.length === 1) {\n\t\t\treturn new L.Polygon(polys.concat(inner), options);\n\t\t}\n\t\treturn new L.MultiPolygon(polys, options);\n\t},\n\n\tgetLatLngs: function (xml) {\n\t\tvar el = xml.getElementsByTagName('coordinates');\n\t\tvar coords = [];\n\t\tfor (var j = 0; j < el.length; j++) {\n\t\t\t// text might span many childNodes\n\t\t\tcoords = coords.concat(this._read_coords(el[j]));\n\t\t}\n\t\treturn coords;\n\t},\n\n\t_read_coords: function (el) {\n\t\tvar text = '', coords = [], i;\n\t\tfor (i = 0; i < el.childNodes.length; i++) {\n\t\t\ttext = text + el.childNodes[i].nodeValue;\n\t\t}\n\t\ttext = text.split(/[\\s\\n]+/);\n\t\tfor (i = 0; i < text.length; i++) {\n\t\t\tvar ll = text[i].split(',');\n\t\t\tif (ll.length < 2) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcoords.push(new L.LatLng(ll[1], ll[0]));\n\t\t}\n\t\treturn coords;\n\t},\n\n\t_read_gxcoords: function (el) {\n\t\tvar text = '', coords = [];\n\t\ttext = el.firstChild.nodeValue.split(' ');\n\t\tcoords.push(new L.LatLng(text[1], text[0]));\n\t\treturn coords;\n\t},\n\n\tparseGroundOverlay: function (xml) {\n\t\tvar latlonbox = xml.getElementsByTagName('LatLonBox')[0];\n\t\tvar bounds = new L.LatLngBounds(\n\t\t\t[\n\t\t\t\tlatlonbox.getElementsByTagName('south')[0].childNodes[0].nodeValue,\n\t\t\t\tlatlonbox.getElementsByTagName('west')[0].childNodes[0].nodeValue\n\t\t\t],\n\t\t\t[\n\t\t\t\tlatlonbox.getElementsByTagName('north')[0].childNodes[0].nodeValue,\n\t\t\t\tlatlonbox.getElementsByTagName('east')[0].childNodes[0].nodeValue\n\t\t\t]\n\t\t);\n\t\tvar attributes = {Icon: true, href: true, color: true};\n\t\tfunction _parse(xml) {\n\t\t\tvar options = {}, ioptions = {};\n\t\t\tfor (var i = 0; i < xml.childNodes.length; i++) {\n\t\t\t\tvar e = xml.childNodes[i];\n\t\t\t\tvar key = e.tagName;\n\t\t\t\tif (!attributes[key]) { continue; }\n\t\t\t\tvar value = e.childNodes[0].nodeValue;\n\t\t\t\tif (key === 'Icon') {\n\t\t\t\t\tioptions = _parse(e);\n\t\t\t\t\tif (ioptions.href) { options.href = ioptions.href; }\n\t\t\t\t} else if (key === 'href') {\n\t\t\t\t\toptions.href = value;\n\t\t\t\t} else if (key === 'color') {\n\t\t\t\t\toptions.opacity = parseInt(value.substring(0, 2), 16) / 255.0;\n\t\t\t\t\toptions.color = '#' + value.substring(6, 8) + value.substring(4, 6) + value.substring(2, 4);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\tvar options = {};\n\t\toptions = _parse(xml);\n\t\tif (latlonbox.getElementsByTagName('rotation')[0] !== undefined) {\n\t\t\tvar rotation = latlonbox.getElementsByTagName('rotation')[0].childNodes[0].nodeValue;\n\t\t\toptions.rotation = parseFloat(rotation);\n\t\t}\n\t\treturn new L.RotatedImageOverlay(options.href, bounds, {opacity: options.opacity, angle: options.rotation});\n\t}\n\n});\n\nL.KMLIcon = L.Icon.extend({\n\n\tcreateIcon: function () {\n\t\tvar img = this._createIcon('icon');\n\t\timg.onload = function () {\n\t\t\tvar i = img;\n\t\t\tthis.style.width = i.width + 'px';\n\t\t\tthis.style.height = i.height + 'px';\n\n\t\t\tif (this.anchorType.x === 'UNITS_FRACTION' || this.anchorType.x === 'fraction') {\n\t\t\t\timg.style.marginLeft = (-this.anchor.x * i.width) + 'px';\n\t\t\t}\n\t\t\tif (this.anchorType.y === 'UNITS_FRACTION' || this.anchorType.x === 'fraction') {\n\t\t\t\timg.style.marginTop  = (-(1 - this.anchor.y) * i.height) + 'px';\n\t\t\t}\n\t\t\tthis.style.display = '';\n\t\t};\n\t\treturn img;\n\t},\n\n\t_setIconStyles: function (img, name) {\n\t\tL.Icon.prototype._setIconStyles.apply(this, [img, name]);\n\t\t// save anchor information to the image\n\t\timg.anchor = this.options.iconAnchorRef;\n\t\timg.anchorType = this.options.iconAnchorType;\n\t}\n});\n\n\nL.KMLMarker = L.Marker.extend({\n\toptions: {\n\t\ticon: new L.KMLIcon.Default()\n\t}\n});\n\n// Inspired by https://github.com/bbecquet/Leaflet.PolylineDecorator/tree/master/src\nL.RotatedImageOverlay = L.ImageOverlay.extend({\n\toptions: {\n\t\tangle: 0\n\t},\n\t_reset: function () {\n\t\tL.ImageOverlay.prototype._reset.call(this);\n\t\tthis._rotate();\n\t},\n\t_animateZoom: function (e) {\n\t\tL.ImageOverlay.prototype._animateZoom.call(this, e);\n\t\tthis._rotate();\n\t},\n\t_rotate: function () {\n        if (L.DomUtil.TRANSFORM) {\n            // use the CSS transform rule if available\n            this._image.style[L.DomUtil.TRANSFORM] += ' rotate(' + this.options.angle + 'deg)';\n        } else if(L.Browser.ie) {\n            // fallback for IE6, IE7, IE8\n            var rad = this.options.angle * (Math.PI / 180),\n                costheta = Math.cos(rad),\n                sintheta = Math.sin(rad);\n            this._image.style.filter += ' progid:DXImageTransform.Microsoft.Matrix(sizingMethod=\\'auto expand\\', M11=' + \n                costheta + ', M12=' + (-sintheta) + ', M21=' + sintheta + ', M22=' + costheta + ')';                \n        }\n\t},\n\tgetBounds: function() {\n\t\treturn this._bounds;\n\t}\n});\n\n","/*\n Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.\n https://github.com/Leaflet/Leaflet.markercluster\n (c) 2012-2013, Dave Leaver, smartrak\n*/\n(function (window, document, undefined) {/*\n * L.MarkerClusterGroup extends L.FeatureGroup by clustering the markers contained within\n */\n\nL.MarkerClusterGroup = L.FeatureGroup.extend({\n\n\toptions: {\n\t\tmaxClusterRadius: 80, //A cluster will cover at most this many pixels from its center\n\t\ticonCreateFunction: null,\n\n\t\tspiderfyOnMaxZoom: true,\n\t\tshowCoverageOnHover: true,\n\t\tzoomToBoundsOnClick: true,\n\t\tsingleMarkerMode: false,\n\n\t\tdisableClusteringAtZoom: null,\n\n\t\t// Setting this to false prevents the removal of any clusters outside of the viewpoint, which\n\t\t// is the default behaviour for performance reasons.\n\t\tremoveOutsideVisibleBounds: true,\n\n\t\t//Whether to animate adding markers after adding the MarkerClusterGroup to the map\n\t\t// If you are adding individual markers set to true, if adding bulk markers leave false for massive performance gains.\n\t\tanimateAddingMarkers: false,\n\n\t\t//Increase to increase the distance away that spiderfied markers appear from the center\n\t\tspiderfyDistanceMultiplier: 1,\n\n\t\t// Make it possible to specify a polyline options on a spider leg\n\t\tspiderLegPolylineOptions: { weight: 1.5, color: '#222' },\n\n\t\t// When bulk adding layers, adds markers in chunks. Means addLayers may not add all the layers in the call, others will be loaded during setTimeouts\n\t\tchunkedLoading: false,\n\t\tchunkInterval: 200, // process markers for a maximum of ~ n milliseconds (then trigger the chunkProgress callback)\n\t\tchunkDelay: 50, // at the end of each interval, give n milliseconds back to system/browser\n\t\tchunkProgress: null, // progress callback: function(processed, total, elapsed) (e.g. for a progress indicator)\n\n\t\t//Options to pass to the L.Polygon constructor\n\t\tpolygonOptions: {}\n\t},\n\n\tinitialize: function (options) {\n\t\tL.Util.setOptions(this, options);\n\t\tif (!this.options.iconCreateFunction) {\n\t\t\tthis.options.iconCreateFunction = this._defaultIconCreateFunction;\n\t\t}\n\n\t\tthis._featureGroup = L.featureGroup();\n\t\tthis._featureGroup.on(L.FeatureGroup.EVENTS, this._propagateEvent, this);\n\n\t\tthis._nonPointGroup = L.featureGroup();\n\t\tthis._nonPointGroup.on(L.FeatureGroup.EVENTS, this._propagateEvent, this);\n\n\t\tthis._inZoomAnimation = 0;\n\t\tthis._needsClustering = [];\n\t\tthis._needsRemoving = []; //Markers removed while we aren't on the map need to be kept track of\n\t\t//The bounds of the currently shown area (from _getExpandedVisibleBounds) Updated on zoom/move\n\t\tthis._currentShownBounds = null;\n\n\t\tthis._queue = [];\n\t},\n\n\taddLayer: function (layer) {\n\n\t\tif (layer instanceof L.LayerGroup) {\n\t\t\tvar array = [];\n\t\t\tfor (var i in layer._layers) {\n\t\t\t\tarray.push(layer._layers[i]);\n\t\t\t}\n\t\t\treturn this.addLayers(array);\n\t\t}\n\n\t\t//Don't cluster non point data\n\t\tif (!layer.getLatLng) {\n\t\t\tthis._nonPointGroup.addLayer(layer);\n\t\t\treturn this;\n\t\t}\n\n\t\tif (!this._map) {\n\t\t\tthis._needsClustering.push(layer);\n\t\t\treturn this;\n\t\t}\n\n\t\tif (this.hasLayer(layer)) {\n\t\t\treturn this;\n\t\t}\n\n\n\t\t//If we have already clustered we'll need to add this one to a cluster\n\n\t\tif (this._unspiderfy) {\n\t\t\tthis._unspiderfy();\n\t\t}\n\n\t\tthis._addLayer(layer, this._maxZoom);\n\n\t\t//Work out what is visible\n\t\tvar visibleLayer = layer,\n\t\t\tcurrentZoom = this._map.getZoom();\n\t\tif (layer.__parent) {\n\t\t\twhile (visibleLayer.__parent._zoom >= currentZoom) {\n\t\t\t\tvisibleLayer = visibleLayer.__parent;\n\t\t\t}\n\t\t}\n\n\t\tif (this._currentShownBounds.contains(visibleLayer.getLatLng())) {\n\t\t\tif (this.options.animateAddingMarkers) {\n\t\t\t\tthis._animationAddLayer(layer, visibleLayer);\n\t\t\t} else {\n\t\t\t\tthis._animationAddLayerNonAnimated(layer, visibleLayer);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer) {\n\n\t\tif (layer instanceof L.LayerGroup)\n\t\t{\n\t\t\tvar array = [];\n\t\t\tfor (var i in layer._layers) {\n\t\t\t\tarray.push(layer._layers[i]);\n\t\t\t}\n\t\t\treturn this.removeLayers(array);\n\t\t}\n\n\t\t//Non point layers\n\t\tif (!layer.getLatLng) {\n\t\t\tthis._nonPointGroup.removeLayer(layer);\n\t\t\treturn this;\n\t\t}\n\n\t\tif (!this._map) {\n\t\t\tif (!this._arraySplice(this._needsClustering, layer) && this.hasLayer(layer)) {\n\t\t\t\tthis._needsRemoving.push(layer);\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tif (!layer.__parent) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif (this._unspiderfy) {\n\t\t\tthis._unspiderfy();\n\t\t\tthis._unspiderfyLayer(layer);\n\t\t}\n\n\t\t//Remove the marker from clusters\n\t\tthis._removeLayer(layer, true);\n\n\t\tif (this._featureGroup.hasLayer(layer)) {\n\t\t\tthis._featureGroup.removeLayer(layer);\n\t\t\tif (layer.clusterShow) {\n\t\t\t\tlayer.clusterShow();\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t//Takes an array of markers and adds them in bulk\n\taddLayers: function (layersArray) {\n\t\tvar fg = this._featureGroup,\n\t\t\tnpg = this._nonPointGroup,\n\t\t\tchunked = this.options.chunkedLoading,\n\t\t\tchunkInterval = this.options.chunkInterval,\n\t\t\tchunkProgress = this.options.chunkProgress,\n\t\t\tnewMarkers, i, l, m;\n\n\t\tif (this._map) {\n\t\t\tvar offset = 0,\n\t\t\t\tstarted = (new Date()).getTime();\n\t\t\tvar process = L.bind(function () {\n\t\t\t\tvar start = (new Date()).getTime();\n\t\t\t\tfor (; offset < layersArray.length; offset++) {\n\t\t\t\t\tif (chunked && offset % 200 === 0) {\n\t\t\t\t\t\t// every couple hundred markers, instrument the time elapsed since processing started:\n\t\t\t\t\t\tvar elapsed = (new Date()).getTime() - start;\n\t\t\t\t\t\tif (elapsed > chunkInterval) {\n\t\t\t\t\t\t\tbreak; // been working too hard, time to take a break :-)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tm = layersArray[offset];\n\n\t\t\t\t\t//Not point data, can't be clustered\n\t\t\t\t\tif (!m.getLatLng) {\n\t\t\t\t\t\tnpg.addLayer(m);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.hasLayer(m)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._addLayer(m, this._maxZoom);\n\n\t\t\t\t\t//If we just made a cluster of size 2 then we need to remove the other marker from the map (if it is) or we never will\n\t\t\t\t\tif (m.__parent) {\n\t\t\t\t\t\tif (m.__parent.getChildCount() === 2) {\n\t\t\t\t\t\t\tvar markers = m.__parent.getAllChildMarkers(),\n\t\t\t\t\t\t\t\totherMarker = markers[0] === m ? markers[1] : markers[0];\n\t\t\t\t\t\t\tfg.removeLayer(otherMarker);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (chunkProgress) {\n\t\t\t\t\t// report progress and time elapsed:\n\t\t\t\t\tchunkProgress(offset, layersArray.length, (new Date()).getTime() - started);\n\t\t\t\t}\n\n\t\t\t\tif (offset === layersArray.length) {\n\t\t\t\t\t//Update the icons of all those visible clusters that were affected\n\t\t\t\t\tthis._featureGroup.eachLayer(function (c) {\n\t\t\t\t\t\tif (c instanceof L.MarkerCluster && c._iconNeedsUpdate) {\n\t\t\t\t\t\t\tc._updateIcon();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis._topClusterLevel._recursivelyAddChildrenToMap(null, this._zoom, this._currentShownBounds);\n\t\t\t\t} else {\n\t\t\t\t\tsetTimeout(process, this.options.chunkDelay);\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tprocess();\n\t\t} else {\n\t\t\tnewMarkers = [];\n\t\t\tfor (i = 0, l = layersArray.length; i < l; i++) {\n\t\t\t\tm = layersArray[i];\n\n\t\t\t\t//Not point data, can't be clustered\n\t\t\t\tif (!m.getLatLng) {\n\t\t\t\t\tnpg.addLayer(m);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (this.hasLayer(m)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tnewMarkers.push(m);\n\t\t\t}\n\t\t\tthis._needsClustering = this._needsClustering.concat(newMarkers);\n\t\t}\n\t\treturn this;\n\t},\n\n\t//Takes an array of markers and removes them in bulk\n\tremoveLayers: function (layersArray) {\n\t\tvar i, l, m,\n\t\t\tfg = this._featureGroup,\n\t\t\tnpg = this._nonPointGroup;\n\n\t\tif (this._unspiderfy) {\n\t\t\tthis._unspiderfy();\n\t\t}\n\n\t\tif (!this._map) {\n\t\t\tfor (i = 0, l = layersArray.length; i < l; i++) {\n\t\t\t\tm = layersArray[i];\n\t\t\t\tthis._arraySplice(this._needsClustering, m);\n\t\t\t\tnpg.removeLayer(m);\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tfor (i = 0, l = layersArray.length; i < l; i++) {\n\t\t\tm = layersArray[i];\n\n\t\t\tif (!m.__parent) {\n\t\t\t\tnpg.removeLayer(m);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis._removeLayer(m, true, true);\n\n\t\t\tif (fg.hasLayer(m)) {\n\t\t\t\tfg.removeLayer(m);\n\t\t\t\tif (m.clusterShow) {\n\t\t\t\t\tm.clusterShow();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//Fix up the clusters and markers on the map\n\t\tthis._topClusterLevel._recursivelyAddChildrenToMap(null, this._zoom, this._currentShownBounds);\n\n\t\tfg.eachLayer(function (c) {\n\t\t\tif (c instanceof L.MarkerCluster) {\n\t\t\t\tc._updateIcon();\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t},\n\n\t//Removes all layers from the MarkerClusterGroup\n\tclearLayers: function () {\n\t\t//Need our own special implementation as the LayerGroup one doesn't work for us\n\n\t\t//If we aren't on the map (yet), blow away the markers we know of\n\t\tif (!this._map) {\n\t\t\tthis._needsClustering = [];\n\t\t\tdelete this._gridClusters;\n\t\t\tdelete this._gridUnclustered;\n\t\t}\n\n\t\tif (this._noanimationUnspiderfy) {\n\t\t\tthis._noanimationUnspiderfy();\n\t\t}\n\n\t\t//Remove all the visible layers\n\t\tthis._featureGroup.clearLayers();\n\t\tthis._nonPointGroup.clearLayers();\n\n\t\tthis.eachLayer(function (marker) {\n\t\t\tdelete marker.__parent;\n\t\t});\n\n\t\tif (this._map) {\n\t\t\t//Reset _topClusterLevel and the DistanceGrids\n\t\t\tthis._generateInitialClusters();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t//Override FeatureGroup.getBounds as it doesn't work\n\tgetBounds: function () {\n\t\tvar bounds = new L.LatLngBounds();\n\n\t\tif (this._topClusterLevel) {\n\t\t\tbounds.extend(this._topClusterLevel._bounds);\n\t\t}\n\n\t\tfor (var i = this._needsClustering.length - 1; i >= 0; i--) {\n\t\t\tbounds.extend(this._needsClustering[i].getLatLng());\n\t\t}\n\n\t\tbounds.extend(this._nonPointGroup.getBounds());\n\n\t\treturn bounds;\n\t},\n\n\t//Overrides LayerGroup.eachLayer\n\teachLayer: function (method, context) {\n\t\tvar markers = this._needsClustering.slice(),\n\t\t\ti;\n\n\t\tif (this._topClusterLevel) {\n\t\t\tthis._topClusterLevel.getAllChildMarkers(markers);\n\t\t}\n\n\t\tfor (i = markers.length - 1; i >= 0; i--) {\n\t\t\tmethod.call(context, markers[i]);\n\t\t}\n\n\t\tthis._nonPointGroup.eachLayer(method, context);\n\t},\n\n\t//Overrides LayerGroup.getLayers\n\tgetLayers: function () {\n\t\tvar layers = [];\n\t\tthis.eachLayer(function (l) {\n\t\t\tlayers.push(l);\n\t\t});\n\t\treturn layers;\n\t},\n\n\t//Overrides LayerGroup.getLayer, WARNING: Really bad performance\n\tgetLayer: function (id) {\n\t\tvar result = null;\n\n\t\tthis.eachLayer(function (l) {\n\t\t\tif (L.stamp(l) === id) {\n\t\t\t\tresult = l;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t},\n\n\t//Returns true if the given layer is in this MarkerClusterGroup\n\thasLayer: function (layer) {\n\t\tif (!layer) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar i, anArray = this._needsClustering;\n\n\t\tfor (i = anArray.length - 1; i >= 0; i--) {\n\t\t\tif (anArray[i] === layer) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tanArray = this._needsRemoving;\n\t\tfor (i = anArray.length - 1; i >= 0; i--) {\n\t\t\tif (anArray[i] === layer) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn !!(layer.__parent && layer.__parent._group === this) || this._nonPointGroup.hasLayer(layer);\n\t},\n\n\t//Zoom down to show the given layer (spiderfying if necessary) then calls the callback\n\tzoomToShowLayer: function (layer, callback) {\n\n\t\tvar showMarker = function () {\n\t\t\tif ((layer._icon || layer.__parent._icon) && !this._inZoomAnimation) {\n\t\t\t\tthis._map.off('moveend', showMarker, this);\n\t\t\t\tthis.off('animationend', showMarker, this);\n\n\t\t\t\tif (layer._icon) {\n\t\t\t\t\tcallback();\n\t\t\t\t} else if (layer.__parent._icon) {\n\t\t\t\t\tvar afterSpiderfy = function () {\n\t\t\t\t\t\tthis.off('spiderfied', afterSpiderfy, this);\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.on('spiderfied', afterSpiderfy, this);\n\t\t\t\t\tlayer.__parent.spiderfy();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif (layer._icon && this._map.getBounds().contains(layer.getLatLng())) {\n\t\t\t//Layer is visible ond on screen, immediate return\n\t\t\tcallback();\n\t\t} else if (layer.__parent._zoom < this._map.getZoom()) {\n\t\t\t//Layer should be visible at this zoom level. It must not be on screen so just pan over to it\n\t\t\tthis._map.on('moveend', showMarker, this);\n\t\t\tthis._map.panTo(layer.getLatLng());\n\t\t} else {\n\t\t\tvar moveStart = function () {\n\t\t\t\tthis._map.off('movestart', moveStart, this);\n\t\t\t\tmoveStart = null;\n\t\t\t};\n\n\t\t\tthis._map.on('movestart', moveStart, this);\n\t\t\tthis._map.on('moveend', showMarker, this);\n\t\t\tthis.on('animationend', showMarker, this);\n\t\t\tlayer.__parent.zoomToBounds();\n\n\t\t\tif (moveStart) {\n\t\t\t\t//Never started moving, must already be there, probably need clustering however\n\t\t\t\tshowMarker.call(this);\n\t\t\t}\n\t\t}\n\t},\n\n\t//Overrides FeatureGroup.onAdd\n\tonAdd: function (map) {\n\t\tthis._map = map;\n\t\tvar i, l, layer;\n\n\t\tif (!isFinite(this._map.getMaxZoom())) {\n\t\t\tthrow \"Map has no maxZoom specified\";\n\t\t}\n\n\t\tthis._featureGroup.onAdd(map);\n\t\tthis._nonPointGroup.onAdd(map);\n\n\t\tif (!this._gridClusters) {\n\t\t\tthis._generateInitialClusters();\n\t\t}\n\n\t\tfor (i = 0, l = this._needsRemoving.length; i < l; i++) {\n\t\t\tlayer = this._needsRemoving[i];\n\t\t\tthis._removeLayer(layer, true);\n\t\t}\n\t\tthis._needsRemoving = [];\n\n\t\t//Remember the current zoom level and bounds\n\t\tthis._zoom = this._map.getZoom();\n\t\tthis._currentShownBounds = this._getExpandedVisibleBounds();\n\n\t\tthis._map.on('zoomend', this._zoomEnd, this);\n\t\tthis._map.on('moveend', this._moveEnd, this);\n\n\t\tif (this._spiderfierOnAdd) { //TODO FIXME: Not sure how to have spiderfier add something on here nicely\n\t\t\tthis._spiderfierOnAdd();\n\t\t}\n\n\t\tthis._bindEvents();\n\n\t\t//Actually add our markers to the map:\n\t\tl = this._needsClustering;\n\t\tthis._needsClustering = [];\n\t\tthis.addLayers(l);\n\t},\n\n\t//Overrides FeatureGroup.onRemove\n\tonRemove: function (map) {\n\t\tmap.off('zoomend', this._zoomEnd, this);\n\t\tmap.off('moveend', this._moveEnd, this);\n\n\t\tthis._unbindEvents();\n\n\t\t//In case we are in a cluster animation\n\t\tthis._map._mapPane.className = this._map._mapPane.className.replace(' leaflet-cluster-anim', '');\n\n\t\tif (this._spiderfierOnRemove) { //TODO FIXME: Not sure how to have spiderfier add something on here nicely\n\t\t\tthis._spiderfierOnRemove();\n\t\t}\n\n\n\n\t\t//Clean up all the layers we added to the map\n\t\tthis._hideCoverage();\n\t\tthis._featureGroup.onRemove(map);\n\t\tthis._nonPointGroup.onRemove(map);\n\n\t\tthis._featureGroup.clearLayers();\n\n\t\tthis._map = null;\n\t},\n\n\tgetVisibleParent: function (marker) {\n\t\tvar vMarker = marker;\n\t\twhile (vMarker && !vMarker._icon) {\n\t\t\tvMarker = vMarker.__parent;\n\t\t}\n\t\treturn vMarker || null;\n\t},\n\n\t//Remove the given object from the given array\n\t_arraySplice: function (anArray, obj) {\n\t\tfor (var i = anArray.length - 1; i >= 0; i--) {\n\t\t\tif (anArray[i] === obj) {\n\t\t\t\tanArray.splice(i, 1);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t},\n\n\t//Internal function for removing a marker from everything.\n\t//dontUpdateMap: set to true if you will handle updating the map manually (for bulk functions)\n\t_removeLayer: function (marker, removeFromDistanceGrid, dontUpdateMap) {\n\t\tvar gridClusters = this._gridClusters,\n\t\t\tgridUnclustered = this._gridUnclustered,\n\t\t\tfg = this._featureGroup,\n\t\t\tmap = this._map;\n\n\t\t//Remove the marker from distance clusters it might be in\n\t\tif (removeFromDistanceGrid) {\n\t\t\tfor (var z = this._maxZoom; z >= 0; z--) {\n\t\t\t\tif (!gridUnclustered[z].removeObject(marker, map.project(marker.getLatLng(), z))) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//Work our way up the clusters removing them as we go if required\n\t\tvar cluster = marker.__parent,\n\t\t\tmarkers = cluster._markers,\n\t\t\totherMarker;\n\n\t\t//Remove the marker from the immediate parents marker list\n\t\tthis._arraySplice(markers, marker);\n\n\t\twhile (cluster) {\n\t\t\tcluster._childCount--;\n\n\t\t\tif (cluster._zoom < 0) {\n\t\t\t\t//Top level, do nothing\n\t\t\t\tbreak;\n\t\t\t} else if (removeFromDistanceGrid && cluster._childCount <= 1) { //Cluster no longer required\n\t\t\t\t//We need to push the other marker up to the parent\n\t\t\t\totherMarker = cluster._markers[0] === marker ? cluster._markers[1] : cluster._markers[0];\n\n\t\t\t\t//Update distance grid\n\t\t\t\tgridClusters[cluster._zoom].removeObject(cluster, map.project(cluster._cLatLng, cluster._zoom));\n\t\t\t\tgridUnclustered[cluster._zoom].addObject(otherMarker, map.project(otherMarker.getLatLng(), cluster._zoom));\n\n\t\t\t\t//Move otherMarker up to parent\n\t\t\t\tthis._arraySplice(cluster.__parent._childClusters, cluster);\n\t\t\t\tcluster.__parent._markers.push(otherMarker);\n\t\t\t\totherMarker.__parent = cluster.__parent;\n\n\t\t\t\tif (cluster._icon) {\n\t\t\t\t\t//Cluster is currently on the map, need to put the marker on the map instead\n\t\t\t\t\tfg.removeLayer(cluster);\n\t\t\t\t\tif (!dontUpdateMap) {\n\t\t\t\t\t\tfg.addLayer(otherMarker);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcluster._recalculateBounds();\n\t\t\t\tif (!dontUpdateMap || !cluster._icon) {\n\t\t\t\t\tcluster._updateIcon();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcluster = cluster.__parent;\n\t\t}\n\n\t\tdelete marker.__parent;\n\t},\n\n\t_isOrIsParent: function (el, oel) {\n\t\twhile (oel) {\n\t\t\tif (el === oel) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\toel = oel.parentNode;\n\t\t}\n\t\treturn false;\n\t},\n\n\t_propagateEvent: function (e) {\n\t\tif (e.layer instanceof L.MarkerCluster) {\n\t\t\t//Prevent multiple clustermouseover/off events if the icon is made up of stacked divs (Doesn't work in ie <= 8, no relatedTarget)\n\t\t\tif (e.originalEvent && this._isOrIsParent(e.layer._icon, e.originalEvent.relatedTarget)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.type = 'cluster' + e.type;\n\t\t}\n\n\t\tthis.fire(e.type, e);\n\t},\n\n\t//Default functionality\n\t_defaultIconCreateFunction: function (cluster) {\n\t\tvar childCount = cluster.getChildCount();\n\n\t\tvar c = ' marker-cluster-';\n\t\tif (childCount < 10) {\n\t\t\tc += 'small';\n\t\t} else if (childCount < 100) {\n\t\t\tc += 'medium';\n\t\t} else {\n\t\t\tc += 'large';\n\t\t}\n\n\t\treturn new L.DivIcon({ html: '<div><span>' + childCount + '</span></div>', className: 'marker-cluster' + c, iconSize: new L.Point(40, 40) });\n\t},\n\n\t_bindEvents: function () {\n\t\tvar map = this._map,\n\t\t    spiderfyOnMaxZoom = this.options.spiderfyOnMaxZoom,\n\t\t    showCoverageOnHover = this.options.showCoverageOnHover,\n\t\t    zoomToBoundsOnClick = this.options.zoomToBoundsOnClick;\n\n\t\t//Zoom on cluster click or spiderfy if we are at the lowest level\n\t\tif (spiderfyOnMaxZoom || zoomToBoundsOnClick) {\n\t\t\tthis.on('clusterclick', this._zoomOrSpiderfy, this);\n\t\t}\n\n\t\t//Show convex hull (boundary) polygon on mouse over\n\t\tif (showCoverageOnHover) {\n\t\t\tthis.on('clustermouseover', this._showCoverage, this);\n\t\t\tthis.on('clustermouseout', this._hideCoverage, this);\n\t\t\tmap.on('zoomend', this._hideCoverage, this);\n\t\t}\n\t},\n\n\t_zoomOrSpiderfy: function (e) {\n\t\tvar map = this._map;\n\t\tif (e.layer._bounds._northEast.equals(e.layer._bounds._southWest)) {\n\t\t\tif (this.options.spiderfyOnMaxZoom) {\n\t\t\t\te.layer.spiderfy();\n\t\t\t}\n\t\t} else if (map.getMaxZoom() === map.getZoom()) {\n\t\t\tif (this.options.spiderfyOnMaxZoom) {\n\t\t\t\te.layer.spiderfy();\n\t\t\t}\n\t\t} else if (this.options.zoomToBoundsOnClick) {\n\t\t\te.layer.zoomToBounds();\n\t\t}\n\n\t\t// Focus the map again for keyboard users.\n\t\tif (e.originalEvent && e.originalEvent.keyCode === 13) {\n\t\t\tmap._container.focus();\n\t\t}\n\t},\n\n\t_showCoverage: function (e) {\n\t\tvar map = this._map;\n\t\tif (this._inZoomAnimation) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._shownPolygon) {\n\t\t\tmap.removeLayer(this._shownPolygon);\n\t\t}\n\t\tif (e.layer.getChildCount() > 2 && e.layer !== this._spiderfied) {\n\t\t\tthis._shownPolygon = new L.Polygon(e.layer.getConvexHull(), this.options.polygonOptions);\n\t\t\tmap.addLayer(this._shownPolygon);\n\t\t}\n\t},\n\n\t_hideCoverage: function () {\n\t\tif (this._shownPolygon) {\n\t\t\tthis._map.removeLayer(this._shownPolygon);\n\t\t\tthis._shownPolygon = null;\n\t\t}\n\t},\n\n\t_unbindEvents: function () {\n\t\tvar spiderfyOnMaxZoom = this.options.spiderfyOnMaxZoom,\n\t\t\tshowCoverageOnHover = this.options.showCoverageOnHover,\n\t\t\tzoomToBoundsOnClick = this.options.zoomToBoundsOnClick,\n\t\t\tmap = this._map;\n\n\t\tif (spiderfyOnMaxZoom || zoomToBoundsOnClick) {\n\t\t\tthis.off('clusterclick', this._zoomOrSpiderfy, this);\n\t\t}\n\t\tif (showCoverageOnHover) {\n\t\t\tthis.off('clustermouseover', this._showCoverage, this);\n\t\t\tthis.off('clustermouseout', this._hideCoverage, this);\n\t\t\tmap.off('zoomend', this._hideCoverage, this);\n\t\t}\n\t},\n\n\t_zoomEnd: function () {\n\t\tif (!this._map) { //May have been removed from the map by a zoomEnd handler\n\t\t\treturn;\n\t\t}\n\t\tthis._mergeSplitClusters();\n\n\t\tthis._zoom = this._map._zoom;\n\t\tthis._currentShownBounds = this._getExpandedVisibleBounds();\n\t},\n\n\t_moveEnd: function () {\n\t\tif (this._inZoomAnimation) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar newBounds = this._getExpandedVisibleBounds();\n\n\t\tthis._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, this._zoom, newBounds);\n\t\tthis._topClusterLevel._recursivelyAddChildrenToMap(null, this._map._zoom, newBounds);\n\n\t\tthis._currentShownBounds = newBounds;\n\t\treturn;\n\t},\n\n\t_generateInitialClusters: function () {\n\t\tvar maxZoom = this._map.getMaxZoom(),\n\t\t\tradius = this.options.maxClusterRadius,\n\t\t\tradiusFn = radius;\n\t\n\t\t//If we just set maxClusterRadius to a single number, we need to create\n\t\t//a simple function to return that number. Otherwise, we just have to\n\t\t//use the function we've passed in.\n\t\tif (typeof radius !== \"function\") {\n\t\t\tradiusFn = function () { return radius; };\n\t\t}\n\n\t\tif (this.options.disableClusteringAtZoom) {\n\t\t\tmaxZoom = this.options.disableClusteringAtZoom - 1;\n\t\t}\n\t\tthis._maxZoom = maxZoom;\n\t\tthis._gridClusters = {};\n\t\tthis._gridUnclustered = {};\n\t\n\t\t//Set up DistanceGrids for each zoom\n\t\tfor (var zoom = maxZoom; zoom >= 0; zoom--) {\n\t\t\tthis._gridClusters[zoom] = new L.DistanceGrid(radiusFn(zoom));\n\t\t\tthis._gridUnclustered[zoom] = new L.DistanceGrid(radiusFn(zoom));\n\t\t}\n\n\t\tthis._topClusterLevel = new L.MarkerCluster(this, -1);\n\t},\n\n\t//Zoom: Zoom to start adding at (Pass this._maxZoom to start at the bottom)\n\t_addLayer: function (layer, zoom) {\n\t\tvar gridClusters = this._gridClusters,\n\t\t    gridUnclustered = this._gridUnclustered,\n\t\t    markerPoint, z;\n\n\t\tif (this.options.singleMarkerMode) {\n\t\t\tlayer.options.icon = this.options.iconCreateFunction({\n\t\t\t\tgetChildCount: function () {\n\t\t\t\t\treturn 1;\n\t\t\t\t},\n\t\t\t\tgetAllChildMarkers: function () {\n\t\t\t\t\treturn [layer];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//Find the lowest zoom level to slot this one in\n\t\tfor (; zoom >= 0; zoom--) {\n\t\t\tmarkerPoint = this._map.project(layer.getLatLng(), zoom); // calculate pixel position\n\n\t\t\t//Try find a cluster close by\n\t\t\tvar closest = gridClusters[zoom].getNearObject(markerPoint);\n\t\t\tif (closest) {\n\t\t\t\tclosest._addChild(layer);\n\t\t\t\tlayer.__parent = closest;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Try find a marker close by to form a new cluster with\n\t\t\tclosest = gridUnclustered[zoom].getNearObject(markerPoint);\n\t\t\tif (closest) {\n\t\t\t\tvar parent = closest.__parent;\n\t\t\t\tif (parent) {\n\t\t\t\t\tthis._removeLayer(closest, false);\n\t\t\t\t}\n\n\t\t\t\t//Create new cluster with these 2 in it\n\n\t\t\t\tvar newCluster = new L.MarkerCluster(this, zoom, closest, layer);\n\t\t\t\tgridClusters[zoom].addObject(newCluster, this._map.project(newCluster._cLatLng, zoom));\n\t\t\t\tclosest.__parent = newCluster;\n\t\t\t\tlayer.__parent = newCluster;\n\n\t\t\t\t//First create any new intermediate parent clusters that don't exist\n\t\t\t\tvar lastParent = newCluster;\n\t\t\t\tfor (z = zoom - 1; z > parent._zoom; z--) {\n\t\t\t\t\tlastParent = new L.MarkerCluster(this, z, lastParent);\n\t\t\t\t\tgridClusters[z].addObject(lastParent, this._map.project(closest.getLatLng(), z));\n\t\t\t\t}\n\t\t\t\tparent._addChild(lastParent);\n\n\t\t\t\t//Remove closest from this zoom level and any above that it is in, replace with newCluster\n\t\t\t\tfor (z = zoom; z >= 0; z--) {\n\t\t\t\t\tif (!gridUnclustered[z].removeObject(closest, this._map.project(closest.getLatLng(), z))) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Didn't manage to cluster in at this zoom, record us as a marker here and continue upwards\n\t\t\tgridUnclustered[zoom].addObject(layer, markerPoint);\n\t\t}\n\n\t\t//Didn't get in anything, add us to the top\n\t\tthis._topClusterLevel._addChild(layer);\n\t\tlayer.__parent = this._topClusterLevel;\n\t\treturn;\n\t},\n\n\t//Enqueue code to fire after the marker expand/contract has happened\n\t_enqueue: function (fn) {\n\t\tthis._queue.push(fn);\n\t\tif (!this._queueTimeout) {\n\t\t\tthis._queueTimeout = setTimeout(L.bind(this._processQueue, this), 300);\n\t\t}\n\t},\n\t_processQueue: function () {\n\t\tfor (var i = 0; i < this._queue.length; i++) {\n\t\t\tthis._queue[i].call(this);\n\t\t}\n\t\tthis._queue.length = 0;\n\t\tclearTimeout(this._queueTimeout);\n\t\tthis._queueTimeout = null;\n\t},\n\n\t//Merge and split any existing clusters that are too big or small\n\t_mergeSplitClusters: function () {\n\n\t\t//Incase we are starting to split before the animation finished\n\t\tthis._processQueue();\n\n\t\tif (this._zoom < this._map._zoom && this._currentShownBounds.intersects(this._getExpandedVisibleBounds())) { //Zoom in, split\n\t\t\tthis._animationStart();\n\t\t\t//Remove clusters now off screen\n\t\t\tthis._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, this._zoom, this._getExpandedVisibleBounds());\n\n\t\t\tthis._animationZoomIn(this._zoom, this._map._zoom);\n\n\t\t} else if (this._zoom > this._map._zoom) { //Zoom out, merge\n\t\t\tthis._animationStart();\n\n\t\t\tthis._animationZoomOut(this._zoom, this._map._zoom);\n\t\t} else {\n\t\t\tthis._moveEnd();\n\t\t}\n\t},\n\n\t//Gets the maps visible bounds expanded in each direction by the size of the screen (so the user cannot see an area we do not cover in one pan)\n\t_getExpandedVisibleBounds: function () {\n\t\tif (!this.options.removeOutsideVisibleBounds) {\n\t\t\treturn this._map.getBounds();\n\t\t}\n\n\t\tvar map = this._map,\n\t\t\tbounds = map.getBounds(),\n\t\t\tsw = bounds._southWest,\n\t\t\tne = bounds._northEast,\n\t\t\tlatDiff = L.Browser.mobile ? 0 : Math.abs(sw.lat - ne.lat),\n\t\t\tlngDiff = L.Browser.mobile ? 0 : Math.abs(sw.lng - ne.lng);\n\n\t\treturn new L.LatLngBounds(\n\t\t\tnew L.LatLng(sw.lat - latDiff, sw.lng - lngDiff, true),\n\t\t\tnew L.LatLng(ne.lat + latDiff, ne.lng + lngDiff, true));\n\t},\n\n\t//Shared animation code\n\t_animationAddLayerNonAnimated: function (layer, newCluster) {\n\t\tif (newCluster === layer) {\n\t\t\tthis._featureGroup.addLayer(layer);\n\t\t} else if (newCluster._childCount === 2) {\n\t\t\tnewCluster._addToMap();\n\n\t\t\tvar markers = newCluster.getAllChildMarkers();\n\t\t\tthis._featureGroup.removeLayer(markers[0]);\n\t\t\tthis._featureGroup.removeLayer(markers[1]);\n\t\t} else {\n\t\t\tnewCluster._updateIcon();\n\t\t}\n\t}\n});\n\nL.MarkerClusterGroup.include(!L.DomUtil.TRANSITION ? {\n\n\t//Non Animated versions of everything\n\t_animationStart: function () {\n\t\t//Do nothing...\n\t},\n\t_animationZoomIn: function (previousZoomLevel, newZoomLevel) {\n\t\tthis._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, previousZoomLevel);\n\t\tthis._topClusterLevel._recursivelyAddChildrenToMap(null, newZoomLevel, this._getExpandedVisibleBounds());\n\n\t\t//We didn't actually animate, but we use this event to mean \"clustering animations have finished\"\n\t\tthis.fire('animationend');\n\t},\n\t_animationZoomOut: function (previousZoomLevel, newZoomLevel) {\n\t\tthis._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, previousZoomLevel);\n\t\tthis._topClusterLevel._recursivelyAddChildrenToMap(null, newZoomLevel, this._getExpandedVisibleBounds());\n\n\t\t//We didn't actually animate, but we use this event to mean \"clustering animations have finished\"\n\t\tthis.fire('animationend');\n\t},\n\t_animationAddLayer: function (layer, newCluster) {\n\t\tthis._animationAddLayerNonAnimated(layer, newCluster);\n\t}\n} : {\n\n\t//Animated versions here\n\t_animationStart: function () {\n\t\tthis._map._mapPane.className += ' leaflet-cluster-anim';\n\t\tthis._inZoomAnimation++;\n\t},\n\t_animationEnd: function () {\n\t\tif (this._map) {\n\t\t\tthis._map._mapPane.className = this._map._mapPane.className.replace(' leaflet-cluster-anim', '');\n\t\t}\n\t\tthis._inZoomAnimation--;\n\t\tthis.fire('animationend');\n\t},\n\t_animationZoomIn: function (previousZoomLevel, newZoomLevel) {\n\t\tvar bounds = this._getExpandedVisibleBounds(),\n\t\t    fg = this._featureGroup,\n\t\t    i;\n\n\t\t//Add all children of current clusters to map and remove those clusters from map\n\t\tthis._topClusterLevel._recursively(bounds, previousZoomLevel, 0, function (c) {\n\t\t\tvar startPos = c._latlng,\n\t\t\t\tmarkers = c._markers,\n\t\t\t\tm;\n\n\t\t\tif (!bounds.contains(startPos)) {\n\t\t\t\tstartPos = null;\n\t\t\t}\n\n\t\t\tif (c._isSingleParent() && previousZoomLevel + 1 === newZoomLevel) { //Immediately add the new child and remove us\n\t\t\t\tfg.removeLayer(c);\n\t\t\t\tc._recursivelyAddChildrenToMap(null, newZoomLevel, bounds);\n\t\t\t} else {\n\t\t\t\t//Fade out old cluster\n\t\t\t\tc.clusterHide();\n\t\t\t\tc._recursivelyAddChildrenToMap(startPos, newZoomLevel, bounds);\n\t\t\t}\n\n\t\t\t//Remove all markers that aren't visible any more\n\t\t\t//TODO: Do we actually need to do this on the higher levels too?\n\t\t\tfor (i = markers.length - 1; i >= 0; i--) {\n\t\t\t\tm = markers[i];\n\t\t\t\tif (!bounds.contains(m._latlng)) {\n\t\t\t\t\tfg.removeLayer(m);\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\tthis._forceLayout();\n\n\t\t//Update opacities\n\t\tthis._topClusterLevel._recursivelyBecomeVisible(bounds, newZoomLevel);\n\t\t//TODO Maybe? Update markers in _recursivelyBecomeVisible\n\t\tfg.eachLayer(function (n) {\n\t\t\tif (!(n instanceof L.MarkerCluster) && n._icon) {\n\t\t\t\tn.clusterShow();\n\t\t\t}\n\t\t});\n\n\t\t//update the positions of the just added clusters/markers\n\t\tthis._topClusterLevel._recursively(bounds, previousZoomLevel, newZoomLevel, function (c) {\n\t\t\tc._recursivelyRestoreChildPositions(newZoomLevel);\n\t\t});\n\n\t\t//Remove the old clusters and close the zoom animation\n\t\tthis._enqueue(function () {\n\t\t\t//update the positions of the just added clusters/markers\n\t\t\tthis._topClusterLevel._recursively(bounds, previousZoomLevel, 0, function (c) {\n\t\t\t\tfg.removeLayer(c);\n\t\t\t\tc.clusterShow();\n\t\t\t});\n\n\t\t\tthis._animationEnd();\n\t\t});\n\t},\n\n\t_animationZoomOut: function (previousZoomLevel, newZoomLevel) {\n\t\tthis._animationZoomOutSingle(this._topClusterLevel, previousZoomLevel - 1, newZoomLevel);\n\n\t\t//Need to add markers for those that weren't on the map before but are now\n\t\tthis._topClusterLevel._recursivelyAddChildrenToMap(null, newZoomLevel, this._getExpandedVisibleBounds());\n\t\t//Remove markers that were on the map before but won't be now\n\t\tthis._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds, previousZoomLevel, this._getExpandedVisibleBounds());\n\t},\n\t_animationZoomOutSingle: function (cluster, previousZoomLevel, newZoomLevel) {\n\t\tvar bounds = this._getExpandedVisibleBounds();\n\n\t\t//Animate all of the markers in the clusters to move to their cluster center point\n\t\tcluster._recursivelyAnimateChildrenInAndAddSelfToMap(bounds, previousZoomLevel + 1, newZoomLevel);\n\n\t\tvar me = this;\n\n\t\t//Update the opacity (If we immediately set it they won't animate)\n\t\tthis._forceLayout();\n\t\tcluster._recursivelyBecomeVisible(bounds, newZoomLevel);\n\n\t\t//TODO: Maybe use the transition timing stuff to make this more reliable\n\t\t//When the animations are done, tidy up\n\t\tthis._enqueue(function () {\n\n\t\t\t//This cluster stopped being a cluster before the timeout fired\n\t\t\tif (cluster._childCount === 1) {\n\t\t\t\tvar m = cluster._markers[0];\n\t\t\t\t//If we were in a cluster animation at the time then the opacity and position of our child could be wrong now, so fix it\n\t\t\t\tm.setLatLng(m.getLatLng());\n\t\t\t\tif (m.clusterShow) {\n\t\t\t\t\tm.clusterShow();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcluster._recursively(bounds, newZoomLevel, 0, function (c) {\n\t\t\t\t\tc._recursivelyRemoveChildrenFromMap(bounds, previousZoomLevel + 1);\n\t\t\t\t});\n\t\t\t}\n\t\t\tme._animationEnd();\n\t\t});\n\t},\n\t_animationAddLayer: function (layer, newCluster) {\n\t\tvar me = this,\n\t\t\tfg = this._featureGroup;\n\n\t\tfg.addLayer(layer);\n\t\tif (newCluster !== layer) {\n\t\t\tif (newCluster._childCount > 2) { //Was already a cluster\n\n\t\t\t\tnewCluster._updateIcon();\n\t\t\t\tthis._forceLayout();\n\t\t\t\tthis._animationStart();\n\n\t\t\t\tlayer._setPos(this._map.latLngToLayerPoint(newCluster.getLatLng()));\n\t\t\t\tlayer.clusterHide();\n\n\t\t\t\tthis._enqueue(function () {\n\t\t\t\t\tfg.removeLayer(layer);\n\t\t\t\t\tlayer.clusterShow();\n\n\t\t\t\t\tme._animationEnd();\n\t\t\t\t});\n\n\t\t\t} else { //Just became a cluster\n\t\t\t\tthis._forceLayout();\n\n\t\t\t\tme._animationStart();\n\t\t\t\tme._animationZoomOutSingle(newCluster, this._map.getMaxZoom(), this._map.getZoom());\n\t\t\t}\n\t\t}\n\t},\n\n\t//Force a browser layout of stuff in the map\n\t// Should apply the current opacity and location to all elements so we can update them again for an animation\n\t_forceLayout: function () {\n\t\t//In my testing this works, infact offsetWidth of any element seems to work.\n\t\t//Could loop all this._layers and do this for each _icon if it stops working\n\n\t\tL.Util.falseFn(document.body.offsetWidth);\n\t}\n});\n\nL.markerClusterGroup = function (options) {\n\treturn new L.MarkerClusterGroup(options);\n};\n\n\nL.MarkerCluster = L.Marker.extend({\n\tinitialize: function (group, zoom, a, b) {\n\n\t\tL.Marker.prototype.initialize.call(this, a ? (a._cLatLng || a.getLatLng()) : new L.LatLng(0, 0), { icon: this });\n\n\n\t\tthis._group = group;\n\t\tthis._zoom = zoom;\n\n\t\tthis._markers = [];\n\t\tthis._childClusters = [];\n\t\tthis._childCount = 0;\n\t\tthis._iconNeedsUpdate = true;\n\n\t\tthis._bounds = new L.LatLngBounds();\n\n\t\tif (a) {\n\t\t\tthis._addChild(a);\n\t\t}\n\t\tif (b) {\n\t\t\tthis._addChild(b);\n\t\t}\n\t},\n\n\t//Recursively retrieve all child markers of this cluster\n\tgetAllChildMarkers: function (storageArray) {\n\t\tstorageArray = storageArray || [];\n\n\t\tfor (var i = this._childClusters.length - 1; i >= 0; i--) {\n\t\t\tthis._childClusters[i].getAllChildMarkers(storageArray);\n\t\t}\n\n\t\tfor (var j = this._markers.length - 1; j >= 0; j--) {\n\t\t\tstorageArray.push(this._markers[j]);\n\t\t}\n\n\t\treturn storageArray;\n\t},\n\n\t//Returns the count of how many child markers we have\n\tgetChildCount: function () {\n\t\treturn this._childCount;\n\t},\n\n\t//Zoom to the minimum of showing all of the child markers, or the extents of this cluster\n\tzoomToBounds: function () {\n\t\tvar childClusters = this._childClusters.slice(),\n\t\t\tmap = this._group._map,\n\t\t\tboundsZoom = map.getBoundsZoom(this._bounds),\n\t\t\tzoom = this._zoom + 1,\n\t\t\tmapZoom = map.getZoom(),\n\t\t\ti;\n\n\t\t//calculate how far we need to zoom down to see all of the markers\n\t\twhile (childClusters.length > 0 && boundsZoom > zoom) {\n\t\t\tzoom++;\n\t\t\tvar newClusters = [];\n\t\t\tfor (i = 0; i < childClusters.length; i++) {\n\t\t\t\tnewClusters = newClusters.concat(childClusters[i]._childClusters);\n\t\t\t}\n\t\t\tchildClusters = newClusters;\n\t\t}\n\n\t\tif (boundsZoom > zoom) {\n\t\t\tthis._group._map.setView(this._latlng, zoom);\n\t\t} else if (boundsZoom <= mapZoom) { //If fitBounds wouldn't zoom us down, zoom us down instead\n\t\t\tthis._group._map.setView(this._latlng, mapZoom + 1);\n\t\t} else {\n\t\t\tthis._group._map.fitBounds(this._bounds);\n\t\t}\n\t},\n\n\tgetBounds: function () {\n\t\tvar bounds = new L.LatLngBounds();\n\t\tbounds.extend(this._bounds);\n\t\treturn bounds;\n\t},\n\n\t_updateIcon: function () {\n\t\tthis._iconNeedsUpdate = true;\n\t\tif (this._icon) {\n\t\t\tthis.setIcon(this);\n\t\t}\n\t},\n\n\t//Cludge for Icon, we pretend to be an icon for performance\n\tcreateIcon: function () {\n\t\tif (this._iconNeedsUpdate) {\n\t\t\tthis._iconObj = this._group.options.iconCreateFunction(this);\n\t\t\tthis._iconNeedsUpdate = false;\n\t\t}\n\t\treturn this._iconObj.createIcon();\n\t},\n\tcreateShadow: function () {\n\t\treturn this._iconObj.createShadow();\n\t},\n\n\n\t_addChild: function (new1, isNotificationFromChild) {\n\n\t\tthis._iconNeedsUpdate = true;\n\t\tthis._expandBounds(new1);\n\n\t\tif (new1 instanceof L.MarkerCluster) {\n\t\t\tif (!isNotificationFromChild) {\n\t\t\t\tthis._childClusters.push(new1);\n\t\t\t\tnew1.__parent = this;\n\t\t\t}\n\t\t\tthis._childCount += new1._childCount;\n\t\t} else {\n\t\t\tif (!isNotificationFromChild) {\n\t\t\t\tthis._markers.push(new1);\n\t\t\t}\n\t\t\tthis._childCount++;\n\t\t}\n\n\t\tif (this.__parent) {\n\t\t\tthis.__parent._addChild(new1, true);\n\t\t}\n\t},\n\n\t//Expand our bounds and tell our parent to\n\t_expandBounds: function (marker) {\n\t\tvar addedCount,\n\t\t    addedLatLng = marker._wLatLng || marker._latlng;\n\n\t\tif (marker instanceof L.MarkerCluster) {\n\t\t\tthis._bounds.extend(marker._bounds);\n\t\t\taddedCount = marker._childCount;\n\t\t} else {\n\t\t\tthis._bounds.extend(addedLatLng);\n\t\t\taddedCount = 1;\n\t\t}\n\n\t\tif (!this._cLatLng) {\n\t\t\t// when clustering, take position of the first point as the cluster center\n\t\t\tthis._cLatLng = marker._cLatLng || addedLatLng;\n\t\t}\n\n\t\t// when showing clusters, take weighted average of all points as cluster center\n\t\tvar totalCount = this._childCount + addedCount;\n\n\t\t//Calculate weighted latlng for display\n\t\tif (!this._wLatLng) {\n\t\t\tthis._latlng = this._wLatLng = new L.LatLng(addedLatLng.lat, addedLatLng.lng);\n\t\t} else {\n\t\t\tthis._wLatLng.lat = (addedLatLng.lat * addedCount + this._wLatLng.lat * this._childCount) / totalCount;\n\t\t\tthis._wLatLng.lng = (addedLatLng.lng * addedCount + this._wLatLng.lng * this._childCount) / totalCount;\n\t\t}\n\t},\n\n\t//Set our markers position as given and add it to the map\n\t_addToMap: function (startPos) {\n\t\tif (startPos) {\n\t\t\tthis._backupLatlng = this._latlng;\n\t\t\tthis.setLatLng(startPos);\n\t\t}\n\t\tthis._group._featureGroup.addLayer(this);\n\t},\n\n\t_recursivelyAnimateChildrenIn: function (bounds, center, maxZoom) {\n\t\tthis._recursively(bounds, 0, maxZoom - 1,\n\t\t\tfunction (c) {\n\t\t\t\tvar markers = c._markers,\n\t\t\t\t\ti, m;\n\t\t\t\tfor (i = markers.length - 1; i >= 0; i--) {\n\t\t\t\t\tm = markers[i];\n\n\t\t\t\t\t//Only do it if the icon is still on the map\n\t\t\t\t\tif (m._icon) {\n\t\t\t\t\t\tm._setPos(center);\n\t\t\t\t\t\tm.clusterHide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (c) {\n\t\t\t\tvar childClusters = c._childClusters,\n\t\t\t\t\tj, cm;\n\t\t\t\tfor (j = childClusters.length - 1; j >= 0; j--) {\n\t\t\t\t\tcm = childClusters[j];\n\t\t\t\t\tif (cm._icon) {\n\t\t\t\t\t\tcm._setPos(center);\n\t\t\t\t\t\tcm.clusterHide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t},\n\n\t_recursivelyAnimateChildrenInAndAddSelfToMap: function (bounds, previousZoomLevel, newZoomLevel) {\n\t\tthis._recursively(bounds, newZoomLevel, 0,\n\t\t\tfunction (c) {\n\t\t\t\tc._recursivelyAnimateChildrenIn(bounds, c._group._map.latLngToLayerPoint(c.getLatLng()).round(), previousZoomLevel);\n\n\t\t\t\t//TODO: depthToAnimateIn affects _isSingleParent, if there is a multizoom we may/may not be.\n\t\t\t\t//As a hack we only do a animation free zoom on a single level zoom, if someone does multiple levels then we always animate\n\t\t\t\tif (c._isSingleParent() && previousZoomLevel - 1 === newZoomLevel) {\n\t\t\t\t\tc.clusterShow();\n\t\t\t\t\tc._recursivelyRemoveChildrenFromMap(bounds, previousZoomLevel); //Immediately remove our children as we are replacing them. TODO previousBounds not bounds\n\t\t\t\t} else {\n\t\t\t\t\tc.clusterHide();\n\t\t\t\t}\n\n\t\t\t\tc._addToMap();\n\t\t\t}\n\t\t);\n\t},\n\n\t_recursivelyBecomeVisible: function (bounds, zoomLevel) {\n\t\tthis._recursively(bounds, 0, zoomLevel, null, function (c) {\n\t\t\tc.clusterShow();\n\t\t});\n\t},\n\n\t_recursivelyAddChildrenToMap: function (startPos, zoomLevel, bounds) {\n\t\tthis._recursively(bounds, -1, zoomLevel,\n\t\t\tfunction (c) {\n\t\t\t\tif (zoomLevel === c._zoom) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//Add our child markers at startPos (so they can be animated out)\n\t\t\t\tfor (var i = c._markers.length - 1; i >= 0; i--) {\n\t\t\t\t\tvar nm = c._markers[i];\n\n\t\t\t\t\tif (!bounds.contains(nm._latlng)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (startPos) {\n\t\t\t\t\t\tnm._backupLatlng = nm.getLatLng();\n\n\t\t\t\t\t\tnm.setLatLng(startPos);\n\t\t\t\t\t\tif (nm.clusterHide) {\n\t\t\t\t\t\t\tnm.clusterHide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tc._group._featureGroup.addLayer(nm);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (c) {\n\t\t\t\tc._addToMap(startPos);\n\t\t\t}\n\t\t);\n\t},\n\n\t_recursivelyRestoreChildPositions: function (zoomLevel) {\n\t\t//Fix positions of child markers\n\t\tfor (var i = this._markers.length - 1; i >= 0; i--) {\n\t\t\tvar nm = this._markers[i];\n\t\t\tif (nm._backupLatlng) {\n\t\t\t\tnm.setLatLng(nm._backupLatlng);\n\t\t\t\tdelete nm._backupLatlng;\n\t\t\t}\n\t\t}\n\n\t\tif (zoomLevel - 1 === this._zoom) {\n\t\t\t//Reposition child clusters\n\t\t\tfor (var j = this._childClusters.length - 1; j >= 0; j--) {\n\t\t\t\tthis._childClusters[j]._restorePosition();\n\t\t\t}\n\t\t} else {\n\t\t\tfor (var k = this._childClusters.length - 1; k >= 0; k--) {\n\t\t\t\tthis._childClusters[k]._recursivelyRestoreChildPositions(zoomLevel);\n\t\t\t}\n\t\t}\n\t},\n\n\t_restorePosition: function () {\n\t\tif (this._backupLatlng) {\n\t\t\tthis.setLatLng(this._backupLatlng);\n\t\t\tdelete this._backupLatlng;\n\t\t}\n\t},\n\n\t//exceptBounds: If set, don't remove any markers/clusters in it\n\t_recursivelyRemoveChildrenFromMap: function (previousBounds, zoomLevel, exceptBounds) {\n\t\tvar m, i;\n\t\tthis._recursively(previousBounds, -1, zoomLevel - 1,\n\t\t\tfunction (c) {\n\t\t\t\t//Remove markers at every level\n\t\t\t\tfor (i = c._markers.length - 1; i >= 0; i--) {\n\t\t\t\t\tm = c._markers[i];\n\t\t\t\t\tif (!exceptBounds || !exceptBounds.contains(m._latlng)) {\n\t\t\t\t\t\tc._group._featureGroup.removeLayer(m);\n\t\t\t\t\t\tif (m.clusterShow) {\n\t\t\t\t\t\t\tm.clusterShow();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (c) {\n\t\t\t\t//Remove child clusters at just the bottom level\n\t\t\t\tfor (i = c._childClusters.length - 1; i >= 0; i--) {\n\t\t\t\t\tm = c._childClusters[i];\n\t\t\t\t\tif (!exceptBounds || !exceptBounds.contains(m._latlng)) {\n\t\t\t\t\t\tc._group._featureGroup.removeLayer(m);\n\t\t\t\t\t\tif (m.clusterShow) {\n\t\t\t\t\t\t\tm.clusterShow();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t},\n\n\t//Run the given functions recursively to this and child clusters\n\t// boundsToApplyTo: a L.LatLngBounds representing the bounds of what clusters to recurse in to\n\t// zoomLevelToStart: zoom level to start running functions (inclusive)\n\t// zoomLevelToStop: zoom level to stop running functions (inclusive)\n\t// runAtEveryLevel: function that takes an L.MarkerCluster as an argument that should be applied on every level\n\t// runAtBottomLevel: function that takes an L.MarkerCluster as an argument that should be applied at only the bottom level\n\t_recursively: function (boundsToApplyTo, zoomLevelToStart, zoomLevelToStop, runAtEveryLevel, runAtBottomLevel) {\n\t\tvar childClusters = this._childClusters,\n\t\t    zoom = this._zoom,\n\t\t    i, c;\n\n\t\tif (zoomLevelToStart > zoom) { //Still going down to required depth, just recurse to child clusters\n\t\t\tfor (i = childClusters.length - 1; i >= 0; i--) {\n\t\t\t\tc = childClusters[i];\n\t\t\t\tif (boundsToApplyTo.intersects(c._bounds)) {\n\t\t\t\t\tc._recursively(boundsToApplyTo, zoomLevelToStart, zoomLevelToStop, runAtEveryLevel, runAtBottomLevel);\n\t\t\t\t}\n\t\t\t}\n\t\t} else { //In required depth\n\n\t\t\tif (runAtEveryLevel) {\n\t\t\t\trunAtEveryLevel(this);\n\t\t\t}\n\t\t\tif (runAtBottomLevel && this._zoom === zoomLevelToStop) {\n\t\t\t\trunAtBottomLevel(this);\n\t\t\t}\n\n\t\t\t//TODO: This loop is almost the same as above\n\t\t\tif (zoomLevelToStop > zoom) {\n\t\t\t\tfor (i = childClusters.length - 1; i >= 0; i--) {\n\t\t\t\t\tc = childClusters[i];\n\t\t\t\t\tif (boundsToApplyTo.intersects(c._bounds)) {\n\t\t\t\t\t\tc._recursively(boundsToApplyTo, zoomLevelToStart, zoomLevelToStop, runAtEveryLevel, runAtBottomLevel);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_recalculateBounds: function () {\n\t\tvar markers = this._markers,\n\t\t\tchildClusters = this._childClusters,\n\t\t\ti;\n\n\t\tthis._bounds = new L.LatLngBounds();\n\t\tdelete this._wLatLng;\n\n\t\tfor (i = markers.length - 1; i >= 0; i--) {\n\t\t\tthis._expandBounds(markers[i]);\n\t\t}\n\t\tfor (i = childClusters.length - 1; i >= 0; i--) {\n\t\t\tthis._expandBounds(childClusters[i]);\n\t\t}\n\t},\n\n\n\t//Returns true if we are the parent of only one cluster and that cluster is the same as us\n\t_isSingleParent: function () {\n\t\t//Don't need to check this._markers as the rest won't work if there are any\n\t\treturn this._childClusters.length > 0 && this._childClusters[0]._childCount === this._childCount;\n\t}\n});\n\n\n\n/*\n* Extends L.Marker to include two extra methods: clusterHide and clusterShow.\n* \n* They work as setOpacity(0) and setOpacity(1) respectively, but\n* they will remember the marker's opacity when hiding and showing it again.\n* \n*/\n\n\nL.Marker.include({\n\t\n\tclusterHide: function () {\n\t\tthis.options.opacityWhenUnclustered = this.options.opacity || 1;\n\t\treturn this.setOpacity(0);\n\t},\n\t\n\tclusterShow: function () {\n\t\tvar ret = this.setOpacity(this.options.opacity || this.options.opacityWhenUnclustered);\n\t\tdelete this.options.opacityWhenUnclustered;\n\t\treturn ret;\n\t}\n\t\n});\n\n\n\n\n\nL.DistanceGrid = function (cellSize) {\n\tthis._cellSize = cellSize;\n\tthis._sqCellSize = cellSize * cellSize;\n\tthis._grid = {};\n\tthis._objectPoint = { };\n};\n\nL.DistanceGrid.prototype = {\n\n\taddObject: function (obj, point) {\n\t\tvar x = this._getCoord(point.x),\n\t\t    y = this._getCoord(point.y),\n\t\t    grid = this._grid,\n\t\t    row = grid[y] = grid[y] || {},\n\t\t    cell = row[x] = row[x] || [],\n\t\t    stamp = L.Util.stamp(obj);\n\n\t\tthis._objectPoint[stamp] = point;\n\n\t\tcell.push(obj);\n\t},\n\n\tupdateObject: function (obj, point) {\n\t\tthis.removeObject(obj);\n\t\tthis.addObject(obj, point);\n\t},\n\n\t//Returns true if the object was found\n\tremoveObject: function (obj, point) {\n\t\tvar x = this._getCoord(point.x),\n\t\t    y = this._getCoord(point.y),\n\t\t    grid = this._grid,\n\t\t    row = grid[y] = grid[y] || {},\n\t\t    cell = row[x] = row[x] || [],\n\t\t    i, len;\n\n\t\tdelete this._objectPoint[L.Util.stamp(obj)];\n\n\t\tfor (i = 0, len = cell.length; i < len; i++) {\n\t\t\tif (cell[i] === obj) {\n\n\t\t\t\tcell.splice(i, 1);\n\n\t\t\t\tif (len === 1) {\n\t\t\t\t\tdelete row[x];\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t},\n\n\teachObject: function (fn, context) {\n\t\tvar i, j, k, len, row, cell, removed,\n\t\t    grid = this._grid;\n\n\t\tfor (i in grid) {\n\t\t\trow = grid[i];\n\n\t\t\tfor (j in row) {\n\t\t\t\tcell = row[j];\n\n\t\t\t\tfor (k = 0, len = cell.length; k < len; k++) {\n\t\t\t\t\tremoved = fn.call(context, cell[k]);\n\t\t\t\t\tif (removed) {\n\t\t\t\t\t\tk--;\n\t\t\t\t\t\tlen--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tgetNearObject: function (point) {\n\t\tvar x = this._getCoord(point.x),\n\t\t    y = this._getCoord(point.y),\n\t\t    i, j, k, row, cell, len, obj, dist,\n\t\t    objectPoint = this._objectPoint,\n\t\t    closestDistSq = this._sqCellSize,\n\t\t    closest = null;\n\n\t\tfor (i = y - 1; i <= y + 1; i++) {\n\t\t\trow = this._grid[i];\n\t\t\tif (row) {\n\n\t\t\t\tfor (j = x - 1; j <= x + 1; j++) {\n\t\t\t\t\tcell = row[j];\n\t\t\t\t\tif (cell) {\n\n\t\t\t\t\t\tfor (k = 0, len = cell.length; k < len; k++) {\n\t\t\t\t\t\t\tobj = cell[k];\n\t\t\t\t\t\t\tdist = this._sqDist(objectPoint[L.Util.stamp(obj)], point);\n\t\t\t\t\t\t\tif (dist < closestDistSq) {\n\t\t\t\t\t\t\t\tclosestDistSq = dist;\n\t\t\t\t\t\t\t\tclosest = obj;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn closest;\n\t},\n\n\t_getCoord: function (x) {\n\t\treturn Math.floor(x / this._cellSize);\n\t},\n\n\t_sqDist: function (p, p2) {\n\t\tvar dx = p2.x - p.x,\n\t\t    dy = p2.y - p.y;\n\t\treturn dx * dx + dy * dy;\n\t}\n};\n\n\n/* Copyright (c) 2012 the authors listed at the following URL, and/or\nthe authors of referenced articles or incorporated external code:\nhttp://en.literateprograms.org/Quickhull_(Javascript)?action=history&offset=20120410175256\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nRetrieved from: http://en.literateprograms.org/Quickhull_(Javascript)?oldid=18434\n*/\n\n(function () {\n\tL.QuickHull = {\n\n\t\t/*\n\t\t * @param {Object} cpt a point to be measured from the baseline\n\t\t * @param {Array} bl the baseline, as represented by a two-element\n\t\t *   array of latlng objects.\n\t\t * @returns {Number} an approximate distance measure\n\t\t */\n\t\tgetDistant: function (cpt, bl) {\n\t\t\tvar vY = bl[1].lat - bl[0].lat,\n\t\t\t\tvX = bl[0].lng - bl[1].lng;\n\t\t\treturn (vX * (cpt.lat - bl[0].lat) + vY * (cpt.lng - bl[0].lng));\n\t\t},\n\n\t\t/*\n\t\t * @param {Array} baseLine a two-element array of latlng objects\n\t\t *   representing the baseline to project from\n\t\t * @param {Array} latLngs an array of latlng objects\n\t\t * @returns {Object} the maximum point and all new points to stay\n\t\t *   in consideration for the hull.\n\t\t */\n\t\tfindMostDistantPointFromBaseLine: function (baseLine, latLngs) {\n\t\t\tvar maxD = 0,\n\t\t\t\tmaxPt = null,\n\t\t\t\tnewPoints = [],\n\t\t\t\ti, pt, d;\n\n\t\t\tfor (i = latLngs.length - 1; i >= 0; i--) {\n\t\t\t\tpt = latLngs[i];\n\t\t\t\td = this.getDistant(pt, baseLine);\n\n\t\t\t\tif (d > 0) {\n\t\t\t\t\tnewPoints.push(pt);\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (d > maxD) {\n\t\t\t\t\tmaxD = d;\n\t\t\t\t\tmaxPt = pt;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { maxPoint: maxPt, newPoints: newPoints };\n\t\t},\n\n\n\t\t/*\n\t\t * Given a baseline, compute the convex hull of latLngs as an array\n\t\t * of latLngs.\n\t\t *\n\t\t * @param {Array} latLngs\n\t\t * @returns {Array}\n\t\t */\n\t\tbuildConvexHull: function (baseLine, latLngs) {\n\t\t\tvar convexHullBaseLines = [],\n\t\t\t\tt = this.findMostDistantPointFromBaseLine(baseLine, latLngs);\n\n\t\t\tif (t.maxPoint) { // if there is still a point \"outside\" the base line\n\t\t\t\tconvexHullBaseLines =\n\t\t\t\t\tconvexHullBaseLines.concat(\n\t\t\t\t\t\tthis.buildConvexHull([baseLine[0], t.maxPoint], t.newPoints)\n\t\t\t\t\t);\n\t\t\t\tconvexHullBaseLines =\n\t\t\t\t\tconvexHullBaseLines.concat(\n\t\t\t\t\t\tthis.buildConvexHull([t.maxPoint, baseLine[1]], t.newPoints)\n\t\t\t\t\t);\n\t\t\t\treturn convexHullBaseLines;\n\t\t\t} else {  // if there is no more point \"outside\" the base line, the current base line is part of the convex hull\n\t\t\t\treturn [baseLine[0]];\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * Given an array of latlngs, compute a convex hull as an array\n\t\t * of latlngs\n\t\t *\n\t\t * @param {Array} latLngs\n\t\t * @returns {Array}\n\t\t */\n\t\tgetConvexHull: function (latLngs) {\n\t\t\t// find first baseline\n\t\t\tvar maxLat = false, minLat = false,\n\t\t\t\tmaxPt = null, minPt = null,\n\t\t\t\ti;\n\n\t\t\tfor (i = latLngs.length - 1; i >= 0; i--) {\n\t\t\t\tvar pt = latLngs[i];\n\t\t\t\tif (maxLat === false || pt.lat >= maxLat) {\n\t\t\t\t\tmaxPt = pt;\n\t\t\t\t\tmaxLat = pt.lat;\n\t\t\t\t}\n\t\t\t\tif (minLat === false || pt.lat < minLat) {\n\t\t\t\t\tminPt = pt;\n\t\t\t\t\tminLat = pt.lat;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar ch = [].concat(this.buildConvexHull([minPt, maxPt], latLngs),\n\t\t\t\t\t\t\t\tthis.buildConvexHull([maxPt, minPt], latLngs));\n\t\t\treturn ch;\n\t\t}\n\t};\n}());\n\nL.MarkerCluster.include({\n\tgetConvexHull: function () {\n\t\tvar childMarkers = this.getAllChildMarkers(),\n\t\t\tpoints = [],\n\t\t\tp, i;\n\n\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\tp = childMarkers[i].getLatLng();\n\t\t\tpoints.push(p);\n\t\t}\n\n\t\treturn L.QuickHull.getConvexHull(points);\n\t}\n});\n\n\n//This code is 100% based on https://github.com/jawj/OverlappingMarkerSpiderfier-Leaflet\n//Huge thanks to jawj for implementing it first to make my job easy :-)\n\nL.MarkerCluster.include({\n\n\t_2PI: Math.PI * 2,\n\t_circleFootSeparation: 25, //related to circumference of circle\n\t_circleStartAngle: Math.PI / 6,\n\n\t_spiralFootSeparation:  28, //related to size of spiral (experiment!)\n\t_spiralLengthStart: 11,\n\t_spiralLengthFactor: 5,\n\n\t_circleSpiralSwitchover: 9, //show spiral instead of circle from this marker count upwards.\n\t\t\t\t\t\t\t\t// 0 -> always spiral; Infinity -> always circle\n\n\tspiderfy: function () {\n\t\tif (this._group._spiderfied === this || this._group._inZoomAnimation) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar childMarkers = this.getAllChildMarkers(),\n\t\t\tgroup = this._group,\n\t\t\tmap = group._map,\n\t\t\tcenter = map.latLngToLayerPoint(this._latlng),\n\t\t\tpositions;\n\n\t\tthis._group._unspiderfy();\n\t\tthis._group._spiderfied = this;\n\n\t\t//TODO Maybe: childMarkers order by distance to center\n\n\t\tif (childMarkers.length >= this._circleSpiralSwitchover) {\n\t\t\tpositions = this._generatePointsSpiral(childMarkers.length, center);\n\t\t} else {\n\t\t\tcenter.y += 10; //Otherwise circles look wrong\n\t\t\tpositions = this._generatePointsCircle(childMarkers.length, center);\n\t\t}\n\n\t\tthis._animationSpiderfy(childMarkers, positions);\n\t},\n\n\tunspiderfy: function (zoomDetails) {\n\t\t/// <param Name=\"zoomDetails\">Argument from zoomanim if being called in a zoom animation or null otherwise</param>\n\t\tif (this._group._inZoomAnimation) {\n\t\t\treturn;\n\t\t}\n\t\tthis._animationUnspiderfy(zoomDetails);\n\n\t\tthis._group._spiderfied = null;\n\t},\n\n\t_generatePointsCircle: function (count, centerPt) {\n\t\tvar circumference = this._group.options.spiderfyDistanceMultiplier * this._circleFootSeparation * (2 + count),\n\t\t\tlegLength = circumference / this._2PI,  //radius from circumference\n\t\t\tangleStep = this._2PI / count,\n\t\t\tres = [],\n\t\t\ti, angle;\n\n\t\tres.length = count;\n\n\t\tfor (i = count - 1; i >= 0; i--) {\n\t\t\tangle = this._circleStartAngle + i * angleStep;\n\t\t\tres[i] = new L.Point(centerPt.x + legLength * Math.cos(angle), centerPt.y + legLength * Math.sin(angle))._round();\n\t\t}\n\n\t\treturn res;\n\t},\n\n\t_generatePointsSpiral: function (count, centerPt) {\n\t\tvar legLength = this._group.options.spiderfyDistanceMultiplier * this._spiralLengthStart,\n\t\t\tseparation = this._group.options.spiderfyDistanceMultiplier * this._spiralFootSeparation,\n\t\t\tlengthFactor = this._group.options.spiderfyDistanceMultiplier * this._spiralLengthFactor,\n\t\t\tangle = 0,\n\t\t\tres = [],\n\t\t\ti;\n\n\t\tres.length = count;\n\n\t\tfor (i = count - 1; i >= 0; i--) {\n\t\t\tangle += separation / legLength + i * 0.0005;\n\t\t\tres[i] = new L.Point(centerPt.x + legLength * Math.cos(angle), centerPt.y + legLength * Math.sin(angle))._round();\n\t\t\tlegLength += this._2PI * lengthFactor / angle;\n\t\t}\n\t\treturn res;\n\t},\n\n\t_noanimationUnspiderfy: function () {\n\t\tvar group = this._group,\n\t\t\tmap = group._map,\n\t\t\tfg = group._featureGroup,\n\t\t\tchildMarkers = this.getAllChildMarkers(),\n\t\t\tm, i;\n\n\t\tthis.setOpacity(1);\n\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\tm = childMarkers[i];\n\n\t\t\tfg.removeLayer(m);\n\n\t\t\tif (m._preSpiderfyLatlng) {\n\t\t\t\tm.setLatLng(m._preSpiderfyLatlng);\n\t\t\t\tdelete m._preSpiderfyLatlng;\n\t\t\t}\n\t\t\tif (m.setZIndexOffset) {\n\t\t\t\tm.setZIndexOffset(0);\n\t\t\t}\n\n\t\t\tif (m._spiderLeg) {\n\t\t\t\tmap.removeLayer(m._spiderLeg);\n\t\t\t\tdelete m._spiderLeg;\n\t\t\t}\n\t\t}\n\n\t\tgroup._spiderfied = null;\n\t}\n});\n\nL.MarkerCluster.include(!L.DomUtil.TRANSITION ? {\n\t//Non Animated versions of everything\n\t_animationSpiderfy: function (childMarkers, positions) {\n\t\tvar group = this._group,\n\t\t\tmap = group._map,\n\t\t\tfg = group._featureGroup,\n\t\t\ti, m, leg, newPos;\n\n\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\tnewPos = map.layerPointToLatLng(positions[i]);\n\t\t\tm = childMarkers[i];\n\n\t\t\tm._preSpiderfyLatlng = m._latlng;\n\t\t\tm.setLatLng(newPos);\n\t\t\tif (m.setZIndexOffset) {\n\t\t\t\tm.setZIndexOffset(1000000); //Make these appear on top of EVERYTHING\n\t\t\t}\n\n\t\t\tfg.addLayer(m);\n\n\t\t\tvar legOptions = this._group.options.spiderLegPolylineOptions;\n\t\t\tleg = new L.Polyline([this._latlng, newPos], legOptions);\n\t\t\tmap.addLayer(leg);\n\t\t\tm._spiderLeg = leg;\n\t\t}\n\t\tthis.setOpacity(0.3);\n\t\tgroup.fire('spiderfied');\n\t},\n\n\t_animationUnspiderfy: function () {\n\t\tthis._noanimationUnspiderfy();\n\t}\n} : {\n\t//Animated versions here\n\tSVG_ANIMATION: (function () {\n\t\treturn document.createElementNS('http://www.w3.org/2000/svg', 'animate').toString().indexOf('SVGAnimate') > -1;\n\t}()),\n\n\t_animationSpiderfy: function (childMarkers, positions) {\n\t\tvar me = this,\n\t\t\tgroup = this._group,\n\t\t\tmap = group._map,\n\t\t\tfg = group._featureGroup,\n\t\t\tthisLayerPos = map.latLngToLayerPoint(this._latlng),\n\t\t\ti, m, leg, newPos;\n\n\t\t//Add markers to map hidden at our center point\n\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\tm = childMarkers[i];\n\n\t\t\t//If it is a marker, add it now and we'll animate it out\n\t\t\tif (m.setOpacity) {\n\t\t\t\tm.setZIndexOffset(1000000); //Make these appear on top of EVERYTHING\n\t\t\t\tm.clusterHide();\n\t\t\t\n\t\t\t\tfg.addLayer(m);\n\n\t\t\t\tm._setPos(thisLayerPos);\n\t\t\t} else {\n\t\t\t\t//Vectors just get immediately added\n\t\t\t\tfg.addLayer(m);\n\t\t\t}\n\t\t}\n\n\t\tgroup._forceLayout();\n\t\tgroup._animationStart();\n\n\t\tvar initialLegOpacity = L.Path.SVG ? 0 : 0.3,\n\t\t\txmlns = L.Path.SVG_NS;\n\n\n\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\tnewPos = map.layerPointToLatLng(positions[i]);\n\t\t\tm = childMarkers[i];\n\n\t\t\t//Move marker to new position\n\t\t\tm._preSpiderfyLatlng = m._latlng;\n\t\t\tm.setLatLng(newPos);\n\t\t\t\n\t\t\tif (m.setOpacity) {\n\t\t\t\tm.clusterShow();\n\t\t\t}\n\n\n\t\t\t//Add Legs.\n\t\t\tvar legOptions = this._group.options.spiderLegPolylineOptions;\n\t\t\tif (legOptions.opacity === undefined) {\n\t\t\t\tlegOptions.opacity = initialLegOpacity;\n\t\t\t}\n\t\t\tleg = new L.Polyline([me._latlng, newPos], legOptions);\n\t\t\tmap.addLayer(leg);\n\t\t\tm._spiderLeg = leg;\n\n\t\t\t//Following animations don't work for canvas\n\t\t\tif (!L.Path.SVG || !this.SVG_ANIMATION) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t//How this works:\n\t\t\t//http://stackoverflow.com/questions/5924238/how-do-you-animate-an-svg-path-in-ios\n\t\t\t//http://dev.opera.com/articles/view/advanced-svg-animation-techniques/\n\n\t\t\t//Animate length\n\t\t\tvar length = leg._path.getTotalLength();\n\t\t\tleg._path.setAttribute(\"stroke-dasharray\", length + \",\" + length);\n\n\t\t\tvar anim = document.createElementNS(xmlns, \"animate\");\n\t\t\tanim.setAttribute(\"attributeName\", \"stroke-dashoffset\");\n\t\t\tanim.setAttribute(\"begin\", \"indefinite\");\n\t\t\tanim.setAttribute(\"from\", length);\n\t\t\tanim.setAttribute(\"to\", 0);\n\t\t\tanim.setAttribute(\"dur\", 0.25);\n\t\t\tleg._path.appendChild(anim);\n\t\t\tanim.beginElement();\n\n\t\t\t//Animate opacity\n\t\t\tanim = document.createElementNS(xmlns, \"animate\");\n\t\t\tanim.setAttribute(\"attributeName\", \"stroke-opacity\");\n\t\t\tanim.setAttribute(\"attributeName\", \"stroke-opacity\");\n\t\t\tanim.setAttribute(\"begin\", \"indefinite\");\n\t\t\tanim.setAttribute(\"from\", 0);\n\t\t\tanim.setAttribute(\"to\", 0.5);\n\t\t\tanim.setAttribute(\"dur\", 0.25);\n\t\t\tleg._path.appendChild(anim);\n\t\t\tanim.beginElement();\n\t\t}\n\t\tme.setOpacity(0.3);\n\n\t\t//Set the opacity of the spiderLegs back to their correct value\n\t\t// The animations above override this until they complete.\n\t\t// If the initial opacity of the spiderlegs isn't 0 then they appear before the animation starts.\n\t\tif (L.Path.SVG) {\n\t\t\tthis._group._forceLayout();\n\n\t\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\t\tm = childMarkers[i]._spiderLeg;\n\n\t\t\t\tm.options.opacity = 0.5;\n\t\t\t\tm._path.setAttribute('stroke-opacity', 0.5);\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(function () {\n\t\t\tgroup._animationEnd();\n\t\t\tgroup.fire('spiderfied');\n\t\t}, 200);\n\t},\n\n\t_animationUnspiderfy: function (zoomDetails) {\n\t\tvar group = this._group,\n\t\t\tmap = group._map,\n\t\t\tfg = group._featureGroup,\n\t\t\tthisLayerPos = zoomDetails ? map._latLngToNewLayerPoint(this._latlng, zoomDetails.zoom, zoomDetails.center) : map.latLngToLayerPoint(this._latlng),\n\t\t\tchildMarkers = this.getAllChildMarkers(),\n\t\t\tsvg = L.Path.SVG && this.SVG_ANIMATION,\n\t\t\tm, i, a;\n\n\t\tgroup._animationStart();\n\n\t\t//Make us visible and bring the child markers back in\n\t\tthis.setOpacity(1);\n\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\tm = childMarkers[i];\n\n\t\t\t//Marker was added to us after we were spidified\n\t\t\tif (!m._preSpiderfyLatlng) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t//Fix up the location to the real one\n\t\t\tm.setLatLng(m._preSpiderfyLatlng);\n\t\t\tdelete m._preSpiderfyLatlng;\n\t\t\t//Hack override the location to be our center\n\t\t\tif (m.setOpacity) {\n\t\t\t\tm._setPos(thisLayerPos);\n\t\t\t\tm.clusterHide();\n\t\t\t} else {\n\t\t\t\tfg.removeLayer(m);\n\t\t\t}\n\n\t\t\t//Animate the spider legs back in\n\t\t\tif (svg) {\n\t\t\t\ta = m._spiderLeg._path.childNodes[0];\n\t\t\t\ta.setAttribute('to', a.getAttribute('from'));\n\t\t\t\ta.setAttribute('from', 0);\n\t\t\t\ta.beginElement();\n\n\t\t\t\ta = m._spiderLeg._path.childNodes[1];\n\t\t\t\ta.setAttribute('from', 0.5);\n\t\t\t\ta.setAttribute('to', 0);\n\t\t\t\ta.setAttribute('stroke-opacity', 0);\n\t\t\t\ta.beginElement();\n\n\t\t\t\tm._spiderLeg._path.setAttribute('stroke-opacity', 0);\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(function () {\n\t\t\t//If we have only <= one child left then that marker will be shown on the map so don't remove it!\n\t\t\tvar stillThereChildCount = 0;\n\t\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\t\tm = childMarkers[i];\n\t\t\t\tif (m._spiderLeg) {\n\t\t\t\t\tstillThereChildCount++;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tfor (i = childMarkers.length - 1; i >= 0; i--) {\n\t\t\t\tm = childMarkers[i];\n\n\t\t\t\tif (!m._spiderLeg) { //Has already been unspiderfied\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\n\t\t\t\tif (m.setOpacity) {\n\t\t\t\t\tm.clusterShow();\n\t\t\t\t\tm.setZIndexOffset(0);\n\t\t\t\t}\n\n\t\t\t\tif (stillThereChildCount > 1) {\n\t\t\t\t\tfg.removeLayer(m);\n\t\t\t\t}\n\n\t\t\t\tmap.removeLayer(m._spiderLeg);\n\t\t\t\tdelete m._spiderLeg;\n\t\t\t}\n\t\t\tgroup._animationEnd();\n\t\t}, 200);\n\t}\n});\n\n\nL.MarkerClusterGroup.include({\n\t//The MarkerCluster currently spiderfied (if any)\n\t_spiderfied: null,\n\n\t_spiderfierOnAdd: function () {\n\t\tthis._map.on('click', this._unspiderfyWrapper, this);\n\n\t\tif (this._map.options.zoomAnimation) {\n\t\t\tthis._map.on('zoomstart', this._unspiderfyZoomStart, this);\n\t\t}\n\t\t//Browsers without zoomAnimation or a big zoom don't fire zoomstart\n\t\tthis._map.on('zoomend', this._noanimationUnspiderfy, this);\n\n\t\tif (L.Path.SVG && !L.Browser.touch) {\n\t\t\tthis._map._initPathRoot();\n\t\t\t//Needs to happen in the pageload, not after, or animations don't work in webkit\n\t\t\t//  http://stackoverflow.com/questions/8455200/svg-animate-with-dynamically-added-elements\n\t\t\t//Disable on touch browsers as the animation messes up on a touch zoom and isn't very noticable\n\t\t}\n\t},\n\n\t_spiderfierOnRemove: function () {\n\t\tthis._map.off('click', this._unspiderfyWrapper, this);\n\t\tthis._map.off('zoomstart', this._unspiderfyZoomStart, this);\n\t\tthis._map.off('zoomanim', this._unspiderfyZoomAnim, this);\n\n\t\tthis._unspiderfy(); //Ensure that markers are back where they should be\n\t},\n\n\n\t//On zoom start we add a zoomanim handler so that we are guaranteed to be last (after markers are animated)\n\t//This means we can define the animation they do rather than Markers doing an animation to their actual location\n\t_unspiderfyZoomStart: function () {\n\t\tif (!this._map) { //May have been removed from the map by a zoomEnd handler\n\t\t\treturn;\n\t\t}\n\n\t\tthis._map.on('zoomanim', this._unspiderfyZoomAnim, this);\n\t},\n\t_unspiderfyZoomAnim: function (zoomDetails) {\n\t\t//Wait until the first zoomanim after the user has finished touch-zooming before running the animation\n\t\tif (L.DomUtil.hasClass(this._map._mapPane, 'leaflet-touching')) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._map.off('zoomanim', this._unspiderfyZoomAnim, this);\n\t\tthis._unspiderfy(zoomDetails);\n\t},\n\n\n\t_unspiderfyWrapper: function () {\n\t\t/// <summary>_unspiderfy but passes no arguments</summary>\n\t\tthis._unspiderfy();\n\t},\n\n\t_unspiderfy: function (zoomDetails) {\n\t\tif (this._spiderfied) {\n\t\t\tthis._spiderfied.unspiderfy(zoomDetails);\n\t\t}\n\t},\n\n\t_noanimationUnspiderfy: function () {\n\t\tif (this._spiderfied) {\n\t\t\tthis._spiderfied._noanimationUnspiderfy();\n\t\t}\n\t},\n\n\t//If the given layer is currently being spiderfied then we unspiderfy it so it isn't on the map anymore etc\n\t_unspiderfyLayer: function (layer) {\n\t\tif (layer._spiderLeg) {\n\t\t\tthis._featureGroup.removeLayer(layer);\n\n\t\t\tlayer.setOpacity(1);\n\t\t\t//Position will be fixed up immediately in _animationUnspiderfy\n\t\t\tlayer.setZIndexOffset(0);\n\n\t\t\tthis._map.removeLayer(layer._spiderLeg);\n\t\t\tdelete layer._spiderLeg;\n\t\t}\n\t}\n});\n\n\n}(window, document));","/* global emp */\n\n/*\n * This file should be moved to emp-map core so it does not have to be\n * recoded or copied to each map engine.\n */\n\nemp.typeLibrary.utils = emp.typeLibrary.utils || {};\n\nemp.typeLibrary.utils.icon = {\n    offsetUnit: {\n        FRACTION: 'fraction',\n        PIXEL: 'pixels',\n        INSETPIXELS: 'insetpixels'\n    },\n    calculateOffset: function(iIconSize, sOffset, sOffsetType)\n    {\n        var iOffset = 0;\n        var iOffsetValue;\n        var dFraction;\n\n        switch (sOffsetType.toLowerCase())\n        {\n            case emp.typeLibrary.utils.icon.offsetUnit.FRACTION:\n                dFraction = parseFloat(sOffset);\n                iOffset = Math.floor(iIconSize * dFraction);\n                break;\n            case emp.typeLibrary.utils.icon.offsetUnit.PIXEL:\n                iOffsetValue = parseInt(sOffset);\n                iOffset = iOffsetValue;\n                break;\n            case emp.typeLibrary.utils.icon.offsetUnit.INSETPIXELS:\n                iOffsetValue = parseInt(sOffset);\n                iOffset = iIconSize - iOffsetValue;\n                break;\n        }\n\n        return iOffset;\n    }\n};\n\n\n","/* global leafLet */\n\nif (window.leafLet === undefined)\n{\n    leafLet = {};\n}\nleafLet.typeLibrary = {};\nleafLet.editor = {};\nleafLet.typeLibrary.airspace = {};\nleafLet.internalPrivateClass = {};\n\nleafLet.typeLibrary.objectType = {\n    OVERLAY: \"overlay\",\n    FEATURE: \"feature\",\n    WMS: \"wms\",\n    LL_CONTROL: 'leafletControl',\n    LL_DEFAULT_MAP: 'leafletDefaultMap'\n};\n\nleafLet.typeLibrary.featureType = leafLet.typeLibrary.featureType || {};\nleafLet.typeLibrary.featureType.AOI = 'aoi';","/* global L, emp, LatLon, leafLet */\nL.LEAFLET_DEFAULT_LINE_COLOR = '#0033ff';\nL.LEAFLET_DEFAULT_LINE_WEIGHT = 5;\n\nL.LatLng.fromEmpLatLon = function (oEmpLatLon) {\n    return new L.LatLng(oEmpLatLon._lat, oEmpLatLon._lon);\n};\n\nL.LatLng.prototype.toEmpLatLon = function () {\n    return new LatLon(this.lat, this.lng);\n};\n\nL.LatLng.prototype.distanceTo = function (oCoord) {\n    var oThis = this.toEmpLatLon();\n    var oThat = oCoord.toEmpLatLon();\n\n    return oThis.distanceTo(oThat) * 1000.0;\n};\n\nL.LatLng.prototype.bearingTo = function (oCoord) {\n    var oThis = this.toEmpLatLon();\n    var oThat = oCoord.toEmpLatLon();\n\n    return oThis.bearingTo(oThat);\n};\n\nL.LatLng.prototype.destinationPoint = function (brng, dist) {\n    var oThis = this.toEmpLatLon();\n    var oThat = oThis.destinationPoint(brng, dist / 1000.0);\n\n    return new L.LatLng(oThat._lat, oThat._lon, this.alt);\n};\n\nL.LatLng.prototype.moveCoordinate = function (brng, dist) {\n    var oThis = this.toEmpLatLon();\n    var oThat = oThis.destinationPoint(brng, dist / 1000.0);\n\n    this.lat = oThat._lat;\n    this.lng = oThat._lon;\n};\n\nL.LatLng.prototype.intersectLines = function (dBrng1, oCoord2, dBrng2) {\n    var oThis = this.toEmpLatLon();\n    var oThat = oCoord2.toEmpLatLon();\n    var oResult = undefined;\n\n    try {\n        oResult = LatLon.intersection(oThis, dBrng1, oThat, dBrng2);\n    } catch (error) {\n    }\n\n    if (oResult) {\n        return new L.LatLng(oResult._lat, oResult._lon);\n    }\n\n    return oResult;\n};\n\nL.LatLng.prototype.wrap = function (a, b) { // (Number, Number) -> LatLng\n    var lng = this.lng;\n\n    a = a || -180;\n    b = b || 180;\n\n    lng = (lng + b) % (b - a) + (lng < a || lng === b ? b : a);\n\n    return new L.LatLng(this.lat, lng, this.alt);\n};\n\nL.LatLng.prototype.midPointTo = function (oCoord) {\n    var dBrng = this.bearingTo(oCoord);\n    var dDist = this.distanceTo(oCoord) / 2.0;\n\n    return this.destinationPoint(dBrng, dDist);\n};\n\nL.LatLng.prototype.pointAtFractionOfDistanceTo = function (oCoord, dFraction) {\n    var dBrng = this.bearingTo(oCoord);\n    var dDist = this.distanceTo(oCoord) * dFraction;\n\n    return this.destinationPoint(dBrng, dDist);\n};\n\nL.LatLng.prototype.pointAt3QtrDistanceTo = function (oCoord) {\n    var dBrng = this.bearingTo(oCoord);\n    var dDist = this.distanceTo(oCoord) * 0.75;\n\n    return this.destinationPoint(dBrng, dDist);\n};\n\nleafLet.internalPrivateClass.EmpIcon = function () {\n    var publicInterface = {\n        createIcon: function (oldIcon) {\n            var oThis = this;\n            var img = this._createIcon('icon');\n\n            this.options.oIconImag = img;\n\n            img.onload = function () {\n                var i = img;\n                this.style.width = i.width + 'px';\n                this.style.height = i.height + 'px';\n                oThis._applyAnchorRef();\n                this.style.display = '';\n            };\n\n            img.onerror = function () {\n                var oDefaultIcon = emp.utilities.icon.getDefaultIcon(oThis.options.basePath);\n\n                oThis.options.iconSize = new L.Point(oDefaultIcon.size.width, oDefaultIcon.size.height);\n                oThis.options.iconAnchorRef = {x: oDefaultIcon.offset.x, y: oDefaultIcon.offset.y};\n                oThis.options.iconAnchorType = {x: oDefaultIcon.offset.xUnits, y: oDefaultIcon.offset.yUnits};\n\n                img.src = oDefaultIcon.iconUrl;\n            };\n            return img;\n        },\n        _applyAnchorRef: function () {\n            var oIconUtils = emp.utilities.icon;\n            var oImg = this.options.oIconImag;\n\n            if (this.options.iconAnchor) {\n                var oOffset = this.options.iconAnchor;\n                var oUnits = this.options.iconAnchorType;\n                var sXUnits = 'pixels';\n                var sYUnits = 'pixels';\n\n                if (oUnits && (typeof (oUnits.x) === 'string')) {\n                    sXUnits = oUnits.x;\n                }\n\n                if (oUnits && (typeof (oUnits.y) === 'string')) {\n                    sYUnits = oUnits.y;\n                }\n\n                oImg.style.marginLeft = oIconUtils.calculateXOffset(oImg.width, oOffset.x, sXUnits) + 'px';\n                oImg.style.marginTop = oIconUtils.calculateYOffset(oImg.height, oOffset.y, sYUnits, oIconUtils.referencePoint.TOP_LEFT) + 'px';\n            } else {\n                var oDefaultIcon = emp.utilities.icon.getDefaultIcon(this.options.basePath);\n                var iXOffset = oIconUtils.calculateXOffset(oDefaultIcon.offset.width, oDefaultIcon.offset.x.toString(), oDefaultIcon.offset.xUnits);\n                var iYOffset = oIconUtils.calculateYOffset(oDefaultIcon.offset.height, oDefaultIcon.offset.y.toString(), oDefaultIcon.offset.yUnits, oIconUtils.referencePoint.TOP_LEFT);\n\n                oImg.style.marginLeft = iXOffset + 'px';\n                oImg.style.marginTop = iYOffset + 'px';\n            }\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.EmpIcon = L.Icon.extend(leafLet.internalPrivateClass.EmpIcon());\n\n\nL.Icon.Default = L.Icon.Default.extend({\n    options: {\n        iconSize: [25, 41],\n        iconAnchor: [12, 41]\n    },\n    _getIconUrl: function (name) {\n        if (name === 'shadow') {\n            return undefined;\n        }\n        var oDefaultIcon = emp.utilities.icon.getDefaultIcon(this.options.basePath);\n        var iXOffset = emp.utilities.icon.calculateXOffset(oDefaultIcon.offset.width, oDefaultIcon.offset.x, oDefaultIcon.offset.xUnits);\n        var iYOffset = emp.utilities.icon.calculateYOffset(oDefaultIcon.offset.height, oDefaultIcon.offset.y, oDefaultIcon.offset.yUnits, emp.utilities.icon.referencePoint.BOTTOM_LEFT);\n\n        this.options.iconSize = new L.Point(oDefaultIcon.size.width, oDefaultIcon.size.height);\n        this.options.iconAnchor = new L.Point(iXOffset, iYOffset);\n\n        return oDefaultIcon.iconUrl;\n    }\n});\n\nL.Marker = L.Marker.extend({\n    options: {\n        icon: new L.Icon.Default()\n    },\n    _initInteraction: function () {\n        if (!this.options.clickable) {\n            return;\n        }\n\n        // TODO refactor into something shared with Map/Path/etc. to DRY it up\n\n        var icon = this._icon,\n                events = ['dblclick', 'mouseup', 'mousedown', 'mouseover', 'mouseout', 'contextmenu'];\n\n        L.DomUtil.addClass(icon, 'leaflet-clickable');\n        L.DomEvent.on(icon, 'click', this._onMouseClick, this);\n        L.DomEvent.on(icon, 'keypress', this._onKeyPress, this);\n\n        for (var i = 0; i < events.length; i++) {\n            L.DomEvent.on(icon, events[i], this._fireMouseEvent, this);\n        }\n\n        if (L.Handler.MarkerDrag) {\n            this.dragging = new L.Handler.MarkerDrag(this);\n\n            if (this.options.draggable) {\n                this.dragging.enable();\n            }\n        }\n    },\n    _fireMouseEvent: function (e) {\n\n        this.fire(e.type, {\n            originalEvent: e,\n            latlng: this._latlng\n        });\n\n        // TODO proper custom event propagation\n        // this line will always be called if marker is in a FeatureGroup\n        if (e.type === 'contextmenu' && this.hasEventListeners(e.type)) {\n            L.DomEvent.preventDefault(e);\n        }\n        if ((e.type !== 'mousedown') && (e.type !== 'mouseup')) {\n            L.DomEvent.stopPropagation(e);\n        } else {\n            L.DomEvent.preventDefault(e);\n        }\n    },\n    _setPos: function (pos) {\n        var oImg;\n        var sTemp;\n\n        L.DomUtil.setPosition(this._icon, pos);\n\n        if (this._shadow) {\n            L.DomUtil.setPosition(this._shadow, pos);\n        }\n\n        this._zIndex = pos.y + this.options.zIndexOffset;\n        this._resetZIndex();\n\n        oImg = this._icon;\n        sTemp = oImg.style[L.DomUtil.TRANSFORM];\n\n        sTemp = emp.helpers.isEmptyString(oImg.style[L.DomUtil.TRANSFORM]) ? '' : oImg.style[L.DomUtil.TRANSFORM];\n\n        if (!emp.helpers.isEmptyString(this.options.icon.options.heading)) {\n            sTemp += ' rotate(' + this.options.icon.options.heading + 'deg)';\n        }\n        if (!emp.helpers.isEmptyString(this.options.icon.options.scale)) {\n            sTemp += ' scale(' + this.options.icon.options.scale + ',' + this.options.icon.options.scale + ')';\n        }\n\n        oImg.style[L.DomUtil.TRANSFORM] = sTemp;\n    },\n    empSelect: function () {\n        var labelStyle = this.options.oFeature.getEngineInstanceInterface().selectLabelStyle;\n\n        if (this.options.oFeature &&\n                (this.options.oFeature.getFormat() === emp.typeLibrary.featureFormatType.MILSTD) &&\n                this.options.oFeature.isMultiPointTG()) {\n            return;\n        }\n\n        if (this.options.icon instanceof L.DivIcon) {\n            if (labelStyle) {\n                emp.$(this._icon).find('p').css('color', 'rgb(' + labelStyle.color.red + ', ' + labelStyle.color.green + ', ' + labelStyle.color.blue + ')');\n            }\n        } else if (this.options.icon instanceof L.Icon) {\n            emp.$(this._icon).addClass('icon-selected');\n        }\n    },\n    empDeselect: function () {\n        var labelStyle = this.options.oFeature.getLabelStyle();\n\n        if (this.options.oFeature &&\n                (this.options.oFeature.getFormat() === emp.typeLibrary.featureFormatType.MILSTD) &&\n                this.options.oFeature.isMultiPointTG()) {\n            return;\n        }\n\n        if (this.options.icon instanceof L.DivIcon) {\n            if (labelStyle) {\n                emp.$(this._icon).find('p').css('color', 'rgb(' + labelStyle.color.red + ', ' + labelStyle.color.green + ', ' + labelStyle.color.blue + ')');\n            }\n        } else if (this.options.icon instanceof L.Icon) {\n            emp.$(this._icon).removeClass('icon-selected');\n        }\n    }\n});\n\nL.Path = L.Path.extend({\n    _initEvents: function () {\n        if (this.options.clickable) {\n            if (L.Browser.svg || !L.Browser.vml) {\n                L.DomUtil.addClass(this._path, 'leaflet-clickable');\n            }\n\n            L.DomEvent.on(this._container, 'click', this._onMouseClick, this);\n\n            var events = ['dblclick', 'mouseup', 'mousedown', 'mouseover',\n                'mouseout', 'mousemove', 'contextmenu'];\n            for (var i = 0; i < events.length; i++) {\n                L.DomEvent.on(this._container, events[i], this._fireMouseEvent, this);\n            }\n        }\n    },\n    _updateStyle: function () {\n        if (this.options.stroke) {\n            this._path.setAttribute('stroke', this.options.color);\n            this._path.setAttribute('stroke-opacity', this.options.opacity);\n            this._path.setAttribute('stroke-width', this.options.weight + 2);\n            if (this.options.dashArray) {\n                this._path.setAttribute('stroke-dasharray', this.options.dashArray);\n            } else {\n                this._path.removeAttribute('stroke-dasharray');\n            }\n            if (this.options.lineCap) {\n                this._path.setAttribute('stroke-linecap', this.options.lineCap);\n            }\n            if (this.options.lineJoin) {\n                this._path.setAttribute('stroke-linejoin', this.options.lineJoin);\n            }\n        } else {\n            this._path.setAttribute('stroke', 'none');\n        }\n        if (this.options.fill) {\n            this._path.setAttribute('fill', this.options.fillColor || this.options.color);\n            this._path.setAttribute('fill-opacity', this.options.fillOpacity);\n        } else {\n            this._path.setAttribute('fill', 'none');\n        }\n    }\n});\n\nL.Polyline = L.Polyline.extend({\n    empSelect: function () {\n        var oSelectAttributes = this.options.oFeature.options.instanceInterface.selectAttributes;\n        this.options.tempColor = this.options.color;\n        this.options.tempWeight = this.options.weight;\n\n        //this.options.color = '#' + oSelectAttributes.color;\n        //this.options.weight = oSelectAttributes.width;\n        this.setStyle({\n            color: '#' + oSelectAttributes.color,\n            weight: oSelectAttributes.width\n        });\n    },\n    empDeselect: function () {\n        var oStyle = {};\n\n        if (this.options.hasOwnProperty('tempColor') && (!emp.util.isEmptyString(this.options.tempColor))) {\n            oStyle.color = this.options.tempColor;\n            if (oStyle.color === null) {\n                oStyle.stroke = false;\n            }\n            delete this.options['tempColor'];\n        }\n\n        if (this.options.hasOwnProperty('tempWeight') && (!isNaN(this.options.tempWeight))) {\n            oStyle.weight = this.options.tempWeight;\n            delete this.options['tempWeight'];\n        }\n\n        if (oStyle.hasOwnProperty('color') || oStyle.hasOwnProperty('weight')) {\n            this.setStyle(oStyle);\n        }\n    }\n});\n\nL.Polygon = L.Polygon.extend({\n    empSelect: function () {\n        var oSelectAttributes = this.options.oFeature.options.instanceInterface.selectAttributes;\n        this.options.tempColor = this.options.color;\n        this.options.tempWeight = this.options.weight;\n\n        //this.options.color = '#' + oSelectAttributes.color;\n        //this.options.weight = oSelectAttributes.width;\n        this.setStyle({\n            color: '#' + oSelectAttributes.color,\n            weight: oSelectAttributes.width\n        });\n    },\n    empDeselect: function () {\n        //this.options.color = this.options.tempColor;\n        //this.options.weight = this.options.tempWeight;\n        this.setStyle({\n            color: this.options.tempColor,\n            weight: this.options.tempWeight\n        });\n    }\n});\n\nL.Circle = L.Circle.extend({\n    empSelect: function () {\n        var oSelectAttributes = this.options.oFeature.options.instanceInterface.selectAttributes;\n        this.options.tempColor = this.options.color;\n        this.options.tempWeight = this.options.weight;\n\n        //this.options.color = '#' + oSelectAttributes.color;\n        //this.options.weight = oSelectAttributes.width;\n        this.setStyle({\n            color: '#' + oSelectAttributes.color,\n            weight: oSelectAttributes.width\n        });\n    },\n    empDeselect: function () {\n        //this.options.color = this.options.tempColor;\n        //this.options.weight = this.options.tempWeight;\n        this.setStyle({\n            color: this.options.tempColor,\n            weight: this.options.tempWeight\n        });\n    }\n});\n\nL.MultiPolyline = L.FeatureGroup.extend({\n    initialize: function (latlngs, options) {\n        this._layers = {};\n        this._options = options;\n        this.setLatLngs(latlngs);\n    },\n    setLatLngs: function (latlngs) {\n        var i = 0,\n                len = latlngs.length;\n\n        this.eachLayer(function (layer) {\n            if (i < len) {\n                layer.setLatLngs(latlngs[i++]);\n            } else {\n                this.removeLayer(layer);\n            }\n        }, this);\n\n        while (i < len) {\n            this.addLayer(new L.Polyline(latlngs[i++], this._options));\n        }\n\n        return this;\n    },\n    getLatLngs: function () {\n        var latlngs = [];\n\n        this.eachLayer(function (layer) {\n            latlngs.push(layer.getLatLngs());\n        });\n\n        return latlngs;\n    }\n});\n\nL.MultiPolygon = L.FeatureGroup.extend({\n    initialize: function (latlngs, options) {\n        this._layers = {};\n        this._options = options;\n        this.setLatLngs(latlngs);\n    },\n    setLatLngs: function (latlngs) {\n        var i = 0,\n                len = latlngs.length;\n\n        this.eachLayer(function (layer) {\n            if (i < len) {\n                layer.setLatLngs(latlngs[i++]);\n            } else {\n                this.removeLayer(layer);\n            }\n        }, this);\n\n        while (i < len) {\n            this.addLayer(new L.Polygon(latlngs[i++], this._options));\n        }\n\n        return this;\n    },\n    getLatLngs: function () {\n        var latlngs = [];\n\n        this.eachLayer(function (layer) {\n            latlngs.push(layer.getLatLngs());\n        });\n\n        return latlngs;\n    }\n});\n\nL.multiPolyline = function (latlngs, options) {\n    return new L.MultiPolyline(latlngs, options);\n};\n\nL.multiPolygon = function (latlngs, options) {\n    return new L.MultiPolygon(latlngs, options);\n};\n\n\nL.TileLayer = L.TileLayer.extend({\n    getTileUrl: function (tilePoint) {\n        var sURL = L.Util.template(this._url, L.extend({\n            s: this._getSubdomain(tilePoint),\n            z: tilePoint.z,\n            x: tilePoint.x,\n            y: tilePoint.y\n        }, this.options));\n\n        if (this.options.isDefaultMap) {\n            if (this.options.instanceInterface.useProxyForDefault) {\n                sURL = emp.util.config.getProxyUrl() + \"?\" + \"mime=image/*&url=\" + encodeURIComponent(sURL);\n            }\n        } else {\n            if (this.options.useProxy) {\n                sURL = emp.util.config.getProxyUrl() + \"?\" + \"mime=image/*&url=\" + encodeURIComponent(sURL);\n            }\n        }\n\n        return sURL;\n    }\n});\n\nL.TileLayer.WMS = L.TileLayer.WMS.extend({\n    getTileUrl: function (tilePoint) { // (Point, Number) -> String\n\n        var sURL;\n        var map = this._map,\n                tileSize = this.options.tileSize,\n                nwPoint = tilePoint.multiplyBy(tileSize),\n                sePoint = nwPoint.add([tileSize, tileSize]),\n                nw = this._crs.project(map.unproject(nwPoint, tilePoint.z)),\n                se = this._crs.project(map.unproject(sePoint, tilePoint.z)),\n                bbox = this._wmsVersion >= 1.3 && this._crs === L.CRS.EPSG4326 ?\n        [se.y, nw.x, nw.y, se.x].join(',') :\n        [nw.x, se.y, se.x, nw.y].join(','),\n                url = L.Util.template(this._url, {s: this._getSubdomain(tilePoint)});\n\n        sURL = url + L.Util.getParamString(this.wmsParams, url, true) + '&BBOX=' + bbox;\n\n        if (this.options.useProxy) {\n            sURL = emp.util.config.getProxyUrl() + \"?\" + \"mime=image/*&url=\" + encodeURIComponent(sURL);\n        }\n\n        return sURL;\n    }\n});\n\nL.Control.Zoom = L.Control.Zoom.extend({\n    getCoreId: function () {\n        return this.options.coreId;\n    },\n    getObjectType: function () {\n        return this.options.objectType;\n    }\n});\n\nL.Control.Scale = L.Control.Scale.extend({\n    getCoreId: function () {\n        return this.options.coreId;\n    },\n    getObjectType: function () {\n        return this.options.objectType;\n    }\n});\n\nL.TileLayer = L.TileLayer.extend({\n    getCoreId: function () {\n        return this.options.coreId;\n    },\n    getObjectType: function () {\n        return this.options.objectType;\n    }\n});\n","/* global L, emp, leafLet */\n\nleafLet.internalPrivateClass.EmpKMLIcon = function(){\n    var publicInterface = {\n        createIcon: function (oldIcon) {\n            var oThis = this;\n            var img = this._createIcon('icon', oldIcon);\n            this.options.oIconImag = img;\n            \n            img.onload = function () {\n                //this.width = this.naturalWidth;\n                //this.height = this.naturalHeight;\n                oThis.options.oMarker.update();\n            };\n\n            img.onerror = function(){\n                var oDefaultIcon = emp.utilities.icon.getDefaultIcon(oThis.options.basePath);\n                \n                oThis.options.iconSize = new L.Point(oDefaultIcon.size.width, oDefaultIcon.size.height);\n                oThis.options.iconAnchorRef = {x: oDefaultIcon.offset.x, y: oDefaultIcon.offset.y};\n                oThis.options.iconAnchorType =\t{x: oDefaultIcon.offset.xUnits, y: oDefaultIcon.offset.yUnits};\n\n                img.src = oDefaultIcon.iconUrl;\n            };\n            return img;\n        },\n        _getRealScale: function()\n        {\n            var dKMLScale = 1.0;\n            var dScale = 1.0;\n            \n            if (!emp.helpers.isEmptyString(this.options.scale))\n            {\n                dKMLScale = parseFloat(this.options.scale);\n            }\n\n            if ((this.options.oIconImag.naturalWidth > this.options.oIconImag.naturalHeight) &&\n                    (this.options.oIconImag.naturalWidth > 32))\n            {\n                dScale = 32 / this.options.oIconImag.naturalWidth;\n            }\n            else if ((this.options.oIconImag.naturalHeight > this.options.oIconImag.naturalWidth) &&\n                    (this.options.oIconImag.naturalHeight > 32))\n            {\n                dScale = 32 / this.options.oIconImag.naturalHeight;\n            }\n            else if ((this.options.oIconImag.naturalHeight === this.options.oIconImag.naturalWidth) &&\n                    (this.options.oIconImag.naturalHeight > 32))\n            {\n                dScale = 32 / this.options.oIconImag.naturalHeight;\n            }\n\n            return dKMLScale * dScale;\n        },\n        _calculatXOffset: function(iIconWidth, sOffset, sOffsetType, dScale)\n        {\n            var iOffset = 0;\n\n            switch (sOffsetType.toLowerCase())\n            {\n                case 'fraction':\n                    var dFraction = parseFloat(sOffset);\n\n                    iOffset = Math.floor(iIconWidth * dFraction * -1.0);\n                    break;\n                case 'pixels':\n                    var iOffsetValue = parseInt(sOffset);\n\n                    iOffset = iOffsetValue * -1;\n                    break;\n                case 'insetpixels':\n                    var iOffsetValue = parseInt(sOffset);\n\n                    iOffset = (iIconWidth - iOffsetValue) * -1;\n                    break;\n            }\n\n            return Math.floor(iOffset * dScale);\n        },\n        _calculatYOffset: function(iIconHeight, sOffset, sOffsetType, dScale)\n        {\n            var iOffset = 0;\n\n            switch (sOffsetType.toLowerCase())\n            {\n                case 'fraction':\n                    var dFraction = parseFloat(sOffset);\n\n                    iOffset = Math.floor(iIconHeight * dFraction) - iIconHeight;\n                    break;\n                case 'pixels':\n                    var iOffsetValue = parseInt(sOffset);\n\n                    iOffset = iOffsetValue - iIconHeight;\n                    break;\n                case 'insetpixels':\n                    var iOffsetValue = parseInt(sOffset);\n\n                    iOffset = iOffsetValue * -1;\n                    break;\n            }\n\n            return Math.floor(iOffset * dScale);\n        },\n        _applyAnchorRef: function()\n        {\n            var oImg = this.options.oIconImag;\n            var marginLeft;\n            var marginTop;\n            var iIconWidth;\n            var iIconHeight;\n            var dAngle;\n            var dTempX;\n            var dTempY;\n            var fHeading;\n            var iCenterX;\n            var iCenterY;\n            var dScale = this._getRealScale();\n\n            if (this.options.iconAnchorRef)\n            {\n                var oOffset = this.options.iconAnchorRef;\n                var oUnits = this.options.iconAnchorType;\n                var sXUnits = 'fraction';\n                var sYUnits = 'fraction';\n\n                if (oUnits && (typeof (oUnits.x) === 'string'))\n                {\n                    sXUnits = oUnits.x;\n                }\n\n                if (oUnits && (typeof (oUnits.y) === 'string'))\n                {\n                    sYUnits = oUnits.y;\n                }\n\n                marginLeft = this._calculatXOffset(oImg.naturalWidth, oOffset.x, sXUnits, dScale);\n                marginTop = this._calculatYOffset(oImg.naturalHeight, oOffset.y, sYUnits, dScale);\n                \n                iIconWidth = Math.floor(oImg.naturalWidth * dScale);\n                iIconHeight = Math.floor(oImg.naturalHeight * dScale);\n            }\n            else\n            {\n                var oIconUtils = emp.typeLibrary.utils.icon;\n                var oDefaultIcon = oIconUtils.getDefaultIcon(this.options.basePath);\n                var iXOffset = oIconUtils.calculateXOffset(oDefaultIcon.size.width, oDefaultIcon.offset.x, oDefaultIcon.offset.xUnits);\n                var iYOffset = oIconUtils.calculateYOffset(oDefaultIcon.size.height, oDefaultIcon.offset.y, oDefaultIcon.offset.yUnits, emp.utilities.icon.referencePoin.BOTTOM_LEFT);\n                \n                marginLeft = iXOffset;\n                marginTop = iYOffset;\n                \n                iIconWidth = Math.floor(oDefaultIcon.size.width * dScale);\n                iIconHeight = Math.floor(oDefaultIcon.size.height * dScale);\n            }\n\n            if (!emp.helpers.isEmptyString(this.options.heading))\n            {\n                fHeading = parseFloat(this.options.heading);\n                iCenterX = marginLeft + (iIconWidth / 2);\n                iCenterY = marginTop + (iIconHeight / 2);\n                \n                dTempX = 0 - iCenterX;\n                dTempY = 0 - iCenterY;\n\n                dAngle = fHeading * Math.PI / 180.0;\n                var dSin = Math.sin(dAngle);\n                var dCos = Math.cos(dAngle);\n\n                var dNewX = Math.round((dTempX * dCos) - (dTempY * dSin));\n                var dNewY = Math.round((dTempX * dSin) + (dTempY * dCos));\n\n                dTempX = dNewX + iCenterX;\n                dTempY = dNewY + iCenterY;\n\n                marginLeft -= dTempX;\n                marginTop -= dTempY;\n            }\n\n            oImg.style.marginLeft = Math.ceil(marginLeft) + 'px';\n            oImg.style.marginTop = Math.ceil(marginTop) + 'px';\n            \n            oImg.style.width = iIconWidth + 'px';\n            oImg.style.height = iIconHeight + 'px';\n            \n            return Math.floor(dScale * 1000) / 1000;\n        }\n    };\n    \n    return publicInterface;\n};\n\nleafLet.typeLibrary.EmpKMLIcon = L.KMLIcon.extend(leafLet.internalPrivateClass.EmpKMLIcon());\n\nleafLet.internalPrivateClass.EmpKMLMarker = function(){\n    var publicInterface = {\n\tinitialize: function (latlng, options) {\n            options.draggable = false;\n\n            options.icon.options.oMarker = this;\n            L.Marker.prototype.initialize.call(this, latlng, options);\n\t},\n        setLatLng: function (latlng) {\n            this._latlng = L.latLng(latlng);\n\n            if (this._icon)\n            {\n                var pos = this._map.latLngToLayerPoint(this._latlng).round();\n\n                this._setPos(pos);\n            }\n\n            return this.fire('move', { latlng: this._latlng });\n        },\n        update: function () {\n            if (this._icon) {\n                var pos = this._map.latLngToLayerPoint(this._latlng).round();\n\n                this._setPos(pos);\n            }\n\n            return this;\n        },\n\n\t_setPos: function (pos) {\n            var oImg;\n            var sTemp;\n            var dScale = this.options.icon._applyAnchorRef();\n            \n            L.Marker.prototype._setPos.call(this, pos);\n            \n            oImg = this._icon;\n\n            sTemp = emp.helpers.isEmptyString(oImg.style[L.DomUtil.TRANSFORM])? '': oImg.style[L.DomUtil.TRANSFORM];\n            \n            //sTemp += ' scale(' + dScale + ',' + dScale + ')';\n            \n            if (!emp.helpers.isEmptyString(this.options.icon.options.heading))\n            {\n                sTemp += ' rotate(' + this.options.icon.options.heading + 'deg)';\n            }\n            \n            oImg.style[L.DomUtil.TRANSFORM] = sTemp;\n\t}\n    };\n    \n    return publicInterface;\n};\n\nleafLet.typeLibrary.EmpKMLMarker = L.Marker.extend(leafLet.internalPrivateClass.EmpKMLMarker());\n\nleafLet.internalPrivateClass.KMLPluginExtension = function(){\n    var publicInterface = {\n        initialize: function(kml, options) {\n            L.Util.setOptions(this, options);\n            this._kml = kml;\n            this._layers = {};\n\n            if (kml)\n            {\n                if (typeof (kml) !== 'string')\n                {\n                    throw new Error('KML or URL must be a string.');\n                }\n                \n                if (emp.helpers.isUrl(kml))\n                {\n                    this.addKML(kml, options, this.options.async);\n                }\n                else\n                {\n                    this._addKML(emp.$.parseXML(kml), options);\n                }\n            }\n        },\n        getIconUrl: function(sKmlUrl)\n        {\n            var sURL = sKmlUrl;\n            if (this.options.oFeatureProperties.hasOwnProperty('iconUrl'))\n            {\n                sURL = this.options.oFeatureProperties.iconUrl;\n            }\n            \n            if (emp.util.config.getUseProxySetting())\n            {\n                sURL = emp.util.config.getProxyUrl() + \"?\" + \"mime=image/*&url=\" + escape(sURL);\n            }\n\n            return sURL;\n        },\n        _addKML: function(xml, options)\n        {\n                this.options.kmlDoc = xml;\n                var layers = this.parseKML(xml);\n                if (!layers || !layers.length) return;\n                for (var i = 0; i < layers.length; i++) {\n                    this.fire('addlayer', {\n                            layer: layers[i]\n                    });\n                    this.addLayer(layers[i]);\n                }\n                this.latLngs = this.getLatLngs(xml);\n                this.fire('loaded');\n        },\n        parseStyle: function (xml) {\n            var style = {};\n            var sl = xml.getElementsByTagName('Style');\n\n            //for (var i = 0; i < sl.length; i++) {\n            var attributes = {color: true, width: true, Icon: true, href: true,\n                              hotSpot: true, scale: true, heading:true};\n\n            function _parse(xml) {\n                var options = {};\n                for (var i = 0; i < xml.childNodes.length; i++) {\n                    var e = xml.childNodes[i];\n                    var key = e.tagName;\n                    if (!attributes[key]) { continue; }\n                    if (key === 'hotSpot')\n                    {\n                        for (var j = 0; j < e.attributes.length; j++) {\n                            options[e.attributes[j].name] = e.attributes[j].nodeValue;\n                        }\n                    } else {\n                        var value = e.childNodes[0].nodeValue;\n                        if (key === 'color') {\n                            options.opacity = parseInt(value.substring(0, 2), 16) / 255.0;\n                            options.color = '#' + value.substring(6, 8) + value.substring(4, 6) + value.substring(2, 4);\n                        } else if (key === 'width') {\n                            options.weight = value;\n                        } else if (key === 'Icon') {\n                            ioptions = _parse(e);\n                            if (ioptions.href) { options.href = ioptions.href; }\n                        } else if (key === 'href') {\n                            options.href = value;\n                        } else if (key === 'scale') {\n                            options.scale = value;\n                        } else if (key === 'heading') {\n                            options.heading = value;\n                        }\n                    }\n                }\n                return options;\n            }\n\n            for (var i = 0; i < sl.length; i++) {\n                var e = sl[i],\n                    el;\n                var options = {},\n                    poptions = {},\n                    ioptions = {};\n\n                el = e.getElementsByTagName('LineStyle');\n                if (el && el[0]) { options = _parse(el[0]); }\n\n                el = e.getElementsByTagName('PolyStyle');\n\n                if (el && el[0]) { poptions = _parse(el[0]); }\n\n                if (poptions.color) { options.fillColor = poptions.color; }\n\n                if (poptions.opacity) { options.fillOpacity = poptions.opacity; }\n\n                el = e.getElementsByTagName('IconStyle');\n                if (el && el[0]) { ioptions = _parse(el[0]); }\n\n                if (ioptions.href) {\n                    // save anchor info until the image is loaded\n                    \n                    var oIconOptions = {\n                        iconUrl: this.getIconUrl(ioptions.href),\n                        shadowUrl: null,\n                        iconAnchorRef: {x: ioptions.x, y: ioptions.y},\n                        iconAnchorType:\t{x: ioptions.xunits, y: ioptions.yunits}\n                    };\n                    \n                    if (!emp.helpers.isEmptyString(ioptions.scale))\n                    {\n                        oIconOptions.scale = ioptions.scale;\n                    }\n                    \n                    if (!emp.helpers.isEmptyString(ioptions.heading))\n                    {\n                        oIconOptions.heading = ioptions.heading;\n                    }\n                    \n                    oIconOptions.basePath = this.options.basePath;\n                    \n                    options.icon = new leafLet.typeLibrary.EmpKMLIcon(oIconOptions);\n                }\n                style['#' + e.getAttribute('id')] = options;\n            }\n            return style;\n        },\n        parsePlacemark: function (place, xml, style) {\n            var h, i, j, el, options = {};\n\n            var multi = ['MultiGeometry', 'gx:MultiTrack'];\n            for (h in multi) {\n                if (!multi.hasOwnProperty(h)) {\n                    continue;\n                }\n                el = place.getElementsByTagName(multi[h]);\n                for (i = 0; i < el.length; i++) {\n                    return this.parsePlacemark(el[i], xml, style);\n                }\n            }\n\n            el = place.getElementsByTagName('Style');\n            \n            if (el && (el.length > 0))\n            {\n                for (i = 0; i < el.length; i++) {\n                    var sIndex = '#' + el[i].getAttribute('id');\n                    for (var a in style[sIndex]) {\n                        if (!style[sIndex].hasOwnProperty(a)) {\n                            continue;\n                        }\n                        options[a] = style[sIndex][a];\n                    }\n                }\n            }\n            else\n            {\n                el = place.getElementsByTagName('styleUrl');\n\n                for (i = 0; i < el.length; i++) {\n                    var url = el[i].childNodes[0].nodeValue;\n                    for (var a in style[url]) {\n                        if (!style[url].hasOwnProperty(a)) {\n                            continue;\n                        }\n                        options[a] = style[url][a];\n                    }\n                }\n            }\n\n            var layers = [];\n\n            var parse = ['LineString', 'Polygon', 'Point', 'gx:Track'];\n            for (j in parse) {\n                if (!parse.hasOwnProperty(j)) {\n                    continue;\n                }\n                var tag = parse[j];\n                el = place.getElementsByTagName(tag);\n                for (i = 0; i < el.length; i++) {\n                    var l = this['parse' + tag.replace(/gx:/, '')](el[i], xml, options);\n                    if (l) { layers.push(l); }\n                }\n            }\n\n            if (!layers.length) {\n                return;\n            }\n            var layer = layers[0];\n            if (layers.length > 1) {\n                layer = new L.FeatureGroup(layers);\n            }\n\n            var sID, name, descr = '';\n            \n            if (place.id) {\n                sID = place.id;\n            }\n\n            el = place.getElementsByTagName('name');\n            if (el.length && el[0].childNodes.length) {\n                name = el[0].childNodes[0].nodeValue;\n            }\n            el = place.getElementsByTagName('description');\n            for (i = 0; i < el.length; i++) {\n                for (j = 0; j < el[i].childNodes.length; j++) {\n                    descr = descr + el[i].childNodes[j].nodeValue;\n                }\n            }\n            \n            if ((typeof (name) === 'string') && (name.length > 0))\n            {\n                layer.options.kmlName = name;\n            }\n            \n            if ((typeof (descr) === 'string') && (descr.length > 0))\n            {\n                layer.options.kmlDescription = descr;\n            }\n            \n            if ((typeof (sID) === 'string') && (sID.length > 0))\n            {\n                layer.options.sSubItemID = sID;\n            }\n\n            //if (name) {\n            //    layer.bindPopup('<h2>' + name + '</h2>' + descr, {\n            //        closeButton: false\n            //    });\n            //}\n\n            return layer;\n        },\n        _read_coords: function (el) {\n            var text = '', coords = [], i;\n            for (i = 0; i < el.childNodes.length; i++) {\n                text = text + el.childNodes[i].nodeValue;\n            }\n            text = text.split(/[\\s\\n]+/);\n            for (i = 0; i < text.length; i++) {\n                var ll = text[i].split(',');\n                if (ll.length < 2) {\n                    continue;\n                }\n                coords.push(new L.LatLng(ll[1], ll[0], ll[2]));\n            }\n            return coords;\n        },\n        _read_gxcoords: function (el) {\n            var text = '', coords = [];\n            text = el.firstChild.nodeValue.split(' ');\n            coords.push(new L.LatLng(text[1], text[0], text[2]));\n            return coords;\n        },\n        getOptions: function(sType, oOptions)\n        {\n            var oColor;\n            var oProperties = this.options.oFeatureProperties;\n            \n            if (sType === 'point') {\n                var sURL;\n                var iXOffset,\n                    iYOffset,\n                    sXUnits,\n                    sYUnits;\n\n                if (oProperties.hasOwnProperty('iconUrl'))\n                {\n                    sURL = this.getIconUrl(oProperties.iconUrl);\n                }\n\n                if (oProperties.hasOwnProperty('iconXOffset'))\n                {\n                    iXOffset = oProperties.iconXOffset;\n                    if (oProperties.hasOwnProperty('xUnits'))\n                    {\n                        sXUnits = oProperties.xUnits;\n                    }\n                }\n\n                if (oProperties.hasOwnProperty('iconYOffset'))\n                {\n                    iYOffset = oProperties.iconYOffset;\n                    if (oProperties.hasOwnProperty('yUnits'))\n                    {\n                        sYUnits = oProperties.yUnits;\n                    }\n                }\n\n                if (!iXOffset)\n                {\n                    if (oOptions.icon && oOptions.icon.options.iconAnchorRef)\n                    {\n                        iXOffset = oOptions.icon.options.iconAnchorRef.x;\n                    }\n                    else\n                    {\n                        iXOffset = 0;\n                    }\n                }\n\n                if (!sXUnits)\n                {\n                    if (oOptions.icon && oOptions.icon.options.iconAnchorType)\n                    {\n                        sXUnits = oOptions.icon.options.iconAnchorType.x;\n                    }\n                    else\n                    {\n                        sXUnits = 'fraction';\n                    }\n                }\n\n                if (!iYOffset)\n                {\n                    if (oOptions.icon && oOptions.icon.options.iconAnchorRef)\n                    {\n                        iYOffset = oOptions.icon.options.iconAnchorRef.y;\n                    }\n                    else\n                    {\n                        iYOffset = 0;\n                    }\n                }\n\n                if (!sYUnits)\n                {\n                    if (oOptions.icon && oOptions.icon.options.iconAnchorType)\n                    {\n                        sYUnits = oOptions.icon.options.iconAnchorType.y;\n                    }\n                    else\n                    {\n                        sYUnits = 'fraction';\n                    }\n                }\n\n                if (!oOptions.icon)\n                {\n                    if (!sURL)\n                    {\n                        var oDefaultIcon = emp.utilities.icon.getDefaultIcon(this.options.basePath);\n                        \n                        sURL = oDefaultIcon.iconUrl;\n                        iYOffset = oDefaultIcon.offset.y;\n                        iXOffset = oDefaultIcon.offset.x;\n                        sXUnits = oDefaultIcon.offset.xUnits;\n                        sYUnits = oDefaultIcon.offset.yUnits;\n                    }\n                    \n                    if (this.options.oFeature.isSelected())\n                    {\n                        oOptions.icon = new leafLet.typeLibrary.EmpKMLIcon({\n                            iconUrl: sURL,\n                            shadowUrl: null,\n                            iconAnchorRef: {x: iXOffset, y: iYOffset},\n                            iconAnchorType: {x: sXUnits, y: sYUnits},\n                            className: 'icon-selected',\n                            basePath: this.options.basePath\n                        });\n                    }\n                    else\n                    {\n                        oOptions.icon = new leafLet.typeLibrary.EmpKMLIcon({\n                            iconUrl: sURL,\n                            shadowUrl: null,\n                            iconAnchorRef: {x: iXOffset, y: iYOffset},\n                            iconAnchorType: {x: sXUnits, y: sYUnits},\n                            basePath: this.options.basePath\n                        });\n                    }\n                }\n                else\n                {\n                    if ((typeof (sURL) === 'string') && (sURL.length > 0))\n                    {\n                        oOptions.icon.options.iconUrl = sURL;\n                    }\n                    oOptions.icon.options.iconAnchorRef = {x: iXOffset, y: iYOffset};\n                    oOptions.icon.options.iconAnchorType = {x: sXUnits, y: sYUnits};\n\n                    if (this.options.oFeature.isSelected())\n                    {\n                        oOptions.icon.options.className = 'icon-selected';\n                    }\n                    else\n                    {\n                        oOptions.icon.options.className = '';\n                    }\n                }\n            }\n            \n            if (this.options.oFeature.isSelected()) {\n                oOptions.color = '#' + this.options.oFeature.options.instanceInterface.selectAttributes.color;\n                oOptions.weight = this.options.oFeature.options.instanceInterface.selectAttributes.width;\n                \n                if ((sType === 'line') || (sType === 'polygon')) {\n                    if (oProperties.hasOwnProperty('lineColor')) {\n                        oOptions.tempColor = leafLet.utils.convertColor(oProperties.lineColor).sColor;\n                    } else {\n                        oOptions.tempColor = L.LEAFLET_DEFAULT_LINE_COLOR;\n                    }\n                    if (oProperties.hasOwnProperty('lineWidth'))\n                    {\n                        if (typeof (oProperties.lineWidth) === 'string')\n                        {\n                            oOptions.tempWeight = parseInt(oProperties.lineWidth);\n                        }\n                        else\n                        {\n                            oOptions.tempWeight = oProperties.lineWidth;\n                        }\n                    } else {\n                        oOptions.tempWeight = L.LEAFLET_DEFAULT_LINE_WEIGHT;\n                    }\n                }\n            } else if (oProperties.hasOwnProperty('lineColor') && ((sType === 'line') || (sType === 'polygon'))) {\n                oColor = leafLet.utils.convertColor(oProperties.lineColor);\n                \n                oOptions.color = oColor.sColor;\n                oOptions.opacity = oColor.opacity;\n                \n                if (oProperties.hasOwnProperty('lineWidth'))\n                {\n                    if (typeof (oProperties.lineWidth) === 'string')\n                    {\n                        oOptions.weight = parseInt(oProperties.lineWidth);\n                    }\n                    else\n                    {\n                        oOptions.weight = oProperties.lineWidth;\n                    }\n                }                    \n            }\n\n            if (oProperties.hasOwnProperty('fillColor') && (sType === 'polygon'))\n            {\n                oColor = leafLet.utils.convertColor(oProperties.fillColor);\n                \n                oOptions.fill = true;\n                oOptions.fillColor = oColor.sColor;\n                oOptions.fillOpacity = oColor.opacity;\n            }\n            \n            oOptions.oFeature = this.options.oFeature;\n            \n            return oOptions;\n        },\n        parsePoint: function (line, xml, options) {\n            var el = line.getElementsByTagName('coordinates');\n            if (!el.length) {\n                return;\n            }\n            var ll = el[0].childNodes[0].nodeValue.split(',');\n            return new leafLet.typeLibrary.EmpKMLMarker(new L.LatLng(ll[1], ll[0], ll[2]), this.getOptions('point', options));\n        },\n\tparseLineString: function (line, xml, options) {\n            var coords = this.parseCoords(line);\n            if (!coords.length) { return; }\n            return new L.Polyline(coords, this.getOptions('line', options));\n\t},\n\tparseTrack: function (line, xml, options) {\n            var el = xml.getElementsByTagName('gx:coord');\n            var coords = [];\n            for (var j = 0; j < el.length; j++) {\n                    coords = coords.concat(this._read_gxcoords(el[j]));\n            }\n            if (!coords.length) { return; }\n            return new L.Polyline(coords, this.getOptions('line', options));\n\t},\n\tparsePolygon: function (line, xml, options) {\n            var el, polys = [], inner = [], i, coords;\n            \n            el = line.getElementsByTagName('outerBoundaryIs');\n            \n            for (i = 0; i < el.length; i++) {\n                coords = this.parseCoords(el[i]);\n                if (coords) {\n                    polys.push(coords);\n                }\n            }\n            el = line.getElementsByTagName('innerBoundaryIs');\n            for (i = 0; i < el.length; i++) {\n                coords = this.parseCoords(el[i]);\n                if (coords) {\n                    inner.push(coords);\n                }\n            }\n            if (!polys.length) {\n                return;\n            }\n            if (options.fillColor) {\n                options.fill = true;\n            }\n            if (polys.length === 1) {\n                return new L.Polygon(polys.concat(inner), this.getOptions('polygon', options));\n            }\n            return new L.MultiPolygon(polys, this.getOptions('polygon', options));\n\t}\n/*\tgetBounds: function () {\n\t\tvar bounds = new L.LatLngBounds();\n\n\t\tthis.eachLayer(function (layer) {\n\t\t\tbounds.extend(layer instanceof leafLet.typeLibrary.EmpKMLMarker ? layer.getLatLng() : layer.getBounds());\n\t\t});\n\n\t\treturn bounds;\n\t}\n*/\n    };\n    \n    return publicInterface;\n};\n\nleafLet.typeLibrary.EmpKmlObject = L.KML.extend(leafLet.internalPrivateClass.KMLPluginExtension());\n","\n/* global L, leafLet, emp */\n\nL.MarkerCluster.mergeOptions({\n    titleText: \"\",\n    popupText: \"\",\n    overlay: undefined\n});\n\nL.MarkerCluster.include({\n    setPopupHeading: function(sText)\n    {\n        this.options.titleText = sText;\n    },\n    getPopupHeading: function()\n    {\n        return this.options.titleText;\n    },\n    setPopupText: function(sText)\n    {\n        this.options.popupText = sText;\n    },\n    getPopupText: function()\n    {\n        return this.options.popupText;\n    },\n    setOverlay: function(oOverlay)\n    {\n        this.options.overlay = oOverlay;\n    },\n    getOverlayId: function()\n    {\n        var sID = undefined;\n        \n        if (this.options.overlay instanceof leafLet.typeLibrary.Overlay)\n        {\n            sID = this.options.overlay.getOverlayId();\n        }\n        \n        return sID;\n    },\n    getParentId: function()\n    {\n        var sID = undefined;\n        \n        if (this.options.overlay instanceof leafLet.typeLibrary.Overlay)\n        {\n            sID = this.options.overlay.getParentId();\n        }\n        \n        return sID;\n    },\n    getFeatureId: function()\n    {\n        return undefined;\n    }\n});\n\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.EllipseObject = function() {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n                oMap: args.leafletMap,\n                semiMajor: args.semiMajor,\n                semiMinor: args.semiMinor,\n                azimuth: args.azimuth,\n                centerLatLng: args.centerLatLng,\n                isSelected: args.isSelected,\n                selectAttributes: args.selectAttributes,\n                oCoordList: [],\n                properties: args.properties,\n                oFeature: args.oFeature\n            };\n\n            L.Util.setOptions(this, options);\n\n            this._generatePolygon();\n\n            L.Polygon.prototype.initialize.call(this, this.options.oCoordList, this.options.properties);\n        },\n        isSelected: function() {\n            return this.options.isSelected;\n        },\n        _generatePolygon: function() {\n            var x, newX;\n            var y, newY;\n            var tempLatLng;\n            var angle;\n            var angleTan;\n            var angleTan2;\n            var xyPoint, newPoint;\n            var oLatLngList = [];\n            var q1PointList = [];\n            var q2PointList = [];\n            var q3PointList = [];\n            var q4PointList = [];\n            var coordList = this.options.oCoordList;\n            var leafletMap = this.options.oMap;\n            var centerPoint = leafletMap.latLngToLayerPoint(this.options.centerLatLng);\n            var northCoord = this.options.centerLatLng.destinationPoint(0, this.options.semiMinor);\n            var eastCoord = this.options.centerLatLng.destinationPoint(90, this.options.semiMajor);\n            var northPoint = leafletMap.latLngToLayerPoint(northCoord);\n            var eastPoint = leafletMap.latLngToLayerPoint(eastCoord);\n            var semiMajorPx = centerPoint.distanceTo(eastPoint);\n            var semiMinorPx = centerPoint.distanceTo(northPoint);\n            var nPtePtDist = northPoint.distanceTo(eastPoint);\n            var semiMajorPx2 = semiMajorPx * semiMajorPx;\n            var semiMinorPx2 = semiMinorPx * semiMinorPx;\n            var majorMinor = semiMajorPx * semiMinorPx;\n            var azimuth = this.options.azimuth;\n            var cosAzimuth = Math.cos(azimuth.toRad());\n            var sinAzimuth = Math.sin(azimuth.toRad());\n            var deltaRadian = (90.0 / nPtePtDist).toRad();\n            var maxRadian = Math.PI / 2.0;\n\n            x = semiMajorPx;\n            y = 0;\n\n            // Create 1st quadrant point and rotate it.\n            xyPoint = new L.point(((x * cosAzimuth) - (y * sinAzimuth)), ((y * cosAzimuth) + (x * sinAzimuth)), true);\n            newPoint = centerPoint.add(xyPoint);\n            q1PointList.push(newPoint);\n\n            // Create 4th quadrant point and rotate it.\n            xyPoint = new L.point(((x * cosAzimuth * -1) - (y * sinAzimuth * -1)), ((y * cosAzimuth * -1) + (x * sinAzimuth * -1)), true);\n            newPoint = centerPoint.add(xyPoint);\n            q4PointList.push(newPoint);\n\n            for (angle = deltaRadian; angle < maxRadian; angle += deltaRadian) {\n                angleTan = Math.tan(angle);\n                angleTan2 = angleTan * angleTan;\n                x = majorMinor / (Math.sqrt(semiMinorPx2 + (semiMajorPx2 * angleTan2)));\n                y = x * angleTan;\n                // Create 1st quadrant point and rotate it.\n                xyPoint = new L.point(((x * cosAzimuth) - (y * sinAzimuth)), ((y * cosAzimuth) + (x * sinAzimuth)), true);\n                newPoint = centerPoint.add(xyPoint);\n                q1PointList.push(newPoint);\n\n                // Create 2nd quadrant point and rotate it.\n                xyPoint = new L.point(((x * cosAzimuth * -1) - (y * sinAzimuth)), ((y * cosAzimuth) + (x * sinAzimuth * -1)), true);\n                newPoint = centerPoint.add(xyPoint);\n                q2PointList.push(newPoint);\n\n                // Create 3rd quadrant point and rotate it.\n                xyPoint = new L.point(((x * cosAzimuth) - (y * sinAzimuth * -1)), ((y * cosAzimuth * -1) + (x * sinAzimuth)), true);\n                newPoint = centerPoint.add(xyPoint);\n                q3PointList.push(newPoint);\n\n                // Create 4th quadrant point and rotate it.\n                xyPoint = new L.point(((x * cosAzimuth * -1) - (y * sinAzimuth * -1)), ((y * cosAzimuth * -1) + (x * sinAzimuth * -1)), true);\n                newPoint = centerPoint.add(xyPoint);\n                q4PointList.push(newPoint);\n            }\n\n            for (x = 0; x < q1PointList.length; x++) {\n                tempLatLng = leafletMap.layerPointToLatLng(q1PointList[x]);\n                if (tempLatLng) {\n                    coordList.push(tempLatLng);\n                }\n            }\n\n            for (x = q2PointList.length - 1; x >= 0; x--) {\n                tempLatLng = leafletMap.layerPointToLatLng(q2PointList[x]);\n                if (tempLatLng) {\n                    coordList.push(tempLatLng);\n                }\n            }\n\n            for (x = 0; x < q4PointList.length; x++) {\n                tempLatLng = leafletMap.layerPointToLatLng(q4PointList[x]);\n                if (tempLatLng) {\n                    coordList.push(tempLatLng);\n                }\n            }\n\n            for (x = q3PointList.length - 1; x >= 0; x--) {\n                tempLatLng = leafletMap.layerPointToLatLng(q3PointList[x]);\n                if (tempLatLng) {\n                    coordList.push(tempLatLng);\n                }\n            }\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.EllipseObject = L.Polygon.extend(leafLet.internalPrivateClass.EllipseObject());\n","\n/* global leafLet, emp, L */\n\nleafLet.internalPrivateClass.SelectionManager = function(args){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n                eventData: [],\n                featureSelectedList: {},\n                mapInstance: args.mapInstance\n            };\n            L.Util.setOptions(this, options);\n        },\n        destroy: function()\n        {\n            var iIndex;\n            var oKeyList = emp.helpers.associativeArray.getKeys(this.options.featureSelectedList);\n            \n            for (iIndex = 0; iIndex < oKeyList.length; iIndex++) {\n                delete this.options.featureSelectedList[oKeyList[iIndex]];\n            }\n            \n            this.options.eventData = [];\n        },\n        getKey: function(oFeature, sSubFeatureID)\n        {\n            var sKey = oFeature.getCoreId();\n            \n            if (!emp.helpers.isEmptyString(sSubFeatureID))\n            {\n                sKey += '-' + sSubFeatureID;\n            }\n            \n            return sKey;\n        },\n        _createSelectionObject: function(oFeature, sSubFeatureID)\n        {\n            var sKey = this.getKey(oFeature, sSubFeatureID);\n            var oSelectedListObject = {\n                sKey : sKey,\n                oFeature: oFeature,\n                oSelectionData: {\n                    coreId: oFeature.getCoreId(),\n                    overlayId: oFeature.getOverlayId(),\n                    parentId: oFeature.getParentId(),\n                    featureId: oFeature.getFeatureId(),\n                    select: true\n                }\n            };\n            \n            if ((typeof (sSubFeatureID) === 'string') && (sSubFeatureID.length > 0))\n            {\n                oSelectedListObject.oSelectionData.selectedId = sSubFeatureID;\n            }\n            \n            return oSelectedListObject;\n        },\n        deselectAllFeatures: function()\n        {\n            var iIndex;\n            var oFeatureSelection;\n            var oKeyList = emp.helpers.associativeArray.getKeys(this.options.featureSelectedList);\n\n            for (iIndex = 0; iIndex < oKeyList.length; iIndex++) {\n                oFeatureSelection = this.options.featureSelectedList[oKeyList[iIndex]];\n                \n                if (!oFeatureSelection.oFeature.isInEditMode())\n                {\n                    oFeatureSelection.oSelectionData.select = false;\n\n                    this.options.eventData.push(oFeatureSelection.oSelectionData);\n                    delete this.options.featureSelectedList[oKeyList[iIndex]];\n                    this.applyHighlight2LeafletObject(oFeatureSelection.oFeature, oFeatureSelection.oSelectionData.selectedId, false);\n                }\n            }\n        },\n        _removeFeatureFromSelectedList: function(oFeature, sSubFeatureID)\n        {\n            var sKey = this.getKey(oFeature, sSubFeatureID);\n\n            if (this.options.featureSelectedList[sKey] !== undefined)\n            {\n                delete this.options.featureSelectedList[sKey];\n            }\n        },\n        _addFeatureToSelectedList: function(oSelectedListObject)\n        {\n            if (this.options.featureSelectedList[oSelectedListObject.sKey] === undefined)\n            {\n                this.options.featureSelectedList[oSelectedListObject.sKey] = oSelectedListObject;\n            }\n        },\n        isSelected: function(oFeature, sSubFeatureID)\n        {\n            var bSelected = false;\n            var sKey = this.getKey(oFeature);\n            \n            // First check if the entire feature is selected.\n            if (this.options.featureSelectedList[sKey] !== undefined)\n            {\n                return true;\n            }\n            \n            if (!emp.helpers.isEmptyString(sSubFeatureID))\n            {\n                sKey = this.getKey(oFeature, sSubFeatureID);\n                bSelected = ((this.options.featureSelectedList[sKey] === undefined)? false: true);\n            }\n            \n            return bSelected;\n        },\n        selectFeature: function(oFeature, sSubFeatureID)\n        {\n            var oSelectedListObject = this._createSelectionObject(oFeature, sSubFeatureID);\n\n            this.applyHighlight2LeafletObject(oFeature, sSubFeatureID, true);\n            this._addFeatureToSelectedList(oSelectedListObject);\n            this.options.eventData.push(oSelectedListObject.oSelectionData);\n        },\n        deselectFeature: function(oFeature, sSubFeatureID)\n        {\n            var sKey = this.getKey(oFeature, sSubFeatureID);\n            var oSelectedListObject = this.options.featureSelectedList[sKey];\n\n            if (emp.helpers.isEmptyString(sSubFeatureID))\n            {\n                this._removeFeaturesEntries(oFeature);\n            }\n            else if (oSelectedListObject)\n            {\n                this._removeFeatureFromSelectedList(oFeature, sSubFeatureID);\n                this.applyHighlight2LeafletObject(oFeature, sSubFeatureID, false);\n                oSelectedListObject.oSelectionData.select = false;\n                this.options.eventData.push(oSelectedListObject.oSelectionData);\n            }\n        },\n        generateEvent: function()\n        {\n            if (this.options.eventData.length > 0)\n            {\n                this.options.mapInstance.eventing.SelectionChange(this.options.eventData);\n            }\n            \n            this.resetEventData();\n        },\n        resetEventData: function()\n        {\n            if (this.options.eventData.length > 0)\n            {\n                this.options.eventData = [];\n            }\n        },\n        _applyHighlight: function(oLeafletObj, oFeature, sSubFeatureID, bSelected)\n        {\n            var iIndex;\n            \n            if (oLeafletObj instanceof L.LayerGroup)\n            {\n                var oItemList = oLeafletObj.getLayers();\n                \n                for (iIndex = 0; iIndex < oItemList.length; iIndex++)\n                {\n                    this._applyHighlight(oItemList[iIndex], oFeature, sSubFeatureID, bSelected);\n                }\n            }\n            else\n            {\n                if (typeof (oLeafletObj.empSelect) === 'function')\n                {\n                    if (emp.helpers.isEmptyString(sSubFeatureID))\n                    {\n                        if (bSelected && !this.isSelected(oFeature, sSubFeatureID))\n                        {\n                            oLeafletObj.empSelect();\n                        }\n                        else if (!bSelected && !this.isSelected(oFeature, sSubFeatureID))\n                        {\n                            oLeafletObj.empDeselect();\n                        }\n                    }\n                    else if (oLeafletObj && oLeafletObj.options && !emp.helpers.isEmptyString(oLeafletObj.options.sSubItemID))\n                    {\n                        if (oLeafletObj.options.sSubItemID === sSubFeatureID)\n                        {\n                            if (bSelected && !this.isSelected(oFeature, sSubFeatureID))\n                            {\n                                oLeafletObj.empSelect();\n                            }\n                            else if (!bSelected && !this.isSelected(oFeature, sSubFeatureID))\n                            {\n                                oLeafletObj.empDeselect();\n                            }\n                        }\n                    }\n                }\n            }\n        },\n        applyHighlight2LeafletObject: function(oFeature, sSubFeatureID, bSelected)\n        {\n            var oLeafletObj = oFeature.getLeafletObject();\n            \n            this._applyHighlight(oLeafletObj, oFeature, sSubFeatureID, bSelected);\n        },\n        _removeFeaturesEntries: function(oFeature)\n        {\n            var oFeatureSelection;\n            var sCoreID = oFeature.getCoreId();\n            var oKeyList = emp.helpers.associativeArray.getKeys(this.options.featureSelectedList);\n\n            for (var iIndex in oKeyList)\n            {\n                oFeatureSelection = this.options.featureSelectedList[oKeyList[iIndex]];\n\n                if (oFeatureSelection.oSelectionData.coreId === sCoreID)\n                {\n                    oFeatureSelection.oSelectionData.select = false;\n\n                    this.options.eventData.push(oFeatureSelection.oSelectionData);\n\n                    delete this.options.featureSelectedList[oKeyList[iIndex]];\n                    this.applyHighlight2LeafletObject(oFeatureSelection.oFeature, oFeatureSelection.oSelectionData.selectedId, false);\n                }\n            }\n        },\n        removeFeature: function(oFeature)\n        {\n            this._removeFeaturesEntries(oFeature);\n            this.generateEvent();\n        }\n    };\n    \n    return publicInterface;\n};\n\n\nleafLet.SelectionManager = L.Class.extend(leafLet.internalPrivateClass.SelectionManager());\n","/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.empObject = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            L.FeatureGroup.prototype.initialize.call(this);\n            var options = {\n                objectType:  args.item.globalType,\n                name: args.item.name,\n                description: args.item.description,\n                coreId: args.item.coreId || emp.helpers.id.newGUID(),\n                parentCoreId: args.item.parentCoreId,\n                parentId: args.item.parentId,\n                instanceInterface: args.instanceInterface,\n                oClusteredParent: undefined,\n                objectChildren: {}\n            };\n            L.Util.setOptions(this, options);\n        },\n        destroy: function()\n        {\n            var oParent = this.getParentObject();\n            \n            this.clearChildren();\n\n            if (oParent)\n            {\n                oParent.removeChildObject(this);\n            }\n\n            this.getEngineInstanceInterface().removeEmpObject(this);\n        },\n        clearChildren: function()\n        {\n            var aKeys = emp.helpers.associativeArray.getKeys(this.options.objectChildren);\n\n            for (var sKey in aKeys)\n            {\n                if (this.options.objectChildren[aKeys[sKey]].options.objectType ===\n                        leafLet.typeLibrary.objectType.FEATURE)\n                {\n                    if (this.options.objectChildren[aKeys[sKey]].isInEditMode())\n                    {\n                        var instanceInterface = this.getEngineInstanceInterface();\n                        instanceInterface.oCurrentEditor.cancelEdit();\n                        instanceInterface.oCurrentEditor.destroy();\n                        instanceInterface.bInEditMode = false;\n                        instanceInterface.bInDrawMode = false;\n                        instanceInterface.oCurrentEditor = undefined;\n                        instanceInterface.oEditTransaction.run();\n                        instanceInterface.oEditTransaction = undefined;\n                    }\n                }\n                this.options.objectChildren[aKeys[sKey]].destroy();\n                this.removeChildObjectById(aKeys[sKey]);\n            }\n\n            this.clearLayers();\n        },\n        getRootOverlay: function()\n        {\n            return this.getEngineInstanceInterface().rootOverlay;\n        },\n        getEngineInstanceInterface: function()\n        {\n            return this.options.instanceInterface;\n        },\n        getLeafletMap: function()\n        {\n            return this.getEngineInstanceInterface().leafletInstance;\n        },\n        getEngObject: function(sCoreId)\n        {\n            return this.getEngineInstanceInterface().mapEngObjectList[sCoreId];\n        },\n        getCoreId: function()\n        {\n            return this.options.coreId;\n        },\n        getParentCoreId: function()\n        {\n            return this.options.parentCoreId;\n        },\n        getOverlayId: function()\n        {\n            return undefined;\n        },\n        getFeatureId: function()\n        {\n            return undefined;\n        },\n        getParentId: function()\n        {\n            return this.options.parentId;\n        },\n        getName: function()\n        {\n            return this.options.name;\n        },\n        getDescription: function()\n        {\n            return this.options.description;\n        },\n        setName: function(sValue)\n        {\n            this.options.name = sValue;\n        },\n        getObjectType: function()\n        {\n            return this.options.objectType;\n        },\n        getChild: function(sCoreId)\n        {\n            return this.options.objectChildren[sCoreId];\n        },\n        getChildList: function()\n        {\n            return this.options.objectChildren;\n        },\n        getChildKeyList: function()\n        {\n            return emp.helpers.associativeArray.getKeys(this.options.objectChildren);\n        },\n        getParentObject: function()\n        {\n            var oParent = this.getEngObject(this.getParentCoreId());\n\n            if (!oParent)\n            {\n                oParent = this.getRootOverlay();\n            }\n            \n            return oParent;\n        },\n        getClusteredOverlay: function()\n        {\n            var oParent;\n            var oOverlay = undefined;\n            \n            switch (this.getObjectType())\n            {\n                case leafLet.typeLibrary.objectType.FEATURE:\n                case leafLet.typeLibrary.objectType.WMS:\n                    oParent = this.getEngObject(this.getParentCoreId());\n\n                    if (oParent)\n                    {\n                        oOverlay = oParent.getClusteredOverlay();\n                    }\n                    break;\n                case leafLet.typeLibrary.objectType.OVERLAY:\n                    if (this.isCurrentlyClustered())\n                    {\n                        oOverlay = this;\n                    }\n                    else\n                    {\n                        oParent = this.getEngObject(this.getParentCoreId());\n                        \n                        if (oParent)\n                        {\n                            oOverlay = oParent.getClusteredOverlay();\n                        }\n                    }\n                    break;\n            }\n            return oOverlay;\n        },\n        deactivateParentCluster: function()\n        {\n            var oParent = this.getParentObject();\n\n            if (oParent)\n            {\n                this.options.oClusteredParent = oParent.getClusteredOverlay();\n\n                if (this.options.oClusteredParent)\n                {\n                    this.options.oClusteredParent.clusterDeactivate();\n                }\n            }\n        },\n        activateParentCluster: function()\n        {\n            if (this.options.oClusteredParent)\n            {\n                this.options.oClusteredParent.clusterActivate();\n                this.options.oClusteredParent = undefined;\n            }\n        },\n        addChildObject: function(oChild)\n        {\n            if (this.options.objectChildren[oChild.getCoreId()] === undefined)\n            {\n                this.options.objectChildren[oChild.getCoreId()] = oChild;\n                this.addLayer(oChild);\n                \n                var oClusteredOverlay = this.getClusteredOverlay();\n\n                if (oClusteredOverlay)\n                {\n                    oClusteredOverlay.getClusterObject().addLayer(oChild);\n                }\n            }\n        },\n        removeChildObject: function(oFeature)\n        {\n            this.removeChildObjectById(oFeature.getCoreId());\n        },\n        removeChildObjectById: function(sCoreId)\n        {\n            var oChild = this.getChild(sCoreId);\n\n            if (oChild !== undefined)\n            {\n                if (this.hasLayer(oChild))\n                {\n                    this.removeLayer(oChild);\n                }\n                delete this.options.objectChildren[sCoreId];\n                \n                var oClusteredOverlay = this.getClusteredOverlay();\n\n                if (oClusteredOverlay)\n                {\n                    oClusteredOverlay.getClusterObject().removeLayer(oChild);\n                }\n            }\n        },\n        hasChildren: function()\n        {\n            return !emp.helpers.associativeArray.isEmpty(this.options.objectChildren);\n        }\n    };\n    \n    return publicInterface;\n};\n\nleafLet.typeLibrary.empObject = L.FeatureGroup.extend(leafLet.internalPrivateClass.empObject());\n","/* global L, leafLet, emp */\nleafLet.internalPrivateClass.DisplayableObject = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n                visible: args.item.visible,\n                leafletObject: undefined //set where needed\n            };\n            L.Util.setOptions(this, options);\n            leafLet.typeLibrary.empObject.prototype.initialize.call(this, args);\n        },\n        destroy: function()\n        {\n            var oLeafletObject = this.getLeafletObject();\n\n            if (oLeafletObject !== undefined)\n            {\n                if (typeof (oLeafletObject.closePopup) === 'function')\n                {\n                    oLeafletObject.closePopup();\n                }\n\n                if (this.hasLayer(oLeafletObject))\n                {\n                    this.removeLayer(oLeafletObject);\n                }\n                this.options.leafletObject = undefined;\n            }\n            leafLet.typeLibrary.empObject.prototype.destroy.call(this);\n        },\n        getLeafletObject: function()\n        {\n            return this.options.leafletObject;\n        },\n        isVisible: function()\n        {\n            return this.options.visible;\n        },\n        setVisibility: function(oItem)\n        {\n            this.options.visible = oItem.visible;\n            if (this.getLeafletObject() !== undefined)\n            {\n                if (oItem.visible && !this.hasLayer(this.getLeafletObject()))\n                {\n                    var oMapBounds = this.getLeafletMap().getBounds();\n                    this._updateLeafletObject(oMapBounds, this.getLeafletObject(), false);\n                    this.addLayer(this.getLeafletObject());\n                }\n                else if (!oItem.visible && this.hasLayer(this.getLeafletObject()))\n                {\n                    this.removeLayer(this.getLeafletObject());\n                }\n            }\n            // We don't have to process its children because the core will send everything that get affected.\n        },\n        setStyle: function(sType, oProperties)\n        {\n            var oChild;\n            var aKeyList = this.getChildKeyList();\n            \n            if (this.getObjectType() === leafLet.typeLibrary.objectType.FEATURE)\n            {\n                this.setFeatureStyle(sType, oProperties);\n            }\n            \n            for (var iIndex = 0; iIndex < aKeyList.length; iIndex++)\n            {\n                oChild = this.getChild(aKeyList[iIndex]);\n                \n                switch (oChild.getObjectType())\n                {\n                    case leafLet.typeLibrary.objectType.FEATURE:\n                    case leafLet.typeLibrary.objectType.OVERLAY:\n                        oChild.setStyle(sType, oProperties);\n                        break;\n                    case leafLet.typeLibrary.objectType.WMS:\n                    default:\n                        break;\n                }\n            }\n        }\n    };\n    \n    return publicInterface;\n};\n\nleafLet.typeLibrary.DisplayableObject = leafLet.typeLibrary.empObject.extend(leafLet.internalPrivateClass.DisplayableObject());\n","/* global leafLet, emp, L */\n\nleafLet.internalPrivateClass.EmpClusterGroup = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n                oOverlay: args.overlay,\n                instanceInterface: args.instanceInterface\n            };\n            L.Util.setOptions(this, options);\n\n            var oClusterDef = args.overlay.getClusterDef();\n            var oThis = this;\n            \n            L.MarkerClusterGroup.prototype.initialize.call(this, {\n                maxClusterRadius: oClusterDef.getDistance(),\n                zoomToBoundsOnClick: false,\n                iconCreateFunction: function(oCluster){\n                    return oThis._iconCreateFunction(oCluster);\n                }\n            });\n        },\n        getOverlay: function()\n        {\n            return this.options.oOverlay;\n        },\n        _ParamReplacementCB: function(oCluster, sParam)\n        {\n            var sRet = \"\";\n            var oOverlay = this.getOverlay();\n            var oClusterDef = oOverlay.getClusterDef();\n            \n            switch (sParam.toLowerCase())\n            {\n                case 'count':\n                    sRet = oCluster.getChildCount().toString();\n                    break;\n                case 'name':\n                    sRet = oOverlay.getName() || \"\";\n                    break;\n                case 'description':\n                    sRet = oOverlay.getDescription() || \"\";\n                    break;\n                case 'featurenames':\n                    var oFeatureList = oCluster.getAllChildMarkers();\n                    \n                    for (var iIndex = 0; iIndex < oFeatureList.length; iIndex++)\n                    {\n                        if (typeof (oFeatureList[iIndex].getName) === 'function')\n                        {\n                            sRet += oFeatureList[iIndex].getName();\n                            sRet += \"<br/>\";\n                        }\n                    }\n                    break;\n                case 'maxclusterradius':\n                    sRet = oClusterDef.getDistance() + \"m\";\n                    break;\n                case 'styletype':\n                    var oClusterStyle = oClusterDef.getClusterStyle();\n                    \n                    if (oClusterStyle.getIconStyle())\n                    {\n                        sRet = \"Icon Style\";\n                    }\n                    else if (oClusterStyle.getPointStyle())\n                    {\n                        sRet = \"Point Style\";\n                    }\n                    break;\n            }\n\n            return sRet;\n        },\n        _setClusterHeadingText: function(oCluster)\n        {\n            var oThis = this;\n            var sPopupText = \"\";\n            var oOverlay = this.getOverlay();\n            var oClusterDef = oOverlay.getClusterDef();\n            var oClusterStyle = oClusterDef.getClusterStyle();\n            var sTitle = emp.helpers.getReplacementString(oClusterStyle.getTitle(),\n                function(sParam)\n                {\n                    return oThis._ParamReplacementCB(oCluster, sParam);\n                }\n            );\n\n            if (sTitle.length > 0)\n            {\n                sPopupText += sTitle;\n            }\n            \n            oCluster.setPopupHeading(sPopupText);\n        },\n        _setClusterPopupText: function(oCluster)\n        {\n            var oThis = this;\n            var sPopupText = \"\";\n            var oOverlay = this.getOverlay();\n            var oClusterDef = oOverlay.getClusterDef();\n            var oClusterStyle = oClusterDef.getClusterStyle();\n            var sSummary = emp.helpers.getReplacementString(oClusterStyle.getSummary(), function(sParam)\n                {\n                    return oThis._ParamReplacementCB(oCluster, sParam);\n                });\n            var sDescription = emp.helpers.getReplacementString(oClusterStyle.getDescription(), function(sParam)\n                {\n                    return oThis._ParamReplacementCB(oCluster, sParam);\n                });\n\n            if (sSummary.length > 0)\n            {\n                sPopupText += sSummary + \"<br/>\";\n            }\n\n            if (sDescription.length > 0)\n            {\n                sPopupText += sDescription + \"<br/>\";\n            }\n            \n            oCluster.setPopupText(sPopupText);\n        },\n        _iconCreateFunction: function(oCluster)\n        {\n            var oClusterIcon;\n            var oThis = this;\n            var oOverlay = this.getOverlay();\n            var oClusterDef = oOverlay.getClusterDef();\n            var oClusterStyle = oClusterDef.getClusterStyle();\n            var oIconStyle = oClusterStyle.getIconStyle();\n            var oPointStyle = oClusterStyle.getPointStyle();\n            \n            oCluster.options.overlay = oOverlay;\n\n            if (oIconStyle)\n            {\n                var sStr = emp.helpers.getReplacementString(oClusterStyle.getLabel(), function(sParam)\n                    {\n                        return oThis._ParamReplacementCB(oCluster, sParam);\n                    });\n\n                var sURL = emp.helpers.getReplacementString(oIconStyle.getURL(), function(sParam)\n                    {\n                        return oThis._ParamReplacementCB(oCluster, sParam);\n                    });\n\n                if (sStr && sStr.length > 0)\n                {\n                    oClusterIcon = new L.DivIcon({\n                        className: \"iconStyleDiv\",\n                        html: \"<table><tbody><tr><td><img class='iconStyleDivIcon' src='\" + sURL + \"'></td><td class='iconStyleDivLabel'>\" + sStr + \"</td></tr></tbody></table>\"\n                    });\n                }\n                else\n                {\n                    oClusterIcon = new L.Icon({\n                        url: sURL\n                    });\n                }\n            }\n            else if (oPointStyle)\n            {\n                var sStr = emp.helpers.getReplacementString(oClusterStyle.getLabel(), function(sParam)\n                    {\n                        return oThis._ParamReplacementCB(oCluster, sParam);\n                    });\n                var sLabel = sStr.replace(\" \", \"\\n\");\n\n                var oImage = oPointStyle.createIcon(sLabel);\n                var iRadius = oPointStyle.getRadius();\n                oClusterIcon = new L.Icon({\n                    iconUrl: oImage.toDataURL(),\n                    iconAnchor: new L.Point(iRadius, iRadius),\n                    iconSize: new L.Point(oImage.width, oImage.height),\n                    popupAnchor:  new L.Point(iRadius, 0)\n                });\n            }\n            else\n            {\n                var sStr = emp.helpers.getReplacementString(oClusterStyle.getLabel(), function(sParam)\n                    {\n                        return oThis._ParamReplacementCB(oCluster, sParam);\n                    });\n                var sLabel = sStr.replace(\" \", \"\\n\");\n                var iRadius = 25;\n                var oImage = emp.helpers.createCircleCanvas({\n                        iRadius: iRadius,\n                        dOpacity: 1.0,\n                        sStrokeColor: \"darkBlue\",\n                        sFillColor: \"lightblue\",\n                        sTextColor: \"black\",\n                        sText: sLabel\n                    });\n\n                oClusterIcon = new L.Icon({\n                    iconUrl: oImage.toDataURL(),\n                    iconAnchor: new L.Point(iRadius / 2, iRadius / 2),\n                    iconSize: new L.Point(oImage.width, oImage.height),\n                    popupAnchor:  new L.Point(iRadius, 0)\n                });\n            }\n\n            this._setClusterPopupText(oCluster);\n            this._setClusterHeadingText(oCluster);\n\n            oCluster.on('click', function(oEvent){\n                if (oThis.getEngineInstanceInterface())\n                {\n                    oThis.getEngineInstanceInterface().handleFeatureClicked(oEvent);\n                }\n            }, this);\n\n            oCluster.on('contextmenu', function(oEvent){\n                if (oThis.getEngineInstanceInterface())\n                {\n                    oThis.getEngineInstanceInterface().handleFeatureClicked(oEvent);\n                }\n            }, this);\n\n            return oClusterIcon;\n        },\n        addLayer: function (layer) {\n            if (layer instanceof leafLet.typeLibrary.Feature)\n            {\n                var oChild;\n                var oKeyList = layer.getChildKeyList();\n\n                // If its a multi point TG we do not add it.\n                if ((layer.getFormat() !== emp.typeLibrary.featureFormatType.MILSTD) ||\n                        !layer.isMultiPointTG())\n                {\n                    if (layer.getLeafletObject())\n                    {\n                        var oThis = this;\n                        var oLeafletObject = layer.getLeafletObject();\n                        layer.removeLayer(oLeafletObject);\n                        this.addLayer(oLeafletObject);\n\n                        oLeafletObject.on('click', function(oEvent){\n                            if (oThis.getEngineInstanceInterface())\n                            {\n                                oEvent.target = layer;\n                                oThis.getEngineInstanceInterface().handleFeatureClicked(oEvent);\n                            }\n                        }, this);\n\n                        oLeafletObject.on('contextmenu', function(oEvent){\n                            if (oThis.getEngineInstanceInterface())\n                            {\n                                oEvent.target = layer;\n                                oThis.getEngineInstanceInterface().handleFeatureClicked(oEvent);\n                            }\n                        }, this);\n                    }\n                }\n\n                // Now we check to see if it\n                // has children to add.\n                if (layer.hasChildren())\n                {\n                    for (var iIndex = 0; iIndex < oKeyList.length; iIndex++)\n                    {\n                        oChild = layer.getChild(oKeyList[iIndex]);\n                        this.addLayer(oChild);\n                    }\n                }\n                return this;\n            }\n\n            if (layer instanceof L.LayerGroup) {\n                for (var i in layer._layers) {\n                    this.addLayer(layer._layers[i]);\n                }\n                return this;\n            }\n\n            //Don't cluster non point data\n            if (!layer.getLatLng) {\n                    this._nonPointGroup.addLayer(layer);\n                    return this;\n            }\n\n            if (!this._map) {\n                    this._needsClustering.push(layer);\n                    return this;\n            }\n\n            if (this.hasLayer(layer)) {\n                    return this;\n            }\n\n\n            //If we have already clustered we'll need to add this one to a cluster\n\n            if (this._unspiderfy) {\n                    this._unspiderfy();\n            }\n\n            this._addLayer(layer, this._maxZoom);\n\n            //Work out what is visible\n            var visibleLayer = layer,\n                    currentZoom = this._map.getZoom();\n            if (layer.__parent) {\n                    while (visibleLayer.__parent._zoom >= currentZoom) {\n                            visibleLayer = visibleLayer.__parent;\n                    }\n            }\n\n            if (this._currentShownBounds.contains(visibleLayer.getLatLng())) {\n                    if (this.options.animateAddingMarkers) {\n                            this._animationAddLayer(layer, visibleLayer);\n                    } else {\n                            this._animationAddLayerNonAnimated(layer, visibleLayer);\n                    }\n            }\n            return this;\n        },\n        removeLayer: function (layer) {\n            if (layer instanceof leafLet.typeLibrary.Feature)\n            {\n                var oChild;\n                var oKeyList = layer.getChildKeyList();\n\n                // If its a multi point TG we do not process it.\n                if ((layer.getFormat() !== emp.typeLibrary.featureFormatType.MILSTD) ||\n                        !layer.isMultiPointTG())\n                {\n                    if (layer.getLeafletObject())\n                    {\n                        var oLeafletObject = layer.getLeafletObject();\n\n                        this.removeLayer(oLeafletObject);\n                        layer.addLayer(oLeafletObject);\n\n                        oLeafletObject.off('click', function(oEvent){}, this);\n                        oLeafletObject.off('contextmenu', function(oEvent){}, this);\n                    }\n                }\n\n                // Now we check to see if it\n                // has children to process.\n                if (layer.hasChildren())\n                {\n                    for (var iIndex = 0; iIndex < oKeyList.length; iIndex++)\n                    {\n                        oChild = layer.getChild(oKeyList[iIndex]);\n                        this.removeLayer(oChild);\n                    }\n                }\n                return this;\n            }\n\n            if (layer instanceof L.LayerGroup)\n            {\n                    for (var i in layer._layers) {\n                        this.removeLayer(layer._layers[i]);\n                    }\n                    return this;\n            }\n\n            //Non point layers\n            if (!layer.getLatLng) {\n                    this._nonPointGroup.removeLayer(layer);\n                    return this;\n            }\n\n            if (!this._map) {\n                    if (!this._arraySplice(this._needsClustering, layer) && this.hasLayer(layer)) {\n                            this._needsRemoving.push(layer);\n                    }\n                    return this;\n            }\n\n            if (!layer.__parent) {\n                    return this;\n            }\n\n            if (this._unspiderfy) {\n                    this._unspiderfy();\n                    this._unspiderfyLayer(layer);\n            }\n\n            //Remove the marker from clusters\n            this._removeLayer(layer, true);\n\n            if (this._featureGroup.hasLayer(layer)) {\n                    this._featureGroup.removeLayer(layer);\n                    if (layer.clusterShow) {\n                            layer.clusterShow();\n                    }\n            }\n\n            return this;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.EmpClusterGroup = L.MarkerClusterGroup.extend(leafLet.internalPrivateClass.EmpClusterGroup());\n","/* global leafLet, L, emp */\n/* \n *\n */\nleafLet.internalPrivateClass.Overlay = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n                overlayId: args.item.overlayId,\n                oProperties: args.item.properties,\n                oClusterDef: (args.item.properties.cluster? new emp.typeLibrary.Overlay.Cluster(args.item.properties.cluster): undefined),\n                bClusterActive: (args.item.properties.bClusterActive === true) || false,\n                oLeafletClusterObject: undefined\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.DisplayableObject.prototype.initialize.call(this, args);\n        },\n        destroy: function()\n        {\n            if (this.hasClusterDef())\n            {\n                this.clusterRemove();\n            }\n            leafLet.typeLibrary.DisplayableObject.prototype.destroy.call(this);\n        },\n        getOverlayId: function()\n        {\n            return this.options.overlayId;\n        },\n        getDescription: function()\n        {\n            return (this.options.oProperties.hasOwnProperty('description')? this.options.oProperties.description: \"\");\n        },\n        hasFeatures: function()\n        {\n            for(var sCoreId in this.options.objectChildren)\n            {\n                if (!this.options.objectChildren.hasOwnProperty(sCoreId)) {\n                    continue;\n                }\n                var oChild = this.options.objectChildren[sCoreId];\n\n                switch (oChild.getObjectType())\n                {\n                    case leafLet.typeLibrary.objectType.FEATURE:\n                        return true;\n                    default:\n                        break;\n                }\n\n                if (oChild.hasFeatures())\n                {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n        getFeatureBounds: function()\n        {\n            var oBounds = undefined;\n            var oChildBounds;\n            var oChildList = this.getChildList();\n            \n            if (this.hasChildren())\n            {\n                var sKeys = emp.helpers.associativeArray.getKeys(oChildList);\n                \n                for (var iIndex = 0; iIndex < sKeys.length; iIndex++)\n                {\n                    oChildBounds = oChildList[sKeys[iIndex]].getFeatureBounds();\n                    \n                    if (oChildBounds)\n                    {\n                        if (!oBounds)\n                        {\n                            oBounds = new leafLet.typeLibrary.EmpBoundary(oChildBounds.getSouthWest(), oChildBounds.getNorthEast());\n                        }\n                        else\n                        {\n                            oBounds.addCoordinate(oChildBounds.getSouthWest());\n                            oBounds.addCoordinate(oChildBounds.getNorthEast());\n                        }\n                    }\n                }\n            }\n\n            return oBounds;\n        },\n        _setClusterDef: function(oClusterDef)\n        {\n            if (!(oClusterDef instanceof emp.typeLibrary.Overlay.Cluster))\n            {\n                throw new Error(\"Invalid overlay cluster object.\");\n            }\n            \n            this.options.oClusterDef = new emp.typeLibrary.Overlay.Cluster(oClusterDef);\n        },\n        getClusterObject: function()\n        {\n            return this.options.oLeafletClusterObject;\n        },\n        setName: function(sValue)\n        {\n            leafLet.typeLibrary.DisplayableObject.prototype.setName.call(this, sValue);\n\n            if (this.isCurrentlyClustered())\n            {\n                // we need to reset the cluster popup.\n                this.clusterDeactivate();\n                this.clusterActivate();\n            }\n        },\n        isCurrentlyClustered: function()\n        {\n            return this.hasClusterDef() && this.isClusterActive();\n        },\n        hasClusterDef: function()\n        {\n            return (this.options.oClusterDef instanceof emp.typeLibrary.Overlay.Cluster);\n        },\n        getClusterDef: function()\n        {\n            return this.options.oClusterDef;\n        },\n        isClusterActive: function()\n        {\n            return this.options.bClusterActive;\n        },\n        activateCluster: function()\n        {\n            this.options.bClusterActive = false;\n            this.clusterActivate();\n        },\n        clusterSet: function(oClusterDef)\n        {\n            if (this.hasClusterDef())\n            {\n                this.clusterRemove();\n            }\n            \n            this._setClusterDef(oClusterDef);\n            this.clusterActivate();\n        },\n        _doClusterActivate: function()\n        {\n            var oKeyList = this.getChildKeyList();\n            var oChild;\n\n            this.options.oLeafletClusterObject = new leafLet.typeLibrary.EmpClusterGroup(\n                {\n                    overlay: this,\n                    instanceInterface: this.getEngineInstanceInterface()\n                }\n            );\n            \n            this.getLeafletMap().addLayer(this.getClusterObject());\n            \n            for (var iIndex = 0; iIndex < oKeyList.length; iIndex++)\n            {\n                oChild = this.getChild(oKeyList[iIndex]);\n\n                //this.removeLayer(oChild);\n                if (oChild instanceof leafLet.typeLibrary.Overlay)\n                {\n                    if (oChild.isCurrentlyClustered())\n                    {\n                        // If we run into an overlay that is currently clusterred we skip it.\n                        continue;\n                    }\n                }\n                this.getClusterObject().addLayer(oChild);\n            }\n        },\n        clusterActivate: function()\n        {\n            if (this.hasClusterDef() && !this.isClusterActive())\n            {\n                this.deactivateParentCluster();\n                this._doClusterActivate();\n                this.options.bClusterActive = true;\n                this.activateParentCluster();\n            }\n        },\n        clusterDeactivate: function()\n        {\n            if (this.hasClusterDef() && this.isClusterActive())\n            {\n                var oChild;\n                var oKeyList = this.getChildKeyList();\n                //var oParent = this.getParentObject();\n\n                this.deactivateParentCluster();\n                //this.getClusterObject().clearLayers();\n                \n                for (var iIndex = 0; iIndex < oKeyList.length; iIndex++)\n                {\n                    oChild = this.getChild(oKeyList[iIndex]);\n\n                    if (oChild instanceof leafLet.typeLibrary.Overlay)\n                    {\n                        if (oChild.isCurrentlyClustered())\n                        {\n                            // If we run into an overlay that is currently clusterred we skip it.\n                            continue;\n                        }\n                    }\n                    this.getClusterObject().removeLayer(oChild);\n                }\n\n                this.getLeafletMap().removeLayer(this.getClusterObject());\n\n                this.options.oLeafletClusterObject = undefined;\n                this.options.bClusterActive = false;\n            \n                //oParent.addLayer(this);\n                this.activateParentCluster();\n            }\n        },\n        clusterRemove: function()\n        {\n            if (this.hasClusterDef())\n            {\n                this.clusterDeactivate();\n                this.options.oClusterDef = undefined;\n                this.options.bClusterActive = false;\n            }\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.Overlay = leafLet.typeLibrary.DisplayableObject.extend(leafLet.internalPrivateClass.Overlay());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.Feature = function () {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n                objectType: leafLet.typeLibrary.objectType.FEATURE,\n                featureId: args.item.featureId,\n                overlayId: args.item.overlayId,\n                parentId: args.item.parentId,\n                format: args.item.format,\n                url: args.item.url,\n                data: (args.item.data ? emp.helpers.copyObject(args.item.data) : undefined),\n                properties: (args.item.properties ? emp.helpers.copyObject(args.item.properties) : {}),\n                azimuth: ((args.item.properties && args.item.properties.azimuth) ? args.item.properties.azimuth: 0),\n                labelStyle: ((args.item.properties && args.item.properties.labelStyle) ? args.item.properties.labelStyle: args.instanceInterface.defaultLabelStyle),\n                selected: false,\n                bEditable: true,\n                isEditMode: false,\n                originalStyle: {} // Used to store the style of the feature before highlighting.\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.DisplayableObject.prototype.initialize.call(this, args);\n\n            this.setLeafletObject(this._createFeature(this.options));\n\n            this.on('click', function (oEvent) {\n                if (oEvent.target.getEngineInstanceInterface()) {\n                    oEvent.target.getEngineInstanceInterface().handleFeatureClicked(oEvent);\n                }\n            }, this);\n\n            this.on('contextmenu', function (oEvent) {\n                if (oEvent.target.getEngineInstanceInterface()) {\n                    oEvent.target.getEngineInstanceInterface().handleFeatureClicked(oEvent);\n                }\n            }, this);\n        },\n        destroy: function () {\n            this.getEngineInstanceInterface().oSelectionManager.removeFeature(this);\n            leafLet.typeLibrary.DisplayableObject.prototype.destroy.call(this);\n        },\n        getAzimuth: function() {\n            return this.options.azimuth;\n        },\n        getLabelStyle: function() {\n            return this.options.labelStyle;\n        },\n        isInEditMode: function () {\n            return this.options.isEditMode;\n        },\n        setEditMode: function () {\n            this.options.isEditMode = true;\n            if (this.isSelected()) {\n                this.render();\n                //this._unSelectFeature(this.getLeafletObject());\n            }\n        },\n        resetEditMode: function () {\n            this.options.isEditMode = false;\n            if (this.isSelected()) {\n                this.render();\n            }\n        },\n        setLeafletObject: function (oObject) {\n            //if (!oObject) {\n            //    return;\n            //}\n            \n            if (this.options.leafletObject && (this.options.leafletObject !== oObject)) {\n                //this.options.leafletObject.clearAllEventListeners();\n                this.removeLayer(this.options.leafletObject);\n            }\n\n            if (this.isVisible() && oObject) {\n                var oMapBounds = this.getLeafletMap().getBounds();\n                this._updateLeafletObject(oMapBounds, oObject, false);\n\n                if (oObject && (this.options.leafletObject !== oObject)) {\n                    this.addLayer(oObject);\n                }\n            }\n            this.options.leafletObject = oObject;\n        },\n        getOverlayId: function () {\n            return this.options.overlayId;\n        },\n        getFeatureId: function () {\n            return this.options.featureId;\n        },\n        getParentId: function () {\n            return this.options.parentId;\n        },\n        getData: function () {\n            return this.options.data;\n        },\n        setData: function (oData) {\n            this.options.data = oData;\n        },\n        getProperties: function () {\n            return this.options.properties;\n        },\n        setProperties: function (oProp) {\n            this.options.properties = oProp;\n        },\n        getFormat: function () {\n            return this.options.format;\n        },\n        isEditable: function () {\n            return this.options.bEditable;\n        },\n        isSelected: function (sSubItemID) {\n            var oSelectionManager = this.getEngineInstanceInterface().oSelectionManager;\n\n            return oSelectionManager.isSelected(this, sSubItemID);\n        },\n        isMilStd: function () {\n            return (this.options.format === emp.typeLibrary.featureFormatType.MILSTD);\n        },\n        isGeoJson: function () {\n            return (this.options.format === emp.typeLibrary.featureFormatType.GEOJSON);\n        },\n        isKML: function () {\n            return (this.options.format === emp.typeLibrary.featureFormatType.KML);\n        },\n        isAirspace: function () {\n            return (this.options.format === emp.typeLibrary.featureFormatType.AIRSPACE);\n        },\n        isImage: function () {\n            return (this.options.format === emp.typeLibrary.featureFormatType.IMAGE);\n        },\n        isAOI: function () {\n            return (this instanceof leafLet.typeLibrary.AOIFeature);\n        },\n        isGeoEllipse: function() {\n            return (this instanceof leafLet.typeLibrary.GeoEllipseFeature);\n        },\n        getFeatureBounds: function () {\n            var oBounds = undefined;\n            var oLeafletObject = this.getLeafletObject();\n            //var oMapBoundary = this.getEngineInstanceInterface().leafletInstance.getBounds();\n\n            if (oLeafletObject) {\n                if (typeof (oLeafletObject.getBounds) === 'function') {\n                    oBounds = new leafLet.typeLibrary.EmpBoundary(oLeafletObject.getBounds());\n                } else if (oLeafletObject instanceof L.Marker) {\n                    oBounds = new leafLet.typeLibrary.EmpBoundary(oLeafletObject.getLatLng().wrap(), oLeafletObject.getLatLng().wrap());\n                } else {\n                    throw new Error(\"Unable to get bounds of leaflet type.\");\n                }\n            }\n\n            return oBounds;\n        },\n        _createFeature: function (args) {\n            throw new Error(\"Class for feature of type \" + args.format + \" has not implemented a _createFeature function.\");\n        },\n        getAngleUnits: function () {\n            return leafLet.utils.AngleUnits.DEGREES;\n        },\n        getAzimuthUnits: function () {\n            return leafLet.utils.AngleUnits.DEGREES;\n        },\n        getAltitudeUnits: function () {\n            var sText = leafLet.utils.Units.FEET;\n\n            switch (this.options.format) {\n                case emp.typeLibrary.featureFormatType.GEOJSON:\n                case emp.typeLibrary.featureFormatType.AIRSPACE:\n                    sText = leafLet.utils.Units.METERS;\n                    break;\n                case emp.typeLibrary.featureFormatType.MILSTD:\n                    if (this.options.oMilStdModifiers.SYMSTD === 0) {\n                        sText = leafLet.utils.Units.FEET;\n                    } else {\n                        sText = leafLet.utils.Units.METERS;\n                    }\n                    break;\n                case emp.typeLibrary.featureFormatType.KML:\n                case emp.typeLibrary.featureFormatType.IMAGE:\n                    break;\n                default:\n                    // All Geo Spatial features are meters.\n                    sText = leafLet.utils.Units.METERS;\n                    break;\n            }\n\n            return sText;\n        },\n        getUnits: function () {\n            return leafLet.utils.Units.FEET;\n        },\n        getAltitudeModeAbbr: function () {\n            return leafLet.utils.AltitudeModeAbbr(this.options.properties.altitudeMode);\n        },\n        _getAltUnitsAndModeText: function () {\n            var sText = this.getAltitudeUnits();\n            var aAltMode = this.getAltitudeModeAbbr();\n\n            if (sText.length === 0) {\n                return \"\";\n            }\n\n            if (aAltMode.length > 0) {\n                sText += \" \" + aAltMode;\n            }\n\n            return sText;\n        },\n        _getPopupDescription: function () {\n            var sDescription = this.options.properties.description;\n\n            if (sDescription && (sDescription !== \"\")) {\n                //sDescription = \"<b>Description</b>:&nbsp;\" + sDescription + \"<br/>\";\n            } else {\n                sDescription = \"\";\n            }\n\n            return sDescription;\n        },\n        getPopupHeading: function () {\n            // Each feature class can override this function.\n            if (!this.options.name || (typeof (this.options.name) !== 'string') || (this.options.name === \"\")) {\n                return \"\";\n            }\n            return this.options.name;\n        },\n        getPopupText: function () {\n            // Each feature class can override this function.\n            return this._getPopupDescription();\n        },\n        updateFeature: function (args) {\n            var oNewLeafletObject;\n            var oArgs = {};\n            var oCoreFeature = args || {};\n\n            if (args.hasOwnProperty('bUpdateGraphic')) {\n                oArgs.bUpdateGraphic = args.bUpdateGraphic;\n            }\n\n            if (oCoreFeature.hasOwnProperty('format') && (oCoreFeature.format !== this.options.format)) {\n                throw new Error(\"A \" + this.options.format + \" feature can not be updated to a \" + oCoreFeature.format + \".\");\n            }\n\n            if (oCoreFeature.hasOwnProperty('name') && (oCoreFeature.name !== this.options.name)) {\n                oArgs.name = oCoreFeature.name;\n            } else {\n                oArgs.name = this.options.name;\n            }\n\n            if (oCoreFeature.hasOwnProperty('url') && (oCoreFeature.url !== this.options.url)) {\n                oArgs.url = oCoreFeature.url;\n            } else {\n                oArgs.url = this.options.url;\n            }\n\n            if (oCoreFeature.hasOwnProperty('data')) {\n                oArgs.data = emp.helpers.copyObject(oCoreFeature.data);\n            } else {\n                oArgs.data = this.options.data;\n            }\n\n            if (oCoreFeature.hasOwnProperty('properties')) {\n                oArgs.properties = emp.helpers.copyObject(oCoreFeature.properties);\n                if (oArgs.properties.lineColor !== this.getProperties().lineColor) {\n                    oArgs.bUpdateGraphic = true;\n                } else if (oArgs.properties.fillColor !== this.getProperties().fillColor) {\n                    oArgs.bUpdateGraphic = true;\n                }\n            } else {\n                oArgs.properties = this.options.properties;\n            }\n\n            oArgs.leafletObject = this.options.leafletObject;\n            //oArgs.instanceInterface = this.getEngineInstanceInterface();\n            oArgs.bEditable = this.options.bEditable;\n\n            oNewLeafletObject = this._updateFeature(oArgs);\n\n            this.setLeafletObject(oNewLeafletObject);\n\n            //this.options.featureId = oCoreFeature.featureId;\n            //this.options.overlayId = oCoreFeature.overlayId;\n            //this.options.parentId = oCoreFeature.parentId;\n            this.options.url = oArgs.url;\n            this.options.data = oArgs.data;\n            this.options.properties = oArgs.properties;\n            this.options.bEditable = oArgs.bEditable;\n            if (oCoreFeature.hasOwnProperty('name') && (oCoreFeature.name !== this.options.name)) {\n                this.setName(oArgs.name);\n            }\n        },\n        setSelection: function (bValue) {\n            if (bValue === this.options.selected) {\n                return;\n            }\n\n            this.options.selected = bValue;\n            if (!this.isInEditMode()) {\n                this.render();\n            }\n        },\n        render: function () {\n        },\n        _updateLeafletObject: function (oMapBounds, oLeafletObject, bWrappedAlready, iLevel) {\n            var oLatLngList;\n            var oNewLatLngList;\n            var bCoordWrapped = bWrappedAlready;\n            var iCurrentLevel = iLevel || 0;\n\n            if (!oLeafletObject) {\n                return bCoordWrapped;\n            }\n\n            if ((oLeafletObject instanceof L.Marker) ||\n                    (oLeafletObject instanceof L.Popup)) {\n                if (oLeafletObject.getLatLng()) {\n                    oLatLngList = [oLeafletObject.getLatLng()];\n                    bCoordWrapped = leafLet.utils.wrapCoordinates(oMapBounds, oLatLngList, bCoordWrapped);\n                    oLeafletObject.setLatLng(oLatLngList[0]);\n                }\n            } else if (oLeafletObject instanceof L.Polygon) {\n                oLatLngList = oLeafletObject.getLatLngs();\n\n                if (oLatLngList[0] && (oLatLngList[0][0] instanceof Array)) {\n                    for (var iList = 0; iList < oLatLngList.length; iList++) {\n                        bCoordWrapped = bCoordWrapped || leafLet.utils.wrapCoordinates(oMapBounds, oLatLngList[iIndex], bCoordWrapped);\n                    }\n                } else if (oLatLngList.length > 0) {\n                    bCoordWrapped = leafLet.utils.wrapCoordinates(oMapBounds, oLatLngList, bCoordWrapped);\n                }\n\n                if (bCoordWrapped) {\n                    oLeafletObject.setLatLngs(oLatLngList);\n                }\n            } else if (oLeafletObject instanceof L.Polyline) {\n                oNewLatLngList = [];\n                oLatLngList = oLeafletObject.getLatLngs();\n\n                if (oLatLngList.length > 0) {\n                    bCoordWrapped = leafLet.utils.wrapCoordinates(oMapBounds, oLatLngList, bCoordWrapped);\n                }\n\n                if (bCoordWrapped) {\n                    oLeafletObject.setLatLngs(oLatLngList);\n                }\n            } else if (oLeafletObject instanceof L.LayerGroup) {\n                var oItemList = oLeafletObject.getLayers();\n                var bHasNotWrapped = !bCoordWrapped;\n\n                for (var iIndex = 0; iIndex < oItemList.length; iIndex++) {\n                    bCoordWrapped = this._updateLeafletObject(oMapBounds, oItemList[iIndex], bCoordWrapped, iCurrentLevel + 1);\n                    if (bCoordWrapped && bHasNotWrapped) {\n                        bHasNotWrapped = false;\n                        if (iCurrentLevel === 0) {\n                            // We need the loop to start again.\n                            iIndex = -1;\n                        } else {\n                            // We need to break out so the top iteration starts over.\n                            break;\n                            ;\n                        }\n                    }\n                }\n            }\n\n            return bCoordWrapped;\n        },\n        updateCoordinates: function (oMapBounds) {\n            if (this.isVisible()) {\n                // We only update coordinates to the visible.\n                this._updateLeafletObject(oMapBounds, this.getLeafletObject(), false);\n            }\n        },\n        getLineStyle: function (sEMPStyle) {\n\n            var sLeaftletStyle;\n\n            switch (sEMPStyle) {\n                case emp.typeLibrary.OutlineStyleType.DOT:\n                    sLeaftletStyle = \"1, 5\";\n                    break;\n                case emp.typeLibrary.OutlineStyleType.DASH:\n                    sLeaftletStyle = \"10, 5\";\n                    break;\n                case emp.typeLibrary.OutlineStyleType.DASH_DOT:\n                    sLeaftletStyle = \"10, 5, 1, 5\";\n                    break;\n                case emp.typeLibrary.OutlineStyleType.LONG_DASH:\n                    sLeaftletStyle = \"20, 5\";\n                    break;\n                case emp.typeLibrary.OutlineStyleType.LONG_DASH_DOT:\n                    sLeaftletStyle = \"20, 5, 1, 5\";\n                    break;\n                case emp.typeLibrary.OutlineStyleType.SOLID:\n                default:\n                    break;\n            }\n\n            return sLeaftletStyle;\n        },\n        setFeatureStyle: function (sType, oProperties) {\n            switch (this.getFormat()) {\n                case emp.typeLibrary.featureFormatType.KML:\n                case emp.typeLibrary.featureFormatType.GEOJSON:\n                    this.setFeatureStyleProperties(sType, oProperties);\n                    break;\n                default:\n                    break;\n            }\n        },\n        _propagateEvent: function (e) {\n            if (e.target instanceof leafLet.typeLibrary.Feature) {\n                // If its a feature don't propagate.\n                return;\n            }\n\n            e = L.extend({\n                layer: e.target,\n                target: this\n            }, e);\n            this.fire(e.type, e);\n        },\n        _getPolygonProperties: function(args) {\n            var argsProperties = leafLet.utils.geoJson.mergeGeoJSONProperties(this.getEngineInstanceInterface(), args.properties);\n            var oProperties = {\n                smoothFactor: 1.0,\n                noClip: false,\n                oFeature: this\n            };\n            var strokeColor = (argsProperties.color? argsProperties.color: undefined);\n            var fillColor = (argsProperties.fillColor? argsProperties.fillColor: undefined);\n\n            // If they are both missing set the default stroke.\n            if ((strokeColor === undefined) && (fillColor === undefined)) {\n                strokeColor = '#' + this.getEngineInstanceInterface().defaultStrokeStyle.color;\n            }\n\n            if (strokeColor) {\n                oProperties['stroke'] = true;\n                oProperties['color'] = strokeColor;\n                oProperties['opacity'] = (argsProperties.opacity? argsProperties.opacity: this.getEngineInstanceInterface().defaultStrokeStyle.opacity);\n                oProperties['weight'] = (argsProperties.weight? argsProperties.weight: this.getEngineInstanceInterface().defaultStrokeStyle.width);\n            } else {\n                oProperties['stroke'] = false;\n                oProperties['color'] = null;\n            }\n\n            if (this.isSelected()) {\n                oProperties['tempColor'] = oProperties['color'];\n                oProperties['tempWeight'] = oProperties['weight'];\n                oProperties['color'] = '#' + this.getEngineInstanceInterface().selectAttributes.color;\n                oProperties['weight'] = this.getEngineInstanceInterface().selectAttributes.width;\n                oProperties['stroke'] = true;\n            }\n\n            if (fillColor) {\n                oProperties['fill'] = true;\n                oProperties['fillColor'] = fillColor;\n                oProperties['fillOpacity'] = (argsProperties.fillOpacity? argsProperties.fillOpacity: 0.8);\n            } else {\n                oProperties['fill'] = false;\n            }\n\n            return oProperties;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.Feature = leafLet.typeLibrary.DisplayableObject.extend(leafLet.internalPrivateClass.Feature());\n","\n/* global L, leafLet, emp */\nleafLet.internalPrivateClass.WMS = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            leafLet.typeLibrary.DisplayableObject.prototype.initialize.call(this, args);\n            var options = {\n                id: args.item.id,\n                overlayId: args.item.overlayId,\n                transparent: args.item.params.transparent,\n                format: args.item.params.format,\n                version: args.item.params.version,\n                activeLayer: (args.item.activeLayers? emp.helpers.copyObject(args.item.activeLayers): []),\n                url: args.item.url,\n                useProxy: args.item.useProxy\n            };\n            L.Util.setOptions(this, options);\n\n            this.options.leafletObject = this.createWMS(this.options);\n            if (this.options.leafletObject.wmsParams.hasOwnProperty('useProxy')) {\n                delete this.options.leafletObject.wmsParams.useProxy;\n            }\n            if ((this.options.leafletObject !== undefined) && this.options.visible && (this.options.activeLayer.length > 0))\n            {\n                this.getEngineInstanceInterface().addMapLayer(this.options.leafletObject);\n            }\n        },\n        destroy: function()\n        {\n            if (this.options.leafletObject !== undefined)\n            {\n                this.getEngineInstanceInterface().removeMapLayer(this.options.leafletObject);\n                this.options.leafletObject = undefined;\n            }\n            leafLet.typeLibrary.DisplayableObject.prototype.destroy.call(this);\n        },\n        getOverlayId: function()\n        {\n            return this.options.overlayId;\n        },\n        getId: function()\n        {\n            return this.options.id;\n        },\n        createWMS: function(args)\n        {\n            var oWMS = undefined;\n\n            oWMS = new L.TileLayer.WMS(args.url, {\n                layers: args.activeLayer.join(','),\n                format: args.format,\n                transparent: args.transparent,\n                version: args.version,\n                useProxy: args.useProxy\n            });\n\n            return oWMS;\n        },\n        updateWMS: function(args)\n        {\n            var options = {\n                id: args.id,\n                overlayId: args.overlayId,\n                transparent: args.params.transparent,\n                format: args.params.format,\n                version: args.params.version,\n                activeLayer: (args.activeLayers? emp.helpers.copyObject(args.activeLayers): []),\n                url: args.url,\n                useProxy: args.useProxy\n            };\n            var oWMS = this.createWMS(options);\n\n            if (this.hasLayer(this.options.leafletObject))\n            {\n                // Its on the map so we need to remove it.\n                this.getEngineInstanceInterface().removeMapLayer(this.options.leafletObject);\n            }\n\n            this.options.leafletObject = oWMS;\n            if (this.options.visible)\n            {\n                this.getEngineInstanceInterface().addMapLayer(this.options.leafletObject);\n            }\n        },\n        setVisibility: function(oItem)\n        {\n            this.options.activeLayer = (oItem.activeLayers? emp.helpers.copyObject(oItem.activeLayers): []);\n\n            if (this.options.leafletObject !== undefined)\n            {\n                if (oItem.visible)\n                {\n                    this.options.visible = true;\n                    this.options.leafletObject.setParams({\n                        layers: this.options.activeLayer.join(',')\n                    });\n                    this.getEngineInstanceInterface().addMapLayer(this.options.leafletObject);\n                }\n                else if (!oItem.visible && (this.options.activeLayer.length === 0))\n                {\n                    this.options.visible = false;\n                    this.getEngineInstanceInterface().removeMapLayer(this.options.leafletObject);\n                }\n                else\n                {\n                    this.options.leafletObject.setParams({\n                        layers: this.options.activeLayer.join(',')\n                    });\n                }\n            }\n            // We don't have to process its children because the core will send everything that get affected.\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.WMS = leafLet.typeLibrary.DisplayableObject.extend(leafLet.internalPrivateClass.WMS());\n","/* global leafLet, emp, L */\n\nleafLet.typeLibrary.EmpBoundary = function(oSouthWest, oNorthEast) {\n    var degNorth = undefined;\n    var degSouth = undefined;\n    var degWest = undefined;\n    var degEast = undefined;\n\n    this.initialize = function(oSW, oNE) {\n        var oLatLngList;\n        var index;\n\n        if (oSW === undefined) {\n            throw new Error(\"Invalid oSouthWest parameters.\");\n        } else if (oNE === undefined) {\n            if (oSW instanceof L.LatLngBounds) {\n                if (oSW.getSouthWest() && oSW.getNorthEast()) {\n                    oNE = oSW.getNorthEast();\n                    oSW = oSW.getSouthWest();\n                } else {\n                    throw new Error(\"Invalid type oSouthWest.\");\n                }\n            } else if (oSW instanceof Array) {\n                if (oSW.length < 2) {\n                    throw new Error(\"Invalid type oSouthWest.\");\n                }\n                \n                for (index = 0; index < oSW.length; index++) {\n                    publicInterface.addCoordinate(oSW[index]);\n                }\n                return;\n            } else if (oSW instanceof L.LatLng) {\n                oNE = oSW;\n            } else {\n                throw new Error(\"Invalid type oSouthWest.\");\n            }\n        }\n\n        oNE = oNE.wrap();\n        oSW = oSW.wrap();\n\n        degNorth = oNE.lat;\n        degEast = oNE.lng;\n        degSouth = oSW.lat;\n        degWest = oSW.lng;\n    };\n\n    var publicInterface = {\n        addCoordinate: function(oCoord) {\n            var oCoordinate = oCoord.wrap();\n\n            if (!degNorth) {\n                degNorth = oCoordinate.lat;\n                degSouth = oCoordinate.lat;\n                degWest = oCoordinate.lng;\n                degEast = oCoordinate.lng;\n            } else {\n                if (oCoordinate.lat > degNorth) {\n                    degNorth = oCoordinate.lat;\n                } else if (oCoordinate.lat < degSouth) {\n                    degSouth = oCoordinate.lat;\n                }\n\n                var degSE2Coord = emp.geoLibrary.GetAzimuth({x: degEast, y: degSouth}, {x: oCoordinate.lng, y: oCoordinate.lat});\n\n                if (degWest <= degEast) {\n                    // The bounds does NOT cross the IDL.\n                    if (degSE2Coord >= 0.0) {\n                        // The Logitude is east of the east edge.\n                        degEast = oCoordinate.lng;\n                    } else {\n                        var degSW2Coord = emp.geoLibrary.GetAzimuth({x: degWest, y: degSouth}, {x: oCoordinate.lng, y: oCoordinate.lat});\n\n                        if (degSW2Coord < 0.0) {\n                            // The Logitude is to the west of the west edge.\n                            degWest = oCoordinate.lng;\n                        }\n                    }\n                } else {\n                    // The bounds does cross the IDL.\n                    if (degSE2Coord <= 0.0) {\n                        // The Logitude is east of the east edge.\n                        degEast = oCoordinate.lng;\n                    } else {\n                        var degSW2Coord = emp.geoLibrary.GetAzimuth({x: degWest, y: degSouth}, {x: oCoordinate.lng, y: oCoordinate.lat});\n\n                        if (degSW2Coord > 0.0) {\n                            // The Logitude is to the west of the west edge.\n                            degWest = oCoordinate.lng;\n                        }\n                    }\n                }\n            }\n        },\n        getNorth: function() {\n            return degNorth;\n        },\n        getSouth: function() {\n            return degSouth;\n        },\n        getWest: function() {\n            return degWest;\n        },\n        getEast: function() {\n            return degEast;\n        },\n        getCenter: function() {\n            var lat = (degNorth + degSouth) / 2.0;\n            var lng = (degEast + degWest) / 2.0;\n            \n            if (degWest > degEast) {\n                if (lng > 0) {\n                    lng -= 180.0;\n                } else {\n                    lng += 180.0;\n                }\n            }\n            return new L.LatLng(lat, lng);\n        },\n        getCenterWest: function() {\n            var dCenterLat = (degNorth + degSouth) / 2.0;\n            return new L.LatLng(dCenterLat, degWest);\n        },\n        getCenterEast: function() {\n            var dCenterLat = (degNorth + degSouth) / 2.0;\n            return new L.LatLng(dCenterLat, degEast);\n        },\n        getSouthWest: function() {\n            return new L.LatLng(degSouth, degWest);\n        },\n        getNorthEast: function() {\n            return new L.LatLng(degNorth, degEast);\n        },\n        getSouthEast: function() {\n            return new L.LatLng(degSouth, degEast);\n        },\n        getNorthWest: function() {\n            return new L.LatLng(degNorth, degWest);\n        },\n        containsCoordiante: function(oCoordinate) {\n            if (!degNorth) {\n                return false;\n            } else {\n                if (oCoordinate.lat > degNorth) {\n                    return false;\n                } else if (oCoordinate.lat < degSouth) {\n                    return false;\n                }\n\n                if (this.containsIDL()) {\n                    if ((degEast < oCoordinate.lng) && (oCoordinate.lng < degWest)) {\n                        return false;\n                    }\n                } else {\n                    if ((degEast < oCoordinate.lng) || (oCoordinate.lng < degWest)) {\n                        return false;\n                    }\n                }\n            }\n\n            return true;\n        },\n        contained: function(oBoundary) {\n            if (!degNorth || !oBoundary.getNorth()) {\n                return false;\n            } else {\n                if (oBoundary.getNorth() > degNorth) {\n                    return false;\n                } else if (oBoundary.getSouth() < degSouth) {\n                    return false;\n                }\n\n                var degSE2Coord = emp.geoLibrary.GetAzimuth({x: degEast, y: degSouth}, {x: oBoundary.getEast(), y: oBoundary.getNorth()});\n\n                if (degWest < degEast) {\n                    // The IDL is not in the bounds.\n                    if (degSE2Coord > 0.0) {\n                        // The Logitude is east of the east edge.\n                        return false;\n                    } else {\n                        var degSW2Coord = emp.geoLibrary.GetAzimuth({x: degWest, y: degSouth}, {x: oCoordinate.lng, y: oCoordinate.lat});\n\n                        if (degSW2Coord < 0.0) {\n                            // The Logitude is to the west of the west edge.\n                            return false;\n                        }\n                    }\n                } else {\n                    if (degSE2Coord < 0.0) {\n                        // The Logitude is east of the east edge.\n                        return false;\n                    } else {\n                        var degSW2Coord = emp.geoLibrary.GetAzimuth({x: degWest, y: degSouth}, {x: oCoordinate.lng, y: oCoordinate.lat});\n\n                        if (degSW2Coord > 0.0) {\n                            // The Logitude is to the west of the west edge.\n                            return false;\n                        }\n                    }\n                }\n            }\n\n            return true;\n        },\n        intersects: function(oBoundary) {\n            if (!degNorth || !oBoundary.getNorth()) {\n                return false;\n            } else {\n                if ((oBoundary.getNorth() < degSouth) ||\n                        (oBoundary.getSouth() > degNorth)) {\n                    // The oBoundary is below or above this one.\n                    return false;\n                } else if (this.containsIDL()) {\n                    var bounds = new leafLet.typeLibrary.EmpBoundary(this.getSouthWest(), new L.LatLng(degNorth, 180.0));\n                    \n                    if (!oBoundary.intersects(bounds)) {\n                        bounds = new leafLet.typeLibrary.EmpBoundary(new L.LatLng(degSouth, -180.0), this.getNorthEast());\n                        return oBoundary.intersects(bounds);\n                    }\n                }else if (oBoundary.containsIDL()) {\n                    var bounds = new leafLet.typeLibrary.EmpBoundary(oBoundary.getSouthWest(), new L.LatLng(oBoundary.getNorth(), 180.0));\n                    \n                    if (!this.intersects(bounds)) {\n                        bounds = new leafLet.typeLibrary.EmpBoundary(new L.LatLng(oBoundary.getSouth(), -180.0), oBoundary.getNorthEast());\n                        return this.intersects(bounds);\n                    }\n                } else {\n                    var oSouthWest = this.getSouthWest();\n                    var oBNorthEast = oBoundary.getNorthEast();\n                    var dBrng = oSouthWest.bearingTo(oBNorthEast);\n\n                    if ((dBrng < 0.0) || (dBrng > 90.0)) {\n                        return false;\n                    }\n\n                    var oSouthEast = this.getSouthEast();\n                    var oBNorthWest = oBoundary.getNorthWest();\n\n                    dBrng = oSouthEast.bearingTo(oBNorthWest);\n\n                    if (dBrng < 270.0) {\n                        return false;\n                    }\n                }\n            }\n\n            return true;\n        },\n        isEmpty: function() {\n            return (!degNorth || !degSouth || !degWest || !degEast);\n        },\n        getCenterWidth: function() {\n            var oCenterWest = this.getCenterWest();\n            var oCenterEast = this.getCenterEast();\n            return oCenterWest.distanceTo(oCenterEast);\n        },\n        setCenterWidth: function(dWidth) {\n            var oCenter = this.getCenter();\n            var oNewWestCoord = oCenter.destinationPoint(-90.0, dWidth / 2.0);\n            var oNewEastCoord = oCenter.destinationPoint(90.0, dWidth / 2.0);\n\n            degWest = oNewWestCoord.lng;\n            degEast = oNewEastCoord.lng;\n        },\n        containsIDL: function() {\n            return (degWest > degEast);\n        }\n    };\n\n    this.initialize(oSouthWest, oNorthEast);\n\n    return publicInterface;\n};\n","/* global L, leafLet, emp, armyc2, sec */\n\nleafLet.internalPrivateClass.MilStdFeature = function() {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n                oMilStdModifiers: {},\n                sBasicSymbolCode: undefined,\n                i2525Version: 0,\n                bIsMultiPointTG: false\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        getMilStdModifiers: function() {\n            return this.options.oMilStdModifiers;\n        },\n        getBasicSymbolCode: function() {\n            return this.options.sBasicSymbolCode;\n        },\n        getAzimuthUnits: function() {\n            var sUnits = leafLet.utils.AngleUnits.DEGREES;\n            var RendererSettings = armyc2.c2sd.renderer.utilities.RendererSettings;\n            var oBasicSymbolCode = leafLet.utils.milstd.basicSymbolCode;\n\n            switch (this.getBasicSymbolCode()) {\n            case oBasicSymbolCode.RECTANGULAR_TARGET:\n                switch (this.get2525Version()) {\n                case RendererSettings.Symbology_2525Bch2_USAS_13_14:\n                    sUnits = leafLet.utils.AngleUnits.MILS;\n                    break;\n                case RendererSettings.Symbology_2525C:\n                    sUnits = leafLet.utils.AngleUnits.DEGREES;\n                    break;\n                }\n                break;\n            }\n            return sUnits;\n        },\n        getAltitudeUnits: function() {\n            var sRet = leafLet.utils.Units.FEET;\n\n            return sRet;\n        },\n        getUnits: function() {\n            var retValue = leafLet.utils.Units.METERS;\n            var RendererSettings = armyc2.c2sd.renderer.utilities.RendererSettings;\n            var oBasicSymbolCode = leafLet.utils.milstd.basicSymbolCode;\n\n            switch (this.getBasicSymbolCode()) {\n            case oBasicSymbolCode.RECTANGULAR_TARGET:\n                /*\n                                    switch (this.get2525Version())\n                                    {\n                                        case RendererSettings.Symbology_2525Bch2_USAS_13_14:\n                                        case RendererSettings.Symbology_2525C:\n                                            retValue = leafLet.utils.Units.METERS;\n                                            break;\n                                    }\n                */\n                break;\n            }\n\n            return retValue;\n        },\n        getPopupHeading: function() {\n            var sText = this.getName();\n\n            if (!sText || (typeof (sText) !== 'string') || (sText === \"\")) {\n                // There is no name, check for a unique identifier.\n                var cMilStdModifiers = leafLet.utils.milstd.Modifiers;\n                var oModifiers = this.getMilStdModifiers();\n\n                if (oModifiers.hasOwnProperty(cMilStdModifiers.UNIQUE_DESIGNATOR_1)) {\n                    sText = oModifiers[cMilStdModifiers.UNIQUE_DESIGNATOR_1];\n                } else {\n                    sText = \"\";\n                }\n            }\n\n            return sText;\n        },\n        getPopupText: function() {\n            var sPopupText = \"\";\n            if (this.options.leafletObject instanceof L.Marker) {\n                var oCoordList = this.getCoordinateList();\n\n                sPopupText = \"<b>Symbol Code</b>:&nbsp;\" + this.options.data.symbolCode +\n                             \"<br/>&nbsp;&nbsp;&nbsp;&nbsp;<b>Lat</b>:&nbsp;\" + oCoordList[0].lat.toFixed(5) +\n                             \"<br/>&nbsp;&nbsp;&nbsp;&nbsp;<b>Lon</b>:&nbsp;\" + oCoordList[0].lng.toFixed(5) +\n                             (!isNaN(oCoordList[0].alt)? \"<br/>&nbsp;&nbsp;&nbsp;&nbsp;<b>Alt</b>:&nbsp;\" + oCoordList[0].alt + this._getAltUnitsAndModeText(): \"\") +\n                             \"<br/><br/>\" + this._getPopupDescription();\n            } else {\n                sPopupText = \"<b>Symbol Code</b>:&nbsp;\" + this.options.data.symbolCode + \"<br/><br/>\" +\n                             this._getPopupDescription();\n            }\n\n            return sPopupText;\n        },\n        _createMultiPointFeature: function(args, oModifier, i2525Version) {\n            var leafletObject;\n            var leafletObject2;\n            var leafletObjectTemp;\n            var sDescription = args.properties.description || \"\";\n            var oMapBounds = this.getEngineInstanceInterface().leafletInstance.getBounds();\n            var oEmpMapBounds = new leafLet.typeLibrary.EmpBoundary(oMapBounds.getSouthWest(), oMapBounds.getNorthEast());\n\n            leafLet.utils.milstd.applyRequiredModifiers(args.data.symbolCode, oModifier, i2525Version, this.getEngineInstanceInterface().getLeafletMap());\n\n            leafletObject = leafLet.utils.milstd.renderMPGraphic({\n                instanceInterface: this.getEngineInstanceInterface(),\n                isSelected: args.selected,\n                sID: args.coreId,\n                sName: args.name,\n                sDescription: sDescription,\n                sSymbolCode: args.data.symbolCode,\n                oCoordData: args.data,\n                oModifiers: oModifier,\n                i2525Version: i2525Version,\n                oFeature: this,\n                empMapBounds: oEmpMapBounds\n            });\n\n            return leafletObject;\n        },\n        _createSinglePointFeature: function(oItem, oModifiers) {\n            var oFeature;\n            var oCoordinates = leafLet.utils.geoJson.convertCoordinatesToLatLng(oItem.data)[0];\n            var oMilStdIcon = this._getSinglePointIcon(oItem, oModifiers);\n\n            oFeature = new L.Marker(oCoordinates, {\n                icon: oMilStdIcon,\n                oFeature: this\n            });\n\n            return oFeature;\n        },\n        _modifierOnList: function(sModifier) {\n            return ((this.getEngineInstanceInterface().oLabelList.indexOf(sModifier) === -1)? false: true);\n        },\n        _getSinglePointIcon: function(oItem, oMainModifiers) {\n          var iconUrl,\n              sModifier,\n              oModifierArray = [],\n              oModifiers = {},\n              sClassName = '',\n              strippedSymbolCode = '',\n              msa = armyc2.c2sd.renderer.utilities.MilStdAttributes,\n              image,\n              oMilStdIcon,\n              oOffset,\n              oImageBounds,\n              renderingOptimization,\n              baseURL,\n              sModifiers,\n              size,\n              svgColor;\n\n            if (!oMainModifiers.hasOwnProperty('T') ||\n                    (oMainModifiers.hasOwnProperty('T') && (oMainModifiers.T !== oItem.name))) {\n                // If there is no T or its diff than name.\n                oMainModifiers[\"CN\"] = oItem.name;\n            }\n\n            for (sModifier in oMainModifiers) {\n                if (oMainModifiers.hasOwnProperty(sModifier)) {\n                    switch (sModifier) {\n                    case leafLet.utils.milstd.longModifiers.FILL_COLOR:\n                        if (L.Browser.canvas) {\n                            oModifiers[msa.FillColor] = '#' + oMainModifiers[sModifier];\n                        } else {\n                            oModifiers['fillcolor'] = oMainModifiers[sModifier];\n                        }\n                        break;\n                    case leafLet.utils.milstd.longModifiers.LINE_COLOR:\n                        if (L.Browser.canvas) {\n                            oModifiers[msa.LineColor] = '#' + oMainModifiers[sModifier];\n                        } else {\n                            oModifiers['linecolor'] = oMainModifiers[sModifier];\n                        }\n                        break;\n                    case leafLet.utils.milstd.Modifiers.STANDARD:\n                        oModifiers[sModifier] = oMainModifiers[sModifier];\n                        break;\n                    default:\n                        if (this._modifierOnList(sModifier)) {\n                            oModifiers[sModifier] = oMainModifiers[sModifier];\n                        }\n                        break;\n                    }\n                }\n            }\n\n            oModifiers.SIZE = this.getEngineInstanceInterface().iMilStdIconSize;\n            if (this.isSelected()) {\n                sClassName = 'icon-selected';\n            }\n\n            if (L.Browser.canvas) {\n                image = armyc2.c2sd.renderer.MilStdIconRenderer.Render(oItem.data.symbolCode, oModifiers);\n                iconUrl = image.toDataUrl();\n            oOffset = image.getCenterPoint();\n            oImageBounds = image.getImageBounds();\n            renderingOptimization = this.getEngineInstanceInterface().renderingOptimization;\n            oMilStdIcon;\n            if (renderingOptimization.viewInZone) {\n              switch (renderingOptimization.viewInZone) {\n                case \"farDistanceZone\":\n                  switch (oItem.data.symbolCode.charAt(1)) {\n                    case \"H\":\n                    case \"S\":\n                    case \"J\":\n                    case \"K\":\n                      svgColor = renderingOptimization.farDistanceThreshold.RED;\n                      break;\n                    case \"F\":\n                    case \"D\":\n                    case \"A\":\n                    case \"M\":\n                      svgColor = renderingOptimization.farDistanceThreshold.BLUE;\n                      break;\n                    case \"N\":\n                    case \"L\":\n                      svgColor = renderingOptimization.farDistanceThreshold.GREEN;\n                      break;\n                    case \"U\":\n                    case \"P\":\n                    case \"G\":\n                    case \"W\":\n                      svgColor = renderingOptimization.farDistanceThreshold.YELLOW;\n                      break;\n                    default:\n                      svgColor = renderingOptimization.farDistanceThreshold.YELLOW;\n                      break;\n                  }\n                  image = renderingOptimization.farDistanceThreshold.getSVG({\n                    x: oOffset.x,\n                    y: oOffset.y,\n                    radius: 3,\n                    color: svgColor\n                  });\n                  iconUrl = 'data:image/svg+xml,' + image;\n                  break;\n                case \"midDistanceZone\":\n                  strippedSymbolCode = oItem.data.symbolCode.slice(0, 10).concat(\"-----\");\n                  image = armyc2.c2sd.renderer.MilStdIconRenderer.Render(strippedSymbolCode, {SIZE: oModifiers.SIZE});\n                  iconUrl = image.toDataUrl();\n                  oOffset = image.getCenterPoint();\n                  oImageBounds = image.getImageBounds();\n                  break;\n              }\n            }\n                oMilStdIcon = new L.Icon({\n                    iconUrl:iconUrl,\n                    iconAnchor: new L.Point(oOffset.x, oOffset.y),\n                    iconSize: new L.Point(oImageBounds.width, oImageBounds.height),\n                    popupAnchor:  new L.Point(oOffset.x, oOffset.y),\n                    className: sClassName\n                });\n\n                return oMilStdIcon;\n            }\n          sModifiers = \"\";\n            for (sModifier in oModifiers) {\n                if (oModifiers.hasOwnProperty(sModifier)) {\n                    oModifierArray.push(sModifier + \"=\" + oModifiers[sModifier]);\n                }\n            }\n\n            if (oModifierArray.length > 0) {\n                sModifiers = \"?\" + oModifierArray.join(\"&\");\n            }\n\n            if (!emp.map.engine.rendererUrl || emp.map.engine.rendererUrl === \"\") {\n                baseURL = location.protocol + \"//\" + location.host + \"/\";\n            } else {\n                baseURL = emp.map.engine.rendererUrl;\n            }\n\n            iconUrl = baseURL + \"/mil-sym-service/renderer/image/\" + oItem.data.symbolCode + sModifiers;\n          size = oModifiers.size || 32;\n          oMilStdIcon = new L.Icon({\n                iconUrl:iconUrl,\n                className: sClassName\n            });\n\n            return oMilStdIcon;\n        },\n        _updateSinglePointFeature: function(oItem, oModifiers, bUpdateIcon) {\n            var oCoordinates = leafLet.utils.geoJson.convertCoordinatesToLatLng(oItem.data)[0];\n\n            if (bUpdateIcon) {\n                var oIcon = this._getSinglePointIcon(oItem, oModifiers);\n                oItem.leafletObject.setLatLng(oCoordinates);\n                oItem.leafletObject.setIcon(oIcon);\n            } else {\n                oItem.leafletObject.setLatLng(oCoordinates);\n            }\n            oItem.leafletObject.update();\n\n            return oItem.leafletObject;\n        },\n        _createFeature: function(oOptions) {\n            var oFeature = undefined;\n            var sSymbolCode = oOptions.data.symbolCode;\n            var oModifiers = leafLet.utils.milstd.convertModifiersTo2525(oOptions);\n            var i2525Version = oModifiers[leafLet.utils.milstd.Modifiers.STANDARD];\n            var isMultiPoint = armyc2.c2sd.renderer.utilities.SymbolUtilities.isMultiPoint(sSymbolCode, i2525Version);\n            var sBasicSymbolCode = armyc2.c2sd.renderer.utilities.SymbolUtilities.getBasicSymbolID(sSymbolCode);\n            var oSymbolDef = armyc2.c2sd.renderer.utilities.SymbolDefTable.getSymbolDef(sBasicSymbolCode, i2525Version);\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oOptions.data);\n\n            if (oSymbolDef && (oCoordList.length < oSymbolDef.minPoints)) {\n                // We can't draw it yet.\n                this.options.oMilStdModifiers = new leafLet.typeLibrary.MilStdModifiers(this, oModifiers);\n                this.options.properties.modifiers = this.options.oMilStdModifiers.toLongModifiers();\n                this.options.i2525Version = i2525Version;\n                this.options.sBasicSymbolCode = sBasicSymbolCode;\n                return undefined;\n            }\n\n            if (isMultiPoint) {\n                oFeature = this._createMultiPointFeature(oOptions, oModifiers, i2525Version);\n                oOptions.bIsMultiPointTG = true;\n            } else if (oOptions.data.coordinates.length > 0) {\n                oFeature = this._createSinglePointFeature(oOptions, oModifiers);\n                oOptions.bIsMultiPointTG = false;\n            }\n\n            if (oFeature) {\n                var oMapBoundry = this.getEngineInstanceInterface().leafletInstance.getBounds();\n                this._updateLeafletObject(oMapBoundry, oFeature, false);\n            }\n\n            this.options.oMilStdModifiers = new leafLet.typeLibrary.MilStdModifiers(this, oModifiers);\n            this.options.properties.modifiers = this.options.oMilStdModifiers.toLongModifiers();\n            this.options.i2525Version = i2525Version;\n            this.options.sBasicSymbolCode = sBasicSymbolCode;\n            return oFeature;\n        },\n        getCoordinateList: function() {\n            return leafLet.utils.geoJson.convertCoordinatesToLatLng(this.getData());\n        },\n        setCoordinates: function(oLatLngList) {\n            leafLet.utils.geoJson.convertLatLngListToGeoJson(this.getData(), oLatLngList);\n        },\n        isMultiPointTG: function() {\n            return this.options.bIsMultiPointTG;\n        },\n        getFeatureBounds: function() {\n            var oEmpBoundary = leafLet.typeLibrary.Feature.prototype.getFeatureBounds.call(this);\n\n            if (!oEmpBoundary || oEmpBoundary.isEmpty()) {\n                var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(this.options.data);\n\n                oEmpBoundary = new leafLet.typeLibrary.EmpBoundary(oCoordList);\n            }\n\n            return oEmpBoundary;\n        },\n        get2525Version: function() {\n            return this.options.i2525Version;\n        },\n        render: function() {\n            if (this.isVisible()) {\n                var oLeafletObject = this._createFeature(this.options);\n\n                this.setLeafletObject(oLeafletObject);\n            }\n        },\n        _updateMilStdFeature: function(args, oModifiers, bUpdateGraphic) {\n            var oFeature = undefined;\n            var sSymbolCode = args.data.symbolCode;\n            var i2525Version = oModifiers[leafLet.utils.milstd.Modifiers.STANDARD];\n            var isMultiPoint = armyc2.c2sd.renderer.utilities.SymbolUtilities.isMultiPoint(sSymbolCode, i2525Version);\n\n            if (isMultiPoint) {\n                oFeature = this._createMultiPointFeature(args, oModifiers, i2525Version);\n                args.bIsMultiPointTG = true;\n            } else {\n                oFeature = this._updateSinglePointFeature(args, oModifiers, bUpdateGraphic);\n            }\n\n            if (oFeature) {\n                var oMapBoundry = this.getEngineInstanceInterface().leafletInstance.getBounds();\n                this._updateLeafletObject(oMapBoundry, oFeature, false);\n            }\n\n            return oFeature;\n        },\n        updateCoordinates: function(oMapBounds) {\n            if (this.isVisible() && !this.isMultiPointTG()) {\n                // We only update coordinates to the visible NON tactical graphics.\n                // TG will get re-rendered.\n                this._updateLeafletObject(oMapBounds, this.getLeafletObject(), false);\n            }\n        },\n        _updateFeature: function(oArgs) {\n            var oNewFeafure;\n            var sModifier;\n            var bUpdateGraphic = (oArgs.bUpdateGraphic === true);\n            var oMilStdModifiers = this.options.oMilStdModifiers;\n            var oMilStdUtil = leafLet.utils.milstd;\n            var oModifiers = oMilStdUtil.convertModifiersTo2525(oArgs);\n\n            if (!bUpdateGraphic) {\n                if ((oArgs.hasOwnProperty('name') && (oArgs['name'] !== this.getName()))) {\n                    bUpdateGraphic = true;\n                } else if (oArgs.data.symbolCode !== this.options.data.symbolCode) {\n                    // The symbol changed we need to regenerate the graphic.\n                    bUpdateGraphic = true;\n                } else {\n                    for (sModifier in oModifiers) {\n                        if (!oModifiers.hasOwnProperty(sModifier)) {\n                            continue;\n                        }\n                        if (oMilStdModifiers.oModifiers[sModifier] === undefined) {\n                            // There is a new modifiers.\n                            // We need to regenerate the graphic.\n                            bUpdateGraphic = true;\n                            break;\n                        } else if (!oMilStdUtil.areModifierValuesEqual(oMilStdModifiers.oModifiers[sModifier], oModifiers[sModifier])) {\n                            // The modifier changed.\n                            // We need to regenerate the graphic.\n                            bUpdateGraphic = true;\n                            break;\n                        }\n                    }\n\n                    if (!bUpdateGraphic) {\n                        for (sModifier in oMilStdModifiers.oModifiers) {\n                            if (!oMilStdModifiers.oModifiers.hasOwnProperty(sModifier)) {\n                                continue;\n                            }\n                            if ((sModifier !== 'CN') && (oModifiers[sModifier] === undefined)) {\n                                // A modifier was removed.\n                                // We need to regenerate the graphic.\n                                bUpdateGraphic = true;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n\n            oNewFeafure = this._updateMilStdFeature(oArgs, oModifiers, bUpdateGraphic);\n            this.options.oMilStdModifiers = new leafLet.typeLibrary.MilStdModifiers(this, oModifiers);\n            this.options.properties.modifiers = this.options.oMilStdModifiers.toLongModifiers();\n            this.options.bIsMultiPointTG = oArgs.bIsMultiPointTG;\n\n            return oNewFeafure;\n        },\n        updateIconSize: function() {\n            var sSymbolCode = this.options.data.symbolCode;\n            var oModifiers = this.options.oMilStdModifiers.toModifiers();\n            var i2525Version = oModifiers[leafLet.utils.milstd.Modifiers.STANDARD];\n            var isMultiPoint = armyc2.c2sd.renderer.utilities.SymbolUtilities.isMultiPoint(sSymbolCode, i2525Version);\n\n            if (!isMultiPoint) {\n                this._updateSinglePointFeature(this.options, oModifiers, true);\n            }\n        },\n        resetEditMode: function() {\n            this.options.isEditMode = false;\n            if (this.isSelected() && this.isMultiPointTG()) {\n                this.render();\n            }\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.MilStdFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.MilStdFeature());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.KMLFeature = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n                sKMLName: undefined,\n                sKMLDesctiption: undefined\n            };\n            L.Util.setOptions(this, options);\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        getPopupHeading: function(oLeafletObject)\n        {\n            var sText = this.options.name;\n            var sKMLName = '';\n            \n            if (oLeafletObject && oLeafletObject.options.hasOwnProperty('kmlName'))\n            {\n                sKMLName = oLeafletObject.options.kmlName;\n            }\n            \n            if ((typeof (sText) === 'string') && (sText.length > 0))\n            {\n                if ((typeof (sKMLName) === 'string') && (sKMLName.length > 0))\n                {\n                    if (sText !== sKMLName)\n                    {\n                        sText += \" (\" + sKMLName + \")\";\n                    }\n                }\n            }\n            else if ((typeof (sKMLName) === 'string') && (sKMLName.length > 0))\n            {\n                sText = sKMLName;\n            }\n            \n            return sText;\n        },\n        getPopupText: function(oLeafletObject)\n        {\n            var sPopupText = \"\";\n            var sKMLDescription = '';\n            \n            if (oLeafletObject && oLeafletObject.options.hasOwnProperty('kmlDescription'))\n            {\n                sKMLDescription = oLeafletObject.options.kmlDescription;\n            }\n\n            if (oLeafletObject instanceof L.Marker)\n            {\n                var oLatLng = oLeafletObject.getLatLng().wrap();\n                sPopupText += \n                        \"<center><b>Lat</b>:&nbsp;\" + oLatLng.lat.toFixed(5) + \"<br/><b>Lon</b>:&nbsp;\" + oLatLng.lng.toFixed(5) +\n                        ((oLatLng.alt)? \"<br/><b>Alt</b>:&nbsp;\" + oLatLng.alt + this._getAltUnitsAndModeText(): \"\") + \"</center><br/>\";\n            }\n\n            if (!emp.util.isEmptyString(this._getPopupDescription()))\n            {\n                sPopupText += this._getPopupDescription();\n            }\n            else if (!emp.util.isEmptyString(sKMLDescription))\n            {\n                //sPopupText += \"<br/><center><b>Description</b></center>\" +\n                //    this.options.sKMLDesctiption;\n                sPopupText += sKMLDescription;\n            }\n            return sPopupText;\n        },\n        _getUrlViaProxy: function(sURL)\n        {\n            var data = \"mime=text/xml&url=\" + escape(sURL),\n                proxyUrl;\n            // Check for V2 environment\n            if (emp.hasOwnProperty(\"appSetup\")) {\n              proxyUrl = emp.appSetup.urlProxy;\n            } else {\n              proxyUrl = emp.util.config.getProxyUrl();\n            }\n            \n            return proxyUrl + \"?\" + data;\n        },\n        _setKMLParameters: function(oKmlDoc, oOptions)\n        {\n            if (oKmlDoc)\n            {\n                // We need the name and description if there was any in the KML in case there is\n                // none in the feature.\n                // However if the KML has more than one name and description,\n                // we take the first one we find.\n                emp.$.each(emp.$(oKmlDoc).find(\"name\"), function(i, oNameElem)\n                {\n                    if (oOptions.sKMLName === undefined)\n                    {\n                        oOptions.sKMLName = oNameElem.textContent;\n                    }\n                });\n                emp.$.each(emp.$(oKmlDoc).find(\"description\"), function(i, oDescElem)\n                {\n                    if (oOptions.sKMLDesctiption === undefined)\n                    {\n                        oOptions.sKMLDesctiption = oDescElem.textContent;\n                    }\n                });\n            }\n        },\n        _createFeatureFromString: function(oOptions)\n        {\n            var oFeature = new leafLet.typeLibrary.EmpKmlObject(oOptions.data, {\n                async: false,\n                kmlDoc: undefined,\n                oFeature: this,\n                oFeatureProperties: oOptions.properties,\n                sProxyUrl: (this.options.instanceInterface.bUseProxy? this.options.instanceInterface.getProxyURL(): undefined),\n                basePath: this.getEngineInstanceInterface().getBasePath()\n            });\n\n            if (oFeature === undefined)\n            {\n                throw new Error(\"KML returned no object.\");\n            }\n            else if ((oFeature instanceof L.LayerGroup) &&\n                    (oFeature.getLayers().length === 1))\n            {\n                var oChild = oFeature.getLayers()[0];\n\n                if ((oChild instanceof L.Polygon) ||\n                    (oChild instanceof L.Polyline) ||\n                    (oChild instanceof L.Marker))\n                {\n                    oOptions.bEditable = true;\n                }\n                else\n                {\n                    oOptions.bEditable = false;\n                }\n            }\n            else\n            {\n                oOptions.bEditable = false;\n            }\n\n            this._setKMLParameters(oFeature.options.kmlDoc, oOptions);\n\n            return oFeature;\n        },\n        _createFeatureFromURL: function(oOptions)\n        {\n            var oFeature = new leafLet.typeLibrary.EmpKmlObject(oOptions.url, {\n                async: false,\n                kmlDoc: undefined,\n                oFeature: this,\n                oFeatureProperties: oOptions.properties,\n                sProxyUrl: (this.options.instanceInterface.bUseProxy? this.options.instanceInterface.getProxyURL(): undefined),\n                basePath: this.getEngineInstanceInterface().getBasePath()\n            });\n\n            if (oFeature === undefined)\n            {\n                throw new Error(\"KML returned no object.\");\n            }\n            else\n            {\n                oOptions.bEditable = false;\n                this._setKMLParameters(oFeature.options.kmlDoc, oOptions);\n            }\n\n            return oFeature;\n        },\n        _createFeature: function(args)\n        {\n            var oFeature = undefined;\n\n            if (args.url && (args.url !== \"\"))\n            {\n                oFeature = this._createFeatureFromURL(args);\n            }\n            else\n            {\n                oFeature = this._createFeatureFromString(args);\n            }\n\n            return oFeature;\n        },\n        _updateFeature: function(oArgs)\n        {\n            return this._createFeature(oArgs);\n        },\n/*\n        setLeafletObject: function(oObject)\n        {\n            leafLet.typeLibrary.Feature.prototype.setLeafletObject.call(this, oObject);\n            if (this.options.leafletObject)\n            {\n                if (this.isSelected())\n                {\n                    this._setSelected(this.options.leafletObject);\n                }\n            }\n        },\n        _setSelected: function(oLayer)\n        {\n            if (oLayer === undefined)\n            {\n                return;\n            }\n            \n            if (oLayer instanceof L.LayerGroup)\n            {\n                for (var Key in oLayer._layers)\n                {\n                    this._setSelected(oLayer._layers[Key]);\n                }\n            }\n            else if (oLayer instanceof L.Marker)\n            {\n                emp.$(oLayer._icon).addClass('icon-selected');\n            }\n        },\n*/\n        setFeatureStyleProperties: function(sType, oProperties)\n        {\n            var bDoUpdate = false;\n            var bMultiGeometry = false;\n            var oLeafletObject = this.getLeafletObject();\n            var oFeatureProperties = this.getProperties();\n            \n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                if (oLeafletObject.getLayers().length === 1)\n                {\n                    oLeafletObject = oLeafletObject.getLayers()[0];\n                }\n                else\n                {\n                    bMultiGeometry = true;\n                }\n            }\n            \n            if ((sType === emp.typeLibrary.OverlayStyleType.POINT) &&\n                    (oLeafletObject instanceof L.Marker))\n            {\n                if (oProperties.hasOwnProperty('iconUrl'))\n                {\n                    oFeatureProperties.iconUrl = oProperties.iconUrl;\n                    bDoUpdate = true;\n                }\n            }\n            else if ((sType === emp.typeLibrary.OverlayStyleType.LINE) &&\n                    (oLeafletObject instanceof L.Polyline))\n            {\n                if (oProperties.hasOwnProperty('lineColor'))\n                {\n                    oFeatureProperties.lineColor = oProperties.lineColor;\n                    if (oProperties.hasOwnProperty('lineWidth'))\n                    {\n                        oFeatureProperties.lineWidth = oProperties.lineWidth;\n                    }                    \n                    bDoUpdate = true;\n                }\n            }\n            else if ((sType === emp.typeLibrary.OverlayStyleType.POLYGON) &&\n                    (oLeafletObject instanceof L.Polygon))\n            {\n                if (oProperties.hasOwnProperty('lineColor'))\n                {\n                    oFeatureProperties.lineColor = oProperties.lineColor;\n                    if (oProperties.hasOwnProperty('lineWidth'))\n                    {\n                        oFeatureProperties.lineWidth = oProperties.lineWidth;\n                    }\n                    \n                    bDoUpdate = true;\n                }\n\n                if (oProperties.hasOwnProperty('fillColor'))\n                {\n                    oFeatureProperties.fillColor = oProperties.fillColor;\n                    bDoUpdate = true;\n                }\n            }\n            else if ((sType === emp.typeLibrary.OverlayStyleType.MULTIGEOMETRY) &&\n                    bMultiGeometry)\n            {\n                if (oProperties.hasOwnProperty('lineColor'))\n                {\n                    oFeatureProperties.lineColor = oProperties.lineColor;\n                    if (oProperties.hasOwnProperty('lineWidth'))\n                    {\n                        oFeatureProperties.lineWidth = oProperties.lineWidth;\n                    }\n                    \n                    bDoUpdate = true;\n                }\n\n                if (oProperties.hasOwnProperty('fillColor'))\n                {\n                    oFeatureProperties.fillColor = oProperties.fillColor;\n                    bDoUpdate = true;\n                }\n                \n                if (oProperties.hasOwnProperty('iconUrl'))\n                {\n                    oFeatureProperties.iconUrl = oProperties.iconUrl;\n                    bDoUpdate = true;\n                }\n            }\n\n            if (bDoUpdate)\n            {\n                this.updateFeature(this.options);\n            }\n        },\n        render: function()\n        {\n            this.updateFeature(this.options);\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.KMLFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.KMLFeature());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.GeoJsonFeature = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n\n            if (this.options.leafletObject instanceof L.Marker)\n            {\n                var oLatLng = this.options.leafletObject.getLatLng();\n                if (oLatLng !== undefined)\n                {\n                    oLatLng = oLatLng.wrap();\n                    sPopupText += \n                            \"<center><b>Lat</b>:&nbsp;\" + oLatLng.lat.toFixed(5) +\n                            \"<br/><b>Lon</b>:&nbsp;\" + oLatLng.lng.toFixed(5) +\n                            ((oLatLng.alt)? \"<br/><b>Alt</b>:&nbsp;\" + oLatLng.alt + this._getAltUnitsAndModeText(): \"\") + \"</center><br/>\";\n                }\n            }\n\n            sPopupText += this._getPopupDescription();\n\n            return sPopupText;\n        },\n        _createGeoJSONPolygon: function(oGeoJSON, oProperties)\n        {\n            var bIsSelected = this.isSelected();\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oGeoJSON);\n\n            if ((oCoordList === undefined) || (oCoordList.length < 3))\n            {\n                return undefined;\n            }\n\n            if (bIsSelected)\n            {\n                oProperties['tempColor'] = oProperties['color'] || L.LEAFLET_DEFAULT_LINE_COLOR;\n                oProperties['tempWeight'] = oProperties['weigh'] || L.LEAFLET_DEFAULT_LINE_WEIGHT;\n\n                oProperties['color'] = '#' + this.options.instanceInterface.selectAttributes.color;\n                oProperties['weigh'] = this.options.instanceInterface.selectAttributes.width;\n            }\n\n            oProperties.oFeature = this;\n\n            return new L.Polygon(oCoordList, oProperties);\n        },\n        _createGeoJSONLine: function(oGeoJSON, oProperties)\n        {\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oGeoJSON);\n            var bIsSelected = this.isSelected();\n\n            if ((oCoordList === undefined) || (oCoordList.length < 2))\n            {\n                return undefined;\n            }\n\n            if (bIsSelected)\n            {\n                oProperties['tempColor'] = oProperties['color'] || L.LEAFLET_DEFAULT_LINE_COLOR;\n                oProperties['tempWeight'] = oProperties['weigh'] || L.LEAFLET_DEFAULT_LINE_WEIGHT;\n\n                oProperties['color'] = '#' + this.options.instanceInterface.selectAttributes.color;\n                oProperties['weigh'] = this.options.instanceInterface.selectAttributes.width;\n            }\n\n            oProperties.oFeature = this;\n\n            return new L.Polyline(oCoordList, oProperties);\n        },\n        _getDefaultIcon: function()\n        {\n            var oIcon;\n            var oDefaultIcon = emp.utilities.icon.getDefaultIcon(this.getEngineInstanceInterface().getBasePath());\n            var sURL = (this.options.instanceInterface.bUseProxy? \n                            this.getEngineInstanceInterface().getProxyURL() + \"?\" + \"mime=image/*&url=\" + escape(oDefaultIcon.iconUrl): \n                            oDefaultIcon.iconUrl);\n            \n            oIcon = new leafLet.typeLibrary.EmpIcon({\n                iconUrl: sURL,\n                iconAnchor: new L.Point(oDefaultIcon.offset.x, oDefaultIcon.offset.y),\n                iconAnchorType: {x: oDefaultIcon.offset.xUnits, y: oDefaultIcon.offset.yUnits},\n                basePath: this.getEngineInstanceInterface().getBasePath()\n            });\n            \n            return oIcon;\n        },\n        _createGeoJSONPoint: function(oGeoJSON, oProperties)\n        {\n            var bIsSelected = this.isSelected();\n            var oLatLon = leafLet.utils.geoJson.convertCoordinatesToLatLng(oGeoJSON)[0];\n\n            if (oLatLon === undefined)\n            {\n                return undefined;\n            }\n\n            if (oProperties.iconOptions)\n            {\n                if (bIsSelected)\n                {\n                    oProperties.iconOptions.className = 'icon-selected';\n                }\n                \n                oProperties.iconOptions.basePath = this.getEngineInstanceInterface().getBasePath();\n                oProperties.icon = new leafLet.typeLibrary.EmpIcon(oProperties.iconOptions);\n            }\n            \n            oProperties.oFeature = this;\n            \n            return new L.Marker(oLatLon, oProperties);\n        },\n        _createGeoJSONComplex: function(args, oGeoJSON)\n        {\n            var oThis = this;\n            var bIsSelected = this.isSelected();\n            \n            return new L.geoJson(oGeoJSON, {\n                style: function(oGeoJSONData)\n                {\n                    var oProperties = leafLet.utils.geoJson.mergeGeoJSONProperties(this.getEngineInstanceInterface(), args.item.properties, oGeoJSONData.properties);\n            \n                    if (bIsSelected)\n                    {\n                        oProperties['tempColor'] = oProperties['color'];\n                        oProperties['tempWeight'] = oProperties['weigh'];\n                        \n                        oProperties['color'] = '#' + args.instanceInterface.selectAttributes.color;\n                        oProperties['weigh'] = args.instanceInterface.selectAttributes.width;\n                    }\n                    \n                    oProperties.oFeature = oThis;\n                    return oProperties;\n                },\n                coordsToLatLng: function(oCoord)\n                {\n                    return new L.LatLng(oCoord[1], oCoord[0]);\n                },\n                pointToLayer: function(oGeoJsonfeature, latlng)\n                {\n                    var oProperties = leafLet.utils.geoJson.mergeGeoJSONProperties(this.getEngineInstanceInterface(), args.item.properties, oGeoJsonfeature.properties);\n\n                    if (oProperties.iconOptions)\n                    {\n                        if (bIsSelected)\n                        {\n                            oProperties.iconOptions.className = 'icon-selected';\n                        }\n                        oProperties.iconOptions.basPath = this.getEngineInstanceInterface().getBasePath();\n                        oProperties.icon = new leafLet.typeLibrary.EmpIcon(oProperties.iconOptions);\n                    }\n                    \n                    return new L.Marker(latlng, {\n                        icon: oProperties.icon,\n                        sSubItemID: oProperties.sSubItemID,\n                        oFeature: oThis\n                    });\n                }\n            });\n        },\n        _createFeature: function(args)\n        {\n            var oFeature = undefined;\n            var oProperties = leafLet.utils.geoJson.mergeGeoJSONProperties(this.getEngineInstanceInterface(), args.properties, args.data.properties);\n\n            oProperties.title = args.name;\n\n            switch (args.data.type.toLowerCase())\n            {\n                case 'point':\n                    oFeature = this._createGeoJSONPoint(args.data, oProperties);\n                    break;\n                case 'linestring':\n                    oFeature = this._createGeoJSONLine(args.data, oProperties);\n                    break;\n                case 'polygon':\n                    oFeature = this._createGeoJSONPolygon(args.data, oProperties);\n                    break;\n                case 'feature':\n                    if (!args.data.hasOwnProperty('geometry'))\n                    {\n                        throw new Error('GeoJSON Feature with no geometry.');\n                    }\n\n                    switch (args.data.geometry.type.toLowerCase())\n                    {\n                        case 'point':\n                            oFeature = this._createGeoJSONPoint(args.data.geometry, oProperties);\n                            break;\n                        case 'linestring':\n                            oFeature = this._createGeoJSONLine(args.data.geometry, oProperties);\n                            break;\n                        case 'polygon':\n                            oFeature = this._createGeoJSONPolygon(args.data.geometry, oProperties);\n                            break;\n                        default:\n                            oFeature = this._createGeoJSONComplex(args, args.data);\n                            break;\n                    }\n                    break;\n                default:\n                    oFeature = this._createGeoJSONComplex(args, args.data);\n                    break;\n            }\n\n            return oFeature;\n        },\n        _updateFeature: function(oArgs)\n        {\n            return this._createFeature(oArgs);\n        },\n        getGeometryType: function()\n        {\n            return leafLet.utils.geoJson.getGeometryType(this.getData());\n        },\n        render: function()\n        {\n            this.updateFeature(this.options);\n        },\n        setFeatureStyleProperties: function(sType, oProperties)\n        {\n            var bDoUpdate = false;\n            var oFeatureProperties = this.getProperties();\n            var sGeoJsonType = this.getGeometryType().toLowerCase();\n            \n            if ((sType === emp.typeLibrary.OverlayStyleType.POINT) &&\n                    (sGeoJsonType === 'point'))\n            {\n                if (oProperties.hasOwnProperty('iconUrl'))\n                {\n                    oFeatureProperties.iconUrl = oProperties.iconUrl;\n                    this.updateFeature(this.options);\n                }\n            }\n            else if ((sType === emp.typeLibrary.OverlayStyleType.LINE) &&\n                    (sGeoJsonType === 'linestring'))\n            {\n                if (oProperties.hasOwnProperty('lineColor'))\n                {\n                    oFeatureProperties.lineColor = oProperties.lineColor;\n                    if (oProperties.hasOwnProperty('lineWidth'))\n                    {\n                        oFeatureProperties.lineWidth = oProperties.lineWidth;\n                    }                    \n                }\n            }\n            else if ((sType === emp.typeLibrary.OverlayStyleType.POLYGON) &&\n                    (sGeoJsonType === 'polygon'))\n            {\n                if (oProperties.hasOwnProperty('lineColor'))\n                {\n                    oFeatureProperties.lineColor = oProperties.lineColor;\n                    if (oProperties.hasOwnProperty('lineWidth'))\n                    {\n                        oFeatureProperties.lineWidth = oProperties.lineWidth;\n                    }\n                    \n                    bDoUpdate = true;\n                }\n\n                if (oProperties.hasOwnProperty('fillColor'))\n                {\n                    oFeatureProperties.fillColor = oProperties.fillColor;\n                    bDoUpdate = true;\n                }\n                \n                if (bDoUpdate)\n                {\n                    this.updateFeature(this.options);\n                }\n            }\n            else if (\n                        (sType === emp.typeLibrary.OverlayStyleType.MULTIGEOMETRY) &&\n                        !(\n                            (sGeoJsonType === 'point') ||\n                            (sGeoJsonType === 'linestring') ||\n                            (sGeoJsonType === 'polygon')\n                        )\n                    )\n            {\n                if (oProperties.hasOwnProperty('lineColor'))\n                {\n                    oFeatureProperties.lineColor = oProperties.lineColor;\n                    if (oProperties.hasOwnProperty('lineWidth'))\n                    {\n                        oFeatureProperties.lineWidth = oProperties.lineWidth;\n                    }\n                    \n                    bDoUpdate = true;\n                }\n\n                if (oProperties.hasOwnProperty('fillColor'))\n                {\n                    oFeatureProperties.fillColor = oProperties.fillColor;\n                    bDoUpdate = true;\n                }\n                \n                if (oProperties.hasOwnProperty('iconUrl'))\n                {\n                    oFeatureProperties.iconUrl = oProperties.iconUrl;\n                    bDoUpdate = true;\n                }\n\n                if (bDoUpdate)\n                {\n                    this.updateFeature(this.options);\n                }\n            }\n        }\n    };\n    return publicInterface;\n};\n\nleafLet.typeLibrary.GeoJsonFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.GeoJsonFeature());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.AirspaceFeature = function(){\n    var publicInterface = {\n        initialize: function (args, iMinPoint, iMaxPoints) \n        {\n            var options = {\n                iMinPoints: iMinPoint,\n                iMaxPoints: iMaxPoints,\n                oAirspaceAttributeList: {}\n            };\n            L.Util.setOptions(this, options);\n            \n            this.options.oAirspaceAttributeList = new leafLet.typeLibrary.airspace.AttributeList(args.item.properties);\n\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        getMinPoints: function()\n        {\n            return this.options.iMinPoints;\n        },\n        getMaxPoints: function()\n        {\n            return this.options.iMaxPoints;\n        },\n        getUnits: function()\n        {\n            return leafLet.utils.Units.METERS;\n        },\n        getAltitudeModeAbbr: function()\n        {\n            var oAttributes = this.getAttributes(0);\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n\n            return leafLet.utils.AltitudeModeAbbr(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_ALTITUDE_MODE));\n        },\n        getAttributeList: function()\n        {\n            return this.options.oAirspaceAttributeList;\n        },\n        setAttributeList: function(oList)\n        {\n            this.options.oAirspaceAttributeList = oList;\n        },\n        getAttributes: function(iIndex)\n        {\n            return this.getAttributeList().get(iIndex);\n        },\n        getCoordinateList: function()\n        {\n            return leafLet.utils.geoJson.convertCoordinatesToLatLng(this.getData());\n        },\n        setCoordinates: function(oLatLngList)\n        {\n            leafLet.utils.geoJson.convertLatLngListToGeoJson(this.getData(), oLatLngList);\n        },\n        render: function()\n        {\n            if (this.isVisible())\n            {\n                var oNewLeafletObject = this._createFeature(this.options);\n\n                if (oNewLeafletObject)\n                {\n                    this.setLeafletObject(oNewLeafletObject);\n                }\n            }\n        },\n        _updateFeature: function(oArgs)\n        {\n            oArgs.oAirspaceAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            return this._createFeature(oArgs);\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.AirspaceFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.AirspaceFeature());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.ImageFeature = function(){\n    var publicInterface = {\n        initialize: function (args)\n        {\n            var options = {\n                oLatLngList: this._convertBBox(args.item.params),\n                sImageURL: args.item.url\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        _convertBBox: function(oBBox)\n        {\n            //{\"left\": 40.0,\"right\": 45.0,\"top\": 40.0,\"bottom\": 35.0}\n            var oLatLngList = [];\n            \n            oLatLngList.push(new L.LatLng(oBBox.bottom, oBBox.left));\n            oLatLngList.push(new L.LatLng(oBBox.top, oBBox.right));\n            \n            return oLatLngList;\n        },\n        _createFeature: function(args)\n        {\n            var oLeafletObject;\n            \n            oLeafletObject = new L.ImageOverlay(args.sImageURL, args.oLatLngList);\n            \n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oLeafletObject;\n            var oOptions = {\n                sImageURL: oArgs.url,\n                oLatLngList: this._convertBBox(oArgs.params)\n            };\n            \n            oLeafletObject = this._createFeature(oOptions);\n            this.options.sImageURL = oOptions.url;\n            this.options.oLatLngList = oOptions.params;\n            \n            if (oArgs.hasOwnProperty('name'))\n            {\n                this.setName(oArgs.name);\n            }\n            \n            return oLeafletObject;\n        },\n        getPopupText: function()\n        {\n            // Each feature class can override this function.\n            return \"<center><b>URL:&nbsp;\" + this.getURL + \"</b></center><br/>\" +\n                    this._getPopupDescription();\n        },\n        getFeatureBounds: function()\n        {\n            var oBounds = undefined;\n            var oLeafletObject = this.getLeafletObject();\n            var oLatLngList = this.getParams();\n\n            if (oLeafletObject)\n            {\n                oBounds = new leafLet.typeLibrary.EmpBoundary(oLatLngList[0].wrap(), oLatLngList[1].wrap());\n            }\n\n            return oBounds;\n        },\n        getURL: function()\n        {\n            return this.options.sImageURL;\n        },\n        getParams: function()\n        {\n            return this.options.oLatLngList;\n        },\n        render: function()\n        {\n            if (this.isVisible())\n            {\n                var oNewLeafletObject = this._createFeature(this.options);\n\n                if (oNewLeafletObject)\n                {\n                    this.setLeafletObject(oNewLeafletObject);\n                }\n            }\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.ImageFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.ImageFeature());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.AOIFeature = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n                oOriginalData: emp.helpers.copyObject(args.item.data),\n                iBuffer: undefined,\n                sAOIType: undefined,\n                sSymbolCode: undefined,\n                oModifiers: {}\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        _createFeature: function(args)\n        {\n            var sDescription = args.properties.description || \"\";\n            var oGeoJson = args.data;\n\n            this.setAOIType(oGeoJson.properties.aoi.type);\n            this.setAOIBuffer(oGeoJson.properties.aoi.buffer);\n            this.setAOISymbolCode();\n            this.setModifiers();\n\n            return leafLet.utils.milstd.renderMPGraphic({\n                instanceInterface: this.getEngineInstanceInterface(),\n                isSelected: args.selected,\n                sID: args.coreId,\n                sName: args.name,\n                sDescription: sDescription,\n                sSymbolCode: this.getAOISymbolCode(),\n                oCoordData: args.data.geometry,\n                oModifiers: emp.helpers.copyObject(this.getModifiers()),\n                i2525Version: 0,\n                oFeature: this\n            });\n        },\n        _updateFeature: function(oArgs)\n        {\n            return this._createFeature(oArgs);\n        },\n        getPopupText: function()\n        {\n            var eAOIType = emp.typeLibrary.AOIType;\n            var sText;\n            \n            sText = \"<center><b>AOI&nbsp;\";\n            \n            switch (this.getAOIType())\n            {\n                case eAOIType.POINT_RADIUS:\n                    sText += \"Point Radius\";\n                    break;\n                case eAOIType.LINE:\n                    sText += \"Line\";\n                    break;\n                case eAOIType.POLYGON:\n                    sText += \"Polygon\";\n                    break;\n                case eAOIType.BBOX:\n                    sText += \"Rectangle\";\n                    break;\n            }\n            sText += \"</b></center>\";\n            sText += \"<center><b>Buffer</b>:&nbsp;\" + this.getAOIBuffer() + \"</center><br/>\";\n            sText += this._getPopupDescription();\n\n            return sText;\n        },\n        getUnits: function()\n        {\n            return leafLet.utils.Units.METERS;\n        },\n        getAOIType: function()\n        {\n            return this.options.sAOIType;\n        },\n        setAOIType: function(sType)\n        {\n            this.options.sAOIType = sType;\n        },\n        getAOIBuffer: function()\n        {\n            return this.options.iBuffer;\n        },\n        setAOIBuffer: function(iBuffer)\n        {\n            this.options.iBuffer = iBuffer;\n        },\n        setAOIBufferProperty: function(iBuffer)\n        {\n            this.options.data.properties.aoi.buffer = iBuffer;\n        },\n        getAOISymbolCode: function()\n        {\n            return this.options.sSymbolCode;\n        },\n        setAOISymbolCode: function()\n        {\n            var eAOIType = emp.typeLibrary.AOIType;\n            \n            switch (this.getAOIType())\n            {\n                case eAOIType.POINT_RADIUS:\n                    this.options.sSymbolCode = \"BBS_POINT------\";\n                    break;\n                case eAOIType.LINE:\n                    this.options.sSymbolCode = \"BBS_LINE-------\";\n                    break;\n                case eAOIType.POLYGON:\n                    this.options.sSymbolCode = \"BBS_AREA-------\";\n                    break;\n                case eAOIType.BBOX:\n                    this.options.sSymbolCode = \"BBS_RECTANGLE--\";\n                    break;\n            }\n        },\n        getModifiers: function()\n        {\n            return this.options.oModifiers;\n        },\n        setModifiers: function()\n        {\n            var oGeoJson = this.getData();\n            var eMilStdModifiers =  leafLet.utils.milstd.Modifiers;\n            var oProperties = this.getProperties();\n            \n            this.options.oModifiers[eMilStdModifiers.UNIQUE_DESIGNATOR_1] = this.getName();\n            this.options.oModifiers[eMilStdModifiers.DISTANCE] = [this.getAOIBuffer()];\n            \n            if (oProperties)\n            {\n                if (oProperties.hasOwnProperty('fillColor'))\n                {\n                    this.options.oModifiers[\"fillColor\"] = oProperties.fillColor;\n                }\n                if (oProperties.hasOwnProperty('lineColor'))\n                {\n                    this.options.oModifiers[\"lineColor\"] = oProperties.lineColor;\n                }\n            }\n            \n            if (!this.options.oModifiers[\"fillColor\"])\n            {\n                if (oGeoJson && oGeoJson.properties.hasOwnProperty('fillColor'))\n                {\n                    this.options.oModifiers[\"fillColor\"] = oGeoJson.properties.fillColor;\n                }\n            }\n            \n            if (!this.options.oModifiers[\"lineColor\"])\n            {\n                if (oGeoJson && oGeoJson.properties.hasOwnProperty('lineColor'))\n                {\n                    this.options.oModifiers[\"lineColor\"] = oGeoJson.properties.lineColor;\n                }\n            }\n            \n            if (!this.options.oModifiers[\"fillColor\"])\n            {\n                // If fill color is still not set, set our default.\n                // I would prefer the default to be set by the renderer but it fails\n                // if one is not provided.\n                this.options.oModifiers[\"fillColor\"] = '99AAAAAA';\n            }\n        },\n        getGeometryType: function()\n        {\n            return leafLet.utils.geoJson.getGeometryType(this.getData());\n        },\n        render: function()\n        {\n            if (this.isVisible())\n            {\n                var oNewLeafletObject = this._createFeature(this.options);\n\n                this.setLeafletObject(oNewLeafletObject);\n            }\n        }\n    };\n    return publicInterface;\n};\n\nleafLet.typeLibrary.AOIFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.AOIFeature());\n","/* global leafLet, emp, NaN */\n\nleafLet.typeLibrary.MilStdModifiers = function(oFeature, args)\n{\n    var oMilStdFeature = oFeature;\n    var o2525Modifiers = leafLet.utils.milstd.Modifiers;\n    var oStringModifiers = leafLet.utils.milstd.longModifiers;\n    var oLongToShortModifierName = leafLet.utils.milstd.stringToModifiers;\n    var o2525ModifierToLong = leafLet.utils.milstd.o2525ModifierToLong;\n    \n    var publicInterface = {\n        oModifiers: {},\n        getAMValueCount: function()\n        {\n            if (this.oModifiers[o2525Modifiers.DISTANCE] === undefined)\n            {\n                this.oModifiers[o2525Modifiers.DISTANCE] = [];\n            }\n            \n            return this.oModifiers[o2525Modifiers.DISTANCE].length;\n        },\n        getAMValue: function(iIndex)\n        {\n            if (iIndex >= this.getAMValueCount())\n            {\n                return NaN;\n            }\n            \n            var dValue = this.oModifiers[o2525Modifiers.DISTANCE][iIndex];\n            \n            switch (oMilStdFeature.getUnits())\n            {\n                case leafLet.utils.Units.FEET:\n                    dValue = Math.round(dValue * leafLet.utils.METERS_PER_FEET);\n                    break;\n            }\n            return dValue;\n        },\n        setAMValue: function(iIndex, dValue)\n        {\n            switch (oMilStdFeature.getUnits())\n            {\n                case leafLet.utils.Units.FEET:\n                    dValue = Math.round(dValue * leafLet.utils.FEET_PER_METERS);\n                    break;\n            }\n\n            if (iIndex < this.getAMValueCount())\n            {\n                this.oModifiers[o2525Modifiers.DISTANCE][iIndex] = dValue;\n            }\n            else\n            {\n                this.oModifiers[o2525Modifiers.DISTANCE].push(dValue);\n            }\n        },\n        getANValueCount: function()\n        {\n            if (this.oModifiers[o2525Modifiers.AZIMUTH] === undefined)\n            {\n                this.oModifiers[o2525Modifiers.AZIMUTH] = [];\n            }\n            \n            return this.oModifiers[o2525Modifiers.AZIMUTH].length;\n        },\n        getANValue: function(iIndex)\n        {\n            if (iIndex >= this.getANValueCount())\n            {\n                return NaN;\n            }\n            \n            var dValue = this.oModifiers[o2525Modifiers.AZIMUTH][iIndex];\n            \n            switch (oMilStdFeature.getAzimuthUnits())\n            {\n                case leafLet.utils.AngleUnits.MILS:\n                    dValue = dValue * leafLet.utils.DEGREE_PER_MILS;\n                    break;\n            }\n            \n            return dValue;\n        },\n        setANValue: function(iIndex, dValue)\n        {\n            switch (oMilStdFeature.getAzimuthUnits())\n            {\n                case leafLet.utils.AngleUnits.MILS:\n                    dValue = dValue * leafLet.utils.MILS_PER_DEGREE;\n                    break;\n            }\n\n            if (iIndex < this.getANValueCount())\n            {\n                this.oModifiers[o2525Modifiers.AZIMUTH][iIndex] = dValue;\n            }\n            else\n            {\n                this.oModifiers[o2525Modifiers.AZIMUTH].push(dValue); \n            }\n        },\n        getXValueCount: function()\n        {\n            if (this.oModifiers[o2525Modifiers.ALTITUDE_DEPTH] === undefined)\n            {\n                this.oModifiers[o2525Modifiers.ALTITUDE_DEPTH] = [];\n            }\n            \n            return this.oModifiers[o2525Modifiers.ALTITUDE_DEPTH].length;\n        },\n        getXValue: function(iIndex)\n        {\n            if (iIndex >= this.getXValueCount())\n            {\n                return NaN;\n            }\n            \n            var dValue = this.oModifiers[o2525Modifiers.ALTITUDE_DEPTH][iIndex];\n            \n            switch (oMilStdFeature.getAltitudeUnits())\n            {\n                case leafLet.utils.Units.FEET:\n                    dValue = Math.round(dValue * leafLet.utils.FEET_PER_METERS);\n                    break;\n            }\n            \n            return dValue;\n        },\n        setXValue: function(iIndex, dValue)\n        {\n            switch (oMilStdFeature.getAltitudeUnits())\n            {\n                case leafLet.utils.Units.FEET:\n                    dValue = Math.round(dValue * leafLet.utils.METERS_PER_FEET);\n                    break;\n            }\n            \n            if (iIndex < this.getXValueCount())\n            {\n                this.oModifiers[o2525Modifiers.ALTITUDE_DEPTH][iIndex] = dValue;\n            }\n            else\n            {\n                this.oModifiers[o2525Modifiers.ALTITUDE_DEPTH].push(dValue); \n            }\n        },\n        toModifiers: function()\n        {\n            var oNewModifiers = {};\n            \n            for (var sModifier in this.oModifiers)\n            {\n                if (!this.oModifiers.hasOwnProperty(sModifier)) {\n                    continue;\n                }\n                if (this.oModifiers[sModifier] !== undefined)\n                {\n                    oNewModifiers[sModifier] = emp.helpers.copyObject(this.oModifiers[sModifier]);\n                }\n            }\n            \n            return oNewModifiers;\n        },\n        toLongModifiers: function()\n        {\n            var sLongModifier;\n            var oNewModifiers = {};\n            \n            for (var sModifier in this.oModifiers) {\n                if (!this.oModifiers.hasOwnProperty(sModifier)) {\n                    continue;\n                }\n                if (this.oModifiers[sModifier] !== undefined)\n                {\n                    sLongModifier = o2525ModifierToLong[sModifier];\n                    \n                    switch (sModifier)\n                    {\n                        case o2525Modifiers.STANDARD:\n                            oNewModifiers[sLongModifier] = emp.typeLibrary.featureMilStdVersionType.convertToString(this.oModifiers[sModifier]);\n                            break;\n                        default:\n                            oNewModifiers[sLongModifier] = emp.helpers.copyObject(this.oModifiers[sModifier]);\n                            break;\n                    }\n                }\n            }\n            \n            return oNewModifiers;\n        }\n    };\n    \n    var sShortName;\n    \n    for (var sProp in args)\n    {\n        if (!args.hasOwnProperty(sProp)) {\n            continue;\n        }\n        sShortName = sProp;\n        switch (sProp)\n        {\n            case oStringModifiers.FILL_COLOR:\n            case oStringModifiers.LINE_COLOR:\n            case oStringModifiers.X_OFFSET:\n            case oStringModifiers.X_UNITS:\n            case oStringModifiers.Y_OFFSET:\n            case oStringModifiers.Y_UNITS:\n            case oStringModifiers.LINE_THICKNESS:\n                // These do not get added. They are used by the renderer.\n                break;\n            default:\n                if (oLongToShortModifierName[sProp] !== undefined)\n                {\n                    sShortName = oLongToShortModifierName[sProp];\n                }\n                \n                switch (sProp)\n                {\n                    case oStringModifiers.STANDARD:\n                        publicInterface.oModifiers[sShortName] = emp.typeLibrary.featureMilStdVersionType.convertToNumeric(args[oStringModifiers.STANDARD]);\n                        break;\n                    default:\n                        publicInterface.oModifiers[sShortName] = args[sProp];\n                        break;\n                }\n                break;\n        }\n    }\n/*\n    publicInterface.oModifiers[o2525Modifiers.QUANTITY] = args[o2525Modifiers.QUANTITY] || args[oStringModifiers.QUANTITY];\n    publicInterface.oModifiers[o2525Modifiers.REDUCED_OR_REINFORCED] = args[o2525Modifiers.REDUCED_OR_REINFORCED] || args[oStringModifiers.REDUCED_OR_REINFORCED];\n    publicInterface.oModifiers[o2525Modifiers.STAFF_COMMENTS] = args[o2525Modifiers.STAFF_COMMENTS] || args[oStringModifiers.STAFF_COMMENTS];\n    publicInterface.oModifiers[o2525Modifiers.ADDITIONAL_INFO_1] = args[o2525Modifiers.ADDITIONAL_INFO_1] || args[oStringModifiers.ADDITIONAL_INFO_1];\n    publicInterface.oModifiers[o2525Modifiers.ADDITIONAL_INFO_2] = args[o2525Modifiers.ADDITIONAL_INFO_2] || args[oStringModifiers.ADDITIONAL_INFO_2];\n    publicInterface.oModifiers[o2525Modifiers.ADDITIONAL_INFO_3] = args[o2525Modifiers.ADDITIONAL_INFO_3] || args[oStringModifiers.ADDITIONAL_INFO_3];\n    publicInterface.oModifiers[o2525Modifiers.EVALUATION_RATING] = args[o2525Modifiers.EVALUATION_RATING] || args[oStringModifiers.EVALUATION_RATING];\n    publicInterface.oModifiers[o2525Modifiers.COMBAT_EFFECTIVENESS] = args[o2525Modifiers.COMBAT_EFFECTIVENESS] || args[oStringModifiers.COMBAT_EFFECTIVENESS];\n    publicInterface.oModifiers[o2525Modifiers.SIGNATURE_EQUIPMENT] = args[o2525Modifiers.SIGNATURE_EQUIPMENT] || args[oStringModifiers.SIGNATURE_EQUIPMENT];\n    publicInterface.oModifiers[o2525Modifiers.HIGHER_FORMATION] = args[o2525Modifiers.HIGHER_FORMATION] || args[oStringModifiers.HIGHER_FORMATION];\n    publicInterface.oModifiers[o2525Modifiers.HOSTILE] = args[o2525Modifiers.HOSTILE] || args[oStringModifiers.HOSTILE];\n    publicInterface.oModifiers[o2525Modifiers.IFF_SIF] = args[o2525Modifiers.IFF_SIF] || args[oStringModifiers.IFF_SIF];\n    publicInterface.oModifiers[o2525Modifiers.DIRECTION_OF_MOVEMENT] = args[o2525Modifiers.DIRECTION_OF_MOVEMENT] || args[oStringModifiers.DIRECTION_OF_MOVEMENT];\n    publicInterface.oModifiers[o2525Modifiers.OFFSET_INDICATOR] = args[o2525Modifiers.OFFSET_INDICATOR] || args[oStringModifiers.OFFSET_INDICATOR];\n    publicInterface.oModifiers[o2525Modifiers.UNIQUE_DESIGNATOR_1] = args[o2525Modifiers.UNIQUE_DESIGNATOR_1] || args[oStringModifiers.UNIQUE_DESIGNATOR_1];\n    publicInterface.oModifiers[o2525Modifiers.UNIQUE_DESIGNATOR_2] = args[o2525Modifiers.UNIQUE_DESIGNATOR_2] || args[oStringModifiers.UNIQUE_DESIGNATOR_2];\n    publicInterface.oModifiers[o2525Modifiers.EQUIPMENT_TYPE] = args[o2525Modifiers.EQUIPMENT_TYPE] || args[oStringModifiers.EQUIPMENT_TYPE];\n    publicInterface.oModifiers[o2525Modifiers.DATE_TIME_GROUP] = args[o2525Modifiers.DATE_TIME_GROUP] || args[oStringModifiers.DATE_TIME_GROUP];\n    publicInterface.oModifiers[o2525Modifiers.DATE_TIME_GROUP_2] = args[o2525Modifiers.DATE_TIME_GROUP_2] || args[oStringModifiers.DATE_TIME_GROUP_2];\n    publicInterface.oModifiers[o2525Modifiers.ALTITUDE_DEPTH] = args[o2525Modifiers.ALTITUDE_DEPTH] || args[oStringModifiers.ALTITUDE_DEPTH];\n    publicInterface.oModifiers[o2525Modifiers.LOCATION] = args[o2525Modifiers.LOCATION] || args[oStringModifiers.LOCATION];\n    publicInterface.oModifiers[o2525Modifiers.SPEED] = args[o2525Modifiers.SPEED] || args[oStringModifiers.SPEED];\n    publicInterface.oModifiers[o2525Modifiers.SPECIAL_C2_HEADQUARTERS] = args[o2525Modifiers.SPECIAL_C2_HEADQUARTERS] || args[oStringModifiers.SPECIAL_C2_HEADQUARTERS];\n    publicInterface.oModifiers[o2525Modifiers.DISTANCE] = args[o2525Modifiers.DISTANCE] || args[oStringModifiers.DISTANCE];\n    publicInterface.oModifiers[o2525Modifiers.AZIMUTH] = args[o2525Modifiers.AZIMUTH] || args[oStringModifiers.AZIMUTH];\n    publicInterface.oModifiers[o2525Modifiers.STANDARD] = args[o2525Modifiers.STANDARD] || emp.typeLibrary.featureMilStdVersionType.convertToNumeric(args[oStringModifiers.STANDARD]);\n*/\n    return publicInterface;\n};\n","/* global L, leafLet, emp, cmapi */\n\nleafLet.internalPrivateClass.GeoTextFeature = function () {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        getPopupText: function () {\n            var sPopupText = \"\";\n\n            if (this.options.leafletObject instanceof L.Marker) {\n                var oLatLng = this.options.leafletObject.getLatLng();\n                if (oLatLng !== undefined) {\n                    oLatLng = oLatLng.wrap();\n                    sPopupText +=\n                            \"<center><b>Lat</b>:&nbsp;\" + oLatLng.lat.toFixed(5) +\n                            \"<br/><b>Lon</b>:&nbsp;\" + oLatLng.lng.toFixed(5) +\n                            ((oLatLng.alt) ? \"<br/><b>Alt</b>:&nbsp;\" + oLatLng.alt + this._getAltUnitsAndModeText() : \"\") + \"</center><br/>\";\n                }\n            }\n\n            sPopupText += this._getPopupDescription();\n\n            return sPopupText;\n        },\n        _createFeature: function (args) {\n            var oLeafletFeature = undefined;\n            var oProperties;\n            var sLabelText = ((args.name)? args.name: \" \");\n            var iXOffset = 0;\n            var iYOffset = 0;\n            var halfWidth;\n            var myIcon;\n            var oLatLon = leafLet.utils.geoJson.convertCoordinatesToLatLng(args.data)[0];\n            var iTextPixelDim;\n            var htmlFontStyle = 'normal';\n            var htmlFontWeight = 'normal';\n            var sCSSTextShadow = '';\n            var azimuth = ((args.properties && args.properties.azimuth) ? args.properties.azimuth: 0);\n            var labelStyle = ((args.properties && args.properties.labelStyle) ? args.properties.labelStyle: this.getEngineInstanceInterface().defaultLabelStyle);\n\n            if (oLatLon === undefined) {\n                return undefined;\n            }\n\n            if (this.isSelected()) {\n                labelStyle = this.getEngineInstanceInterface().selectLabelStyle;\n            }\n\n            if (labelStyle.typeface) {\n                switch (labelStyle.typeface.toUpperCase()) {\n                    case cmapi.enums.typeface.REGULAR:\n                        break;\n                    case cmapi.enums.typeface.BOLD:\n                        htmlFontWeight = 'bold';\n                        break;\n                    case cmapi.enums.typeface.ITALIC:\n                        htmlFontStyle = 'italic';\n                        ret = 'italic';\n                        break;\n                    case cmapi.enums.typeface.BOLDITALIC:\n                        htmlFontStyle = 'italic';\n                        htmlFontWeight = 'bold';\n                        break;\n                }\n            }\n\n            oProperties = leafLet.utils.geoJson.mergeGeoJSONProperties(this.getEngineInstanceInterface(), args.properties);\n            iTextPixelDim = emp.helpers.getStringPixelDimensions(sLabelText,\n                labelStyle.family,\n                labelStyle.size + 'pt',\n                htmlFontWeight);\n\n            oProperties.title = args.name;\n\n            iYOffset = Math.floor(iTextPixelDim.height / 2);\n\n            if (labelStyle.justification) {\n                switch (labelStyle.justification.toUpperCase()) {\n                    case cmapi.enums.justification.CENTER:\n                        iXOffset = Math.floor(iTextPixelDim.width / 2);\n                        break;\n                    case cmapi.enums.justification.LEFT:\n                        iXOffset = 0;\n                        if (azimuth) {\n                            // We need to move the offset because the rotation always rotates at the center.\n                            halfWidth = Math.floor(iTextPixelDim.width / 2);\n                            iXOffset += Math.floor(halfWidth * (1 - Math.cos(azimuth.toRad())));\n                            iYOffset -= Math.floor(halfWidth * Math.sin(azimuth.toRad()));\n                        }\n                        break;\n                    case cmapi.enums.justification.RIGHT:\n                        iXOffset = iTextPixelDim.width;\n                        if (azimuth) {\n                            // We need to move the offset because the rotation always rotates at the center.\n                            halfWidth = Math.floor(iTextPixelDim.width / 2);\n                            iXOffset -= Math.floor(halfWidth * (1 - Math.cos(azimuth.toRad())));\n                            iYOffset += Math.floor(halfWidth * Math.sin(azimuth.toRad()));\n                        }\n                        break;\n                }\n            }\n\n            if (labelStyle.outlineColor) {\n                sCSSTextShadow = 'text-shadow: 4px 4px 2px rgb(' + labelStyle.outlineColor.red + ', ' + labelStyle.outlineColor.green + ', ' + labelStyle.outlineColor.blue + '); ';\n            }\n\n            myIcon = new L.DivIcon({\n                className: '',\n                html: \"<p \" +\n                        \"style='font-family:\" + labelStyle.family + \"; \" +\n                        \"font-size:\" + labelStyle.size + \"pt; \" +\n                        \"line-height: \" + iTextPixelDim.height + \"px; \" +\n                        \"white-space: nowrap; \" +\n                        \"font-style: \" + htmlFontStyle + '; ' +\n                        \"font-weight:\" + htmlFontWeight + \"; \" +\n                        \"color: rgb(\" + labelStyle.color.red + \", \" + labelStyle.color.green + \", \" + labelStyle.color.blue + \"); \" +\n                        sCSSTextShadow +\n                        \"background: transparent; \" +\n                        \"border: none; \" +\n                        \"-webkit-transform: rotate(\" + azimuth + \"deg); \" +\n                        \"-moz-transform: rotate(\" + azimuth + \"deg); \" +\n                        \"-o-transform: rotate(\" + azimuth + \"deg); \" +\n                        \"transform: rotate(\" + azimuth + \"deg);'>\" +\n                        sLabelText + \"</p>\",\n                iconSize: new L.Point(iTextPixelDim.width, iTextPixelDim.height),\n                iconAnchor: new L.Point(iXOffset, iYOffset)\n            });\n            oLeafletFeature =  new L.Marker(oLatLon, {\n                icon: myIcon,\n                oFeature: this\n            });\n\n            return oLeafletFeature;\n        },\n        _updateFeature: function (oArgs) {\n            return this._createFeature(oArgs);\n        },\n        render: function () {\n            this.updateFeature(this.options);\n        },\n        setFeatureStyleProperties: function (sType, oProperties) {\n        }\n    };\n    return publicInterface;\n};\n\nleafLet.typeLibrary.GeoTextFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.GeoTextFeature());\n","/* global L, leafLet, emp, cmapi */\n\nleafLet.internalPrivateClass.GeoRectangleFeature = function () {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        _createFeature: function (args) {\n            var oLeafletFeature = undefined;\n            var distance;\n            var newLatLng;\n            var oLatLon = leafLet.utils.geoJson.convertCoordinatesToLatLng(args.data)[0];\n            var oLatLngList = [];\n            var angleOffset;\n            var azimuth = ((args.properties && args.properties.azimuth) ? args.properties.azimuth: 0);\n            var height = ((args.properties && args.properties.height) ? args.properties.height / 2: undefined);\n            var width = ((args.properties && args.properties.width) ? args.properties.width / 2: undefined);\n            var oProperties;\n\n            if ((oLatLon === undefined) || (height === undefined) || (width === undefined)) {\n                return undefined;\n            }\n\n            oProperties = this._getPolygonProperties(args);\n\n            distance = Math.sqrt((height * height) + (width * width));\n            // The width and height are reversed to get the angle from the vertical axis.\n            angleOffset = Math.atan2(width, height).toDeg();\n\n            newLatLng = oLatLon.destinationPoint(azimuth + angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            newLatLng = oLatLon.destinationPoint(azimuth + 180.0 - angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            newLatLng = oLatLon.destinationPoint(azimuth + 180.0 + angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            newLatLng = oLatLon.destinationPoint(azimuth + 360.0 - angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            oLeafletFeature =  new L.polygon(oLatLngList, oProperties);\n\n            return oLeafletFeature;\n        },\n        _updateFeature: function (oArgs) {\n            return this._createFeature(oArgs);\n        },\n        render: function () {\n            this.updateFeature(this.options);\n        },\n        setFeatureStyleProperties: function (sType, oProperties) {\n        }\n    };\n    return publicInterface;\n};\n\nleafLet.typeLibrary.GeoRectangleFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.GeoRectangleFeature());\n","/* global L, leafLet, emp, cmapi */\n\nleafLet.internalPrivateClass.GeoSquareFeature = function () {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        _createFeature: function (args) {\n            var oLeafletFeature = undefined;\n            var distance;\n            var newLatLng;\n            var oLatLon = leafLet.utils.geoJson.convertCoordinatesToLatLng(args.data)[0];\n            var oLatLngList = [];\n            var angleOffset;\n            var azimuth = ((args.properties && args.properties.azimuth) ? args.properties.azimuth: 0);\n            var width = ((args.properties && args.properties.width) ? args.properties.width / 2: undefined);\n            var oProperties;\n\n            if ((oLatLon === undefined) || (width === undefined)) {\n                return undefined;\n            }\n\n            oProperties = this._getPolygonProperties(args);\n\n            distance = Math.sqrt(2 * (width * width));\n\n            angleOffset = 45;\n\n            newLatLng = oLatLon.destinationPoint(azimuth + angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            newLatLng = oLatLon.destinationPoint(azimuth + 180.0 - angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            newLatLng = oLatLon.destinationPoint(azimuth + 180.0 + angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            newLatLng = oLatLon.destinationPoint(azimuth + 360.0 - angleOffset, distance);\n            oLatLngList.push(newLatLng);\n\n            oLeafletFeature =  new L.polygon(oLatLngList, oProperties);\n\n            return oLeafletFeature;\n        },\n        _updateFeature: function (oArgs) {\n            return this._createFeature(oArgs);\n        },\n        render: function () {\n            this.updateFeature(this.options);\n        },\n        setFeatureStyleProperties: function (sType, oProperties) {\n        }\n    };\n    return publicInterface;\n};\n\nleafLet.typeLibrary.GeoSquareFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.GeoSquareFeature());\n","/* global L, leafLet, emp, cmapi */\n\nleafLet.internalPrivateClass.GeoCircleFeature = function () {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        _createFeature: function (args) {\n            var oLeafletFeature = undefined;\n            var oLatLon = leafLet.utils.geoJson.convertCoordinatesToLatLng(args.data)[0];\n            var radius = ((args.properties && args.properties.radius) ? args.properties.radius: undefined);\n            var oProperties;\n\n            if ((oLatLon === undefined) || (radius === undefined)) {\n                return undefined;\n            }\n\n            oProperties = this._getPolygonProperties(args);\n\n            oLeafletFeature =  new L.circle(oLatLon, radius, oProperties);\n\n            return oLeafletFeature;\n        },\n        _updateFeature: function (oArgs) {\n            return this._createFeature(oArgs);\n        },\n        render: function () {\n            this.updateFeature(this.options);\n        },\n        setFeatureStyleProperties: function (sType, oProperties) {\n        }\n    };\n    return publicInterface;\n};\n\nleafLet.typeLibrary.GeoCircleFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.GeoCircleFeature());\n","/* global L, leafLet, emp, cmapi */\n\nleafLet.internalPrivateClass.GeoEllipseFeature = function () {\n    var publicInterface = {\n        initialize: function (args) {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n            leafLet.typeLibrary.Feature.prototype.initialize.call(this, args);\n        },\n        _createFeature: function (args) {\n            var oLeafletFeature = undefined;\n            var oLatLon = leafLet.utils.geoJson.convertCoordinatesToLatLng(args.data)[0];\n            var semiMajor = ((args.properties && args.properties.semiMajor) ? args.properties.semiMajor: undefined);\n            var semiMinor = ((args.properties && args.properties.semiMinor) ? args.properties.semiMinor: undefined);\n            var oProperties;\n\n            if ((oLatLon === undefined) || (semiMajor === undefined) || (semiMinor === undefined)) {\n                return undefined;\n            }\n\n            oProperties = this._getPolygonProperties(args);\n\n            oLeafletFeature =  new leafLet.EllipseObject({\n                leafletMap: this.getEngineInstanceInterface().leafletInstance,\n                isSelected: this.isSelected(),\n                selectAttributes: this.getEngineInstanceInterface().selectAttributes,\n                oFeature: this,\n                properties: this._getPolygonProperties(args),\n                centerLatLng: oLatLon,\n                semiMinor: semiMinor,\n                semiMajor: semiMajor,\n                azimuth: ((args.properties && args.properties.azimuth) ? args.properties.azimuth: 0)\n            });\n\n            return oLeafletFeature;\n        },\n        _updateFeature: function (oArgs) {\n            return this._createFeature(oArgs);\n        },\n        render: function () {\n            this.updateFeature(this.options);\n        },\n        setFeatureStyleProperties: function (sType, oProperties) {\n        }\n    };\n    return publicInterface;\n};\n\nleafLet.typeLibrary.GeoEllipseFeature = leafLet.typeLibrary.Feature.extend(leafLet.internalPrivateClass.GeoEllipseFeature());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.typeLibrary.AirspaceAttribute = {\n    AIRSPACE_FILL_COLOR: \"fillColor\",\n    AIRSPACE_LINE_COLOR: \"lineColor\",\n    AIRSPACE_LINE_WIDTH: \"lineWidth\",\n    AIRSPACE_LEFT_WIDTH: \"leftWidth\",\n    AIRSPACE_RIGHT_WIDTH: \"rightWidth\",\n    AIRSPACE_WIDTH: \"width\",\n    AIRSPACE_HEIGHT: \"height\",\n    AIRSPACE_ALTITUDE: \"altitude\",\n    AIRSPACE_MIN_ALTITUDE: \"minAlt\",\n    AIRSPACE_MAX_ALTITUDE: \"maxAlt\",\n    AIRSPACE_ALTITUDE_MODE: \"altitudeMode\",\n    AIRSPACE_INNER_RADIUS: \"innerRadius\",\n    AIRSPACE_RADIUS: \"radius\",\n    AIRSPACE_LEFT_AZIMUTH: \"leftAzimuth\",\n    AIRSPACE_RIGHT_AZIMUTH: \"rightAzimuth\",\n    AIRSPACE_ORBIT_TURN: \"turn\"\n};\n\nleafLet.internalPrivateClass.AirspaceAttributes = function(){\n    var publicInterface = {\n        initialize: function (oProperties, oAttributes) \n        {\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var options = {};\n            \n            for (var sAttr in oAttributes)\n            {\n                if (!oAttributes.hasOwnProperty(sAttr)) {\n                    continue;\n                }\n                if (sAttr === leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_ORBIT_TURN)\n                {\n                    options[sAttr] = oAttributes[sAttr].toLowerCase();\n                }\n                else\n                {\n                    options[sAttr] = oAttributes[sAttr];\n                }\n            }\n            \n            if (oProperties.hasOwnProperty(cAirspaceAttribute.AIRSPACE_FILL_COLOR))\n            {\n                options[cAirspaceAttribute.AIRSPACE_FILL_COLOR] = oProperties[cAirspaceAttribute.AIRSPACE_FILL_COLOR];\n            }\n            \n            if (oProperties.hasOwnProperty(cAirspaceAttribute.AIRSPACE_LINE_COLOR))\n            {\n                options[cAirspaceAttribute.AIRSPACE_LINE_COLOR] = oProperties[cAirspaceAttribute.AIRSPACE_LINE_COLOR];\n            }\n            \n            if (oProperties.hasOwnProperty(cAirspaceAttribute.AIRSPACE_LINE_WIDTH))\n            {\n                options[cAirspaceAttribute.AIRSPACE_LINE_WIDTH] = oProperties[cAirspaceAttribute.AIRSPACE_LINE_WIDTH];\n            }\n            \n            L.Util.setOptions(this, options);\n        },\n        getValue: function(sAttr)\n        {\n            return this.options[sAttr];\n        },\n        setValue: function(sAttr, Value)\n        {\n            this.options[sAttr] = Value;\n        },\n        getAttributes: function()\n        {\n            return this.options;\n        },\n        setRequiredAttributes: function(sAirspaceType)\n        {\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var cAirspaceType = emp.typeLibrary.airspaceSymbolCode;\n            \n            switch (sAirspaceType)\n            {\n                case cAirspaceType.SHAPE3D_CURTAIN:\n                    break;\n                case cAirspaceType.SHAPE3D_CYLINDER:\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_RADIUS)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_RADIUS, 2000);\n                    }\n                    break;\n                case cAirspaceType.SHAPE3D_ORBIT:\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_WIDTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_WIDTH, 2000);\n                    }\n                    if (this.getValue(cAirspaceAttribute.AIRSPACE_ORBIT_TURN) === undefined)\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_ORBIT_TURN, emp.typeLibrary.orbitTurnType.CENTER);\n                    }\n                    break;\n                case cAirspaceType.SHAPE3D_POLYARC:\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_RADIUS)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_RADIUS, 2000);\n                    }\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH, 315.0);\n                    }\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH, 45.0);\n                    }\n                    break;\n                case cAirspaceType.SHAPE3D_POLYGON:\n                    break;\n                case cAirspaceType.SHAPE3D_RADARC:\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_RADIUS)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_RADIUS, 2000);\n                    }\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_INNER_RADIUS)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_INNER_RADIUS, 1000);\n                    }\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH, 315.0);\n                    }\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH, 45.0);\n                    }\n                    break;\n                case cAirspaceType.SHAPE3D_ROUTE:\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_WIDTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_WIDTH, 5000);\n                    }\n                    break;\n                case cAirspaceType.SHAPE3D_TRACK:\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_LEFT_WIDTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_LEFT_WIDTH, 2500);\n                    }\n                    if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_WIDTH)))\n                    {\n                        this.setValue(cAirspaceAttribute.AIRSPACE_RIGHT_WIDTH, 2500);\n                    }\n                    break;\n            }\n            \n            var dMinAlt = this.getValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE);\n            if (isNaN(dMinAlt))\n            {\n                dMinAlt = 0;\n                this.setValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE, dMinAlt);\n            }\n            if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE)))\n            {\n                this.setValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE, dMinAlt + 5000);\n            }\n            else if (dMinAlt > this.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE))\n            {\n                this.setValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE, this.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE));\n                this.setValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE, dMinAlt);\n            }\n            \n            if (this.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR) === undefined)\n            {\n                this.setValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR, \"0xAAAAFFAA\");\n            }\n            \n            if (this.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR) === undefined)\n            {\n                this.setValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR, \"0xFF00AA00\");\n            }\n            \n            if (isNaN(this.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH)))\n            {\n                this.setValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH, 3);\n            }\n        },\n        getAirspaceAttributes: function()\n        {\n            var oAttr = {};\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            for (var sAttr in this.options)\n            {\n                if (!this.options.hasOwnProperty(sAttr)) {\n                    continue;\n                }\n                switch (sAttr)\n                {\n                    case cAirspaceAttribute.AIRSPACE_FILL_COLOR:\n                    case cAirspaceAttribute.AIRSPACE_LINE_COLOR:\n                    case cAirspaceAttribute.AIRSPACE_LINE_WIDTH:\n                        break;\n                    default:\n                        oAttr[sAttr] = this.options[sAttr];\n                        break;\n                }\n            }\n            \n            return oAttr;\n        },\n        duplicateAttribute: function()\n        {\n            return new leafLet.typeLibrary.airspace.Attributes({}, this.options);\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.Attributes = L.Class.extend(leafLet.internalPrivateClass.AirspaceAttributes());\n\nleafLet.internalPrivateClass.AirspaceAttributeList = function(){\n    var publicInterface = {\n        initialize: function (oProperties) \n        {\n            var oAttrList = oProperties.attributes;\n            var options = {\n                oAttributeList: []\n            };\n            L.Util.setOptions(this, options);\n            \n            if (!(oAttrList instanceof Array))\n            {\n                if ((typeof (oAttrList) === 'object') && (oAttrList.length > 0))\n                {\n                    this.add(new leafLet.typeLibrary.airspace.Attributes(oProperties, oAttrList));\n                }\n                else\n                {\n                    this.add(new leafLet.typeLibrary.airspace.Attributes(oProperties, {}));\n                }\n            }\n            else\n            {\n                for (var iIndex = 0; iIndex < oAttrList.length; iIndex++)\n                {\n                    this.add(new leafLet.typeLibrary.airspace.Attributes(oProperties, oAttrList[iIndex]));\n                }\n            }\n        },\n        length: function()\n        {\n            return this.options.oAttributeList.length;\n        },\n        get: function(iIndex)\n        {\n            return this.options.oAttributeList[iIndex];\n        },\n        add: function(oAttr)\n        {\n            this.options.oAttributeList.push(oAttr);\n        },\n        insert: function(iIndex, oAttr)\n        {\n            this.options.oAttributeList.splice(iIndex, 0, oAttr);\n        },\n        remove: function(iIndex)\n        {\n            if (iIndex < this.options.oAttributeList.length)\n            {\n                this.options.oAttributeList.splice(iIndex, 1);\n            }\n        },\n        getAirspaceAttributeList: function()\n        {\n            var oAttrList = [];\n            \n            for (var iIndex = 0; iIndex < this.options.oAttributeList.length; iIndex++)\n            {\n                oAttrList.push(this.options.oAttributeList[iIndex].getAirspaceAttributes());\n            }\n            \n            return oAttrList;\n        },\n        getMinAltitude: function()\n        {\n            var dMin = Number.MAX_VALUE;\n            var oAttributeList = this.options.oAttributeList;\n            var cAttributeConst = leafLet.typeLibrary.AirspaceAttribute;\n            var oAttributes;\n            var dValue;\n            \n            for (var iIndex = 0; iIndex < oAttributeList.length; iIndex++)\n            {\n                oAttributes = oAttributeList[iIndex];\n                dValue = oAttributes.getValue(cAttributeConst.AIRSPACE_MIN_ALTITUDE);\n                \n                if ((typeof (dValue) === 'number') && (dValue < dMin))\n                {\n                    dMin = dValue;\n                }\n            }\n            \n            return Math.round(dMin);\n        },\n        getMaxAltitude: function()\n        {\n            var dMax = Number.MIN_VALUE;\n            var oAttributeList = this.options.oAttributeList;\n            var cAttributeConst = leafLet.typeLibrary.AirspaceAttribute;\n            var oAttributes;\n            var dValue;\n            \n            for (var iIndex = 0; iIndex < oAttributeList.length; iIndex++)\n            {\n                oAttributes = oAttributeList[iIndex];\n                dValue = oAttributes.getValue(cAttributeConst.AIRSPACE_MAX_ALTITUDE);\n                \n                if ((typeof (dValue) === 'number') && (dValue > dMax))\n                {\n                    dMax = dValue;\n                }\n            }\n            \n            return Math.round(dMax);\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.AttributeList = L.Class.extend(leafLet.internalPrivateClass.AirspaceAttributeList());\n\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.CylinderAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 1, 1);\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n            var oAttributes = this.getAttributes(0);\n            var oLatLng = this.getCoordinateList()[0];\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            sPopupText = \"<center>\" + (oLatLng? \n                    \"<b>Lat</b>:&nbsp;\" + oLatLng.lat.toFixed(5) +\n                    \"<br/><b>Lon</b>:&nbsp;\" + oLatLng.lng.toFixed(5): \"\") + \n                    \"<br/><b>Radius</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS) + this.getUnits() +\n                    \"<br/><b>Min Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);;\n            var oAttributes = oArgs.oAirspaceAttributeList.get(0);\n            var oLatLng = oLatLngList[0];\n            \n            if (oLatLng === undefined)\n            {\n                return undefined;\n            }\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_CYLINDER);\n            \n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var iWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH);\n\n            var oOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: iWidth,\n                oFeature: this\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n                \n                oOptions.tempColor = oOptions.color;\n                oOptions.tempWeight = oOptions.weight;\n                \n                oOptions.color = '#' + oSelectAttributes.color;\n                oOptions.weight = oSelectAttributes.width;\n            }\n            var oLeafletObject = new L.Circle(oLatLng, oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS), oOptions);\n\n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        getFeatureBounds: function()\n        {\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oLatLng = this.getCoordinateList()[0];\n            var oAttributes = this.getAttributes(0);\n            var oNorthEast = new L.LatLng(oLatLng.lat, oLatLng.lng);\n            var oSouthWest = new L.LatLng(oLatLng.lat, oLatLng.lng);\n            var dDist = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS) * 2.0;\n\n            oNorthEast.moveCoordinate(45.0, dDist);\n            oSouthWest.moveCoordinate(225.0, dDist);\n\n            return new leafLet.typeLibrary.EmpBoundary(oSouthWest, oNorthEast);\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oLeafletObject = this.options.leafletObject;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var oLatLng = oCoordList[0];\n            var oAttributes = oAttributeList.get(0);\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_CYLINDER);\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var iWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH);\n\n            var oOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: iWidth\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n                \n                oOptions.tempColor = oOptions.color;\n                oOptions.tempWeight = oOptions.weight;\n                \n                oOptions.color = '#' + oSelectAttributes.color;\n                oOptions.weight = oSelectAttributes.width;\n            }\n\n            oLeafletObject.setLatLng(oLatLng);\n            oLeafletObject.setRadius(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS));\n            oLeafletObject.setStyle(oOptions);\n             \n            this.setAttributeList(oAttributeList);\n            this.setProperties(oArgs.properties);\n            this.setData(oArgs.data);\n            \n            return oLeafletObject;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.Cylinder = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.CylinderAirspace());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.PolygonAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 3, Number.MAX_VALUE);\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n            var oAttributes = this.getAttributes(0);\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            sPopupText = \"<center>\" +\n                    \"<b>Min Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);;\n            var oAttributes = oArgs.oAirspaceAttributeList.get(0);\n            \n            if (oLatLngList.length < this.getMinPoints())\n            {\n                return undefined;\n            }\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_POLYGON);\n            \n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var iWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH);\n            var oPolygonOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: iWidth,\n                oFeature: this\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n                \n                oPolygonOptions.tempColor = oPolygonOptions.color;\n                oPolygonOptions.tempWeight = oPolygonOptions.weight;\n                \n                oPolygonOptions.color = '#' + oSelectAttributes.color;\n                oPolygonOptions.weight = oSelectAttributes.width;\n            }\n            \n            var oLeafletObject = new L.Polygon(oLatLngList, oPolygonOptions);\n            \n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oAttributes;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            var oLeafletObject = this.getLeafletObject();\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            oAttributes = oAttributeList.get(0);\n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_POLYGON);\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var iWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH);\n            var oPolygonOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: iWidth\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n\n                oPolygonOptions.tempColor = oPolygonOptions.color;\n                oPolygonOptions.tempWeight = oPolygonOptions.weight;\n                \n                oPolygonOptions.color = '#' + oSelectAttributes.color;\n                oPolygonOptions.weight = oSelectAttributes.width;\n            }\n\n            oLeafletObject.setLatLngs(oLatLngList);\n            oLeafletObject.setStyle(oPolygonOptions);\n            \n            this.setAttributeList(oAttributeList);\n            this.setProperties(oArgs.properties);\n            this.setData(oArgs.data);\n            \n            return oLeafletObject;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.Polygon = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.PolygonAirspace());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.CurtainAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 2, Number.MAX_VALUE);\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n            var oAttributes = this.getAttributes(0);\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            sPopupText = \"<center>\" +\n                    \"<b>Min Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);;\n            var oAttributes = oArgs.oAirspaceAttributeList.get(0);\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_CURTAIN);\n            \n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var iWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH);\n\n            var oOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                weight: iWidth,\n                oFeature: this\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n                \n                oOptions.tempColor = oOptions.color;\n                oOptions.tempWeight = oOptions.weight;\n                \n                oOptions.color = '#' + oSelectAttributes.color;\n                oOptions.weight = oSelectAttributes.width;\n            }\n            \n            var oLeafletObject = new L.Polyline(oLatLngList, oOptions);\n            \n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oLeafletObject = this.options.leafletObject;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var oAttributes = oAttributeList.get(0);\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_CURTAIN);\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var iWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH);\n\n            var oOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                weight: iWidth\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n                \n                oOptions.tempColor = oOptions.color;\n                oOptions.tempWeight = oOptions.weight;\n                \n                oOptions.color = '#' + oSelectAttributes.color;\n                oOptions.weight = oSelectAttributes.width;\n            }\n\n            oLeafletObject.setLatLngs(oCoordList);\n            oLeafletObject.setStyle(oOptions);\n             \n            this.setAttributeList(oAttributeList);\n            this.setProperties(oArgs.properties);\n            this.setData(oArgs.data);\n            \n            return oLeafletObject;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.Curtain = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.CurtainAirspace());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.OrbitAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 2, 2);\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n            var oAttributes = this.getAttributes(0);\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            sPopupText = \"<center>\" +\n                    \"<b>Turn</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_ORBIT_TURN) + \n                    \"<br/><b>Width</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_WIDTH) +  this.getUnits() +\n                    \"<br/><b>Min Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var sTurn;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);;\n            var oNewLatLngList = oLatLngList;\n            var oAttributes = oArgs.oAirspaceAttributeList.get(0);\n            \n            if (oLatLngList.length < 2)\n            {\n                return undefined;\n            }\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_ORBIT);\n            sTurn = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_ORBIT_TURN);\n            \n            if (sTurn !== emp.typeLibrary.orbitTurnType.CENTER)\n            {\n                var dDist = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_WIDTH) / 2;\n                var dAnglePt1Pt2 = oLatLngList[0].bearingTo(oLatLngList[1]);\n                var dBearing;\n                oNewLatLngList = [];\n\n                switch (sTurn)\n                {\n                    case emp.typeLibrary.orbitTurnType.RIGHT:\n                        dBearing = (dAnglePt1Pt2 + 90.0) % 360;\n                        break;\n                    case emp.typeLibrary.orbitTurnType.LEFT:\n                        dBearing = (dAnglePt1Pt2 + 270.0) % 360;\n                        break;\n                }\n                oNewLatLngList.push(oLatLngList[0].destinationPoint(dBearing, dDist));\n                oNewLatLngList.push(oLatLngList[1].destinationPoint(dBearing, dDist));\n            }\n\n            var oLeafletObject = new leafLet.utils.OvalObject({\n                    leafletMap: this.options.instanceInterface.leafletInstance,\n                    width: oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_WIDTH),\n                    attributes: oAttributes,\n                    isSelected: this.isSelected(),\n                    selectAttributes: this.getEngineInstanceInterface().selectAttributes,\n                    coordinates: oNewLatLngList,\n                    oFeature: this\n                });\n            \n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n\n            oArgs.oAirspaceAttributeList = oAttributeList;\n            return this._createFeature(oArgs);\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.Orbit = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.OrbitAirspace());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.RouteAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 2, Number.MAX_VALUE);\n        },\n        getPopupText: function()\n        {\n            var sPopupText;\n            var oAttributeList = this.getAttributeList();\n            \n            sPopupText = \"<center>\" +\n                    \"<b>Min Alt</b>:&nbsp;\" + oAttributeList.getMinAltitude() + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributeList.getMaxAltitude() + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var oOvalLeafletObject;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);;\n            var oAttributes = oArgs.oAirspaceAttributeList.get(0);\n            var bIsSelected = this.isSelected();\n           \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_ROUTE);\n            \n            var oLeafletObject = new L.FeatureGroup();\n            \n            for (var iIndex = 1; iIndex < oLatLngList.length; iIndex++)\n            {\n                var oLegCoords = [oLatLngList[iIndex - 1], oLatLngList[iIndex]];\n                \n                oOvalLeafletObject = new leafLet.utils.OvalObject({\n                        leafletMap: this.options.instanceInterface.leafletInstance,\n                        width: oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_WIDTH),\n                        attributes: oAttributes,\n                        isSelected: bIsSelected,\n                        selectAttributes: this.getEngineInstanceInterface().selectAttributes,\n                        coordinates: oLegCoords,\n                        oFeature: this\n                    });\n                oLeafletObject.addLayer(oOvalLeafletObject);\n            }\n            \n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            var oAttributes = oAttributeList.get(0);\n            var oOvalLeafletObject;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var bIsSelected = this.isSelected();\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_ROUTE);\n            \n            var oLeafletObject = this.getLeafletObject();\n            \n            oLeafletObject.clearLayers();\n            \n            for (var iIndex = 1; iIndex < oLatLngList.length; iIndex++)\n            {\n                var oLegCoords = [oLatLngList[iIndex - 1], oLatLngList[iIndex]];\n                \n                oOvalLeafletObject = new leafLet.utils.OvalObject({\n                        leafletMap: this.options.instanceInterface.leafletInstance,\n                        width: oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_WIDTH),\n                        attributes: oAttributes,\n                        isSelected: bIsSelected,\n                        selectAttributes: this.getEngineInstanceInterface().selectAttributes,\n                        coordinates: oLegCoords,\n                        oFeature: this\n                    });\n                oLeafletObject.addLayer(oOvalLeafletObject);\n            }\n            \n            this.setAttributeList(oAttributeList);\n            this.setData(oArgs.data);\n            this.setProperties(oArgs.properties);\n            return oLeafletObject;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.Route = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.RouteAirspace());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.TrackAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 2, Number.MAX_VALUE);\n        },\n        getPopupText: function()\n        {\n            var sPopupText;\n            var oAttributeList = this.getAttributeList();\n            //var oAttributes = this.getAttributes(0);\n            //var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            sPopupText = \"<center>\" +\n                    \"<b>Min Alt</b>:&nbsp;\" + oAttributeList.getMinAltitude() + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributeList.getMaxAltitude() + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var oOvalLeafletObject;\n            var oAttributes;\n            var dLeftWidth;\n            var dRightWidth;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var oAttributeList = oArgs.oAirspaceAttributeList;\n            var oLeafletObject = new L.FeatureGroup();\n            var bIsSelected = this.isSelected();\n\n            for (var iIndex = 1; iIndex < oLatLngList.length; iIndex++)\n            {\n                var oLegCoords = [oLatLngList[iIndex - 1], oLatLngList[iIndex]];\n                \n                if (iIndex > oAttributeList.length())\n                {\n                    // We need another attribute element.\n                    oAttributes = oAttributeList.get(iIndex - 1);\n                    oAttributes = new leafLet.typeLibrary.airspace.Attributes(this.getProperties(), oAttributes.getAttributes());\n                    oAttributeList.add(oAttributes);\n                }\n                \n                oAttributes = oAttributeList.get(iIndex - 1);\n                oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_TRACK);\n\n                dLeftWidth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_WIDTH);\n                dRightWidth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_WIDTH);\n                \n                if (dRightWidth !== dLeftWidth)\n                {\n                    // tracks have diff left and right width and if they are not\n                    // equal we need to offset the coordinates to account for it.\n                    var Bearing;\n                    var dDist = Math.abs(dRightWidth - dLeftWidth) / 2.0;\n                    var dBearingPt1Pt2 = oLatLngList[iIndex - 1].bearingTo(oLatLngList[iIndex]);\n                    \n                    if (dRightWidth > dLeftWidth)\n                    {\n                        Bearing = (dBearingPt1Pt2 + 90.0) % 360;\n                    }\n                    else\n                    {\n                        Bearing = (dBearingPt1Pt2 + 270.0) % 360;\n                    }\n                    \n                    oLegCoords = [oLatLngList[iIndex - 1].destinationPoint(Bearing, dDist), oLatLngList[iIndex].destinationPoint(Bearing, dDist)];\n                }\n                \n                oOvalLeafletObject = new leafLet.utils.OvalObject({\n                        leafletMap: this.options.instanceInterface.leafletInstance,\n                        width: dLeftWidth + dRightWidth,\n                        attributes: oAttributes,\n                        isSelected: bIsSelected,\n                        selectAttributes: this.getEngineInstanceInterface().selectAttributes,\n                        coordinates: oLegCoords,\n                        oFeature: this\n                    });\n                oLeafletObject.addLayer(oOvalLeafletObject);\n            }\n            \n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oOvalLeafletObject;\n            var oAttributes;\n            var dLeftWidth;\n            var dRightWidth;\n            var oLatLngList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            var oLeafletObject = this.getLeafletObject();\n            var bIsSelected = this.isSelected();\n            \n            oLeafletObject.clearLayers();\n            \n            for (var iIndex = 1; iIndex < oLatLngList.length; iIndex++)\n            {\n                var oLegCoords = [oLatLngList[iIndex - 1], oLatLngList[iIndex]];\n                \n                if (iIndex > oAttributeList.length())\n                {\n                    // We need another attribute element.\n                    oAttributes = oAttributeList.get(iIndex - 1);\n                    oAttributes = new leafLet.typeLibrary.airspace.Attributes(oArgs.properties, oAttributes.getAttributes());\n                    oAttributeList.add(oAttributes);\n                }\n                \n                oAttributes = oAttributeList.get(iIndex - 1);\n                oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_TRACK);\n\n                dLeftWidth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_WIDTH);\n                dRightWidth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_WIDTH);\n                \n                if (dRightWidth !== dLeftWidth)\n                {\n                    // tracks have diff left and right width and if they are not\n                    // equal we need to offset the coordinates to account for it.\n                    var Bearing;\n                    var dDist = Math.abs(dRightWidth - dLeftWidth) / 2.0;\n                    var dBearingPt1Pt2 = oLatLngList[iIndex - 1].bearingTo(oLatLngList[iIndex]);\n                    \n                    if (dRightWidth > dLeftWidth)\n                    {\n                        Bearing = (dBearingPt1Pt2 + 90.0) % 360;\n                    }\n                    else\n                    {\n                        Bearing = (dBearingPt1Pt2 + 270.0) % 360;\n                    }\n                    \n                    oLegCoords = [oLatLngList[iIndex - 1].destinationPoint(Bearing, dDist), oLatLngList[iIndex].destinationPoint(Bearing, dDist)];\n                }\n                \n                oOvalLeafletObject = new leafLet.utils.OvalObject({\n                        leafletMap: this.options.instanceInterface.leafletInstance,\n                        width: dLeftWidth + dRightWidth,\n                        attributes: oAttributes,\n                        isSelected: bIsSelected,\n                        selectAttributes: this.getEngineInstanceInterface().selectAttributes,\n                        coordinates: oLegCoords,\n                        oFeature: this\n                    });\n                oLeafletObject.addLayer(oOvalLeafletObject);\n            }\n             \n            this.setAttributeList(oAttributeList);\n            this.setProperties(oArgs.properties);\n            this.setData(oArgs.data);\n           \n            return oLeafletObject;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.Track = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.TrackAirspace());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.RadArcAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 1, 1);\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n            var oAttributes = this.getAttributes(0);\n            var oLatLng = this.getCoordinateList()[0];\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            \n            sPopupText = \"<center>\" +\n                    \"<b>Lat</b>:&nbsp;\" + oLatLng.lat.toFixed(5) +\n                    \"<br/><b>Lon</b>:&nbsp;\" + oLatLng.lng.toFixed(5) +\n                    \"<br/><b>Left Azimuth</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH) + this.getAngleUnits() +\n                    \"<br/><b>Right Azimuth</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH) + this.getAngleUnits() +\n                    \"<br/><b>Outter Radius</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS) + this.getUnits() +\n                    \"<br/><b>Inner Radius</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_INNER_RADIUS) + this.getUnits() +\n                    \"<br/><b>Min Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var oPartialCoordList;\n            var oLatLngList = [];\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oLeafletObject;\n            var oCenterLatLng = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data)[0];\n            var oAttributes = oArgs.oAirspaceAttributeList.get(0);\n            \n            if (oCenterLatLng === undefined)\n            {\n                return undefined;\n            }\n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_RADARC);\n            var dLeftAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n            var dRightAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n            var dInnerRadius = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_INNER_RADIUS);\n            var dOutterRadius = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS);\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var oPolygonOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH),\n                oFeature: this\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterfacee().selectAttributes;\n                \n                oPolygonOptions.tempColor = oPolygonOptions.color;\n                oPolygonOptions.tempWeight = oPolygonOptions.weight;\n                \n                oPolygonOptions.color = '#' + oSelectAttributes.color;\n                oPolygonOptions.weight = oSelectAttributes.width;\n            }\n\n            oPartialCoordList = leafLet.utils.getArcCoordinates(this.options.instanceInterface.leafletInstance,\n                oCenterLatLng, dInnerRadius, dLeftAzimuth, dRightAzimuth, true);\n                \n            oLatLngList = oLatLngList.concat(oPartialCoordList);\n\n            oPartialCoordList = leafLet.utils.getArcCoordinates(this.options.instanceInterface.leafletInstance,\n                oCenterLatLng, dOutterRadius, dRightAzimuth, dLeftAzimuth, false);\n                \n            oLatLngList = oLatLngList.concat(oPartialCoordList);\n//console.log(\"RadArc Points: \" + oLatLngList.length);\n\n            oLeafletObject = new L.Polygon(oLatLngList, oPolygonOptions);\n             \n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oPartialCoordList;\n            var oLatLngList = [];\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            var oLeafletObject = this.getLeafletObject();\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oAttributes = oAttributeList.get(0);\n            var oCenterLatLng = oCoordList[0];\n            \n            if (oCenterLatLng === undefined)\n            {\n                return undefined;\n            }\n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_RADARC);\n            var dLeftAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n            var dRightAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n            var dInnerRadius = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_INNER_RADIUS);\n            var dOutterRadius = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS);\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var oPolygonOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH)\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterfacee().selectAttributes;\n                \n                oPolygonOptions.tempColor = oPolygonOptions.color;\n                oPolygonOptions.tempWeight = oPolygonOptions.weight;\n                \n                oPolygonOptions.color = '#' + oSelectAttributes.color;\n                oPolygonOptions.weight = oSelectAttributes.width;\n            }\n\n            oPartialCoordList = leafLet.utils.getArcCoordinates(this.options.instanceInterface.leafletInstance,\n                oCenterLatLng, dInnerRadius, dLeftAzimuth, dRightAzimuth, true);\n                \n            oLatLngList = oLatLngList.concat(oPartialCoordList);\n\n            oPartialCoordList = leafLet.utils.getArcCoordinates(this.options.instanceInterface.leafletInstance,\n                oCenterLatLng, dOutterRadius, dRightAzimuth, dLeftAzimuth, false);\n                \n            oLatLngList = oLatLngList.concat(oPartialCoordList);\n\n            oLeafletObject.setLatLngs(oLatLngList);\n            oLeafletObject.setStyle(oPolygonOptions);\n             \n            this.setAttributeList(oAttributeList);\n            this.setProperties(oArgs.properties);\n            this.setData(oArgs.data);\n            \n            return oLeafletObject;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.RadArc = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.RadArcAirspace());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.PolyArcAirspace = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n            };\n            L.Util.setOptions(this, options);\n\n            leafLet.typeLibrary.AirspaceFeature.prototype.initialize.call(this, args, 3, Number.MAX_VALUE);\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n            var oAttributes = this.getAttributes(0);\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oLatLng = this.getCoordinateList()[0];\n            \n            sPopupText = \"<center>\" +\n                    \"<b>Lat</b>:&nbsp;\" + oLatLng.lat.toFixed(5) +\n                    \"<br/><b>Lon</b>:&nbsp;\" + oLatLng.lng.toFixed(5) +\n                    \"<br/><b>Left Azimuth</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH) + this.getAngleUnits() +\n                    \"<br/><b>Right Azimuth</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH) + this.getAngleUnits() +\n                    \"<br/><b>Radius</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS) + this.getUnits() +\n                    \"<br/><b>Min Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MIN_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"<br/><b>Max Alt</b>:&nbsp;\" + oAttributes.getValue(cAirspaceAttribute.AIRSPACE_MAX_ALTITUDE) + this._getAltUnitsAndModeText() + \n                    \"</center><br/>\" +\n                    this._getPopupDescription();\n            return sPopupText;\n        },\n        _createFeature: function(oArgs)\n        {\n            var oPartialCoordList;\n            var oLatLngList = [];\n            var oCoord;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oLeafletObject;\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);;\n            var oAttributes = oArgs.oAirspaceAttributeList.get(0);\n            \n            if (oCoordList.length < this.getMinPoints())\n            {\n                return undefined;\n            }\n            \n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_POLYARC);\n            var dLeftAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n            var dRightAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n            var dRadius = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS);\n            var oCenterLatLng = oCoordList[0];\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var oPolygonOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH),\n                oFeature: this\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n                \n                oPolygonOptions.tempColor = oPolygonOptions.color;\n                oPolygonOptions.tempWeight = oPolygonOptions.weight;\n                \n                oPolygonOptions.color = '#' + oSelectAttributes.color;\n                oPolygonOptions.weight = oSelectAttributes.width;\n            }\n\n            //oCoord = oCenterLatLng.destinationPoint(dLeftAzimuth, dRadius);\n            //oLatLngList.push(oCoord);\n            \n            oPartialCoordList = leafLet.utils.getArcCoordinates(this.options.instanceInterface.leafletInstance,\n                oCenterLatLng, dRadius, dLeftAzimuth, dRightAzimuth, true);\n                \n            oLatLngList = oLatLngList.concat(oPartialCoordList);\n\n            oCoord = oCenterLatLng.destinationPoint(dRightAzimuth, dRadius);\n            oLatLngList.push(oCoord);\n            \n            //for (var iIndex = oCoordList.length - 1; iIndex > 0 ; iIndex--)\n            for (var iIndex = 1; iIndex < oCoordList.length; iIndex++)\n            {\n                oLatLngList.push(oCoordList[iIndex]);\n            }\n            \n//console.log(\"PolyArc Points: \" + oLatLngList.length);\n\n            oLeafletObject = new L.Polygon(oLatLngList, oPolygonOptions);\n            \n            this.setAttributeList(oArgs.oAirspaceAttributeList);\n\n            return oLeafletObject;\n        },\n        _updateFeature: function(oArgs)\n        {\n            var oPartialCoordList;\n            var oLatLngList = [];\n            var oCoord;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oAttributeList = new leafLet.typeLibrary.airspace.AttributeList(oArgs.properties);\n            var oLeafletObject = this.getLeafletObject();\n            var oCoordList = leafLet.utils.geoJson.convertCoordinatesToLatLng(oArgs.data);\n            var oAttributes = oAttributeList.get(0);\n\n\n            oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_POLYARC);\n            var dLeftAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n            var dRightAzimuth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n            var dRadius = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RADIUS);\n            var oCenterLatLng = oCoordList[0];\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var oPolygonOptions = {\n                stroke: true,\n                color: oLineColor.sColor,\n                opacity: oLineColor.opacity,\n                fill: true,\n                fillColor: oFillColor.sColor,\n                fillOpacity: oFillColor.opacity,\n                weight: oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH)\n            };\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.getEngineInstanceInterface().selectAttributes;\n                \n                oPolygonOptions.tempColor = oPolygonOptions.color;\n                oPolygonOptions.tempWeight = oPolygonOptions.weight;\n                \n                oPolygonOptions.color = '#' + oSelectAttributes.color;\n                oPolygonOptions.weight = oSelectAttributes.width;\n            }\n            \n            if (oCoordList.length >= this.getMinPoints())\n            {\n                //oCoord = oCenterLatLng.destinationPoint(dLeftAzimuth, dRadius);\n                //oLatLngList.push(oCoord);\n\n                oPartialCoordList = leafLet.utils.getArcCoordinates(this.options.instanceInterface.leafletInstance,\n                    oCenterLatLng, dRadius, dLeftAzimuth, dRightAzimuth, true);\n\n                oLatLngList = oLatLngList.concat(oPartialCoordList);\n\n                oCoord = oCenterLatLng.destinationPoint(dRightAzimuth, dRadius);\n                oLatLngList.push(oCoord);\n\n                for (var iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    oLatLngList.push(oCoordList[iIndex]);\n                }\n\n                oLeafletObject.setLatLngs(oLatLngList);\n                oLeafletObject.setStyle(oPolygonOptions);\n            }\n             \n            this.setAttributeList(oAttributeList);\n            this.setProperties(oArgs.properties);\n            this.setData(oArgs.data);\n            \n            return oLeafletObject;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.typeLibrary.airspace.PolyArc = leafLet.typeLibrary.AirspaceFeature.extend(leafLet.internalPrivateClass.PolyArcAirspace());\n","/* global leafLet, L, emp */\n\nleafLet.utils = leafLet.utils || {};\n\nleafLet.utils.Units = {\n    FEET: 'ft',\n    METERS: 'm'\n};\n\nleafLet.utils.AngleUnits = {\n    DEGREES: '&deg;',\n    MILS: 'mils'\n};\n\nleafLet.utils.METERS_PER_FEET = 0.3048;\nleafLet.utils.FEET_PER_METERS = 3.28084;\nleafLet.utils.MILS_PER_DEGREE = (6400.0 / 360.0);\nleafLet.utils.DEGREE_PER_MILS = (360.0 / 6400.0);\n\nleafLet.utils.AltitudeModeAbbr = function(sMode) {\n    var sText = \"\";\n\n    switch (sMode) {\n    case emp.typeLibrary.featureAltitudeModeType.RELATIVE_TO_GROUND:\n        sText = \"AGL\";\n        break;\n    case emp.typeLibrary.featureAltitudeModeType.ABSOLUTE:\n        sText = \"MSL\";\n        break;\n    }\n\n    return sText;\n};\n\n\nleafLet.utils.normilizeLongitude = function(dLon) {\n    if (dLon < -180) {\n        while (dLon < -180) {\n            dLon += 360;\n        }\n    } else if (dLon > 180) {\n        dLon = ((dLon + 180) % 360) - 180;\n    }\n\n    return dLon;\n};\n\nleafLet.utils.convertViewBound = function(oBounds, oData) {\n    var oView = oData || {};\n\n    oView.west = leafLet.utils.normilizeLongitude(oBounds.getWest());\n    oView.south = oBounds.getSouth();\n    oView.east = leafLet.utils.normilizeLongitude(oBounds.getEast());\n    oView.north = oBounds.getNorth();\n\n    return oView;\n};\n\nleafLet.utils.isInt = function(sStr) {\n    var y = parseInt(sStr, 10);\n    return !isNaN(y) && (sStr == y) && (sStr.toString() == y.toString());\n};\n\nleafLet.utils.anyCoordinateInBounds = function(oBounds, oCoordinates) {\n    var oCoord;\n    var bRet = false;\n    var oaCoordList = oCoordinates.coordinates;\n\n    switch (oCoordinates.type.toLowerCase()) {\n    case 'point':\n        oCoord = new L.LatLng(oaCoordList[1], oaCoordList[0]);\n        bRet = oBounds.contains(oCoord);\n        break;\n    case 'linestring':\n        for(var iIndex = 0; iIndex < oaCoordList.length; iIndex++) {\n            oCoord = new L.LatLng(oaCoordList[iIndex][1], oaCoordList[iIndex][0]);\n            bRet = oBounds.contains(oCoord);\n\n            if (bRet) {\n                break;\n            }\n        }\n        break;\n    case 'polygon':\n        oaCoordList = oaCoordList[0];\n        for(var iIndex = 0; iIndex < oaCoordList.length; iIndex++) {\n            oCoord = new L.LatLng(oaCoordList[iIndex][1], oaCoordList[iIndex][0]);\n            bRet = oBounds.contains(oCoord);\n\n            if (bRet) {\n                break;\n            }\n        }\n        break;\n    }\n\n    return bRet;\n};\n\nleafLet.utils.wrapLongitude = function(oMapBoundry, oLatLng) {\n    var oMapCenter = oMapBoundry.getCenter();\n    var oNewLatLng = oLatLng.wrap();\n\n    if (oMapBoundry) {\n        if (oMapCenter.lng > 0) {\n            // The map is on the right side\n            if (oMapBoundry.getEast() > 180) {\n                // The right side went beyond the date line.\n                var oNorthEastBoundry = oMapBoundry.getNorthEast().wrap();\n\n                if (oNewLatLng.lng <= oNorthEastBoundry.lng) {\n                    oNewLatLng.lng = oNewLatLng.lng + 360;\n                }\n            }\n        } else {\n            // The map is on the left side\n            if (oMapBoundry.getWest() < -180) {\n                // The left side went beyond the date line.\n                var oNorthWestBoundry = oMapBoundry.getNorthWest().wrap();\n\n                if (oNewLatLng.lng >= oNorthWestBoundry.lng) {\n                    oNewLatLng.lng = oNewLatLng.lng - 360;\n                }\n            }\n        }\n    }\n\n    return oNewLatLng;\n};\n\nleafLet.utils.wrapCoordinates = function(oMapBoundry, oLatLngList, bWrappedAlready) {\n    var iIndex;\n    var lng;\n    var tempLng;\n    var bLnginView;\n    var iCoorCnt = oLatLngList.length;\n    var bCoordWrapped = bWrappedAlready || false;\n    var oMapCenter = oMapBoundry.getCenter();\n    var diffWithWest;\n    var diffWithEast;\n    var empBoundary = new leafLet.typeLibrary.EmpBoundary(oMapBoundry);\n    var bIDLinView = empBoundary.containsIDL();\n    \n    //console.log(\"Start wrapCoordinte\");\n    \n    for (iIndex = 0; iIndex < iCoorCnt; iIndex++) {\n        oLatLngList[iIndex] = oLatLngList[iIndex].wrap();\n        lng = oLatLngList[iIndex].lng;\n        \n        bLnginView = empBoundary.containsCoordiante(oLatLngList[iIndex]);\n\n        if (bIDLinView) {\n            tempLng = (empBoundary.getWest() - empBoundary.getEast()) / 2.0;\n            tempLng += empBoundary.getEast();\n            if (oMapBoundry.getEast() > 180) {\n                // The IDL is on the right of the map.\n                if (lng < tempLng) {\n                    oLatLngList[iIndex].lng += 360;\n                }\n            } else {\n                // The IDL is on the left of the map.\n                if (lng > tempLng) {\n                    oLatLngList[iIndex].lng -= 360;\n                }\n            }\n        } else {\n            if (!bLnginView) {\n                // The coordinate is not in view. We need to calculate where to place the point.\n                // Find the half of the outside lng.\n                tempLng = (empBoundary.getWest() + 180.0);\n                tempLng += (180.0 - empBoundary.getEast());\n                tempLng = tempLng / 2.0;\n                \n                if ((empBoundary.getWest() - tempLng) >= -180) {\n                    tempLng = empBoundary.getWest() - tempLng;\n                    if (lng < tempLng) {\n                        oLatLngList[iIndex].lng += 360;\n                    }\n                } else {\n                    tempLng = empBoundary.getEast() + tempLng;\n                    if (lng > tempLng) {\n                        oLatLngList[iIndex].lng -= 360;\n                    }\n                }\n            }\n        }\n        //console.log(\"IDL:\" + bIDLinView + \" InBBox:\" + bLnginView + \" Moved:\" + (lng != oLatLngList[iIndex].lng) + \" lat/Lng:\" + oLatLngList[iIndex].lat + \"/\" + oLatLngList[iIndex].lng + ((lng != oLatLngList[iIndex].lng)? \"(\" + oLatLngList[iIndex].lat + \"/\" + lng + \")\": \"\"));\n    }\n\n    return bCoordWrapped;\n};\n\nleafLet.utils.dateLineInFeature = function(oLatLngList) {\n    var bDataLineInFeature = false;\n    var lng1, lng2;\n    var iCount = oLatLngList.length;\n    var iCountMinus1 = iCount - 1;\n\n    if (oLatLngList.length === 0) {\n        return false;\n    }\n\n    for (var iIndex = 0; iIndex < iCountMinus1; iIndex++) {\n        lng1 = oLatLngList[iIndex].lng + 180;\n        lng2 = oLatLngList[iIndex + 1].lng + 180;\n\n        if (((lng1 > 180) && (lng2 < 180)) ||\n                ((lng1 < 180) && (lng2 > 180))) {\n            bDataLineInFeature = true;\n            break;\n        }\n    }\n\n    return bDataLineInFeature;\n};\n\nleafLet.utils.convertToColorString = function(dOpacity, sColor) {\n    var sNewColor = sColor.replace(\"#\", \"0x\");\n    var iColor = (Math.round(dOpacity * 255) * 4096) + parseInt(sNewColor);\n\n    sNewColor = iColor.toString(16);\n\n    return sNewColor;\n};\n\nleafLet.utils.mergeProperties = function(oProperties1, oProperties2) {\n    var oProperties = emp.helpers.copyObject(oProperties1);\n\n    for (var sProp in oProperties2) {\n        if (!oProperties2.hasOwnProperty(sProp)) {\n            continue;\n        }\n        oProperties[sProp] = emp.helpers.copyObject(oProperties2[sProp]);\n    }\n\n    return oProperties;\n};\n\nleafLet.utils.metersToFeet = function(iMeters) {\n    return iMeters * 3.28084;\n};\n\nleafLet.utils.feetToMeters = function(iFeet) {\n    return iFeet * 0.3048;\n};\n\nleafLet.utils.convertColor = function(sColor) {\n    var dValue = 255;\n    var oRet = {\n        sColor: \"\",\n        opacity: 1.0\n    };\n\n    if (sColor.indexOf(\"0x\") === 0) {\n        sColor = sColor.substr(2);\n    }\n\n    if (sColor.length > 7) {\n        // There is an alpha value;\n        dValue = parseInt(\"0x\" + sColor.substr(0,2));\n        sColor = sColor.substr(2);\n    } else if (sColor.length > 6) {\n        // There is an alpha value;\n        dValue = parseInt(\"0x\" + sColor.substr(0,1));\n        sColor = sColor.substr(1);\n    }\n    oRet.opacity = dValue / 255;\n    oRet.sColor = \"#\" + sColor;\n\n    return oRet;\n};\n\nleafLet.utils.angleBetween = function(oVertice, oPt1, oPt2) {\n    var dAngleVPt1 = oVertice.bearingTo(oPt1);\n    var dAngleVPt2 = oVertice.bearingTo(oPt2);\n    var dAngle = dAngleVPt2 - dAngleVPt1;\n\n    //if (dAngle > 180.0)\n    //{\n    //    dAngle = 360.0 - dAngle;\n    //}\n\n    return dAngle;\n};\n\nleafLet.utils.getArcCoordinates = function(oMap, oCenter, dRadius, dStartAzimuth, dEndAzimuth, bClockwise) {\n    var oLatLngList = [];\n    var oNewPt;\n    var dNewAngleDelta;\n    var dAngleInc;\n    var oPt1 = oCenter.destinationPoint(dStartAzimuth, dRadius);\n    var oPt2 = oCenter.destinationPoint(dEndAzimuth, dRadius);\n    var oPoint1 = oMap.latLngToContainerPoint(oPt1);\n    var oPoint2 = oMap.latLngToContainerPoint(oPt2);\n    var dAngleVPt1Pt2 = Math.abs(dEndAzimuth - dStartAzimuth);\n    var dPointDist = Math.round(oPoint1.distanceTo(oPoint2));\n\n    if (bClockwise && (dEndAzimuth < dStartAzimuth)) {\n        dAngleVPt1Pt2 = 360 - dAngleVPt1Pt2;\n    } else if (!bClockwise && (dStartAzimuth < dEndAzimuth)) {\n        dAngleVPt1Pt2 = 360 - dAngleVPt1Pt2;\n    }\n\n    if (!bClockwise) {\n        dAngleVPt1Pt2 *= -1.0;\n    }\n\n    dAngleInc = dAngleVPt1Pt2 / dPointDist;\n\n    oLatLngList.push(oPt1);\n\n    // Now make the semi-circle arounf Pt2.\n    for (var iIndex = 0, dNewAngleDelta = dAngleInc;\n            iIndex < dPointDist;\n            iIndex++) {\n        oNewPt = oCenter.destinationPoint((dStartAzimuth + dNewAngleDelta + 360) % 360, dRadius);\n        oLatLngList.push(oNewPt);\n        dNewAngleDelta += dAngleInc;\n    }\n\n    oLatLngList.push(oPt2);\n\n    return oLatLngList;\n};\n\nleafLet.utils.geoColorToHexColorString = function(geoColor) {\n    var sColor;\n\n    sColor = ('00' + geoColor.red.toString(16)).substr(-2);\n    sColor += ('00' + geoColor.green.toString(16)).substr(-2);\n    sColor += ('00' + geoColor.blue.toString(16)).substr(-2);\n\n    return sColor;\n}\n","\n/* global leafLet, L, emp */\n\nleafLet.utils = leafLet.utils || {};\n\nleafLet.utils.geoJson = (function () {\n\n    var privateInterface = {\n    };\n\n    var publicInterface = {\n        convertCoordinatesToString: function (oGeoJson) {\n            var sStr = \"\";\n            if (!oGeoJson.hasOwnProperty('type')) {\n                throw new Error(\"GeoJSON object with no type property.\");\n            }\n\n            switch (oGeoJson.type.toLowerCase()) {\n                case 'point':\n                    sStr = oGeoJson.coordinates[0] + \",\" + oGeoJson.coordinates[1];\n\n                    if (oGeoJson.coordinates.length === 3) {\n                        sStr += \",\" + oGeoJson.coordinates[2];\n                    }\n                    break;\n                case 'linestring':\n                    for (var iIndex = 0; iIndex < oGeoJson.coordinates.length; iIndex++) {\n                        if (sStr.length > 0) {\n                            sStr += \" \";\n                        }\n                        sStr += oGeoJson.coordinates[iIndex][0] + \",\" + oGeoJson.coordinates[iIndex][1];\n\n                        if (oGeoJson.coordinates[iIndex].length === 3) {\n                            sStr += \",\" + oGeoJson.coordinates[iIndex][2];\n                        }\n                    }\n                    break;\n                case 'polygon':\n                    // we get the coordinates of the outter polygon.\n                    for (var iIndex = 0; iIndex < oGeoJson.coordinates[0].length; iIndex++) {\n                        if (sStr.length > 0) {\n                            sStr += \" \";\n                        }\n                        sStr += oGeoJson.coordinates[0][iIndex][0] + \",\" + oGeoJson.coordinates[0][iIndex][1];\n\n                        if (oGeoJson.coordinates[0][iIndex].length === 3) {\n                            sStr += \",\" + oGeoJson.coordinates[0][iIndex][2];\n                        }\n                    }\n                    break;\n                default:\n                    throw new Error(\"Invalid type for coordinate parsing.\");\n            }\n\n            return sStr;\n        },\n        convertCoordinateToLatLng: function (oCoord) {\n            var oCoordinates;\n\n            if (oCoord.length === 3) {\n                oCoordinates = new L.LatLng(oCoord[1], oCoord[0], oCoord[2]);\n            } else {\n                oCoordinates = new L.LatLng(oCoord[1], oCoord[0]);\n            }\n\n            return oCoordinates;\n        },\n        convertCoordinatesToLatLng: function (oGeoJson) {\n            var oCoordinates = [];\n            var oCoord;\n\n            if (!oGeoJson.hasOwnProperty('type')) {\n                throw new Error(\"GeoJSON object with no type property.\");\n            }\n\n            switch (oGeoJson.type.toLowerCase()) {\n                case 'point':\n                    if (oGeoJson.coordinates.length > 0) {\n                        oCoordinates.push(publicInterface.convertCoordinateToLatLng(oGeoJson.coordinates));\n                    }\n                    break;\n                case 'linestring':\n                    for (var iIndex = 0; iIndex < oGeoJson.coordinates.length; iIndex++) {\n                        oCoord = publicInterface.convertCoordinateToLatLng(oGeoJson.coordinates[iIndex]);\n                        oCoordinates.push(oCoord);\n                    }\n                    break;\n                case 'polygon':\n                    // we get the coordinates of the outter polygon.\n                    for (var iIndex = 0; iIndex < oGeoJson.coordinates[0].length; iIndex++) {\n                        oCoord = publicInterface.convertCoordinateToLatLng(oGeoJson.coordinates[0][iIndex]);\n                        oCoordinates.push(oCoord);\n                    }\n                    break;\n                case 'feature':\n                    switch (oGeoJson.geometry.type.toLowerCase()) {\n                        case 'point':\n                            if (oGeoJson.geometry.coordinates.length > 0) {\n                                oCoordinates.push(publicInterface.convertCoordinateToLatLng(oGeoJson.geometry.coordinates));\n                            }\n                            break;\n                        case 'linestring':\n                            for (var iIndex = 0; iIndex < oGeoJson.geometry.coordinates.length; iIndex++) {\n                                oCoord = publicInterface.convertCoordinateToLatLng(oGeoJson.geometry.coordinates[iIndex]);\n                                oCoordinates.push(oCoord);\n                            }\n                            break;\n                        case 'polygon':\n                            // we get the coordinates of the outter polygon.\n                            for (var iIndex = 0; iIndex < oGeoJson.geometry.coordinates[0].length; iIndex++) {\n                                oCoord = publicInterface.convertCoordinateToLatLng(oGeoJson.geometry.coordinates[0][iIndex]);\n                                oCoordinates.push(oCoord);\n                            }\n                            break;\n                        default:\n                            throw new Error(\"Invalid type for coordinate parsing.\");\n                    }\n                    break;\n                default:\n                    throw new Error(\"Invalid type for coordinate parsing.\");\n            }\n\n            return oCoordinates;\n        },\n        convertLatLngToGeoJson: function (oLatLng) {\n            var oGeoJsonCoord = [];\n\n            oGeoJsonCoord.push(oLatLng.lng);\n            oGeoJsonCoord.push(oLatLng.lat);\n\n            if (!isNaN(oLatLng.alt)) {\n                oGeoJsonCoord.push(oLatLng.alt);\n            }\n\n            return oGeoJsonCoord;\n        },\n        convertLatLngListToGeoJson: function (oGeoJson, oLatLngList) {\n            switch (oGeoJson.type.toLowerCase()) {\n                case 'point':\n                    oGeoJson.coordinates = publicInterface.convertLatLngToGeoJson(oLatLngList[0]);\n                    break;\n                case 'linestring':\n                    oGeoJson.coordinates = [];\n\n                    for (var iIndex = 0; iIndex < oLatLngList.length; iIndex++) {\n                        oGeoJson.coordinates.push(publicInterface.convertLatLngToGeoJson(oLatLngList[iIndex]));\n                    }\n                    break;\n                case 'polygon':\n                    oGeoJson.coordinates = [[]];\n\n                    for (var iIndex = 0; iIndex < oLatLngList.length; iIndex++) {\n                        oGeoJson.coordinates[0].push(publicInterface.convertLatLngToGeoJson(oLatLngList[iIndex]));\n                    }\n                    break;\n                case 'feature':\n                    publicInterface.convertLatLngListToGeoJson(oGeoJson.geometry, oLatLngList);\n                    break;\n            }\n        },\n        mergeGeoJSONProperties: function (instanceInterface, oFeatureProperties, oGeoJSONProperties) {\n            var oDefaultIcon = emp.utilities.icon.getDefaultIcon();\n            var oProperties = {};\n            var iXOffset = oDefaultIcon.offset.x;\n            var iYOffset = oDefaultIcon.offset.y;\n            var sXUnits = oDefaultIcon.offset.xUnits;\n            var sYUnits = oDefaultIcon.offset.yUnits;\n            var sDefaultIconUrl = oDefaultIcon.iconUrl;\n            var sURL = (instanceInterface.bUseProxy ?\n                    instanceInterface.getProxyURL() + \"?\" + \"mime=image/*&url=\" + escape(sDefaultIconUrl) : sDefaultIconUrl);\n\n            if (oGeoJSONProperties) {\n                if (oGeoJSONProperties.hasOwnProperty('id')) {\n                    oProperties.sSubItemID = oGeoJSONProperties.id;\n                }\n                if (oGeoJSONProperties.hasOwnProperty('lineColor')) {\n                    oProperties.color = '#' + oGeoJSONProperties.lineColor.substr(2);\n                    var dOpacity = parseInt(\"0x\" + oGeoJSONProperties.lineColor.substr(0, 2)) / 255.0;\n                    oProperties.opacity = dOpacity;\n                }\n                if (oGeoJSONProperties.hasOwnProperty('fillColor')) {\n                    oProperties.fillColor = '#' + oGeoJSONProperties.fillColor.substr(2);\n                    var dOpacity = parseInt(\"0x\" + oGeoJSONProperties.fillColor.substr(0, 2)) / 255.0;\n                    oProperties.fillOpacity = dOpacity;\n                }\n                if (oGeoJSONProperties.hasOwnProperty('lineWidth')) {\n                    oProperties.weigh = parseInt(oGeoJSONProperties.lineWidth);\n                }\n                if (oGeoJSONProperties.hasOwnProperty('iconUrl')) {\n                    sURL = (this.options.instanceInterface.bUseProxy ?\n                            this.options.instanceInterface.getProxyURL() + \"?\" + \"mime=image/*&url=\" + escape(oGeoJSONProperties.iconUrl) :\n                            oGeoJSONProperties.iconUrl);\n                }\n\n                if (oGeoJSONProperties.hasOwnProperty('iconXOffset')) {\n                    iXOffset = oGeoJSONProperties.iconXOffset;\n                }\n\n                if (oGeoJSONProperties.hasOwnProperty('iconYOffset')) {\n                    iYOffset = oGeoJSONProperties.iconYOffset;\n                }\n\n                if (oGeoJSONProperties.hasOwnProperty('xUnits')) {\n                    sXUnits = oGeoJSONProperties.xUnits;\n                }\n\n                if (oGeoJSONProperties.hasOwnProperty('yUnits')) {\n                    sYUnits = oGeoJSONProperties.yUnits;\n                }\n            }\n\n            if (oFeatureProperties) {\n                if (oFeatureProperties.hasOwnProperty('lineColor')) {\n                    oProperties.color = '#' + oFeatureProperties.lineColor.substr(2);\n                    var dOpacity = parseInt(\"0x\" + oFeatureProperties.lineColor.substr(0, 2)) / 255.0;\n                    oProperties.opacity = dOpacity;\n                }\n                if (oFeatureProperties.hasOwnProperty('fillColor')) {\n                    oProperties.fillColor = '#' + oFeatureProperties.fillColor.substr(2);\n                    var dOpacity = parseInt(\"0x\" + oFeatureProperties.fillColor.substr(0, 2)) / 255.0;\n                    oProperties.fillOpacity = dOpacity;\n                }\n                if (oFeatureProperties.hasOwnProperty('lineWidth')) {\n                    oProperties.weight = parseInt(oFeatureProperties.lineWidth);\n                }\n                if (oFeatureProperties.hasOwnProperty('iconUrl')) {\n                    sURL = (this.options.instanceInterface.bUseProxy ?\n                            this.options.instanceInterface.getProxyURL() + \"?\" + \"mime=image/*&url=\" + escape(oFeatureProperties.iconUrl) :\n                            oFeatureProperties.iconUrl);\n                }\n\n                if (oFeatureProperties.hasOwnProperty('iconXOffset')) {\n                    iXOffset = oFeatureProperties.iconXOffset;\n                }\n\n                if (oFeatureProperties.hasOwnProperty('iconYOffset')) {\n                    iYOffset = oFeatureProperties.iconYOffset;\n                }\n\n                if (oFeatureProperties.hasOwnProperty('xUnits')) {\n                    sXUnits = oFeatureProperties.xUnits;\n                }\n\n                if (oFeatureProperties.hasOwnProperty('yUnits')) {\n                    sYUnits = oFeatureProperties.yUnits;\n                }\n            }\n\n            oProperties.iconOptions = {\n                iconUrl: sURL,\n                iconAnchor: new L.Point(iXOffset, iYOffset),\n                iconAnchorType: {x: sXUnits, y: sYUnits}\n            };\n\n            return oProperties;\n        },\n        getGeometryType: function (oGeoJson) {\n            var sType;\n\n            switch (oGeoJson.type.toLowerCase()) {\n                case 'point':\n                    sType = 'Point';\n                    break;\n                case 'linestring':\n                    sType = 'LineString';\n                    break;\n                case 'polygon':\n                    sType = 'Polygon';\n                    break;\n                case 'feature':\n                    sType = publicInterface.getGeometryType(oGeoJson.geometry);\n                    break;\n                default:\n                    sType = oGeoJson.type;\n                    break;\n            }\n\n            return sType;\n        },\n        isAOI: function (oItem) {\n            var bRet = false;\n            var oGeoJson = oItem.data;\n\n            if (oGeoJson.hasOwnProperty('type') &&\n                    (oGeoJson.type.toLowerCase() === 'feature')) {\n                if (oGeoJson.hasOwnProperty('properties') &&\n                        oGeoJson.properties.hasOwnProperty('aoi')) {\n                    bRet = true;\n                }\n            }\n            return bRet;\n        }\n    };\n\n    return publicInterface;\n}());\n","/* global leafLet, L, emp, armyc2, sec */\n\nleafLet.utils = leafLet.utils || {};\n\nleafLet.utils.milstd = (function() {\n    var privateInterface = {\n        getAutoWidth: function(oMap) {\n            var oBounds = oMap.getBounds();\n            var dCenterLat = (oBounds.getNorth() - oBounds.getSouth()) / 2.0;\n            var oCenterWest = new L.LatLng(dCenterLat, leafLet.utils.normilizeLongitude(oBounds.getWest()));\n            var oCenterEast = new L.LatLng(dCenterLat, leafLet.utils.normilizeLongitude(oBounds.getEast()));\n            return Math.round(oCenterWest.distanceTo(oCenterEast) / 32.0);\n        },\n        checkModifier: function(sBasicSymbol, sModifier, oModifiers, i2525Version, oMap) {\n            var sBaseModifier;\n            var sDigit;\n            var iDigit;\n            var oTGModifiers = armyc2.c2sd.renderer.utilities.ModifiersTG;\n            var oBasicCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            sBaseModifier = sModifier;\n            sDigit = \"0\";\n\n            // See if the modifier has a digit or a # sign.\n            if (leafLet.utils.isInt(sBaseModifier.charAt(sBaseModifier.length - 1))\n            || (sBaseModifier.charAt(sBaseModifier.length - 1) === '#')) {\n                sDigit = sBaseModifier.substr(sBaseModifier.length - 1);\n                sBaseModifier = sBaseModifier.substr(0, sBaseModifier.length - 1);\n            }\n\n            iDigit = parseInt(sDigit, 10);\n            if (isNaN(iDigit)) {\n                iDigit = 0;\n            }\n\n            if (oModifiers[sBaseModifier] === undefined) {\n                // This modifier is not present.\n                switch (sBaseModifier) {\n                case oTGModifiers.T_UNIQUE_DESIGNATION_1:\n                    oModifiers[sModifier] = \"\";\n                    break;\n                case oTGModifiers.AM_DISTANCE:\n                    oModifiers[sBaseModifier] = [];\n                    break;\n                case oTGModifiers.AN_AZIMUTH:\n                    oModifiers[sBaseModifier] = [];\n                    break;\n                case oTGModifiers.S_OFFSET_INDICATOR:\n                    oModifiers[sModifier] = \"\";\n                    break;\n                case oTGModifiers.V_EQUIP_TYPE:\n                    oModifiers[sModifier] = \"\";\n                    break;\n                case oTGModifiers.W_DTG_1:\n                    oModifiers[sModifier] = \"\";\n                    break;\n                case oTGModifiers.H_ADDITIONAL_INFO_1:\n                    if ((sDigit === '2') && (i2525Version === 0)) {\n                        switch (sBasicSymbol) {\n                        case oBasicCodes.AIR_CORRIDOR:\n                        case oBasicCodes.MINIMUM_RISK_ROUTE:\n                        case oBasicCodes.STANDARD_ARMY_AIRCRAFT_FLIGHT_ROUTE:\n                        case oBasicCodes.UBMANNED_AERIAL_VEHICLE_ROUTE:\n                        case oBasicCodes.LOW_LEVEL_TRANSIT_ROUTE:\n                            if (oModifiers[oTGModifiers.AM_DISTANCE] === undefined) {\n                                oModifiers[sModifier] = privateInterface.getAutoWidth(oMap);\n                            } else if (oModifiers[oTGModifiers.AM_DISTANCE].length === 0) {\n                                oModifiers[oTGModifiers.AM_DISTANCE].push(privateInterface.getAutoWidth(oMap));\n                            }\n                            break;\n                        default:\n                            break;\n                        }\n                    } else {\n                        oModifiers[sModifier] = \"\";\n                    }\n                    break;\n                case oTGModifiers.X_ALTITUDE_DEPTH:\n                    oModifiers[sBaseModifier] = [];\n                    break;\n                }\n            } else {\n                // If we reach here the modifier has been provided, and if its an AM, AN, or X.\n                // We need to make sure that its an array.\n                switch (sBaseModifier) {\n                case oTGModifiers.AM_DISTANCE:\n                case oTGModifiers.AN_AZIMUTH:\n                case oTGModifiers.X_ALTITUDE_DEPTH:\n                    if (!(oModifiers[sBaseModifier] instanceof Array)) {\n                        if (oModifiers[sBaseModifier] === undefined) {\n                            oModifiers[sBaseModifier] = [];\n                        } else {\n                            var Value = oModifiers[sBaseModifier];\n                            oModifiers[sBaseModifier] = [Value];\n                            //oModifiers[sBaseModifier].splice(iDigit, 0, Value);\n                        }\n                    }\n                    break;\n                }\n            }\n\n            if (oModifiers[sBaseModifier] instanceof Array) {\n                switch (sBaseModifier) {\n                case oTGModifiers.AM_DISTANCE:\n                    var dValue;\n                    var dBaseValue;\n                    switch (sBasicSymbol) {\n                    case oBasicCodes.AIR_CORRIDOR:\n                    case oBasicCodes.MINIMUM_RISK_ROUTE:\n                    case oBasicCodes.STANDARD_ARMY_AIRCRAFT_FLIGHT_ROUTE:\n                    case oBasicCodes.UBMANNED_AERIAL_VEHICLE_ROUTE:\n                    case oBasicCodes.LOW_LEVEL_TRANSIT_ROUTE:\n                        if (oModifiers[oTGModifiers.AM_DISTANCE] === undefined) {\n                            oModifiers[sModifier] = privateInterface.getAutoWidth(oMap);\n                        } else if (oModifiers[oTGModifiers.AM_DISTANCE].length === 0) {\n                            oModifiers[oTGModifiers.AM_DISTANCE].push(privateInterface.getAutoWidth(oMap));\n                        }\n                        break;\n                    case oBasicCodes.CIRCULAR_RANGE_FAN:\n                    case oBasicCodes.SECTOR_RANGE_FAN:\n                    default:\n                        dBaseValue = 5000.0;\n                        if (sDigit.indexOf('#') !== -1) {\n                            if (oModifiers[sBaseModifier].length === 0) {\n                                oModifiers[sBaseModifier].push(dBaseValue);\n                            }\n                        } else if (oModifiers[sBaseModifier][iDigit] === undefined) {\n                            oModifiers[sBaseModifier].splice(iDigit, 0, dBaseValue * (iDigit + 1));\n                        }\n                        break;\n                    }\n                    break;\n                case oTGModifiers.AN_AZIMUTH:\n                    switch (sBasicSymbol) {\n                    case oBasicCodes.SECTOR_RANGE_FAN:\n                        if (sDigit.indexOf('#') !== -1) {\n                            for (var iIndex = 0; iIndex < 2; iIndex++) {\n                                if (iIndex >= oModifiers[sBaseModifier].length) {\n                                    // Only add the value if it does not contain one..\n                                    oModifiers[sBaseModifier].splice(iIndex, 0, (((iIndex % 2) === 0)? 315.0: 45));\n                                }\n                            }\n                        } else if (oModifiers[sBaseModifier][iDigit] === undefined) {\n                            oModifiers[sBaseModifier].splice(iDigit, 0, (((iDigit % 2) === 0)? 315.0: 45));\n                        }\n                        break;\n                    default:\n                        if (sDigit.indexOf('#') !== -1) {\n                            if (oModifiers[sBaseModifier].length === 0) {\n                                // Only add the value if it does not contain one..\n                                oModifiers[sBaseModifier].splice(0, 0, 0);\n                            }\n                        } else if (oModifiers[sBaseModifier][iDigit] === undefined) {\n                            oModifiers[sBaseModifier].splice(iDigit, 0, 0);\n                        }\n                        break;\n                    }\n                    break;\n                case oTGModifiers.X_ALTITUDE_DEPTH:\n                    break;\n                }\n            }\n        },\n        createMilStdEditor: function(oPrivateInterface, oTransaction, oFeature, oEmpItem,  sBasicSymbolCode, oSymbolDef, i2525Version) {\n            var oEditor = undefined;\n            var isMultiPoint = armyc2.c2sd.renderer.utilities.SymbolUtilities.isMultiPoint(sBasicSymbolCode, i2525Version);\n            var oSymbolDefTable = armyc2.c2sd.renderer.utilities.SymbolDefTable;\n            var oParameters = {\n                transaction: oTransaction,\n                EmpDrawEditItem: oEmpItem,\n                feature: oFeature,\n                instanceInterface: oPrivateInterface,\n                basicSymbolCode: sBasicSymbolCode,\n                SymbolDef: oSymbolDef,\n                multiPoint: isMultiPoint\n            };\n\n            if (!isMultiPoint) {\n                oEditor = new leafLet.editor.MilStdSinglePoint(oParameters);\n            } else switch (oSymbolDef.drawCategory) {\n                /**\n                * A polyline, a line with n number of points.\n                * 0 control points\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_LINE:\n                /**\n                * A polyline with n points (entered in reverse order)\n                * 0 control points\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_ARROW:\n                    oEditor = new leafLet.editor.MilStdDCLine(oParameters);\n                    break;\n                /**\n                * An animated shape, uses the animate function to draw.\n                * 0 control points (every point shapes symbol)\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_AUTOSHAPE:\n                    oEditor = new leafLet.editor.MilStdDCAutoShape(oParameters);\n                    break;\n                /**\n                * An enclosed polygon with n points\n                * 0 control points\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_POLYGON:\n                    oEditor = new leafLet.editor.MilStdDCPolygon(oParameters);\n                    break;\n                /**\n                * A graphic with n points whose last point defines the width of the graphic.\n                * 1 control point\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_ROUTE:\n                    oEditor = new leafLet.editor.MilStdDCRoute(oParameters);\n                    break;\n                /**\n                * A line defined only by 2 points, and cannot have more.\n                * 0 control points\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_TWOPOINTLINE:\n                /**\n                * A polyline with 2 points (entered in reverse order).\n                * 0 control points\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_TWOPOINTARROW:\n                    oEditor = new leafLet.editor.MilStdDC2PointLine(oParameters);\n                    break;\n                /**\n                * Shape is defined by a single point\n                * 0 control points\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_POINT:\n                    oEditor = new leafLet.editor.MilStdSinglePoint(oParameters);\n                    break;\n                /**\n                * An animated shape, uses the animate function to draw. Super Autoshape draw\n                * in 2 phases, usually one to define length, and one to define width.\n                * 0 control points (every point shapes symbol)\n                *\n                */\n                case oSymbolDefTable.DRAW_CATEGORY_SUPERAUTOSHAPE:\n                    oEditor = new leafLet.editor.MilStdDCSuperAutoShape(oParameters);\n                    break;\n                /**\n                 * Circle that requires 1 AM modifier value.\n                 * See ModifiersTG.js for modifier descriptions and constant key strings.\n                 */\n                case oSymbolDefTable.DRAW_CATEGORY_CIRCULAR_PARAMETERED_AUTOSHAPE:\n                    oEditor = new leafLet.editor.MilStdDCCircularAutoShape(oParameters);\n                    break;\n                /**\n                 * Rectangle that requires 2 AM modifier values and 1 AN value.\";\n                 * See ModifiersTG.js for modifier descriptions and constant key strings.\n                 */\n                case oSymbolDefTable.DRAW_CATEGORY_RECTANGULAR_PARAMETERED_AUTOSHAPE:\n                    oEditor = new leafLet.editor.MilStdDCRectParamAutoShape(oParameters);\n                    break;\n                /**\n                 * Requires 2 AM values and 2 AN values per sector.\n                 * The first sector can have just one AM value although it is recommended\n                 * to always use 2 values for each sector.  X values are not required\n                 * as our rendering is only 2D for the Sector Range Fan symbol.\n                 * See ModifiersTG.js for modifier descriptions and constant key strings.\n                 */\n                case oSymbolDefTable.DRAW_CATEGORY_SECTOR_PARAMETERED_AUTOSHAPE:\n                    oEditor = new leafLet.editor.MilStdDCSectorParamAutoShape(oParameters);\n                    break;\n                /**\n                 *  Requires at least 1 distance/AM value\"\n                 *  See ModifiersTG.js for modifier descriptions and constant key strings.\n                 */\n                case oSymbolDefTable.DRAW_CATEGORY_CIRCULAR_RANGEFAN_AUTOSHAPE:\n                    oEditor = new leafLet.editor.MilStdDCCircularRangeFan(oParameters);\n                    break;\n                /**\n                 * Requires 1 AM value.\n                 * See ModifiersTG.js for modifier descriptions and constant key strings.\n                 */\n                case oSymbolDefTable.DRAW_CATEGORY_TWO_POINT_RECT_PARAMETERED_AUTOSHAPE:\n                    oEditor = new leafLet.editor.MilStdDC2PointRectAutoShape(oParameters);\n                    break;\n                /**\n                 * 3D airspace, not a milstd graphic.\n                 */\n                case oSymbolDefTable.DRAW_CATEGORY_3D_AIRSPACE:\n                    break;\n                }\n\n            return oEditor;\n        }\n    };\n\n    var publicInterface = {\n        areModifierValuesEqual: function(oValue1, oValue2) {\n            if ((oValue1 instanceof Array) !== (oValue2 instanceof Array)) {\n                // One is an array the other is not.\n                return false;\n            } else if (typeof oValue1 !== typeof oValue2) {\n                return false;\n            }\n\n            if (oValue1 instanceof Array) {\n                if (oValue1.length !== oValue2.length) {\n                    // They are diff sizes.\n                    return false;\n                }\n\n                for (var iIndex = 0; iIndex < oValue1.length; iIndex++) {\n                    if (oValue1[iIndex] !== oValue2[iIndex]) {\n                        // Diff value.\n                        return false;\n                    }\n                }\n            } else if (typeof oValue1 === 'object') {\n                var sValue1 = JSON.stringify(oValue1);\n                var sValue2 = JSON.stringify(oValue2);\n\n                if (sValue1 !== sValue2) {\n                    // Diff value.\n                    return false;\n                }\n            } else if (oValue1 !== oValue2) {\n                // Diff value.\n                return false;\n            }\n\n            return true;\n        },\n        getRequiredModifiers: function(sBasicSymbol, i2525Version) {\n            var sReqModifiers = \"\";\n            var oSymbolDef = armyc2.c2sd.renderer.utilities.SymbolDefTable.getSymbolDef(sBasicSymbol, i2525Version);\n            var oSymDefTable = armyc2.c2sd.renderer.utilities.SymbolDefTable;\n            var oBasicCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oSymbolDef !== null) {\n                switch (oSymbolDef.drawCategory) {\n                case oSymDefTable.DRAW_CATEGORY_CIRCULAR_PARAMETERED_AUTOSHAPE:\n                    // Requires 1 AM.\n                    sReqModifiers = \"AM\";\n                    break;\n                case oSymDefTable.DRAW_CATEGORY_RECTANGULAR_PARAMETERED_AUTOSHAPE:\n                    // Requires 2 AM, 1 AN\n                    sReqModifiers = \"AM.AM1.AN\";\n                    break;\n                case oSymDefTable.DRAW_CATEGORY_SECTOR_PARAMETERED_AUTOSHAPE:\n                    // Requires 1 or more AMs, (2 * (the # AM)) ANs\n                    sReqModifiers = \"AM#.AN#\";\n                    break;\n                case oSymDefTable.DRAW_CATEGORY_CIRCULAR_RANGEFAN_AUTOSHAPE:\n                    // Requires 1 - 3 AMs.\n                    sReqModifiers = \"AM.AM1.AM2\";\n                    break;\n                case oSymDefTable.DRAW_CATEGORY_TWO_POINT_RECT_PARAMETERED_AUTOSHAPE:\n                    // Requires 1 AM.\n                    sReqModifiers = \"AM\";\n                    break;\n                }\n\n                switch (sBasicSymbol) {\n                case oBasicCodes.AIR_CORRIDOR:\n                case oBasicCodes.MINIMUM_RISK_ROUTE:\n                case oBasicCodes.STANDARD_ARMY_AIRCRAFT_FLIGHT_ROUTE:\n                case oBasicCodes.UBMANNED_AERIAL_VEHICLE_ROUTE:\n                case oBasicCodes.LOW_LEVEL_TRANSIT_ROUTE:\n                    // Requires 1 AM.\n                    sReqModifiers = \"AM\";\n                    break;\n                default:\n                    break;\n                }\n            }\n\n            return sReqModifiers;\n        },\n        applyRequiredModifiers: function(sSymbolCode, oModifier, i2525Version, oMap) {\n            var sBasicSymbolCode = armyc2.c2sd.renderer.utilities.SymbolUtilities.getBasicSymbolID(sSymbolCode);\n            var sRequiredModifiers = publicInterface.getRequiredModifiers(sBasicSymbolCode, i2525Version);\n\n            if (sRequiredModifiers.length === 0) {\n                return;\n            }\n\n            var oRequiredModifiers = sRequiredModifiers.split(\".\");\n\n            for (var iIndex = 0; iIndex < oRequiredModifiers.length; iIndex++) {\n                if (oRequiredModifiers[iIndex].length === 0) {\n                    continue;\n                }\n                privateInterface.checkModifier(sBasicSymbolCode, oRequiredModifiers[iIndex], oModifier, i2525Version, oMap);\n            }\n        },\n        convertModifiersTo2525: function(args) {\n            var sColor;\n            var oModifiers = {};\n            var oProperties = args.properties || {};\n            var oPropModifiers = oProperties.modifiers || {};\n            var longModifiers = leafLet.utils.milstd.longModifiers;\n            var o2525Modifiers = leafLet.utils.milstd.Modifiers;\n\n            //var modifierOnList = function(sModifier)\n            //{\n            //    return ((args.instanceInterface.oLabelList.indexOf(sModifier) === -1)? false: true);\n            //};\n\n            if (!oPropModifiers.hasOwnProperty(longModifiers.STANDARD) && !oPropModifiers.hasOwnProperty(o2525Modifiers.STANDARD)) {\n                oPropModifiers[longModifiers.STANDARD] = emp.typeLibrary.featureMilStdVersionType.MILSTD_2525B;\n            }\n\n            for (var sModifier in oPropModifiers) {\n                if (!oPropModifiers.hasOwnProperty(sModifier)) {\n                    continue;\n                }\n                var s2525Modifier = leafLet.utils.milstd.stringToModifiers[sModifier] || sModifier;\n                /*\n                                switch (s2525Modifier)\n                                {\n                                    case o2525Modifiers.STANDARD:\n                                    case o2525Modifiers.AZIMUTH:\n                                    case o2525Modifiers.DISTANCE:\n                                    case o2525Modifiers.ALTITUDE_DEPTH:\n                                        break;\n                                    default:\n                                        if (!modifierOnList(s2525Modifier))\n                                        {\n                                            // Its not on the list, jump over it.\n                                            continue;\n                                        }\n                                        break;\n                                }\n                */\n                if (s2525Modifier) {\n                    if ((s2525Modifier === o2525Modifiers.STANDARD) && (typeof (oPropModifiers[sModifier]) === 'string')) {\n                        //oModifiers[sModifier] = oPropModifiers[sModifier];\n                        oModifiers[s2525Modifier] = emp.typeLibrary.featureMilStdVersionType.convertToNumeric(oPropModifiers[sModifier]);\n                    } else {\n                        oModifiers[s2525Modifier] = emp.helpers.copyObject(oPropModifiers[sModifier]);\n                    }\n                } else {\n                    oModifiers[sModifier] = emp.helpers.copyObject(oPropModifiers[sModifier]);\n                }\n            }\n\n            if (!emp.util.isEmptyString(oProperties[longModifiers.LINE_COLOR])) {\n                sColor = oProperties[longModifiers.LINE_COLOR];\n                if (sColor.length > 5) {\n                    sColor = sColor.substr(sColor.length - 6, 6);\n                }\n                oModifiers[longModifiers.LINE_COLOR] = sColor;\n            }\n\n            if (!emp.util.isEmptyString(oProperties[longModifiers.FILL_COLOR])) {\n                sColor = oProperties[longModifiers.FILL_COLOR];\n                if (sColor.length > 5) {\n                    sColor = sColor.substr(sColor.length - 6, 6);\n                }\n                oModifiers[longModifiers.FILL_COLOR] = sColor;\n            }\n\n            return oModifiers;\n        },\n        createEditor: function(oPrivateInterface, oTransaction, oEmpItem, oFeature) {\n            var sSymbolCode;\n            var i2525Version;\n\n            if (oFeature) {\n                var oModifiers = oFeature.getMilStdModifiers();\n                sSymbolCode = oFeature.getData().symbolCode;\n                i2525Version = oModifiers[leafLet.utils.milstd.Modifiers.STANDARD];\n                i2525Version = i2525Version || 0;\n            } else {\n                // Its definitly a draw.\n                var oProperties = oEmpItem.properties;\n                var oModifiers = (oProperties? oProperties.modifiers: undefined);\n                var symStd = (oModifiers? oModifiers[leafLet.utils.milstd.longModifiers.STANDARD]: \"2525b\");\n                i2525Version = emp.typeLibrary.featureMilStdVersionType.convertToNumeric(symStd);\n                sSymbolCode = oEmpItem.symbolCode;\n            }\n\n            var sBasicSymbolCode = armyc2.c2sd.renderer.utilities.SymbolUtilities.getBasicSymbolID(sSymbolCode);\n            var oSymbolDef = armyc2.c2sd.renderer.utilities.SymbolDefTable.getSymbolDef(sBasicSymbolCode, i2525Version);\n\n            return privateInterface.createMilStdEditor(oPrivateInterface, oTransaction, oFeature, oEmpItem, sBasicSymbolCode, oSymbolDef, i2525Version);\n        },\n        renderMPGraphic: function(oArgs) {\n            //oArgs = {instanceInterface, isSelected, sID, sName, sDescription, sSymbolCode, oCoordData, oModifiers, i2525Version, empMapBounds}\n            var iOutputFormat = 2;\n            var oMap = oArgs.instanceInterface.getLeafletMap();\n            var mapBounds = oMap.getBounds();\n            var empMapBounds = oArgs.empMapBounds; // oMap.getBounds();\n            var oRenderer = sec.web.renderer.SECWebRenderer;\n            var sCoordinateStr = leafLet.utils.geoJson.convertCoordinatesToString(oArgs.oCoordData);\n            var iZoom = oMap.getZoom();\n            var dScale = oArgs.instanceInterface.getScale(iZoom);\n            var dMaxLabelScale = oArgs.instanceInterface.dMaxLabelScale;\n            var sBBox = null;\n            var oDimension = oMap.getSize();\n            var cModifiers = leafLet.utils.milstd.longModifiers;\n            var bIsSelected = oArgs.oFeature.isSelected();\n            var oSelectAttributes = oArgs.instanceInterface.selectAttributes;\n            var bIDLInView = empMapBounds.containsIDL();\n            var pointConverter = new leafLet.utils.renderer.PointConverter(oMap, oDimension.x, oDimension.y, mapBounds, empMapBounds);\n            \n            if ((mapBounds.getEast() - mapBounds.getWest()) < 180.0) {\n                sBBox = empMapBounds.getWest() + \",\" + empMapBounds.getSouth() + \",\" + empMapBounds.getEast() + \",\" + empMapBounds.getNorth();\n            }\n            //console.log(\"BBox: \" + sBBox);\n            //console.log(\"    map BBox: \" + mapBounds.getWest() + \",\" + mapBounds.getSouth() + \",\" + mapBounds.getEast() + \",\" + mapBounds.getNorth());\n            //console.log(\"  center lng: \" + oMap.getCenter().lng);\n            //console.log(\"      size x: \" + oDimension.x + \" y:\" + oDimension.y);\n\n            try {\n                var sGeoJsonData = oRenderer.RenderSymbol2D(oArgs.sID, oArgs.sName, oArgs.sDescription, oArgs.sSymbolCode, sCoordinateStr, oDimension.x, oDimension.y, sBBox, oArgs.oModifiers, iOutputFormat, oArgs.i2525Version, undefined, pointConverter);\n                var oGeoJson = JSON.parse(sGeoJsonData);\n/*\n                console.log(\"Call to RenderSymbol2D:\\n\" +\n                        \"Symbol Code: \" + oArgs.sSymbolCode + \"\\n\" +\n                        \"id: \" + oArgs.sID + \"\\n\" +\n                        \"name: \" + oArgs.sName + \"\\n\" +\n                        \"description: \" + oArgs.sDescription + \"\\n\" +\n                        \"coordinates: \" + sCoordinateStr + \"\\n\" +\n                        \"width: \" + oDimension.x + \"\\n\" +\n                        \"height: \" + oDimension.y + \"\\n\" +\n                        \"bbox: \" + sBBox + \"\\n\" +\n                        \"modifiers: \" + JSON.stringify(oArgs.oModifiers) + \"\\n\" +\n                        \"outFormat: \" + iOutputFormat + \"\\n\" +\n                        \"2525 version: \" + oArgs.i2525Version + \"\\n\" +\n                        \"geoJSON returned:\\n\" + sGeoJsonData + \"\\n\"\n                        );\n*/\n                var oLeaftletGeoJSON = new L.GeoJSON(oGeoJson, {\n                    style: function (oGeoJsonfeature) {\n                        var oStyle = {};\n\n                        switch (oGeoJsonfeature.geometry.type) {\n                        case 'Point':\n                            break;\n                        case 'LineString':\n                        case 'MultiLineString':\n                            oStyle.color = oGeoJsonfeature.properties.strokeColor;\n                            oStyle.opacity = oGeoJsonfeature.properties.lineOpacity;\n                            oStyle.weight = oGeoJsonfeature.properties.strokeWidth;\n\n                            if (bIsSelected) {\n                                oStyle.tempColor = oStyle.color;\n                                oStyle.tempWeight = oStyle.weight;\n                                oStyle.color = '#' + oSelectAttributes.color;\n                                oStyle.weight = oSelectAttributes.width;\n                            }\n                            break;\n                        case 'Polygon':\n                        case 'MultiPolygon':\n                            oStyle.color = oGeoJsonfeature.properties.strokeColor;\n                            oStyle.opacity = oGeoJsonfeature.properties.lineOpacity;\n                            oStyle.weight = oGeoJsonfeature.properties.strokeWidth;\n                            oStyle.fillColor = oGeoJsonfeature.properties.fillColor;\n                            oStyle.fillOpacity = oGeoJsonfeature.properties.fillOpacity;\n\n                            if (bIsSelected) {\n                                oStyle.tempColor = oStyle.color;\n                                oStyle.tempWeight = oStyle.weight;\n                                oStyle.color = '#' + oSelectAttributes.color;\n                                oStyle.weight = oSelectAttributes.width;\n                            }\n                            break;\n                        }\n                        oStyle.oFeature = oArgs.oFeature;\n                        return oStyle;\n                    },\n                    pointToLayer: function(oGeoJsonfeature, latlng) {\n                        var sLabelText = ((dScale <= dMaxLabelScale)? oGeoJsonfeature.properties.label: \" \");\n                        var iTextPixelDim = emp.helpers.getStringPixelDimensions(sLabelText,\n                                            oGeoJsonfeature.properties.fontFamily,\n                                            oGeoJsonfeature.properties.fontSize + \"pt\",\n                                            oGeoJsonfeature.properties.fontWeight);\n                        var iXOffset = 0;\n                        var iYOffset = 0;\n                        var myIcon;\n                        var sTextAlignment = 'center';\n                        //var sVerticalAlignment = 'baseline';\n\n                        if (oGeoJsonfeature.properties.hasOwnProperty('labelAlign')) {\n                            sTextAlignment = oGeoJsonfeature.properties.labelAlign.toLowerCase();\n                            switch (sTextAlignment) {\n                            case 'center':\n                                iXOffset = Math.floor(iTextPixelDim.width / 2);\n                                break;\n                            case 'left':\n                                iXOffset = 0;\n                                break;\n                            case 'right':\n                                iXOffset = iTextPixelDim.width;\n                                break;\n                            }\n                        }\n\n                        if (oGeoJsonfeature.properties.hasOwnProperty('labelBaseline')) {\n                            switch (oGeoJsonfeature.properties.labelBaseline) {\n                            case 'alphabetic': // baseline\n                                //sVerticalAlignment = 'baseline';\n                                iYOffset = Math.floor(iTextPixelDim.height * 0.75);\n                                break;\n                            case 'top': // Top\n                                //sVerticalAlignment = 'top';\n                                iYOffset = 0;\n                                break;\n                            case 'middle': // middle\n                                //sVerticalAlignment = 'middle';\n                                iYOffset = Math.floor(iTextPixelDim.height / 2);\n                                break;\n                            case 'bottom': // Bottom\n                                //sVerticalAlignment = 'bottom';\n                                iYOffset = iTextPixelDim.height;\n                                break;\n                            }\n                        }\n\n                        myIcon = new L.DivIcon({\n                            className: \"milstdMPtext\",\n                            html: \"<p \" +\n                            \"style='font-family:\" + oGeoJsonfeature.properties.fontFamily + \"; \" +\n                            \"font-size:\" + oGeoJsonfeature.properties.fontSize + \"pt; \" +\n                            \"line-height: 1.2; \" +\n                            \"white-space: nowrap; \" +\n                            \"font-weight:\" + oGeoJsonfeature.properties.fontWeight + \"; \" +\n                            \"color:\" + oGeoJsonfeature.properties.fontColor + \"; \" +\n//                                    \"text-align:\" + sTextAlignment + \";\" +\n//                                    \"vertical-align:\" + sVerticalAlignment + \";\" +\n                            \"-webkit-transform: rotate(\" + oGeoJsonfeature.properties.angle + \"deg); \" +\n                            \"-moz-transform: rotate(\" + oGeoJsonfeature.properties.angle + \"deg); \" +\n                            \"-o-transform: rotate(\" + oGeoJsonfeature.properties.angle + \"deg); \" +\n                            \"transform: rotate(\" + oGeoJsonfeature.properties.angle + \"deg);'>\" +\n                            sLabelText + \"</p>\",\n                            iconSize: new L.Point(iTextPixelDim.width, iTextPixelDim.height),\n                            iconAnchor: new L.Point(iXOffset, iYOffset)\n                        });\n                        return new L.Marker(latlng, {\n                            icon: myIcon,\n                            oFeature: oArgs.oFeature\n                        });\n                    },\n                    onEachFeature: function (feature, layer) {\n                        //filterCoordinates(layer);\n                    },\n                    coordsToLatLng: function(oCoord) {\n                        var latLng = new L.LatLng(oCoord[1], oCoord[0]);\n                        return latLng;\n                    }\n                });\n\n                if (oLeaftletGeoJSON instanceof L.LayerGroup) {\n                    if (oLeaftletGeoJSON.getLayers().length === 1) {\n                        // The object created is a group but it only has one\n                        // object in it.\n                        // Make that object the object returned.\n                        oLeaftletGeoJSON = oLeaftletGeoJSON.getLayers()[0];\n                    } else if (oLeaftletGeoJSON.getLayers().length === 0) {\n                        // This happens when the graphic bounding box intersects the map\n                        // but there is nonthing to draw in the graphics bounding\n                        // box portion that is visible.\n                        oLeaftletGeoJSON = undefined;\n                    }\n                }\n\n                if (oLeaftletGeoJSON instanceof L.LayerGroup) {\n                    var oNewChildren = [];\n\n                    // If the object is a group make sure we flaten\n                    // all sub groups.\n                    var FlantenGroup = function(oGroup) {\n                        var oChild;\n                        var oChildren = oGroup.getLayers();\n\n                        for (var iIndex = 0; iIndex < oChildren.length; iIndex++) {\n                            oChild = oChildren[iIndex];\n\n                            oGroup.removeLayer(oChild);\n                            if (oChild instanceof L.LayerGroup) {\n                                FlantenGroup(oChild);\n                            } else {\n                                oNewChildren.push(oChild);\n                            }\n                        }\n                    };\n\n                    while(oLeaftletGeoJSON.getLayers().length > 0) {\n                        var oChild = oLeaftletGeoJSON.getLayers()[0];\n\n                        oLeaftletGeoJSON.removeLayer(oChild);\n                        if (oChild instanceof L.LayerGroup) {\n                            FlantenGroup(oChild);\n                        } else {\n                            oNewChildren.push(oChild);\n                        }\n                    }\n\n                    for (var iIndex = 0; iIndex < oNewChildren.length; iIndex++) {\n                        oLeaftletGeoJSON.addLayer(oNewChildren[iIndex]);\n                    }\n                }\n            } catch (Ex) {\n                console.log(\"GeoJSON Error:\\n\" +\n                            \"Symbol Code: \" + oArgs.sSymbolCode + \"\\n\" +\n                            \"id: \" + oArgs.sID + \"\\n\" +\n                            \"name: \" + oArgs.sName + \"\\n\" +\n                            \"description: \" + oArgs.sDescription + \"\\n\" +\n                            \"coordinates: \" + sCoordinateStr + \"\\n\" +\n                            \"width: \" + oDimension.x + \"\\n\" +\n                            \"height: \" + oDimension.y + \"\\n\" +\n                            \"bbox: \" + sBBox + \"\\n\" +\n                            \"modifiers: \" + JSON.stringify(oArgs.oModifiers) + \"\\n\" +\n                            \"outFormat: \" + iOutputFormat + \"\\n\" +\n                            \"2525 version: \" + oArgs.i2525Version + \"\\n\" +\n                            \"geoJSON returned:\\n\" + sGeoJsonData + \"\\n\"\n                           );\n                throw Ex;\n            }\n\n            return oLeaftletGeoJSON;\n        },\n        createTGFromDraw: function(oEnginePrivateInterface, oLeafletMap, oSymbolDef, sBasicSymbolCode, oDrawItem) {\n            var oCoordList = [];\n            var oFeature = undefined;\n            var oSymbolDefTable = armyc2.c2sd.renderer.utilities.SymbolDefTable;\n            var oBasicCodes = leafLet.utils.milstd.basicSymbolCode;\n            var oMapBounds = oLeafletMap.getBounds();\n            var oMapSouthWest = oMapBounds.getSouthWest().wrap();\n            var oMapNorthEast = oMapBounds.getNorthEast().wrap();\n            var oMapCenter = oMapBounds.getCenter();\n            var oMapCenterWest = new L.LatLng(oMapCenter.lat, oMapSouthWest.lng, 0);\n            var oMapCenterEast = new L.LatLng(oMapCenter.lat, oMapNorthEast.lng, 0);\n            var oMapCenterNorth = new L.LatLng(oMapNorthEast.lat, oMapCenter.lng, 0);\n            var oMapCenterSouth = new L.LatLng(oMapSouthWest.lat, oMapCenter.lng, 0);\n            var dViewWidth = oMapCenterWest.distanceTo(oMapCenterEast);\n            var dViewHeight = oMapCenterSouth.distanceTo(oMapCenterNorth);\n            var dQtrWidth = Math.floor(dViewWidth / 4);\n            var d3rdHeight = Math.floor(dViewHeight / 3);\n            var iStdVersion = emp.typeLibrary.featureMilStdVersionType.convertToNumeric();\n            var dBrng;\n            var dBrngInc;\n            var oGeoJsonData = {\n                symbolCode: oDrawItem.symbolCode,\n                type: 'LineString',\n                coordinates: []\n            };\n            var oProperties = emp.helpers.copyObject(oDrawItem.properties);\n            var oModifiers = leafLet.utils.milstd.convertModifiersTo2525(oDrawItem);\n            var o2525Modifiers = leafLet.utils.milstd.Modifiers;\n            var iStdVersion = oModifiers[o2525Modifiers.STANDARD] || 0;\n\n            oProperties.modifiers = oModifiers;\n\n            switch (oSymbolDef.drawCategory) {\n            case oSymbolDefTable.DRAW_CATEGORY_LINE: // A polyline, a line with n number of points.\n            case oSymbolDefTable.DRAW_CATEGORY_ARROW: // A polyline, a line with n number of points.\n                oCoordList.push(oMapCenter.destinationPoint(270.0, dQtrWidth));\n                oCoordList.push(oMapCenter.destinationPoint(90.0, dQtrWidth));\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_AUTOSHAPE: // N points.\n                switch (sBasicSymbolCode) {\n                case oBasicCodes.TASK_ISOLATE:\n                case oBasicCodes.TASK_OCCUPY:\n                case oBasicCodes.TASK_RETIAN:\n                case oBasicCodes.TASK_SECURE:\n                case oBasicCodes.TASK_CORDON_SEARCH:\n                case oBasicCodes.TASK_CORDON_KNOCK:\n                    oCoordList.push(oMapCenter);\n                    oCoordList.push(oMapCenter.destinationPoint(45.0, d3rdHeight));\n                    break;\n                case oBasicCodes.MINIMUM_SAFE_DISTANCE_ZONES:\n                    oCoordList.push(oMapCenter);\n                    oCoordList.push(oMapCenter.destinationPoint(45.0, dQtrWidth / 2.0));\n                    oCoordList.push(oMapCenter.destinationPoint(45.0, dQtrWidth));\n                    oCoordList.push(oMapCenter.destinationPoint(45.0, dQtrWidth * 1.5));\n                    break;\n                default:\n                    dBrng = 240.0;\n                    dBrngInc = 360.0 / oSymbolDef.minPoints;\n                    oCoordList.push(oMapCenter.destinationPoint(dBrng, dQtrWidth));\n                    while (oCoordList.length < oSymbolDef.minPoints) {\n                        dBrng += dBrngInc;\n                        oCoordList.push(oMapCenter.destinationPoint(dBrng, dQtrWidth));\n                    }\n                    break;\n                }\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_POLYGON: // Polygon with N points.\n                dBrng = 240.0;\n                dBrngInc = 360.0 / oSymbolDef.minPoints;\n                oCoordList.push(oMapCenter.destinationPoint(dBrng, dQtrWidth));\n                while (oCoordList.length < oSymbolDef.minPoints) {\n                    dBrng += dBrngInc;\n                    oCoordList.push(oMapCenter.destinationPoint(dBrng, dQtrWidth));\n                }\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_ROUTE: // A graphic with n points whose last point defines the width of the graphic.\n                oCoordList.push(oMapCenter.destinationPoint(270.0, dQtrWidth));\n                oCoordList.push(oMapCenter.destinationPoint(90.0, dQtrWidth));\n                oCoordList.push(oMapCenter.destinationPoint(260.0, dQtrWidth * 0.9));\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_TWOPOINTLINE: // A line defined only by 2 points, and cannot have more.\n            case oSymbolDefTable.DRAW_CATEGORY_TWOPOINTARROW: // A polyline with 2 points (entered in reverse order).\n            case oSymbolDefTable.DRAW_CATEGORY_TWO_POINT_RECT_PARAMETERED_AUTOSHAPE: // 2 points.\n                oCoordList.push(oMapCenter.destinationPoint(270.0, dQtrWidth));\n                oCoordList.push(oMapCenter.destinationPoint(90.0, dQtrWidth));\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_POINT: // Shape is defined by a single point\n            case oSymbolDefTable.DRAW_CATEGORY_CIRCULAR_PARAMETERED_AUTOSHAPE: // 1 point\n            case oSymbolDefTable.DRAW_CATEGORY_RECTANGULAR_PARAMETERED_AUTOSHAPE: // 1 point.\n            case oSymbolDefTable.DRAW_CATEGORY_CIRCULAR_RANGEFAN_AUTOSHAPE: // 1 point.\n                oCoordList.push(oMapCenter);\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_SECTOR_PARAMETERED_AUTOSHAPE: // 1 point.\n                oCoordList.push(oMapCenter.destinationPoint(180.0, d3rdHeight));\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_SUPERAUTOSHAPE: // N Points.\n                switch (sBasicSymbolCode) {\n                case oBasicCodes.CCGM_OFFENCE_SUPPORT_BY_FIRE_POSITION:\n                    dBrng = 315.0;\n                    oCoordList.push(oMapCenter.destinationPoint(315.0,  dQtrWidth));\n                    oCoordList.push(oMapCenter.destinationPoint(225.0, dQtrWidth));\n                    oCoordList.push(oMapCenter.destinationPoint(45.0, dQtrWidth));\n                    oCoordList.push(oMapCenter.destinationPoint(135.0, dQtrWidth));\n                    break;\n                default:\n                    dBrng = 240.0;\n                    dBrngInc = 360.0 / oSymbolDef.minPoints;\n                    oCoordList.push(oMapCenter.destinationPoint(dBrng, dQtrWidth));\n                    while (oCoordList.length < oSymbolDef.minPoints) {\n                        dBrng += dBrngInc;\n                        oCoordList.push(oMapCenter.destinationPoint(dBrng, dQtrWidth));\n                    }\n                    break;\n                }\n                break;\n            }\n\n            if (oCoordList.length === 1) {\n                oGeoJsonData.type = 'Point';\n            }\n\n            leafLet.utils.geoJson.convertLatLngListToGeoJson(oGeoJsonData, oCoordList);\n\n            switch (oSymbolDef.drawCategory) {\n            case oSymbolDefTable.DRAW_CATEGORY_CIRCULAR_PARAMETERED_AUTOSHAPE:\n                // Requires 1 AM.\n                if (!oModifiers.hasOwnProperty(o2525Modifiers.DISTANCE)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [dQtrWidth];\n                } else if (!(oModifiers[o2525Modifiers.DISTANCE] instanceof Array)\n                           && oModifiers[o2525Modifiers.DISTANCE]) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [oModifiers[o2525Modifiers.DISTANCE]];\n                } else if (oModifiers[o2525Modifiers.DISTANCE].length === 0) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [dQtrWidth];\n                }\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_RECTANGULAR_PARAMETERED_AUTOSHAPE:\n                // Requires 2 AM, 1 AN\n                if (!oModifiers.hasOwnProperty(o2525Modifiers.DISTANCE)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [];\n                } else if (!(oModifiers[o2525Modifiers.DISTANCE] instanceof Array)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [];\n                }\n\n                if (oModifiers[o2525Modifiers.DISTANCE].length === 0) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [dQtrWidth, Math.floor(dQtrWidth / 2)];\n                } else if (oModifiers[o2525Modifiers.DISTANCE].length < 2) {\n                    oModifiers[o2525Modifiers.DISTANCE].push(Math.floor(dQtrWidth / 2));\n                }\n\n                if (!oModifiers.hasOwnProperty(o2525Modifiers.AZIMUTH)) {\n                    oModifiers[o2525Modifiers.AZIMUTH] = [];\n                } else if (!(oModifiers[o2525Modifiers.AZIMUTH] instanceof Array)) {\n                    oModifiers[o2525Modifiers.AZIMUTH] = [];\n                }\n\n                if (oModifiers[o2525Modifiers.AZIMUTH].length === 0) {\n                    oModifiers[o2525Modifiers.AZIMUTH] = [0];\n                }\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_SECTOR_PARAMETERED_AUTOSHAPE:\n                // Requires 1 or more AMs, and 2 ANs per AM.\n                if (!oModifiers.hasOwnProperty(o2525Modifiers.DISTANCE)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                } else if (!(oModifiers[o2525Modifiers.DISTANCE] instanceof Array)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                }\n\n                if (!oModifiers.hasOwnProperty(o2525Modifiers.AZIMUTH)) {\n                    oModifiers[o2525Modifiers.AZIMUTH] = [];\n                } else if (!(oModifiers[o2525Modifiers.AZIMUTH] instanceof Array)) {\n                    oModifiers[o2525Modifiers.AZIMUTH] = [];\n                }\n\n                if (oModifiers[o2525Modifiers.AZIMUTH].length === 0) {\n                    oModifiers[o2525Modifiers.AZIMUTH].push(315.0);\n                }\n\n                if (oModifiers[o2525Modifiers.AZIMUTH].length < 2) {\n                    oModifiers[o2525Modifiers.AZIMUTH].push(45.0);\n                }\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_CIRCULAR_RANGEFAN_AUTOSHAPE:\n                // Requires 1 AMs.\n                /*\n                                    if (!oModifiers.hasOwnProperty(o2525Modifiers.DISTANCE))\n                                    {\n                                        oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                                    }\n                                    else if (!(oModifiers[o2525Modifiers.DISTANCE] instanceof Array))\n                                    {\n                                        oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                                    }\n                                    else if (oModifiers[o2525Modifiers.DISTANCE].length < 1)\n                                    {\n                                        oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                                    }\n                */\n                break;\n            case oSymbolDefTable.DRAW_CATEGORY_TWO_POINT_RECT_PARAMETERED_AUTOSHAPE:\n                // Requires 1 AM.\n                if (!oModifiers.hasOwnProperty(o2525Modifiers.DISTANCE)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                } else if (!(oModifiers[o2525Modifiers.DISTANCE] instanceof Array)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                } else if (oModifiers[o2525Modifiers.DISTANCE].length < 1) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [d3rdHeight];\n                }\n                break;\n            }\n\n            switch (sBasicSymbolCode) {\n            case oBasicCodes.AIR_CORRIDOR:\n            case oBasicCodes.MINIMUM_RISK_ROUTE:\n            case oBasicCodes.STANDARD_ARMY_AIRCRAFT_FLIGHT_ROUTE:\n            case oBasicCodes.UBMANNED_AERIAL_VEHICLE_ROUTE:\n            case oBasicCodes.LOW_LEVEL_TRANSIT_ROUTE:\n                // Requires 1 AM.\n                if (!oModifiers.hasOwnProperty(o2525Modifiers.DISTANCE)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [Math.floor(dQtrWidth / 2)];\n                } else if (!(oModifiers[o2525Modifiers.DISTANCE] instanceof Array)) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [Math.floor(dQtrWidth / 2)];\n                } else if (oModifiers[o2525Modifiers.DISTANCE].length < 1) {\n                    oModifiers[o2525Modifiers.DISTANCE] = [Math.floor(dQtrWidth / 2)];\n                }\n                break;\n            default:\n                break;\n            }\n\n            oFeature = new leafLet.typeLibrary.MilStdFeature({\n                item: {\n                    name: oDrawItem.name,\n                    coreId: oDrawItem.coreId,\n                    parentCoreId: oDrawItem.parentCoreId,\n                    visible: true,\n                    featureId: oDrawItem.featureId,\n                    overlayId: oDrawItem.overlayId,\n                    parentId: oDrawItem.parentId,\n                    format: emp.typeLibrary.featureFormatType.MILSTD,\n                    data: oGeoJsonData,\n                    properties: oProperties\n                },\n                instanceInterface: oEnginePrivateInterface\n            });\n\n            return oFeature;\n        }\n    };\n\n    return publicInterface;\n}());\n\nleafLet.utils.milstd.longModifiers = {\n    QUANTITY: \"quantity\",\n    REDUCED_OR_REINFORCED: \"reinforcedOrReduced\",\n    STAFF_COMMENTS: \"staffComments\",\n    ADDITIONAL_INFO_1: \"additionalInfo1\",\n    ADDITIONAL_INFO_2: \"additionalInfo2\",\n    ADDITIONAL_INFO_3: \"additionalInfo3\",\n    EVALUATION_RATING: \"evaluationRating\",\n    COMBAT_EFFECTIVENESS: \"combatEffectiveness\",\n    SIGNATURE_EQUIPMENT: \"signatureEquipment\",\n    HIGHER_FORMATION: \"higherFormation\",\n    HOSTILE: \"hostile\",\n    IFF_SIF: \"iffSif\",\n    DIRECTION_OF_MOVEMENT: \"directionOfMovement\",\n    OFFSET_INDICATOR: \"offsetIndicator\",\n    UNIQUE_DESIGNATOR_1: \"uniqueDesignation1\",\n    UNIQUE_DESIGNATOR_2: \"uniqueDesignation2\",\n    EQUIPMENT_TYPE: \"equipmentType\",\n    DATE_TIME_GROUP: \"dateTimeGroup1\",\n    DATE_TIME_GROUP_2: \"dateTimeGroup2\",\n    ALTITUDE_DEPTH: \"altitudeDepth\",\n    LOCATION: \"location\",\n    SPEED: \"speed\",\n    SPECIAL_C2_HEADQUARTERS: \"specialC2Headquarters\",\n    DISTANCE: \"distance\",\n    AZIMUTH: \"azimuth\",\n    FILL_COLOR: \"fillColor\",\n    LINE_COLOR: \"lineColor\",\n    X_OFFSET: \"xOffset\",\n    X_UNITS: \"xUnits\",\n    Y_OFFSET: \"yOffset\",\n    Y_UNITS: \"yUnits\",\n    SIZE: \"size\",\n    LINE_THICKNESS: \"lineThickness\",\n    HEADING: \"heading\",\n    STANDARD: \"standard\"\n};\n\nleafLet.utils.milstd.Modifiers = {\n    QUANTITY: \"C\",\n    REDUCED_OR_REINFORCED: \"F\",\n    STAFF_COMMENTS: \"G\",\n    ADDITIONAL_INFO_1: \"H\",\n    ADDITIONAL_INFO_2: \"H1\",\n    ADDITIONAL_INFO_3: \"H2\",\n    EVALUATION_RATING: \"J\",\n    COMBAT_EFFECTIVENESS: \"K\",\n    SIGNATURE_EQUIPMENT: \"L\",\n    HIGHER_FORMATION: \"M\",\n    HOSTILE: \"N\",\n    IFF_SIF: \"P\",\n    DIRECTION_OF_MOVEMENT: \"Q\",\n    OFFSET_INDICATOR: \"S\",\n    UNIQUE_DESIGNATOR_1: \"T\",\n    UNIQUE_DESIGNATOR_2: \"T1\",\n    EQUIPMENT_TYPE: \"V\",\n    DATE_TIME_GROUP: \"W\",\n    DATE_TIME_GROUP_2: \"W1\",\n    ALTITUDE_DEPTH: \"X\",\n    LOCATION: \"Y\",\n    SPEED: \"Z\",\n    SPECIAL_C2_HEADQUARTERS: \"AA\",\n    DISTANCE: \"AM\",\n    AZIMUTH: \"AN\",\n    STANDARD: \"SYMSTD\"\n};\n\nleafLet.utils.milstd.stringToModifiers = (function() {\n    var mapping = {};\n    var longModifiers = leafLet.utils.milstd.longModifiers;\n    var s2525Modifiers = leafLet.utils.milstd.Modifiers;\n\n    mapping[longModifiers.QUANTITY] = s2525Modifiers.QUANTITY;\n    mapping[longModifiers.REDUCED_OR_REINFORCED] = s2525Modifiers.REDUCED_OR_REINFORCED;\n    mapping[longModifiers.STAFF_COMMENTS] = s2525Modifiers.STAFF_COMMENTS;\n    mapping[longModifiers.ADDITIONAL_INFO_1] = s2525Modifiers.ADDITIONAL_INFO_1;\n    mapping[longModifiers.ADDITIONAL_INFO_2] = s2525Modifiers.ADDITIONAL_INFO_2;\n    mapping[longModifiers.ADDITIONAL_INFO_3] = s2525Modifiers.ADDITIONAL_INFO_3;\n    mapping[longModifiers.EVALUATION_RATING] = s2525Modifiers.EVALUATION_RATING;\n    mapping[longModifiers.COMBAT_EFFECTIVENESS] = s2525Modifiers.COMBAT_EFFECTIVENESS;\n    mapping[longModifiers.SIGNATURE_EQUIPMENT] = s2525Modifiers.SIGNATURE_EQUIPMENT;\n    mapping[longModifiers.HIGHER_FORMATION] = s2525Modifiers.HIGHER_FORMATION;\n    mapping[longModifiers.HOSTILE] = s2525Modifiers.HOSTILE;\n    mapping[longModifiers.IFF_SIF] = s2525Modifiers.IFF_SIF;\n    mapping[longModifiers.DIRECTION_OF_MOVEMENT] = s2525Modifiers.DIRECTION_OF_MOVEMENT;\n    mapping[longModifiers.OFFSET_INDICATOR] = s2525Modifiers.OFFSET_INDICATOR;\n    mapping[longModifiers.UNIQUE_DESIGNATOR_1] = s2525Modifiers.UNIQUE_DESIGNATOR_1;\n    mapping[longModifiers.UNIQUE_DESIGNATOR_2] = s2525Modifiers.UNIQUE_DESIGNATOR_2;\n    mapping[longModifiers.EQUIPMENT_TYPE] = s2525Modifiers.EQUIPMENT_TYPE;\n    mapping[longModifiers.DATE_TIME_GROUP] = s2525Modifiers.DATE_TIME_GROUP;\n    mapping[longModifiers.DATE_TIME_GROUP_2] = s2525Modifiers.DATE_TIME_GROUP_2;\n    mapping[longModifiers.ALTITUDE_DEPTH] = s2525Modifiers.ALTITUDE_DEPTH;\n    mapping[longModifiers.LOCATION] = s2525Modifiers.LOCATION;\n    mapping[longModifiers.SPEED] = s2525Modifiers.SPEED;\n    mapping[longModifiers.SPECIAL_C2_HEADQUARTERS] = s2525Modifiers.SPECIAL_C2_HEADQUARTERS;\n    mapping[longModifiers.DISTANCE] = s2525Modifiers.DISTANCE;\n    mapping[longModifiers.AZIMUTH] = s2525Modifiers.AZIMUTH;\n    mapping[longModifiers.FILL_COLOR] = longModifiers.FILL_COLOR;\n    mapping[longModifiers.LINE_COLOR] = longModifiers.LINE_COLOR;\n    mapping[longModifiers.X_OFFSET] = longModifiers.X_OFFSET;\n    mapping[longModifiers.X_UNITS] = longModifiers.X_UNITS;\n    mapping[longModifiers.Y_OFFSET] = longModifiers.Y_OFFSET;\n    mapping[longModifiers.Y_UNITS] = longModifiers.Y_UNITS;\n    mapping[longModifiers.SIZE] = longModifiers.SIZE;\n    mapping[longModifiers.LINE_THICKNESS] = longModifiers.LINE_THICKNESS;\n    mapping[longModifiers.HEADING] = s2525Modifiers.DIRECTION_OF_MOVEMENT;\n    mapping[longModifiers.STANDARD] = s2525Modifiers.STANDARD;\n\n    return mapping;\n}());\n\nleafLet.utils.milstd.o2525ModifierToLong = (function() {\n    var mapping = {};\n    var longModifiers = leafLet.utils.milstd.longModifiers;\n    var s2525Modifiers = leafLet.utils.milstd.Modifiers;\n\n    mapping[s2525Modifiers.QUANTITY] = longModifiers.QUANTITY;\n    mapping[s2525Modifiers.REDUCED_OR_REINFORCED] = longModifiers.REDUCED_OR_REINFORCED;\n    mapping[s2525Modifiers.STAFF_COMMENTS] = longModifiers.STAFF_COMMENTS;\n    mapping[s2525Modifiers.ADDITIONAL_INFO_1] = longModifiers.ADDITIONAL_INFO_1;\n    mapping[s2525Modifiers.ADDITIONAL_INFO_2] = longModifiers.ADDITIONAL_INFO_2;\n    mapping[s2525Modifiers.ADDITIONAL_INFO_3] = longModifiers.ADDITIONAL_INFO_3;\n    mapping[s2525Modifiers.EVALUATION_RATING] = longModifiers.EVALUATION_RATING;\n    mapping[s2525Modifiers.COMBAT_EFFECTIVENESS] = longModifiers.COMBAT_EFFECTIVENESS;\n    mapping[s2525Modifiers.SIGNATURE_EQUIPMENT] = longModifiers.SIGNATURE_EQUIPMENT;\n    mapping[s2525Modifiers.HIGHER_FORMATION] = longModifiers.HIGHER_FORMATION;\n    mapping[s2525Modifiers.HOSTILE] = longModifiers.HOSTILE;\n    mapping[s2525Modifiers.IFF_SIF] = longModifiers.IFF_SIF;\n    mapping[s2525Modifiers.DIRECTION_OF_MOVEMENT] = longModifiers.DIRECTION_OF_MOVEMENT;\n    mapping[s2525Modifiers.OFFSET_INDICATOR] = longModifiers.OFFSET_INDICATOR;\n    mapping[s2525Modifiers.UNIQUE_DESIGNATOR_1] = longModifiers.UNIQUE_DESIGNATOR_1;\n    mapping[s2525Modifiers.UNIQUE_DESIGNATOR_2] = longModifiers.UNIQUE_DESIGNATOR_2;\n    mapping[s2525Modifiers.EQUIPMENT_TYPE] = longModifiers.EQUIPMENT_TYPE;\n    mapping[s2525Modifiers.DATE_TIME_GROUP] = longModifiers.DATE_TIME_GROUP;\n    mapping[s2525Modifiers.DATE_TIME_GROUP_2] = longModifiers.DATE_TIME_GROUP_2;\n    mapping[s2525Modifiers.ALTITUDE_DEPTH] = longModifiers.ALTITUDE_DEPTH;\n    mapping[s2525Modifiers.LOCATION] = longModifiers.LOCATION;\n    mapping[s2525Modifiers.SPEED] = longModifiers.SPEED;\n    mapping[s2525Modifiers.SPECIAL_C2_HEADQUARTERS] = longModifiers.SPECIAL_C2_HEADQUARTERS;\n    mapping[s2525Modifiers.DISTANCE] = longModifiers.DISTANCE;\n    mapping[s2525Modifiers.AZIMUTH] = longModifiers.AZIMUTH;\n    mapping[longModifiers.FILL_COLOR] = longModifiers.FILL_COLOR;\n    mapping[longModifiers.LINE_COLOR] = longModifiers.LINE_COLOR;\n    mapping[longModifiers.X_OFFSET] = longModifiers.X_OFFSET;\n    mapping[longModifiers.X_UNITS] = longModifiers.X_UNITS;\n    mapping[longModifiers.Y_OFFSET] = longModifiers.Y_OFFSET;\n    mapping[longModifiers.Y_UNITS] = longModifiers.Y_UNITS;\n    mapping[longModifiers.SIZE] = longModifiers.SIZE;\n    mapping[longModifiers.LINE_THICKNESS] = longModifiers.LINE_THICKNESS;\n    mapping[s2525Modifiers.HEADING] = longModifiers.DIRECTION_OF_MOVEMENT;\n    mapping[s2525Modifiers.STANDARD] = longModifiers.STANDARD;\n\n    return mapping;\n}());\n\nleafLet.utils.milstd.basicSymbolCode = {\n    AIR_CORRIDOR: \"G*G*ALC---****X\",\n    STANDARD_ARMY_AIRCRAFT_FLIGHT_ROUTE: \"G*G*ALS---****X\",\n    MINIMUM_RISK_ROUTE: \"G*G*ALM---****X\",\n    UBMANNED_AERIAL_VEHICLE_ROUTE: \"G*G*ALU---****X\",\n    LOW_LEVEL_TRANSIT_ROUTE: \"G*G*ALL---****X\",\n    AIRSPACE_COORDINATION_AREA_IRREGULAR: \"G*F*ACAI--****X\",\n    AIRSPACE_COORDINATION_AREA_RECTANGULAR: \"G*F*ACAR--****X\",\n    AIRSPACE_COORDINATION_AREA_CIRCULAR: \"G*F*ACAC--****X\",\n    RESTRICTED_OPERATIONS_ZONE: \"G*G*AAR---****X\",\n    HIGH_DENSITY_AIRSPACE_CONTROL_ZONE: \"G*G*AAH---****X\",\n    MISSILE_ENGAGEMENT_ZONE: \"G*G*AAM---****X\",\n    MISSILE_ENGAGEMENT_ZONE_LOW_ALTITUDE: \"G*G*AAML--****X\",\n    MISSILE_ENGAGEMENT_ZONE_HIGH_ALTITUDE: \"G*G*AAMH--****X\",\n\n    CIRCULAR_RANGE_FAN: \"G*F*AXC---****X\",\n    SECTOR_RANGE_FAN: \"G*F*AXS---****X\",\n\n    RECTANGULAR_TARGET: \"G*F*ATR---****X\",\n    CIRCULAR_TARGET: \"G*FPATC---****X\",\n\n    FORD_EASY: \"G*M*BCE---****X\",\n    FORD_DIFFICULT: \"G*M*BCD---****X\",\n\n    ROADBLOCK_COMPLETE_EXECUTED: \"G*M*ORC---****X\",\n    MINIMUM_SAFE_DISTANCE_ZONES: \"G*M*NM----****X\",\n\n    SEIZE: \"G*T*Z-----****X\",\n\n    AMBUSH: \"G*G*SLA---****X\",\n    BLOCK_TASK: \"G*T*B-----****X\",\n    TASK_ISOLATE: \"G*T*E-----****X\",\n    TASK_OCCUPY: \"G*T*O-----****X\",\n    TASK_RETIAN: \"G*T*Q-----****X\",\n    TASK_SECURE: \"G*T*S-----****X\",\n    TASK_CORDON_SEARCH: \"G*T*V-----****X\",\n    TASK_CORDON_KNOCK: \"G*T*2-----****X\",\n\n    CCGM_OFFENCE_SUPPORT_BY_FIRE_POSITION: \"G*G*OAS---****X\",\n\n    BRIDGE_OR_GAP: \"G*M*BCB---****X\",\n    ASSAULT_CROSSING_AREA: \"G*M*BCA---****X\",\n\n    // Only in 2525B\n    FORWARD_AREA_AIR_DEFENSE_ZONE: \"G*G*AAF---****X\",\n    // Same Symbol Code with diff name in 2525C\n    SHORT_RANGE_AIR_DEFENSE_ENGAGEMENT_ZONE: \"G*G*AAF---****X\",\n\n    // Only in 2525B\n    KILL_BOX_PURPLE_CIRCULAR: \"G*F*AKPC--****X\",\n    KILL_BOX_PURPLE_RECTANGULAR: \"G*F*AKPR--****X\",\n    KILL_BOX_PURPLE_IRREGULAR: \"G*F*AKPI--****X\"\n};\n\n\nemp.typeLibrary.featureMilStdVersionType.convertToString = function(iValue) {\n    var sRet = emp.typeLibrary.featureMilStdVersionType.MILSTD_2525B;\n    switch (iValue) {\n    case 0:\n        sRet = emp.typeLibrary.featureMilStdVersionType.MILSTD_2525B;\n        break;\n    case 1:\n        sRet = emp.typeLibrary.featureMilStdVersionType.MILSTD_2525C;\n        break;\n    }\n\n    return sRet;\n};\n","/* global leafLet, L, emp, armyc2, sec */\n\nleafLet.utils = leafLet.utils || {};\n\nleafLet.utils.kml = (function(){\n    var privateInterface = {\n    };\n\n    var publicInterface = {\n        convertCoordinatesToLatLng: function(sKML)\n        {\n            var oLatLngList = [];\n            var oKmlDoc = emp.$(emp.$.parseXML(sKML));\n            var sCoordStr;\n            var bIsPolygon = false;\n\n            emp.$.each(oKmlDoc.find(\"coordinates\"), function(i, oDescElem)\n            {\n                if (sCoordStr === undefined)\n                {\n                    sCoordStr = oDescElem.textContent;\n                }\n            });\n\n            emp.$.each(oKmlDoc.find(\"Polygon\"), function(i, oDescElem)\n            {\n                bIsPolygon = true;\n            });\n            \n            if (sCoordStr)\n            {\n                var aStrCoordList = sCoordStr.split(/\\s+/g);\n                var aCoord;\n                var dLng;\n                var dLat;\n                var dAlt;\n                \n                for (var iIndex = 0; iIndex < aStrCoordList.length; iIndex++)\n                {\n                    if (aStrCoordList[iIndex].length > 0)\n                    {\n                        aCoord = aStrCoordList[iIndex].split(',');\n                        if (aCoord.length > 1)\n                        {\n                            dLng = Number(aCoord[0]);\n                            dLat = Number(aCoord[1]);\n                            dAlt = undefined;\n                            if (aCoord.length > 2)\n                            {\n                                dAlt = Number(aCoord[2]);\n                            }\n                            oLatLngList.push(new L.LatLng(dLat, dLng, dAlt));\n                        }\n                    }\n                }\n                \n                if (bIsPolygon && (oLatLngList.length > 1))\n                {\n                    // we need to remove the last one if there is more than one..\n                    oLatLngList.splice(oLatLngList.length - 1, 1);\n                }\n            }\n            \n            return oLatLngList;\n        },\n        convertLatLngListToKML: function(sKML, oLatLngList)\n        {\n            var bIsPolygon = false;\n            var oKmlDoc = emp.$.parseXML(sKML);\n            var $oKmlDoc = emp.$(oKmlDoc);\n            var sCoordStr = \"\";\n            \n            emp.$.each($oKmlDoc.find(\"Polygon\"), function(i, oDescElem)\n            {\n                bIsPolygon = true;\n            });\n\n            for (var iIndex = 0; iIndex < oLatLngList.length; iIndex++)\n            {\n                if (sCoordStr.length > 0)\n                {\n                    sCoordStr += \" \";\n                }\n                sCoordStr += oLatLngList[iIndex].lng + \",\";\n                sCoordStr += oLatLngList[iIndex].lat;\n                if (!isNaN(oLatLngList[iIndex].alt))\n                {\n                    sCoordStr += \",\" + oLatLngList[iIndex].alt;\n                }\n            }\n            \n            if (bIsPolygon)\n            {\n                // For polygon we need to repeat the first one last.\n                if (sCoordStr.length > 0)\n                {\n                    sCoordStr += \" \";\n                }\n                sCoordStr += oLatLngList[0].lng + \",\";\n                sCoordStr += oLatLngList[0].lat;\n                if (!isNaN(oLatLngList[0].alt))\n                {\n                    sCoordStr += \",\" + oLatLngList[0].alt;\n                }\n            }\n\n            var bDone = false;\n            emp.$.each($oKmlDoc.find(\"coordinates\"), function(i, oDescElem)\n            {\n                if (!bDone)\n                {\n                    oDescElem.textContent = sCoordStr;\n                    bDone = true;\n                }\n            });\n            function getXmlAsString(xmlDom){\n                return (typeof window.XMLSerializer !== \"undefined\") ? (new window.XMLSerializer()).serializeToString(xmlDom):\n                        xmlDom.xml;\n            }\n\n            return getXmlAsString(oKmlDoc); \n        }\n    };\n    \n    return publicInterface;\n}());\n","\n/* global leafLet, L, emp, armyc2, sec */\n\nleafLet.utils = leafLet.utils || {};\n\nleafLet.utils.airspace = (function(){\n    var privateInterface = {\n    };\n\n    var publicInterface = {\n        createAirspace: function(args)\n        {\n            var oAirspace;\n            var cAirspaceType = emp.typeLibrary.airspaceSymbolCode;\n            \n            switch (args.item.data.symbolCode)\n            {\n                case cAirspaceType.SHAPE3D_CYLINDER:\n                    oAirspace = new leafLet.typeLibrary.airspace.Cylinder(args);\n                    break;\n                case cAirspaceType.SHAPE3D_POLYGON:\n                    oAirspace = new leafLet.typeLibrary.airspace.Polygon(args);\n                    break;\n                case cAirspaceType.SHAPE3D_CURTAIN:\n                    oAirspace = new leafLet.typeLibrary.airspace.Curtain(args);\n                    break;\n                case cAirspaceType.SHAPE3D_ORBIT:\n                    oAirspace = new leafLet.typeLibrary.airspace.Orbit(args);\n                    break;\n                case cAirspaceType.SHAPE3D_ROUTE:\n                    oAirspace = new leafLet.typeLibrary.airspace.Route(args);\n                    break;\n                case cAirspaceType.SHAPE3D_TRACK:\n                    oAirspace = new leafLet.typeLibrary.airspace.Track(args);\n                    break;\n                case cAirspaceType.SHAPE3D_RADARC:\n                    oAirspace = new leafLet.typeLibrary.airspace.RadArc(args);\n                    break;\n                case cAirspaceType.SHAPE3D_POLYARC:\n                    oAirspace = new leafLet.typeLibrary.airspace.PolyArc(args);\n                    break;\n                default:\n                    throw new Error(\"Airspace of this type are not yet supported.\");\n            }\n            \n            return oAirspace;\n        },\n        createEditor: function(oInstanceInterface, oTransaction, oEmpItem, oAirspace)\n        {\n            var oEditor;\n            var cAirspaceType = emp.typeLibrary.airspaceSymbolCode;\n            var sSymbolCode = (oAirspace? oAirspace.getData().symbolCode: oEmpItem.symbolCode);\n            var oParameters = {\n                transaction: oTransaction,\n                EmpDrawEditItem: oEmpItem,\n                feature: oAirspace,\n                instanceInterface: oInstanceInterface\n            };\n\n            switch (sSymbolCode)\n            {\n                case cAirspaceType.SHAPE3D_CURTAIN:\n                    oEditor = new leafLet.editor.AirspaceCurtain(oParameters);\n                    break;\n                case cAirspaceType.SHAPE3D_POLYGON:\n                    oEditor = new leafLet.editor.AirspacePolygon(oParameters);\n                    break;\n                case cAirspaceType.SHAPE3D_CYLINDER:\n                    oEditor = new leafLet.editor.AirspaceCylinder(oParameters);\n                    break;\n                case cAirspaceType.SHAPE3D_ORBIT:\n                    oEditor = new leafLet.editor.AirspaceOrbit(oParameters);\n                    break;\n                case cAirspaceType.SHAPE3D_ROUTE:\n                    oEditor = new leafLet.editor.AirspaceRoute(oParameters);\n                    break;\n                case cAirspaceType.SHAPE3D_TRACK:\n                    oEditor = new leafLet.editor.AirspaceTrack(oParameters);\n                    break;\n                case cAirspaceType.SHAPE3D_RADARC:\n                    oEditor = new leafLet.editor.AirspaceRadArc(oParameters);\n                    break;\n                case cAirspaceType.SHAPE3D_POLYARC:\n                    oEditor = new leafLet.editor.AirspacePolyArc(oParameters);\n                    break;\n                default:\n                    throw new Error(\"Airspace Editor for this type is not yet implemented.\");\n            }\n            \n            return oEditor;\n        }\n    };\n    \n    return publicInterface;\n}());\n","/* global L, leafLet, emp, armyc2 */\n\nleafLet.internalPrivateClass.OvalObject = function(){\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var options = {\n                oMap: args.leafletMap,\n                width: args.width,\n                oAttributes: args.attributes,\n                oOvalCoordList: args.coordinates,\n                isSelected: args.isSelected,\n                selectAttributes: args.selectAttributes,\n                oCoordList: [],\n                oPolygonOptions: {},\n                oFeature: args.oFeature\n            };\n            \n            if (!(args.coordinates instanceof Array))\n            {\n                throw new Error(\"Invalid coordinates type. It must be a 2 element array of L.LatLng objects.\");\n            }\n            else if (args.coordinates.length !== 2)\n            {\n                throw new Error(\"Invalid number of elements. It must be a 2 element array of L.LatLng objects.\");\n            }\n            \n            L.Util.setOptions(this, options);\n                \n            this._generatePolygon();\n\n            L.Polygon.prototype.initialize.call(this, this.options.oCoordList, this.options.oPolygonOptions);\n        },\n        isSelected: function()\n        {\n            return this.options.isSelected;\n        },\n        _generatePolygon: function()\n        {\n            var oPartialCoordList;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oAttributes = this.options.oAttributes;\n            var dWidth = this.options.width;\n            var oMap = this.options.oMap;\n            var oPt1 = this.options.oOvalCoordList[0];\n            var oPt2 = this.options.oOvalCoordList[1];\n            var dBearingPt1Pt2 = oPt1.bearingTo(oPt2);\n            var dRadius = dWidth / 2.0;\n            var dLeftBearing = (dBearingPt1Pt2 + 270.0) % 360;\n            var dRightBearing = (dBearingPt1Pt2 + 90.0) % 360;\n            var oCoordList = this.options.oCoordList;\n            var oLineColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_COLOR));\n            var oFillColor = leafLet.utils.convertColor(oAttributes.getValue(cAirspaceAttribute.AIRSPACE_FILL_COLOR));\n            var oPolygonOptions = this.options.oPolygonOptions;\n            \n            oPolygonOptions.stroke = true;\n            oPolygonOptions.color = oLineColor.sColor;\n            oPolygonOptions.opacity = oLineColor.opacity;\n            oPolygonOptions.fill = true;\n            oPolygonOptions.fillColor = oFillColor.sColor;\n            oPolygonOptions.fillOpacity = oFillColor.opacity;\n            oPolygonOptions.weight = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LINE_WIDTH);\n\n            if (this.isSelected())\n            {\n                var oSelectAttributes = this.options.selectAttributes;\n                \n                oPolygonOptions.tempColor = oPolygonOptions.color;\n                oPolygonOptions.tempWeight = oPolygonOptions.weight;\n                \n                oPolygonOptions.color = '#' + oSelectAttributes.color;\n                oPolygonOptions.weight = oSelectAttributes.width;\n            }\n\n            if (oCoordList.length > 0)\n            {\n                // Clear the coordinates.\n                oCoordList.splice(0, oCoordList.length);\n            }\n\n            oPartialCoordList = leafLet.utils.getArcCoordinates(oMap, oPt1, dRadius, dLeftBearing, dRightBearing, false);\n            \n            for  (var iIndex = 0; iIndex < oPartialCoordList.length; iIndex++)\n            {\n                oCoordList.push(oPartialCoordList[iIndex]);\n            }\n\n            oPartialCoordList = leafLet.utils.getArcCoordinates(oMap, oPt2, dRadius, dRightBearing, dLeftBearing, false);\n                \n            for  (var iIndex = 0; iIndex < oPartialCoordList.length; iIndex++)\n            {\n                oCoordList.push(oPartialCoordList[iIndex]);\n            }\n\n//console.log(\"Oval points: \" + oCoordList.length);\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.utils.OvalObject = L.Polygon.extend(leafLet.internalPrivateClass.OvalObject());\n","/* global leafLet, L, emp, armyc2, sec */\n\nleafLet.utils = leafLet.utils || {};\nleafLet.utils.renderer = leafLet.utils.renderer || {};\n\nleafLet.utils.renderer.PointConverter = function(leafletMap, pixelWidth, pixelHeight, mapBounds, empMapBounds) {\n    var privateInterface = {\n        pixelWidth: 0,\n        pixelHeight: 0,\n        mapBounds: undefined,\n        empMapBounds: undefined,\n        normalize: true,\n        leafletMap: undefined,\n        containeIDL: false,\n        rendererPointConverter: function(leafletMap, pixelWidth, pixelHeight, mapBounds, empMapBounds) {\n            privateInterface.leafletMap = leafletMap;\n            privateInterface.pixelWidth = Number(pixelWidth);\n            privateInterface.pixelHeight = Number(pixelHeight);\n            privateInterface.mapBounds = leafletMap.getBounds();\n            privateInterface.empMapBounds = new leafLet.typeLibrary.EmpBoundary(privateInterface.mapBounds);\n            privateInterface.containeIDL = empMapBounds.containsIDL();\n        }\n    };\n\n    var publicInterface = {\n        set_normalize: function(value) {\n            privateInterface.normalize = value;\n        },\n        /*\n        This method translates a pixel x/y postion to a lat/lng coordinate.\n        The Lat/Lng is normalized.\n        */\n        PixelsToGeo: function(pixel) {\n            var leafletPoint = new L.Point(pixel.getX(), pixel.getY());\n            var point2D = new armyc2.c2sd.graphics2d.Point2D();\n            var latlng = privateInterface.leafletMap.containerPointToLatLng(leafletPoint).wrap();\n            \n            //console.log(\"PixeltoGeo: x:\" + pixel.getX() + \" y:\" + pixel.getY() + \" => \" + latlng.lat + \"/\" + latlng.lng);\n            \n            point2D.setLocation(latlng.lng, latlng.lat);\n            \n            return point2D;\n        },\n        /*\n        This method translates a lat/lng coordinate to a pixel x/y position.\n        The lat/lng is normalized then updated based on the map bounding box.\n        The Leaflet map can have a bounding box with an West value < -180 or\n        an East value > 180 when the IDL is in the viewing area.\n        The longitude width of the viewing area is < 180 deg.\n        */\n        GeoToPixels: function(coord) {\n            var point;\n            var inBoundingBox;\n            var tempLng;\n            var coordLatLng = new L.LatLng(coord.y, coord.x);\n            var leafletLatLng = coordLatLng.wrap();\n            var leafletPoint = new L.Point(0,0);\n            var point2D = new armyc2.c2sd.graphics2d.Point2D();\n            \n            //inBoundingBox = privateInterface.empMapBounds.containsCoordiante(leafletLatLng);\n            \n            if (privateInterface.containeIDL) {\n                // The IDL is in the viewing area.\n                // Find the middle of the outside lng degrees.\n                tempLng = (privateInterface.empMapBounds.getWest() - privateInterface.empMapBounds.getEast()) / 2.0;\n                tempLng += privateInterface.empMapBounds.getEast();\n                if (privateInterface.mapBounds.getEast() > 180.0) {\n                    // The IDL is on the right of the map.\n                    if (leafletLatLng.lng < tempLng) {\n                        // The coordinate is on the right side of the globe\n                        leafletLatLng.lng += 360.0;\n                    }\n                } else {\n                    // West < -180\n                    // The IDL is on the left of the map.\n                    if (leafletLatLng.lng > tempLng) {\n                        // The coordinate is on the left side of the globe.\n                        leafletLatLng.lng -= 360.0;\n                    }\n                }\n            } else {\n                // the IDL is NOT in the viewing area.\n                inBoundingBox = privateInterface.empMapBounds.containsCoordiante(leafletLatLng);\n\n                if (!inBoundingBox) {\n                    // The coordinate is NOT in the viewing area.\n                    // We need to find on which side of the globe the coordiante is on.\n                    // Find the half of the outside lng.\n                    tempLng = (privateInterface.empMapBounds.getWest() + 180.0);\n                    tempLng += (180.0 - privateInterface.empMapBounds.getEast());\n                    tempLng = tempLng / 2.0;\n                    \n                    if ((privateInterface.empMapBounds.getWest() - tempLng) >= -180.0) {\n                        tempLng = privateInterface.empMapBounds.getWest() - tempLng;\n                        if (leafletLatLng.lng < tempLng) {\n                            // The coordinate is not in the viewing area and is on the right side of the globe.\n                            leafletLatLng.lng += 360.0;\n                        }\n                    } else {\n                        tempLng = privateInterface.empMapBounds.getEast() + tempLng;\n                        if (leafletLatLng.lng > tempLng) {\n                            // The coordinate is not in the viewing area and is on the left side of the globe.\n                            leafletLatLng.lng -= 360.0;\n                        }\n                    }\n                 }\n            }\n            // Get the pixel coordainte of the lat/lng coordinate.\n            point = privateInterface.leafletMap.latLngToContainerPoint(leafletLatLng);\n            \n            //console.log(\"GeoToPixel IDL:\" + privateInterface.containeIDL + \" InBBox:\" + inBoundingBox + \" Moved:\" + (leafletLatLng.lng != coord.x) + \" lat/Lng:\" + coord.y + \"/\" + coord.x + ((leafletLatLng.lng != coord.x)? \"(\" + leafletLatLng.lat + \"/\" + leafletLatLng.lng + \")\": \"\") + \" =>  x:\" + point.x + \" y:\" + point.y);\n            point2D.setLocation(point.x, point.y);\n            \n            return point2D;\n        }\n    };\n\n    privateInterface.rendererPointConverter(leafletMap, pixelWidth, pixelHeight, mapBounds, empMapBounds);\n    \n    return publicInterface;\n};\n","\n/* global leafLet, L, emp */\nleafLet.ControlPoint = {\n    Type: {\n        NEW_POSITION_CP: 'newCP',\n        POSITION_CP: 'positionCP',\n        ALTITUDE_CP: 'altitudeCP',\n        RADIUS_CP: 'radiusCP',\n        INNER_RADIUS_CP: 'innerRadiusCP',\n        WIDTH_CP: 'widthCP',\n        LEFT_WIDTH_CP: 'leftWidthCP',\n        RIGHT_WIDTH_CP: 'rightWidthCP',\n        RANGE_CP: 'rangeCP',\n        LENGTH_CP: 'lengthCP',\n        AZIMUTH_CP: 'azimuthCP',\n        LEFT_AZIMUTH_CP: 'leftAzimuthCP',\n        RIGHT_AZIMUTH_CP: 'rightAzimuthCP',\n        ATTITUDE_CP: 'attitudeCP',\n        SEGMENT_CP: 'segmentCP',\n        AOI_BUFFER: 'aoiBufferCP'\n    }\n};\n\nleafLet.internalPrivateClass.CPIcon = function()\n{\n    var publicInterface = {\n        statics:{\n            CP_ICON_DEF: {\n                newCP: {\n                    iRadius: 7,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#00FF00\",\n                    sFillColor: \"#55FF55\"\n                },\n                positionCP: {\n                    iRadius: 11,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#0000FF\",\n                    sFillColor: \"#5555FF\"\n                },\n                altitudeCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#FF0000\",\n                    sFillColor: \"#FF5555\"\n                },\n                radiusCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#555555\",\n                    sFillColor: \"#888888\"\n                },\n                innerRadiusCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#555555\",\n                    sFillColor: \"#888888\"\n                },\n                widthCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#000000\",\n                    sFillColor: \"#555555\"\n                },\n                leftWidthCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#000000\",\n                    sFillColor: \"#555555\"\n                },\n                rightWidthCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#000000\",\n                    sFillColor: \"#555555\"\n                },\n                rangeCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#000000\",\n                    sFillColor: \"#555555\"\n                },\n                lengthCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#000000\",\n                    sFillColor: \"#555555\"\n                },\n                azimuthCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#AAAA00\",\n                    sFillColor: \"#AAAA55\"\n                },\n                leftAzimuthCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#AAAA00\",\n                    sFillColor: \"#AAAA55\"\n                },\n                rightAzimuthCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#AAAA00\",\n                    sFillColor: \"#AAAA55\"\n                },\n                attitudeCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#AAAA00\",\n                    sFillColor: \"#AAAA55\"\n                },\n                segmentCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#AAAAFF\",\n                    sFillColor: \"#AAAAFF\"\n                },\n                aoiBufferCP: {\n                    iRadius: 10,\n                    iLineWidth: 1,\n                    dOpacity: 0.7,\n                    sStrokeColor: \"#000000\",\n                    sFillColor: \"#555555\"\n                }\n            }\n        },\n        initialize: function (oArgs)\n        {\n            var oIconDef = leafLet.editor.CPIcon.CP_ICON_DEF[oArgs.cpType];\n            var oImage = emp.helpers.createCircleCanvas(oIconDef);\n\n            var options = {\n                oIconDef: oIconDef,\n                iRadius: oIconDef.iRadius,\n                iIconWidth: oImage.width,\n                iIconHeight: oImage.height\n            };\n            L.Util.setOptions(this, options);\n\n\n            var options = {\n                iconUrl: oImage.toDataURL()\n//                iconSize: new L.Point(oImage.width, oImage.height)\n            };\n            \n            L.Icon.prototype.initialize.call(this, options);\n        },\n        _setIconStyles: function (img, name) {\n            var options = this.options,\n                size = L.point(options[name + 'Size']),\n                anchor;\n\n            if (name === 'shadow') {\n                anchor = L.point(options.shadowAnchor || options.iconAnchor);\n            } else {\n                anchor = L.point(options.iconAnchor);\n            }\n\n            if (!anchor && size) {\n                anchor = size.divideBy(2, true);\n            }\n\n            img.className = 'leaflet-marker-' + name + ' ' + options.className;\n\n            if (anchor) {\n                img.style.marginLeft = (-anchor.x) + 'px';\n                img.style.marginTop  = (-anchor.y) + 'px';\n            }\n\n            if (size) {\n                img.style.width  = size.x + 'px';\n                img.style.height = size.y + 'px';\n            }\n        }\n    };\n    \n    return publicInterface;\n};\nleafLet.editor.CPIcon = L.Icon.extend(leafLet.internalPrivateClass.CPIcon());\n\nleafLet.internalPrivateClass.ControlPoint = function()\n{\n    var publicInterface = {\n        statics:{\n            oCPIcons:{\n                newCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.NEW_POSITION_CP}),\n                positionCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.POSITION_CP}),\n                altitudeCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.ALTITUDE_CP}),\n                radiusCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.RADIUS_CP}),\n                innerRadiusCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.INNER_RADIUS_CP}),\n                widthCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.WIDTH_CP}),\n                leftWidthCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.LEFT_WIDTH_CP}),\n                rightWidthCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.RIGHT_WIDTH_CP}),\n                rangeCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.RANGE_CP}),\n                lengthCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.LENGTH_CP}),\n                azimuthCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.AZIMUTH_CP}),\n                leftAzimuthCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP}),\n                rightAzimuthCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP}),\n                attitudeCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.ATTITUDE_CP}),\n                segmentCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.SEGMENT_CP}),\n                aoiBufferCP: new leafLet.editor.CPIcon({cpType: leafLet.ControlPoint.Type.AOI_BUFFER})\n            }\n        },\n        initialize: function (oFeature, cpType, oPosition, iIndex, iSubIndex, iValue, oIcon) \n        {\n            var options = {\n                oFeature: oFeature,\n                oIcon: oIcon,\n                cpType: cpType,\n                cpIndex: iIndex,\n                cpSubIndex: iSubIndex,\n                cpValue: iValue,\n                cpPopup: undefined,\n                parent: undefined\n            };\n            L.Util.setOptions(this, options);\n            \n            options = {\n                icon: leafLet.editor.ControlPoint.oCPIcons[this.getType()],\n                zIndexOffset: 1000,\n                clickable: true\n            };\n            \n            L.CircleMarker.prototype.initialize.call(this, oPosition, options);\n            this._updateCoordinate();\n        },\n        _updateCoordinate: function()\n        {\n            var oMapBounds = this.getFeature().getLeafletMap().getBounds();\n            var oCoordList = [this.getPosition()];\n\n            if (leafLet.utils.wrapCoordinates(oMapBounds, oCoordList, false))\n            {\n                this.setLatLng(oCoordList[0]);\n            }\n        },\n        getFeature: function()\n        {\n            return this.options.oFeature;\n        },\n        getRadius: function()\n        {\n            return leafLet.editor.CPIcon.CP_ICON_DEF[this.getType()].iRadius;\n        },\n        setParent: function(oParent)\n        {\n            this.options.parent = oParent;\n        },\n        getType: function()\n        {\n            return this.options.cpType;\n        },\n        setType: function(cpType)\n        {\n            this.options.cpType = cpType;\n            this.setIcon(leafLet.editor.ControlPoint.oCPIcons[this.getType()]);\n        },\n        getIndex: function()\n        {\n            return this.options.cpIndex;\n        },\n        setIndex: function(iValue)\n        {\n            this.options.cpIndex = iValue;\n        },\n        getSubIndex: function()\n        {\n            return this.options.cpSubIndex;\n        },\n        setSubIndex: function(iValue)\n        {\n            this.options.cpSubIndex = iValue;\n        },\n        getPosition: function()\n        {\n            return this.getLatLng();\n        },\n        setCPPosition: function(oValue)\n        {\n            this.setLatLng(oValue);\n            this._updateCoordinate();\n            this.bringToFront();\n            if (this.options.cpPopup)\n            {\n                this.options.cpPopup.setContent(this.getPopupText());\n                this.options.cpPopup.setLatLng(this.getPosition());\n            }\n        },\n        getValue: function()\n        {\n            return this.options.cpValue;\n        },\n        setValue: function(Value)\n        {\n            this.options.cpValue = Value;\n        },\n        _getAngleValue: function()\n        {\n            var oFeature = this.options.oFeature;\n            var sValue;\n            \n            switch (oFeature.getAzimuthUnits())\n            {\n                case leafLet.utils.AngleUnits.MILS:\n                    sValue = (this.getValue() * leafLet.utils.MILS_PER_DEGREE).toFixed(1) + \" \" +\n                            leafLet.utils.AngleUnits.MILS;\n                    break;\n                case leafLet.utils.AngleUnits.DEGREES:\n                    sValue = this.getValue().toFixed(2) +\n                            leafLet.utils.AngleUnits.DEGREES;\n                    break;\n            }\n            \n            return sValue;\n        },\n        _getUnitValue: function()\n        {\n            var oFeature = this.options.oFeature;\n            var sValue;\n            \n            switch (oFeature.getUnits())\n            {\n                case leafLet.utils.Units.FEET:\n                    sValue = (this.getValue() * leafLet.utils.FEET_PER_METERS).toFixed(0) + \" \" +\n                            leafLet.utils.Units.FEET;\n                    break;\n                case leafLet.utils.Units.METERS:\n                    sValue = this.getValue().toFixed(0) + \" \" +\n                            leafLet.utils.Units.METERS;\n                    break;\n            }\n            \n            return sValue;\n        },\n        _getAltitudeValue: function(dValue)\n        {\n            var oFeature = this.options.oFeature;\n            var sAltMode = oFeature.getAltitudeModeAbbr();\n            var sValue;\n            \n            if (sAltMode.length > 0)\n            {\n                sAltMode = \" \" + sAltMode;\n            }\n            else\n            {\n                sAltMode = \"\";\n            }\n            \n            switch (oFeature.getAltitudeUnits())\n            {\n                case leafLet.utils.Units.FEET:\n                    sValue = (dValue * leafLet.utils.FEET_PER_METERS).toFixed(0) + \" \" +\n                            leafLet.utils.Units.FEET + sAltMode;\n                    break;\n                case leafLet.utils.Units.METERS:\n                    sValue = dValue.toFixed(0) + \" \" +\n                            leafLet.utils.Units.METERS + sAltMode;\n                    break;\n            }\n            \n            return sValue;\n        },\n        getPopupText: function()\n        {\n            var sPopupText = \"\";\n            var oLatLng = this.getPosition().wrap();\n            \n            switch (this.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    sPopupText = \"<center>Pt \" + (this.options.cpIndex + 1) + \"<br/>\" +\n                            \"Lat:\" + oLatLng.lat.toFixed(5) + \"<br/>Lon:\" + oLatLng.lng.toFixed(5);\n                    \n                    if (!isNaN(oLatLng.alt))\n                    {\n                        sPopupText += \"<br/>Alt:\" + this._getAltitudeValue(oLatLng.alt);\n                    }\n                    \n                    sPopupText += \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.ALTITUDE_CP:\n                    sPopupText = \"<center>Alt: \" + this._getAltitudeValue(this.getValue()) + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.RADIUS_CP:\n                    sPopupText = \"<center>Radius: \" + this._getUnitValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.INNER_RADIUS_CP:\n                    sPopupText = \"<center>Inner Radius: \" + this._getUnitValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.RANGE_CP:\n                    sPopupText = \"<center>Range: \" + this._getUnitValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.WIDTH_CP:\n                    sPopupText = \"<center>Width: \" + this._getUnitValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.LEFT_WIDTH_CP:\n                    sPopupText = \"<center>Left Width: \" + this._getUnitValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.RIGHT_WIDTH_CP:\n                    sPopupText = \"<center>Right Width: \" + this._getUnitValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.LENGTH_CP:\n                    sPopupText = \"<center>Length: \" + this._getUnitValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.AZIMUTH_CP:\n                    sPopupText = \"<center>Azimuth: \" + this._getAngleValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP:\n                    sPopupText = \"<center>Left Azimuth: \" + this._getAngleValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP:\n                    sPopupText = \"<center>Right Azimuth: \" + this._getAngleValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.ATTITUDE_CP:\n                    sPopupText = \"<center>Attitude: \" + this._getAngleValue() + \"</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.SEGMENT_CP:\n                    sPopupText = \"<center>Segment P\" + (this.getIndex() + 1) + \"-P\" + (this.getSubIndex() + 1) + \"<br/>Move</center>\";\n                    break;\n                case leafLet.ControlPoint.Type.AOI_BUFFER:\n                    sPopupText = \"<center>Buffer: \" + this._getUnitValue() + \"</center>\";\n                    break;\n            }\n            \n            return sPopupText;\n        },\n        showPopup: function()\n        {\n            var sPopupText = this.getPopupText();\n            \n            if (this.options.cpPopup === undefined)\n            {\n                var oPopup = new L.Popup({\n                    closeButton: false,\n                    closeOnClick: false,\n                    autoPan: false,\n                    className: 'mdl-color-text--grey-900',\n                    offset: new L.Point(0, this.getRadius() * -1)\n                });\n\n                this.options.cpPopup = oPopup;\n            }\n            \n            this.options.cpPopup.setContent(sPopupText);\n            this.options.cpPopup.setLatLng(this.getPosition());\n            this.options.parent.addLayer(this.options.cpPopup);\n            //this.bindPopup(oPopup);\n            //this.openPopup();\n            this.bringToFront();\n        },\n        hidePopup: function()\n        {\n            //this.closePopup();\n            //this.unbindPopup();\n            this.options.parent.removeLayer(this.options.cpPopup);\n            //this.options.cpPopup = undefined;\n            this.bringToFront();\n        },\n        updatePopup: function()\n        {\n            if (this.options.cpPopup)\n            {\n                var sPopupText = this.getPopupText();\n                this.options.cpPopup.setContent(sPopupText);\n                this.options.cpPopup.setLatLng(this.getPosition());\n            }\n        },\n        bringToFront: function()\n        {\n//            this.setZIndexOffset(Number.MAX_VALUE);\n        },\n        setPosition: function (el, point, disable3D) { // (HTMLElement, Point[, Boolean])\n            var iRadius = this.options.icon.options.oIconDef.iRadius;\n            var oOffsetPoint = new L.Point(point.x - iRadius, point.y - iRadius);\n\n            // jshint camelcase: false\n            el._leaflet_pos = point;\n\n            if (!disable3D && L.Browser.any3d) {\n                el.style[L.DomUtil.TRANSFORM] =  L.DomUtil.getTranslateString(oOffsetPoint);\n            } else {\n                el.style.left = oOffsetPoint.x + 'px';\n                el.style.top = oOffsetPoint.y + 'px';\n            }\n        },\n        _setPos: function (pos) {\n            this.setPosition(this._icon, pos);\n\n            if (this._shadow) {\n                this.setPosition(this._shadow, pos);\n            }\n\n            this._zIndex = pos.y + this.options.zIndexOffset;\n\n            this._resetZIndex();\n        }\n    };\n    \n    return publicInterface;\n};\n\nleafLet.editor.ControlPoint = L.Marker.extend(leafLet.internalPrivateClass.ControlPoint());\n","/* global leafLet, L, emp */\n\nleafLet.editor.StateType = {\n    IDLE: 'idle',\n    ADDING_CP: 'add',\n    DELETE_CP: 'delete',\n    DRAGGING_CP: 'dragging',\n    FEATURE_DRAG: 'featuredrag'\n};\n\nleafLet.internalPrivateClass.AbstractEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            L.FeatureGroup.prototype.initialize.call(this);\n            var oOptions = {\n                bDestroyFeature: false,\n                editorState: leafLet.editor.StateType.IDLE,\n                isDrawing: ((args.EmpDrawEditItem instanceof emp.typeLibrary.Draw)? true: false), // False if editing.\n                oTransaction: args.transaction,\n                oEmpDrawEditItem: args.EmpDrawEditItem,\n                oCurrentCP: undefined,\n                feature: args.feature,\n                properties: undefined,\n                //leafletObject: (args.feature? args.feature.getLeafletObject(): undefined),\n                leafletMap: args.instanceInterface.leafletInstance,\n                instanceInterface: args.instanceInterface,\n                oControlPointList: [],\n                featureStartLocation: undefined,\n                updateIndex: undefined,\n                oMarkerPopUp: undefined,\n                bCPDragged: false\n            };\n            L.Util.setOptions(this, oOptions);\n            this.options.leafletMap.addLayer(this);\n\n            if (args.feature)\n            {\n                this.options.properties = leafLet.utils.mergeProperties(this.options.feature.options.properties, this.options.oEmpDrawEditItem.properties);\n            }\n            else\n            {\n                this.options.properties = leafLet.utils.mergeProperties(this.options.oEmpDrawEditItem.properties, {});\n            }\n            if (this.isDrawMode())\n            {\n                this.preapareForDrawOperation();\n            }\n            else\n            {\n                this.preapareForEditOperation();\n                \n                if (this.getFeature().getParentCoreId() !== undefined)\n                {\n                    var oParent = this.getFeature().getParentObject();\n                    oParent.removeChildObject(this.getFeature());\n                }\n                \n                this.addLayer(this.getFeature());\n            }\n            \n            this.getFeature().setEditMode();\n            this.assembleControlPoints();\n            \n            this.options.leafletMap.on('click', this.onClickEvent, this);\n            this.options.leafletMap.on('mouseup', this.onFeatureMouseUpEvent, this);\n            //this.on('mousedown', this.onMouseDown, this);\n            //this.on('dblclick', this.onDblClick, this);\n\n            this.setLeafletObjectEvents();\n            \n            this._issueStartEvent();\n        },\n        destroy:function()\n        {\n            if (this.options.oMarkerPopUp)\n            {\n                this.removeLayer(this.options.oMarkerPopUp);\n            }\n            \n            this.removeLayer(this.getFeature());\n\n            this.removeLeafletObjectEvents();\n\n            if (this.options.bDestroyFeature)\n            {\n                this.options.feature.destroy();\n                this.options.feature = undefined;\n            }\n            this.options.leafletMap.off('click', this.onClickEvent, this);\n            this.options.leafletMap.off('mouseup', this.onFeatureMouseUpEvent, this);\n            this.options.leafletMap.off('mouseup', this.onCPMouseUpEvent, this);\n            this.clearAllEventListeners();\n            this.removeAllControlPoints();\n            this.options.leafletMap.removeLayer(this);\n            \n            if (this.getFeature())\n            {\n                if (this.getFeature().getParentCoreId() !== undefined)\n                {\n                    var oParent = this.getFeature().getParentObject();\n                    oParent.addChildObject(this.getFeature());\n                }\n            }\n        },\n        getEngineInstanceInterface: function()\n        {\n            return this.options.instanceInterface;\n        },\n        getMarkerObject: function()\n        {\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject)\n            {\n                if (oLeafletObject instanceof L.LayerGroup)\n                {\n                    oLeafletObject = oLeafletObject.getLayers()[0];\n                }\n\n                if (oLeafletObject instanceof L.Marker)\n                {\n                    return oLeafletObject;\n                }\n            }\n            \n            return undefined;\n        },\n        isMarker: function()\n        {\n            return (this.getMarkerObject()? true: false);\n        },\n        setMarkerEvents: function()\n        {\n            var oLeafletObject = this.getMarkerObject();\n            \n            if (oLeafletObject)\n            {\n                oLeafletObject.on('mousedown', this.onFeatureMouseDown, this);\n                //oLeafletObject.on('mouseup', this.onFeatureMouseUpEvent, this);\n            }\n        },\n        removeMarkerEvents: function()\n        {\n            var oLeafletObject = this.getMarkerObject();\n            \n            if (oLeafletObject)\n            {\n                oLeafletObject.off('mousedown', this.onFeatureMouseDown, this);\n                //oLeafletObject.off('mouseup', this.onFeatureMouseUpEvent, this);\n            }\n        },\n        setLeafletObjectEvents: function()\n        {\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject)\n            {\n                if (this.isMarker())\n                {\n                    this.setMarkerEvents();\n                }\n                else if (oLeafletObject instanceof L.LayerGroup)\n                {\n                    var oChildren = oLeafletObject.getLayers();\n                    \n                    for (var iIndex = 0; iIndex < oChildren.length; iIndex++)\n                    {\n                        oChildren[iIndex].on('mousedown', this.onFeatureMouseDown, this);\n                        //oChildren[iIndex].on('mouseup', this.onFeatureMouseUpEvent, this);\n                    }\n                }\n                else\n                {\n                    oLeafletObject.on('mousedown', this.onFeatureMouseDown, this);\n                    //oLeafletObject.on('mouseup', this.onFeatureMouseUpEvent, this);\n                }\n            }\n        },\n        removeLeafletObjectEvents: function()\n        {\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject)\n            {\n                if (this.isMarker())\n                {\n                    this.removeMarkerEvents();\n                }\n                else if (oLeafletObject instanceof L.LayerGroup)\n                {\n                    var oChildren = oLeafletObject.getLayers();\n                    \n                    for (var iIndex = 0; iIndex < oChildren.length; iIndex++)\n                    {\n                        oChildren[iIndex].off('mousedown', this.onFeatureMouseDown, this);\n                        //oChildren[iIndex].off('mouseup', this.onFeatureMouseUpEvent, this);\n                    }\n                }\n                else\n                {\n                    oLeafletObject.off('mousedown', this.onFeatureMouseDown, this);\n                    //oLeafletObject.off('mouseup', this.onFeatureMouseUpEvent, this);\n                }\n            }\n        },\n        getLeafletMap: function()\n        {\n            return this.options.leafletMap;\n        },\n        removeAllControlPoints: function()\n        {\n            var oControlPointList = this.options.oControlPointList;\n            \n            while (oControlPointList.length > 0)\n            {\n                this.removeCP(oControlPointList[0]);\n            }\n        },\n        _getAltitudeValue: function(dValue)\n        {\n            var oFeature = this.getFeature();\n            \n            return dValue.toFixed(0) + \" \" + oFeature.getAltitudeUnits() + \" \" + oFeature.getAltitudeModeAbbr();\n        },\n        getMarkerPopupText: function()\n        {\n            var sPopupText;\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n            \n            if (oLeafletObject instanceof L.Marker)\n            {\n                var oCoordList = this.getCoordinateList();\n                var oLatLng = oCoordList[0];\n                \n                sPopupText = \"<center>Lat:\" + oLatLng.lat.toFixed(5) + \"<br/>Lon:\" + oLatLng.lng.toFixed(5);\n\n                if (!isNaN(oLatLng.alt))\n                {\n                    sPopupText += \"<br/>Alt:\" + this._getAltitudeValue(oLatLng.alt);\n                }\n\n                sPopupText += \"</center>\";\n            }\n            \n            return sPopupText;\n        },\n        setMarkerPopup: function()\n        {\n/*\n            var sPopupText;\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject)\n            {\n                sPopupText = this.getMarkerPopupText();\n\n                if (this.options.oMarkerPopUp)\n                {\n                    this.options.oMarkerPopUp.setContent(sPopupText);\n                    this.options.oMarkerPopUp.setLatLng(oLeafletObject.getLatLng());\n                    this.options.oMarkerPopUp.update();\n                }\n                else\n                {\n                    this.options.oMarkerPopUp = new L.Popup({\n                        closeButton: false,\n                        autoPan: false,\n                        className: 'mdl-color--grey-800 mdl-shadow--12dp',\n                        offset: new L.Point(0, (this.options.instanceInterface.iMilStdIconSize * -1))\n                    });\n                    this.options.oMarkerPopUp.setLatLng(oLeafletObject.getLatLng());\n                    this.addLayer(this.options.oMarkerPopUp);\n                }\n            }\n*/\n        },\n        getLeafletObject: function()\n        {\n            var oFeature = this.getFeature();\n            \n            if (oFeature)\n            {\n                return oFeature.getLeafletObject();\n            }\n            return undefined;\n        },\n        setLeafletObject: function(oObject)\n        {\n            var oFeature = this.getFeature();\n\n            if (oFeature)\n            {\n                this.removeLeafletObjectEvents();\n                oFeature.setLeafletObject(oObject);\n            }\n            \n            var oMarkerObject = this.getMarkerObject();\n            \n            if (oMarkerObject)\n            {\n                oMarkerObject.unbindPopup();\n            }\n            \n            this.setLeafletObjectEvents();\n            this.setMarkerPopup();\n            this.bringCPForward();\n        },\n        getFeature: function()\n        {\n            return this.options.feature;\n        },\n        setFeature: function(oFeature)\n        {\n            if (this.options.feature)\n            {\n                this.getFeature().clearAllEventListeners();\n                this.removeLayer(this.getFeature());\n                if (this.options.bDestroyFeature)\n                {\n                    this.getFeature().destroy();\n                }\n                this.options.feature = undefined;\n            }\n            \n            if (oFeature)\n            {\n                this.options.feature = oFeature;\n                this.addLayer(this.getFeature());\n                this.setLeafletObjectEvents();\n            }\n        },\n        getDrawEditItem: function()\n        {\n            return this.options.oEmpDrawEditItem;\n        },\n        isDrawMode: function()\n        {\n            return this.options.isDrawing;\n        },\n        preapareForDrawOperation: function()\n        {\n            // The subclass can implement this function.\n            // It is called once at the start of a draw operation, before the assembleControlPoints.\n        },\n        preapareForEditOperation: function()\n        {\n            // The subclass can implement this function.\n            // It is called once at the start of an edit operation,\n            // before the assembleControlPoints is called.\n        },\n        assembleControlPoints: function()\n        {\n            throw new Error(\"The editor has not implemented the assembleControlPoint method.\");\n        },\n        createEMPFeature: function()\n        {\n            var oEMPFeature;\n            var oFeature = this.getFeature();\n            \n            oEMPFeature = new emp.typeLibrary.Feature({\n                coreId: oFeature.getCoreId(),\n                overlayId: oFeature.getOverlayId(),\n                parentId: oFeature.getParentId(),\n                featureId: oFeature.getFeatureId(),\n                name: oFeature.getName(),\n                format: oFeature.getFormat(),\n                data: oFeature.getData(),\n                properties: oFeature.getProperties()\n            });\n            \n            return oEMPFeature;\n        },\n        getCenterPT: function(oPt1, oPt2)\n        {\n            var dDist = oPt1.distanceTo(oPt2);\n            var dBearing = oPt1.bearingTo(oPt2);\n            \n            return oPt1.destinationPoint(dBearing, dDist / 2.0);\n        },\n        getCP: function(iCPIndex)\n        {\n            var oCPList = this.options.oControlPointList;\n            \n            for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n            {\n                if (oCPList[iIndex].getIndex() === iCPIndex)\n                {\n                    return oCPList[iIndex];\n                }\n            }\n            \n            return undefined;\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            return undefined;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            return undefined;\n        },\n        doFeatureMove: function(dBearing, dDistance)\n        {\n            return false;\n        },\n        getState: function()\n        {\n            return this.options.editorState;\n        },\n        isIdle: function()\n        {\n            return (this.getState() === leafLet.editor.StateType.IDLE);\n        },\n        isAddingCP: function()\n        {\n            return (this.getState() === leafLet.editor.StateType.ADDING_CP);\n        },\n        isDeletingCP: function()\n        {\n            return (this.getState() === leafLet.editor.StateType.DELETE_CP);\n        },\n        isDraggingCP: function()\n        {\n            return (this.getState() === leafLet.editor.StateType.DRAGGING_CP);\n        },\n        isDraggingFeature: function()\n        {\n            return (this.getState() === leafLet.editor.StateType.FEATURE_DRAG);\n        },\n        _setState: function(eState) {\n            this.options.editorState = eState;\n        },\n        isCPAddEvent: function(oEvent)\n        {\n            // An add is a mouse Click\n            // with the left button with no Alt, shift nor ctrl keys press.\n            // And it can't occure on a control point.\n            if (this.isIdle() &&\n                (oEvent.originalEvent.button === 0) &&\n                !oEvent.originalEvent.altKey &&\n                !oEvent.originalEvent.ctrlKey &&\n                !oEvent.originalEvent.shiftkey)\n            {\n                if (oEvent.type === 'click')\n                {\n                    if (!(oEvent.target instanceof leafLet.editor.ControlPoint))\n                    {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        },\n        isCPDeleteEvent: function(oEvent)\n        {\n            // A  delete is a mouse DblClick\n            // with the left button with no Alt, shift nor ctrl keys press.\n            // But it must occure on a control point that is not new\n            if (this.isIdle() &&\n                    (oEvent.originalEvent.button === 0) &&\n                    !oEvent.originalEvent.altKey &&\n                    !oEvent.originalEvent.ctrlKey &&\n                    !oEvent.originalEvent.shiftkey)\n            {\n                if (oEvent.type === 'dblclick')\n                {\n                    if ((oEvent.target instanceof leafLet.editor.ControlPoint) &&\n                            (oEvent.target.getType() !== leafLet.ControlPoint.Type.NEW_POSITION_CP))\n                    {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        },\n        isCPDragStartEvent: function(oEvent)\n        {\n            // A CP drag starts with a mouse down\n            // with the left button with no Alt, shift nor ctrl keys press.\n            // But it must occure on a control point.\n            if (this.isIdle() &&\n                    (oEvent.originalEvent.button === 0) &&\n                    !oEvent.originalEvent.altKey &&\n                    !oEvent.originalEvent.ctrlKey &&\n                    !oEvent.originalEvent.shiftkey)\n            {\n                if (oEvent.type === 'mousedown')\n                {\n                    if (oEvent.target instanceof leafLet.editor.ControlPoint)\n                    {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        },\n        isFeatureDragStartEvent: function(oEvent)\n        {\n            // A CP drag starts with a mouse down\n            // with the left button with no Alt, shift nor ctrl keys press.\n            // But it must occure on a control point.\n            if (this.isIdle() &&\n                    (oEvent.originalEvent.button === 0) &&\n                    !oEvent.originalEvent.altKey &&\n                    !oEvent.originalEvent.ctrlKey &&\n                    !oEvent.originalEvent.shiftkey)\n            {\n                if (oEvent.type === 'mousedown')\n                {\n                    if (!(oEvent.target instanceof leafLet.editor.ControlPoint))// &&\n//                            ((oEvent.target === this.getLeafletObject()) ||\n//                            (oEvent.target instanceof L.Marker)))\n                    {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        },\n        onClickEvent: function(oEvent)\n        {\n//console.log(\"Got \" + oEvent.type);\n            if ((this.isCPAddEvent(oEvent)) &&\n                (oEvent.latlng instanceof L.LatLng) &&\n                !this.options.bCPDragged)\n            {\n                this._setState(leafLet.editor.StateType.ADDING_CP);\n\n                var oCP = this.doAddControlPoint(oEvent.latlng.wrap());\n                if (oCP)\n                {\n                    this.updateCPIndex(oCP.getIndex(), 1);\n                    this.addControlPoint(oCP);\n                    this._issueCPAddEvent(oCP.getIndex());\n                }\n                this._setState(leafLet.editor.StateType.IDLE);\n            }\n        },\n        onDblClick: function(oEvent)\n        {\n//console.log(\"Got \" + oEvent.type);\n            if (this.isCPDeleteEvent(oEvent) &&\n                    !this.options.bCPDragged) {\n                var oCP = oEvent.target;\n                \n                this._setState(leafLet.editor.StateType.DELETE_CP);\n                if (this.doDeleteControlPoint(oCP))\n                {\n                    // The editor indicated that the CP can be deleted.\n                    this.removeCP(oCP);\n                    this.updateCPIndex(oCP.getIndex(), -1);\n                    this._issueCPDeleteEvent(oCP.getIndex());\n                }\n                this._setState(leafLet.editor.StateType.IDLE);\n            }\n        },\n        onCPMouseUpEvent: function(oEvent)\n        {\n//console.log(\"Got CP \" + oEvent.type);\n            if (this.isDraggingCP())\n            {\n                var oCP = this.options.oCurrentCP;\n\n                if (typeof (oEvent.originalEvent.target.releaseCapture) === 'function')\n                {\n                    oEvent.originalEvent.target.releaseCapture();\n                }\n                this.getLeafletMap().off('mousemove', this.onCPMouseMoveEvent, this);\n                this.getLeafletMap().off('mouseup', this.onCPMouseUpEvent, this);\n                this.getLeafletMap().dragging.enable();\n                oCP.hidePopup();\n                this._setState(leafLet.editor.StateType.IDLE);\n                this.options.oCurrentCP = undefined;\n                this._issueCPUpdateEvent(this.options.updateIndex, emp.typeLibrary.UpdateEventType.UPDATE);\n                if (typeof (oEvent.originalEvent.stopPropagation) === 'function') {\n                    oEvent.originalEvent.stopPropagation();\n                }\n                if (typeof (oEvent.originalEvent.preventDefault) === 'function') {\n                    oEvent.originalEvent.preventDefault();\n                }\n            }\n        },\n        onCPMouseMoveEvent: function(oEvent)\n        {\n//console.log(\"Got CP \" + oEvent.type);\n            var aiIndex;\n            \n            if (this.isDraggingCP()) {\n                var oCP = this.options.oCurrentCP;\n                this.options.bCPDragged = true;\n                aiIndex = this.doControlPointMoved(oCP, oEvent);\n\n                if (aiIndex instanceof Array) {\n                    oCP.updatePopup();\n                }\n                this.options.updateIndex = aiIndex;\n            }\n        },\n        onCPMouseDown: function(oEvent)\n        {\n//console.log(\"Got CP \" + oEvent.type);\n            if (this.isCPDragStartEvent(oEvent)) {\n                this.options.bCPDragged = false;\n                var iIndex = this.options.oControlPointList.indexOf(oEvent.target);\n                \n                if (iIndex !== -1) {\n                    var oCP = this.options.oControlPointList[iIndex];\n\n                    oCP.showPopup();\n                    this._setState(leafLet.editor.StateType.DRAGGING_CP);\n                    this.options.oCurrentCP = oCP;\n                    this.getLeafletMap().dragging.disable();\n                    this.getLeafletMap().on('mousemove', this.onCPMouseMoveEvent, this);\n                    if (typeof (oEvent.originalEvent.target.setCapture) === 'function') {\n                        oEvent.originalEvent.target.setCapture();\n                    }\n                    this.getLeafletMap().on('mouseup', this.onCPMouseUpEvent, this);\n                }\n            }\n        },\n        onFeatureMouseUpEvent: function(oEvent)\n        {\n//console.log(\"Got Feature \" + oEvent.type);\n            if (this.isDraggingFeature())\n            {\n                var oCPList = this.options.oControlPointList;\n\n                for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n                {\n                    if (oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP)\n                    {\n                        oCPList[iIndex].hidePopup();\n                    }\n                }\n                \n                if (typeof (oEvent.originalEvent.target.releaseCapture) === 'function')\n                {\n                    oEvent.originalEvent.target.releaseCapture();\n                }\n                this.getLeafletMap().off('mousemove', this.onFeatureMouseMoveEvent, this);\n                this.getLeafletMap().dragging.enable();\n                this._setState(leafLet.editor.StateType.IDLE);\n                this._issueCPUpdateEvent(this.options.updateIndex, emp.typeLibrary.UpdateEventType.UPDATE);\n            }\n        },\n        onFeatureMouseMoveEvent: function(oEvent)\n        {\n//console.log(\"Got Feature \" + oEvent.type);\n            var aiIndex;\n            \n            if (this.isDraggingCP())\n            {\n                var oCP = this.options.oCurrentCP;\n                var oOrgLL = oEvent.latlng;\n                var oEventCoord = oOrgLL.wrap();\n                \n                oEvent.latlng = oEventCoord;\n                aiIndex = this.doControlPointMoved(oCP, oEvent);\n                oEvent.latlng = oOrgLL;\n\n                if (aiIndex instanceof Array)\n                {\n                    oCP.updatePopup();\n                }\n                this.options.updateIndex = aiIndex;\n            }\n            else if (this.isDraggingFeature())\n            {\n                var oEventCoord = oEvent.latlng.wrap();\n                var dBearing = this.options.featureStartLocation.bearingTo(oEventCoord);\n                var dDistance = this.options.featureStartLocation.distanceTo(oEventCoord);\n                \n                if (this.doFeatureMove(dBearing, dDistance))\n                {\n                    var oCPList = this.options.oControlPointList;\n                    \n                    aiIndex = [];\n                    for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n                    {\n                        if (oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP)\n                        {\n                            aiIndex.push(oCPList[iIndex].getIndex());\n                            oCPList[iIndex].updatePopup();\n                        }\n                    }\n                    this.options.featureStartLocation = oEvent.latlng;\n                    this.options.updateIndex = aiIndex;\n                }\n            }\n        },\n        onFeatureMouseDown: function(oEvent)\n        {\n//console.log(\"Got Feature \" + oEvent.type);\n            if (this.isFeatureDragStartEvent(oEvent))\n            {\n                var oCPList = this.options.oControlPointList;\n\n                for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n                {\n                    if (oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP)\n                    {\n                        oCPList[iIndex].showPopup();\n                    }\n                }\n                \n                this.options.featureStartLocation = oEvent.latlng;\n                this._setState(leafLet.editor.StateType.FEATURE_DRAG);\n\n                this.getLeafletMap().dragging.disable();\n                this.getLeafletMap().on('mousemove', this.onFeatureMouseMoveEvent, this);\n                if (typeof (oEvent.originalEvent.target.setCapture) === 'function')\n                {\n                    oEvent.originalEvent.target.setCapture();\n                }\n            }\n        },\n        setCPEvents: function(oCP)\n        {\n            oCP.on('dblclick', this.onDblClick, this);\n            oCP.on('mousedown', this.onCPMouseDown, this);\n            //oCP.on('mouseup', this.onCPMouseUpEvent, this);\n        },\n        removeCPEvents: function(oCP)\n        {\n            oCP.off('dblclick', this.onDblClick, this);\n            oCP.off('mousedown', this.onCPMouseDown, this);\n            //oCP.off('mouseup', this.onCPMouseUpEvent, this);\n        },\n        addControlPoint: function(oCP)\n        {\n            this.options.oControlPointList.push(oCP);\n            this.addLayer(oCP);\n            this.setCPEvents(oCP);\n            oCP.bringToFront();\n            oCP.setParent(this);\n        },\n        bringCPForward: function()\n        {\n            var oCPList = this.options.oControlPointList;\n            \n            this.bringToFront();\n            for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n            {\n                oCPList[iIndex].bringToFront();\n            }\n        },\n        removeCP: function(oCP)\n        {\n            var iIndex = this.options.oControlPointList.indexOf(oCP);\n\n            if (iIndex > -1)\n            {\n                this.removeCPEvents(oCP);\n                this.removeLayer(oCP);\n                this.options.oControlPointList.splice(iIndex, 1);\n            }\n        },\n        removeAllCPByType: function(type)\n        {\n            var oCPList = this.options.oControlPointList;\n            \n            for (var iIndex = 0; iIndex < oCPList.length;)\n            {\n                if (oCPList[iIndex].getType() === type)\n                {\n                    this.removeCP(oCPList[iIndex]);\n                }\n                else\n                {\n                    iIndex++;\n                }\n            }\n        },\n        getCoordinateList: function()\n        {\n            throw new Error(\"getCoordinateList function nor impletmented in editor.\");\n        },\n        updateCPIndex: function(iStartIndex, iDelta)\n        {\n            var oCPList = this.options.oControlPointList;\n\n            for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n            {\n                if ((oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP) &&\n                        (oCPList[iIndex].getIndex() >= iStartIndex))\n                {\n                    oCPList[iIndex].setIndex(oCPList[iIndex].getIndex() + iDelta);\n                }\n            }\n        },\n        convertToUpdateCoordinates: function(oCoordList)\n        {\n            var oUpdateCoordList = [];\n            \n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                if (!isNaN(oCoordList[iIndex].alt))\n                {\n                    oUpdateCoordList.push({\n                        lat: oCoordList[iIndex].lat,\n                        lon: oCoordList[iIndex].lng,\n                        alt: oCoordList[iIndex].alt\n                    });\n                }\n                else\n                {\n                    oUpdateCoordList.push({\n                        lat: oCoordList[iIndex].lat,\n                        lon: oCoordList[iIndex].lng\n                    });\n                }\n            }\n            \n            return oUpdateCoordList;\n        },\n        _issueStartEvent: function()\n        {\n            if (this.isDrawMode())\n            {\n                this.getEngineInstanceInterface().empMapInstance.eventing.DrawStart({transaction: this.options.oTransaction});\n            }\n            else\n            {\n                // Else it an edit.\n                this.getEngineInstanceInterface().empMapInstance.eventing.EditStart({transaction: this.options.oTransaction});\n            }\n            this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.START);\n            this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n        },\n        _issueCPUpdateEvent: function(oIndexArray, updateEventType)\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            var oUpdateCoordList = this.convertToUpdateCoordinates(oCoordList);\n            \n            var oUpdateEvent = {\n                name: oFeature.getName(),\n                plotFeature: this.createEMPFeature(),\n                updates:{\n                    type: emp.typeLibrary.CoordinateUpdateType.UPDATE,\n                    indices: oIndexArray,\n                    coordinates: oUpdateCoordList\n                },\n                properties: oFeature.getProperties(),\n                updateEventType: updateEventType,\n                mapInstanceId: this.getEngineInstanceInterface().empMapInstance.mapInstanceId\n            };\n            \n            this.options.oEmpDrawEditItem.update(oUpdateEvent);\n        },\n        _issueCPAddEvent: function(iIndex)\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            var oUpdateCoordList = this.convertToUpdateCoordinates(oCoordList);\n            \n            var oUpdateEvent = {\n                name: oFeature.getName(),\n                plotFeature: this.createEMPFeature(),\n                updates:{\n                    type: emp.typeLibrary.CoordinateUpdateType.ADD,\n                    indices: [iIndex],\n                    coordinates: oUpdateCoordList\n                },\n                properties: oFeature.getProperties(),\n                updateEventType: emp.typeLibrary.UpdateEventType.UPDATE,\n                mapInstanceId: this.getEngineInstanceInterface().empMapInstance.mapInstanceId\n            };\n            \n            this.options.oEmpDrawEditItem.update(oUpdateEvent);\n        },\n        _issueCPDeleteEvent: function(iIndex)\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            var oUpdateCoordList = this.convertToUpdateCoordinates(oCoordList);\n            \n            var oUpdateEvent = {\n                name: oFeature.getName(),\n                plotFeature: this.createEMPFeature(),\n                updates:{\n                    type: emp.typeLibrary.CoordinateUpdateType.REMOVE,\n                    indices: [iIndex],\n                    coordinates: oUpdateCoordList\n                },\n                properties: oFeature.getProperties(),\n                updateEventType: emp.typeLibrary.UpdateEventType.UPDATE,\n                mapInstanceId: this.getEngineInstanceInterface().empMapInstance.mapInstanceId\n            };\n            \n            this.options.oEmpDrawEditItem.update(oUpdateEvent);\n        },\n        _issueEndEvent: function()\n        {\n            if (this.isDrawMode())\n            {\n                this.options.oEmpDrawEditItem.plotFeature = this.createEMPFeature();\n                this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.COMPLETE);\n                this.getEngineInstanceInterface().empMapInstance.eventing.DrawEnd({transaction: this.options.oTransaction});\n            }\n            else\n            {\n                // Else it an edit.\n                this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.COMPLETE);\n                // We need to update the feature.\n                this.getEngineInstanceInterface().empMapInstance.eventing.EditEnd({transaction: this.options.oTransaction});\n            }\n        },\n        _issueCancelEvent: function()\n        {\n            var oErrArray = [];\n\n            oErrArray.push({\n                coreId: this.options.oEmpDrawEditItem.coreId,\n                message: \"Operation canceled.\",\n                level: 0\n            });\n\n            if (this.isDrawMode())\n            {\n                this.getEngineInstanceInterface().empMapInstance.eventing.DrawEnd({\n                    transaction: this.options.oTransaction,\n                    failures: oErrArray\n                });\n            }\n            else\n            {\n                // Else it an edit.\n                this.getEngineInstanceInterface().empMapInstance.eventing.EditEnd({\n                    transaction: this.options.oTransaction,\n                    failures: oErrArray\n                });\n            }\n        },\n        endEdit: function()\n        {\n            this._issueEndEvent();\n            this.getFeature().resetEditMode();\n            this.removeLeafletObjectEvents();\n        },\n        cancelEdit: function()\n        {\n            this._issueCancelEvent();\n            this.getFeature().resetEditMode();\n            this.removeLeafletObjectEvents();\n        },\n        updateLeafletObject: function()\n        {\n            var oFeature = this.getFeature();\n            var oMapBounds = this.getLeafletMap().getBounds();\n            \n            oFeature.updateCoordinates(oMapBounds);\n        },\n        render: function()\n        {\n            this.updateLeafletObject();\n            this.removeAllControlPoints();\n            this.assembleControlPoints();\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.editor.AbstractEditor = L.FeatureGroup.extend(leafLet.internalPrivateClass.AbstractEditor());\n","/* global leafLet, L, emp */\n\nleafLet.internalPrivateClass.GeoJsonEditor = function () {\n    var publicInterface = {\n        initialize: function (args) {\n            var oOptions = {\n                geoJsonType: (args.geoJsonType ? args.geoJsonType.toLowerCase() : undefined)\n            };\n            L.Util.setOptions(this, oOptions);\n\n            leafLet.editor.AbstractEditor.prototype.initialize.call(this, args);\n        },\n        preapareForDrawOperation: function () {\n            if (this.getFeature() === undefined) {\n                var oGeoJsonData = {\n                    type: 'Point',\n                    coordinates: []\n                };\n\n                switch (this.options.geoJsonType) {\n                    case 'point':\n                        oGeoJsonData = {\n                            type: 'Point',\n                            coordinates: []\n                        };\n                        break;\n                    case 'linestring':\n                        oGeoJsonData = {\n                            type: 'LineString',\n                            coordinates: []\n                        };\n                        break;\n                    case 'polygon':\n                        oGeoJsonData = {\n                            type: 'Polygon',\n                            coordinates: [[]]\n                        };\n                        break;\n                }\n\n                this.options.feature = new leafLet.typeLibrary.GeoJsonFeature({\n                    item: {\n                        name: this.options.oEmpDrawEditItem.name,\n                        coreId: this.options.oEmpDrawEditItem.coreId,\n                        parentCoreId: this.options.oEmpDrawEditItem.parentCoreId,\n                        visible: true,\n                        featureId: this.options.oEmpDrawEditItem.featureId,\n                        overlayId: this.options.oEmpDrawEditItem.overlayId,\n                        parentId: this.options.oEmpDrawEditItem.parentId,\n                        format: emp.typeLibrary.featureFormatType.GEOJSON,\n                        data: oGeoJsonData,\n                        properties: this.options.oEmpDrawEditItem.properties\n                    },\n                    instanceInterface: this.getEngineInstanceInterface()\n                });\n                this.addLayer(this.options.feature);\n                this.options.bDestroyFeature = true;\n            }\n        },\n        preapareForEditOperation: function () {\n        },\n        getCoordinateList: function () {\n            return leafLet.utils.geoJson.convertCoordinatesToLatLng(this.getFeature().getData());\n        },\n        setCoordinates: function (oLatLngList) {\n            leafLet.utils.geoJson.convertLatLngListToGeoJson(this.getFeature().getData(), oLatLngList);\n        },\n        _addNewCP: function () {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0) {\n                return;\n            }\n\n            switch (oFeature.getGeometryType().toLowerCase()) {\n                case 'point':\n                    break;\n                case 'linestring':\n                    for (iIndex = 1; iIndex < oCoordList.length; iIndex++) {\n                        // Lets add the new CP.\n                        oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                        oCP = new leafLet.editor.ControlPoint(oFeature,\n                                leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                                oNewCoord, iIndex, 0);\n                        this.addControlPoint(oCP);\n                    }\n                    break;\n                case 'polygon':\n                    if (oCoordList.length > 2) {\n                        for (iIndex = 1; iIndex < oCoordList.length; iIndex++) {\n                            // Lets add the new CP.\n                            oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                            oCP = new leafLet.editor.ControlPoint(oFeature,\n                                    leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                                    oNewCoord, iIndex, 0, \"\");\n                            this.addControlPoint(oCP);\n                        }\n\n                        // Lets add the new CP.\n                        oNewCoord = oCoordList[0].midPointTo(oCoordList[oCoordList.length - 1]);\n                        oCP = new leafLet.editor.ControlPoint(oFeature,\n                                leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                                oNewCoord, oCoordList.length, 0);\n                        this.addControlPoint(oCP);\n                    }\n                    break;\n            }\n        },\n        assembleControlPoints: function () {\n            var oCP;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0) {\n                return;\n            }\n\n            switch (this.getFeature().getGeometryType().toLowerCase()) {\n                case 'point':\n                    break;\n                case 'linestring':\n                case 'polygon':\n                    for (iIndex = 0; iIndex < oCoordList.length; iIndex++) {\n                        oCP = new leafLet.editor.ControlPoint(oFeature,\n                                leafLet.ControlPoint.Type.POSITION_CP,\n                                oCoordList[iIndex], iIndex, 0);\n                        this.addControlPoint(oCP);\n                    }\n                    break;\n            }\n\n            this._addNewCP();\n        },\n        _createLeafletObject: function () {\n            var oLeafletObject;\n            var oCoordList = this.getCoordinateList();\n            var oProperties = leafLet.utils.geoJson.mergeGeoJSONProperties(this.options.instanceInterface, this.options.oEmpDrawEditItem.properties);\n\n            switch (this.getFeature().getGeometryType().toLowerCase()) {\n                case 'point':\n\n                    if (oCoordList.length > 0) {\n                        oProperties.iconOptions.basePath = this.getEngineInstanceInterface().getBasePath();\n                        oProperties.icon = new leafLet.typeLibrary.EmpIcon(oProperties.iconOptions);\n                        oLeafletObject = new L.Marker(oCoordList[0], oProperties);\n                        this.setCPEvents(oLeafletObject);\n                    }\n                    break;\n                case 'linestring':\n                    if (oCoordList.length > 1) {\n                        oLeafletObject = new L.Polyline(oCoordList, oProperties);\n                    }\n                    break;\n                case 'polygon':\n                    if (oCoordList.length > 2) {\n                        oLeafletObject = new L.Polygon(oCoordList, oProperties);\n                    }\n                    break;\n            }\n\n            if (oLeafletObject) {\n                this.setLeafletObject(oLeafletObject);\n            }\n        },\n        updateLeafletObject: function () {\n            var oLeafletObject = this.getLeafletObject();\n\n            if (oLeafletObject === undefined) {\n                this._createLeafletObject();\n            } else {\n                var oCoordList = this.getCoordinateList();\n                switch (this.getFeature().getGeometryType().toLowerCase()) {\n                    case 'point':\n                        oLeafletObject.setLatLng(oCoordList[0]);\n                        break;\n                    case 'linestring':\n                    case 'polygon':\n                        oLeafletObject.setLatLngs(oCoordList);\n                        break;\n                }\n                leafLet.editor.AbstractEditor.prototype.updateLeafletObject.call(this);\n            }\n        },\n        doAddControlPoint: function (oLatLng) {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n\n            switch (this.getFeature().getGeometryType().toLowerCase()) {\n                case 'point':\n                    if (oCoordList.length > 0) {\n                        oCoordList[0].lat = oLatLng.lat;\n                        oCoordList[0].lng = oLatLng.lng;\n                    } else {\n                        oCoordList.push(oLatLng);\n                    }\n                    break;\n                case 'linestring':\n                    oCP = new leafLet.editor.ControlPoint(this.getFeature(),\n                            leafLet.ControlPoint.Type.POSITION_CP,\n                            oLatLng, oCoordList.length, 0);\n                    oCoordList.push(oLatLng);\n                    break;\n                case 'polygon':\n                    oCP = new leafLet.editor.ControlPoint(this.getFeature(),\n                            leafLet.ControlPoint.Type.POSITION_CP,\n                            oLatLng, oCoordList.length, 0);\n                    oCoordList.push(oLatLng);\n                    break;\n            }\n\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject();\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this._addNewCP();\n\n            return oCP;\n        },\n        doDeleteControlPoint: function (oCP) {\n            var bRet = false;\n            var oCoordList = this.getCoordinateList();\n            var iIndex = oCP.getIndex();\n\n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP) {\n                return false;\n            }\n\n            switch (this.getFeature().getGeometryType().toLowerCase()) {\n                case 'point':\n                    break;\n                case 'linestring':\n                    if (oCoordList.length > 2) {\n                        oCoordList.splice(iIndex, 1);\n                        bRet = true;\n                    }\n                    break;\n                case 'polygon':\n                    if (oCoordList.length > 3) {\n                        oCoordList.splice(iIndex, 1);\n                        bRet = true;\n                    }\n                    break;\n            }\n\n            if (bRet) {\n                this.setCoordinates(oCoordList);\n                this.updateLeafletObject();\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n            return bRet;\n        },\n        doControlPointMoved: function (oCP, oEvent) {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n\n            switch (oCP.getType()) {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n\n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position od the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    break;\n            }\n            this.updateLeafletObject();\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this._addNewCP();\n            return [iIndex];\n        },\n        doFeatureMove: function (dBearing, dDistance) {\n            var oCoordList = this.getCoordinateList();\n            var oCPList = this.options.oControlPointList;\n            var oCoord;\n            var iCoordIndex;\n\n            if (this.getFeature().getGeometryType().toLowerCase() === 'point') {\n                oCoordList[0].moveCoordinate(dBearing, dDistance);\n            } else {\n                for (var iIndex = 0; iIndex < oCPList.length; iIndex++) {\n                    iCoordIndex = oCPList[iIndex].getIndex();\n                    oCoord = oCPList[iIndex].getPosition();\n                    oCoord.moveCoordinate(dBearing, dDistance);\n                    oCPList[iIndex].setCPPosition(oCoord);\n                    if (oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP) {\n                        oCoordList[iCoordIndex] = oCoord;\n                    }\n                }\n            }\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject();\n            return true;\n        }\n    };\n\n    return publicInterface;\n};\n\nleafLet.editor.GeoJson = leafLet.editor.AbstractEditor.extend(leafLet.internalPrivateClass.GeoJsonEditor());\n","\n/* global leafLet, armyc2, L, emp */\n\nleafLet.internalPrivateClass.MilStdEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var oOptions = {\n                bMultiPoint: args.multiPoint,\n                sBasicSymbolCode: args.basicSymbolCode,\n                oSymbolDef: args.SymbolDef,\n                oMilStdModifiers: undefined,\n                oCurrentCoordianteList: []\n            };\n            L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.AbstractEditor.prototype.initialize.call(this, args);\n        },\n        isMultiPoint: function()\n        {\n            return this.options.bMultiPoint;\n        },\n        getBasicSymbolCode: function()\n        {\n            return this.options.sBasicSymbolCode;\n        },\n        getSymbolDef: function()\n        {\n            return this.options.oSymbolDef;\n        },\n        preapareForDrawOperation: function()\n        {\n            if (this.getFeature() === undefined)\n            {\n                var oFeature;\n                var oDrawItem = this.options.oEmpDrawEditItem;\n                \n                if (this.isMultiPoint())\n                {\n                    oFeature = leafLet.utils.milstd.createTGFromDraw(\n                            this.getEngineInstanceInterface(),\n                            this.getLeafletMap(),\n                            this.getSymbolDef(),\n                            this.getBasicSymbolCode(),\n                            oDrawItem\n                    );\n                }\n                else\n                {\n                    oFeature = new leafLet.typeLibrary.MilStdFeature({\n                        item: {\n                            name: oDrawItem.name,\n                            coreId: oDrawItem.coreId,\n                            parentCoreId: oDrawItem.parentCoreId,\n                            visible: true,\n                            featureId: oDrawItem.featureId,\n                            overlayId: oDrawItem.overlayId,\n                            parentId: oDrawItem.parentId,\n                            format: emp.typeLibrary.featureFormatType.MILSTD,\n                            data: {\n                                symbolCode: oDrawItem.symbolCode,\n                                type: 'Point',\n                                coordinates: []\n                            },\n                            properties: emp.helpers.copyObject(oDrawItem.properties)\n                        },\n                        instanceInterface: this.getEngineInstanceInterface()\n                    });\n                }\n                this.setFeature(oFeature);\n                this.options.bDestroyFeature = true;\n            }\n            this.preapareForEditOperation();\n        },\n        preapareForEditOperation: function()\n        {\n            var oRendererUtils = armyc2.c2sd.renderer.utilities;\n            var oFeature = this.getFeature();\n            var oData = oFeature.getData();\n            var sSymbolCode = oData.symbolCode;\n            \n            this.options.oMilStdModifiers = oFeature.options.oMilStdModifiers;\n            this.options.sBasicSymbolCode = oRendererUtils.SymbolUtilities.getBasicSymbolID(sSymbolCode);\n            this.options.bMultiPoint = oFeature.isMultiPointTG();\n            this.options.oSymbolDef = oRendererUtils.SymbolDefTable.getSymbolDef(this.options.sBasicSymbolCode, oFeature.get2525Version());\n        },\n        getCoordinateList: function()\n        {\n            return leafLet.utils.geoJson.convertCoordinatesToLatLng(this.getFeature().getData());\n        },\n        setCoordinates: function(oLatLngList)\n        {\n            leafLet.utils.geoJson.convertLatLngListToGeoJson(this.getFeature().getData(), oLatLngList);\n        },\n        updateLeafletObject: function(oCList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            var oCoordList = oCList || this.getCoordinateList();\n                    \n            if (!this.isMultiPoint() || (oCoordList.length >= oSymbolDef.minPoints))\n            {\n                var oFeature = this.getFeature();\n                var oModifiers = oFeature.getMilStdModifiers();\n\n                oFeature.getProperties()['modifiers'] = oModifiers.toLongModifiers();\n                var oLeafletObject = oFeature._createFeature(oFeature.options);\n                this.setLeafletObject(oLeafletObject);\n                return true;\n            }\n            \n            return false;\n        },\n        doFeatureMove: function(dBearing, dDistance)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oCPList = this.options.oControlPointList;\n            var oCoord;\n            var iCoordIndex;\n                    \n            for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n            {\n                iCoordIndex = oCPList[iIndex].getIndex();\n                oCoord = oCPList[iIndex].getPosition();\n                oCoord.moveCoordinate(dBearing, dDistance);\n                oCPList[iIndex].setCPPosition(oCoord);\n                if (oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP)\n                {\n                    oCoordList[iCoordIndex] = oCoord;\n                }\n            }\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject();\n\n            return true;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStd = leafLet.editor.AbstractEditor.extend(leafLet.internalPrivateClass.MilStdEditor());\n","/* global leafLet, L, emp */\n\nleafLet.internalPrivateClass.AOIEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var oOptions = {\n                geoJsonType: (args.geoJsonType? args.geoJsonType.toLowerCase(): undefined)\n            };\n            L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.GeoJson.prototype.initialize.call(this, args);\n        },\n        preapareForEditOperation: function()\n        {\n            var oCoordList;\n            var dNorth;\n            var dSouth;\n            var dWest;\n            var dEast;\n            var iIndex;\n            \n            switch(this.getFeature().getAOIType())\n            {\n                case emp.typeLibrary.AOIType.POINT_RADIUS:\n                    break;\n                case emp.typeLibrary.AOIType.LINE:\n                    break;\n                case emp.typeLibrary.AOIType.POLYGON:\n                    break;\n                case emp.typeLibrary.AOIType.BBOX:\n                    \n                    // force the BBox to be a rectangle aligned with logitude and lat.\n                    oCoordList = this.getCoordinateList();\n                    dNorth = -90.0;\n                    dSouth = 90.0;\n                    dWest = 180.0;\n                    dEast = -180.0;\n\n                    for (iIndex = 0; iIndex < oCoordList.length; iIndex++)\n                    {\n                        if (oCoordList[iIndex].lat > dNorth)\n                        {\n                            dNorth = oCoordList[iIndex].lat;\n                        }\n                        if (oCoordList[iIndex].lat < dSouth)\n                        {\n                            dSouth = oCoordList[iIndex].lat;\n                        }\n                        if (oCoordList[iIndex].lng < dWest)\n                        {\n                            dWest = oCoordList[iIndex].lng;\n                        }\n                        if (oCoordList[iIndex].lng > dEast)\n                        {\n                            dEast = oCoordList[iIndex].lng;\n                        }\n                    }\n\n                    oCoordList[0].lat = dNorth;\n                    oCoordList[0].lng = dWest;\n                    oCoordList[1].lat = dNorth;\n                    oCoordList[1].lng = dEast;\n                    oCoordList[2].lat = dSouth;\n                    oCoordList[2].lng = dEast;\n                    oCoordList[3].lat = dSouth;\n                    oCoordList[3].lng = dWest;\n                    this.setCoordinates(oCoordList);\n                    break;\n            }\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oBufferCoord;\n            var oMidPointCoord;\n            var dBrng = 90.0;\n            var iIndex;\n            var iMostEastCoord;\n            var oMostEastCoord;\n            var oNextCoord;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            switch(this.getFeature().getAOIType())\n            {\n                case emp.typeLibrary.AOIType.POINT_RADIUS:\n                    oBufferCoord = oCoordList[0].destinationPoint(dBrng, oFeature.getAOIBuffer());\n                    oMidPointCoord = oCoordList[0];\n                    break;\n                case emp.typeLibrary.AOIType.LINE:\n                    leafLet.editor.GeoJson.prototype._addNewCP.call(this);\n                    oMidPointCoord = oCoordList[0].midPointTo(oCoordList[1]);\n                    dBrng = oCoordList[0].bearingTo(oCoordList[1]);\n                    dBrng = (dBrng + 270) % 360;\n                    oBufferCoord = oMidPointCoord.destinationPoint(dBrng, oFeature.getAOIBuffer());\n                    break;\n                case emp.typeLibrary.AOIType.POLYGON:\n                    leafLet.editor.GeoJson.prototype._addNewCP.call(this);\n                    iMostEastCoord = 0;\n                    \n                    // Find the coordinate furthest to the east.\n                    for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                    {\n                        if (oCoordList[iIndex].lng > oCoordList[iMostEastCoord].lng)\n                        {\n                            iMostEastCoord = iIndex;\n                        }\n                    }\n                    // Get the coordinates of the furthest east and it's next point.\n                    oMostEastCoord = oCoordList[iMostEastCoord];\n                    oNextCoord = oCoordList[((iMostEastCoord + 1) % oCoordList.length)];\n                    \n                    // Now find the mid point between them\n                    oMidPointCoord = oMostEastCoord.midPointTo(oNextCoord);\n                    dBrng = oMostEastCoord.bearingTo(oNextCoord);\n                    \n                    // Now rotate the bearing.\n                    if (leafLet.utils.dateLineInFeature(oCoordList))\n                    {\n                        // Rotate +90.\n                        dBrng = (dBrng + 90) % 360;\n                    }\n                    else\n                    {\n                        // Rotate -90.\n                        dBrng = (dBrng + 270) % 360;\n                    }\n                    oBufferCoord = oMidPointCoord.destinationPoint(dBrng, oFeature.getAOIBuffer());\n                    break;\n                case emp.typeLibrary.AOIType.BBOX:\n                    oMidPointCoord = oCoordList[1].midPointTo(oCoordList[2]);\n                    dBrng = oCoordList[1].bearingTo(oCoordList[2]);\n                    dBrng = (dBrng + 270) % 360;\n                    oBufferCoord = oMidPointCoord.destinationPoint(dBrng, oFeature.getAOIBuffer());\n                    break;\n            }\n            //oCP = new leafLet.editor.ControlPoint(oFeature,\n            //        leafLet.ControlPoint.Type.AOI_BUFFER,\n            //        oBufferCoord, oMidPointCoord, dBrng, oFeature.getAOIBuffer());\n            //this.addControlPoint(oCP);\n        },\n        removeAllCPByType: function(type)\n        {\n            leafLet.editor.GeoJson.prototype.removeAllCPByType.call(this, type);\n            \n            if (type === leafLet.ControlPoint.Type.NEW_POSITION_CP)\n            {\n                leafLet.editor.GeoJson.prototype.removeAllCPByType.call(this, leafLet.ControlPoint.Type.AOI_BUFFER);\n            }\n        },\n        updateLeafletObject: function()\n        {\n            var oFeature = this.getFeature();\n            \n            oFeature.render();\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n\n            switch(this.getFeature().getAOIType())\n            {\n                case emp.typeLibrary.AOIType.BBOX:\n                    // Can not add points to a BBox.\n                    break;\n                default:\n                    oCP = leafLet.editor.GeoJson.prototype.doAddControlPoint.call(this, oLatLng);\n                    break;\n            }\n            \n            return oCP;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var aRet;\n            var oRefCoord;\n            var dAngle;\n            var dMouseAngle;\n            var dDist;\n            var oNewCoord;\n            var iCoordIndex;\n            var oCoordList;\n            var oTempCP;\n            var oFeature = this.getFeature();\n            \n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.AOI_BUFFER:\n                    // For AOI buufer CPs the index stores the ref point the\n                    // the buffer CP is angled off of.\n                    oRefCoord = oCP.getIndex();\n                    \n                    // The bearing is stored in the sub index.\n                    dAngle = oCP.getSubIndex();\n                    // Get the bearing from the ref point to the mouse position.\n                    dMouseAngle = oRefCoord.bearingTo(oEvent.latlng);\n                    \n                    // Calculate the distance of the ref point to the mouse\n                    // projected it in the direction of dAngleFromRef.\n                    dDist = oRefCoord.distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n\n                    oNewCoord = oRefCoord.destinationPoint(dAngle, dDist);\n                    oCP.setCPPosition(oNewCoord);\n                    oCP.setValue(dDist);\n                    oFeature.setAOIBufferProperty(dDist);\n                    \n                    this.updateLeafletObject();\n                    \n                    aRet = [];\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    switch(oFeature.getAOIType())\n                    {\n                        case emp.typeLibrary.AOIType.POINT_RADIUS:\n                            break;\n                        case emp.typeLibrary.AOIType.LINE:\n                        case emp.typeLibrary.AOIType.POLYGON:\n                            aRet = leafLet.editor.GeoJson.prototype.doControlPointMoved.call(this, oCP, oEvent);\n                            break;\n                        case emp.typeLibrary.AOIType.BBOX:\n                            oCoordList = this.getCoordinateList();\n                            iCoordIndex = oCP.getIndex();\n                            oCoordList[iCoordIndex] = oEvent.latlng;\n                            oCP.setCPPosition(oCoordList[iCoordIndex]);\n                            \n                            switch (iCoordIndex)\n                            {\n                                case 0:\n                                    // The Top left was moved.\n                                    // So we set the long of the bottom left,\n                                    // and the lat of the top right.\n                                    oCoordList[3].lng = oCoordList[0].lng;\n                                    oTempCP = this.getCP(3);\n                                    oTempCP.setCPPosition(oCoordList[3]);\n                                    \n                                    oCoordList[1].lat = oCoordList[0].lat;\n                                    oTempCP = this.getCP(1);\n                                    oTempCP.setCPPosition(oCoordList[1]);\n                                    \n                                    aRet = [0, 1, 3];\n                                    break;\n                                case 1:\n                                    // The Top right was moved.\n                                    // So we set the long of the bottom right,\n                                    // and the lat of the top left.\n                                    oCoordList[2].lng = oCoordList[1].lng;\n                                    oTempCP = this.getCP(2);\n                                    oTempCP.setCPPosition(oCoordList[2]);\n                                    \n                                    oCoordList[0].lat = oCoordList[1].lat;\n                                    oTempCP = this.getCP(0);\n                                    oTempCP.setCPPosition(oCoordList[0]);\n                                    \n                                    aRet = [0, 1, 2];\n                                    break;\n                                case 2:\n                                    // The bottom right was moved.\n                                    // So we set the long of the top right,\n                                    // and the lat of the bottom left.\n                                    oCoordList[1].lng = oCoordList[2].lng;\n                                    oTempCP = this.getCP(1);\n                                    oTempCP.setCPPosition(oCoordList[1]);\n                                    \n                                    oCoordList[3].lat = oCoordList[2].lat;\n                                    oTempCP = this.getCP(3);\n                                    oTempCP.setCPPosition(oCoordList[3]);\n                                    \n                                    aRet = [1, 2, 3];\n                                    break;\n                                case 3:\n                                    // The bottom left was moved.\n                                    // So we set the long of the top left,\n                                    // and the lat of the bottom right.\n                                    oCoordList[0].lng = oCoordList[3].lng;\n                                    oTempCP = this.getCP(0);\n                                    oTempCP.setCPPosition(oCoordList[0]);\n                                    \n                                    oCoordList[2].lat = oCoordList[3].lat;\n                                    oTempCP = this.getCP(2);\n                                    oTempCP.setCPPosition(oCoordList[2]);\n                                    \n                                    aRet = [0, 2, 3];\n                                    break;\n                            }\n                            this.setCoordinates(oCoordList);\n                            this.updateLeafletObject();\n                            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                            this._addNewCP();\n                            break;\n                    }\n                    break;\n                default:\n                    aRet = leafLet.editor.GeoJson.prototype.doControlPointMoved.call(this, oCP, oEvent);\n                    break;\n            }\n            return aRet;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var bRet = false;\n            \n            switch(this.getFeature().getAOIType())\n            {\n                case emp.typeLibrary.AOIType.BBOX:\n                    // Can not delete points from a BBox.\n                    break;\n                default:\n                    bRet = leafLet.editor.GeoJson.prototype.doDeleteControlPoint.call(this, oCP);\n                    break;\n            }\n            return bRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AOI = leafLet.editor.GeoJson.extend(leafLet.internalPrivateClass.AOIEditor());\n","\n/* global leafLet, armyc2, L, emp */\n\nleafLet.internalPrivateClass.KMLEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            var oOptions = {\n            };\n            L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.AbstractEditor.prototype.initialize.call(this, args);\n        },\n        getCoordinateList: function()\n        {\n            return leafLet.utils.kml.convertCoordinatesToLatLng(this.getFeature().getData());\n        },\n        setCoordinates: function(oLatLngList)\n        {\n            var sKML = leafLet.utils.kml.convertLatLngListToKML(this.getFeature().getData(), oLatLngList);\n            this.getFeature().setData(sKML);\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oLeafletObject = this.getLeafletObject();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n            \n            if (oLeafletObject instanceof L.Polygon)\n            {\n                if (oCoordList.length > 2)\n                {\n                    for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                    {\n                        // Lets add the new CP.\n                        oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                        oCP = new leafLet.editor.ControlPoint(oFeature,\n                                leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                                oNewCoord, iIndex, 0, \"\");\n                        this.addControlPoint(oCP);\n                    }\n\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[0].midPointTo(oCoordList[oCoordList.length - 1]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, oCoordList.length, 0);\n                    this.addControlPoint(oCP);\n                }\n            }\n            else if (oLeafletObject instanceof L.Polyline)\n            {\n                if (oCoordList.length > 1)\n                {\n                    for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                    {\n                        // Lets add the new CP.\n                        oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                        oCP = new leafLet.editor.ControlPoint(oFeature,\n                                leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                                oNewCoord, iIndex, 0);\n                        this.addControlPoint(oCP);\n                    }\n                }\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oLeafletObject = this.getLeafletObject();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n            \n            if (oLeafletObject instanceof L.Marker)\n            {\n                // Markers have no control points.\n            }\n            else if ((oLeafletObject instanceof L.Polygon) ||\n                (oLeafletObject instanceof L.Polyline))\n            {\n                for (iIndex = 0; iIndex < oCoordList.length; iIndex++)\n                {\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.POSITION_CP,\n                            oCoordList[iIndex], iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n                this._addNewCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n            \n            if (oLeafletObject instanceof L.Marker)\n            {\n                if (oCoordList.length > 0)\n                {\n                    return undefined;\n                }\n            }\n            else if (oLeafletObject instanceof L.Polygon)\n            {\n            }\n            else if (oLeafletObject instanceof L.Polyline)\n            {\n            }\n\n            if (!(oLeafletObject instanceof L.Marker))\n            {\n                oCP = new leafLet.editor.ControlPoint(this.getFeature(),\n                        leafLet.ControlPoint.Type.POSITION_CP,\n                        oLatLng, oCoordList.length, 0);\n            }\n\n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject();\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this._addNewCP();\n            \n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var bRet = false;\n            var oCoordList = this.getCoordinateList();\n            var iIndex = oCP.getIndex();\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n\n            if (oLeafletObject instanceof L.Polygon)\n            {\n                if (oCoordList.length > 3)\n                {\n                    oCoordList.splice(iIndex, 1);\n                    bRet = true;\n                }\n            }\n            else if (oLeafletObject instanceof L.Polyline)\n            {\n                if (oCoordList.length > 2)\n                {\n                    oCoordList.splice(iIndex, 1);\n                    bRet = true;\n                }\n            }\n            \n            if (bRet)\n            {\n                this.setCoordinates(oCoordList);\n                this.updateLeafletObject();\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n            return bRet;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var oRet = undefined;\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n                    \n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this._issueCPAddEvent(iNewIndex);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position od the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    oRet = [iIndex];\n                    break;\n            }\n            this.updateLeafletObject();\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this._addNewCP();\n            return oRet;\n        },\n        doFeatureMove: function(dBearing, dDistance)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oCPList = this.options.oControlPointList;\n            var oCoord;\n            var iCoordIndex;\n            var oLeafletObject = this.getLeafletObject();\n\n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n            \n            if (oLeafletObject instanceof L.Marker)\n            {\n                oCoord = oCoordList[0];\n                oCoord.moveCoordinate(dBearing, dDistance);\n            }\n            else\n            {\n                for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n                {\n                    iCoordIndex = oCPList[iIndex].getIndex();\n                    oCoord = oCPList[iIndex].getPosition();\n                    oCoord.moveCoordinate(dBearing, dDistance);\n                    oCPList[iIndex].setCPPosition(oCoord);\n                    if (oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP)\n                    {\n                        oCoordList[iCoordIndex] = oCoord;\n                    }\n                }\n            }\n                    \n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject();\n            return true;\n        },\n        updateLeafletObject: function(oCoord)\n        {\n            var oCoordList = oCoord || this.getCoordinateList();\n            var oLeafletObject = this.getLeafletObject();\n            var oMapBounds = this.getLeafletMap().getBounds();\n\n            leafLet.utils.wrapCoordinates(oMapBounds, oCoordList, false);\n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n            \n            if (oLeafletObject instanceof L.Marker)\n            {\n                oLeafletObject.setLatLng(oCoordList[0]);\n            }\n            else if ((oLeafletObject instanceof L.Polygon) ||\n                (oLeafletObject instanceof L.Polyline))\n            {\n                oLeafletObject.setLatLngs(oCoordList);\n            }\n        },\n        convertToUpdateCoordinates: function(oCoordList)\n        {\n            var oUpdateCoordList = leafLet.editor.AbstractEditor.prototype.convertToUpdateCoordinates.call(this, oCoordList);\n            var oLeafletObject = this.getLeafletObject();\n            \n            if (oLeafletObject instanceof L.LayerGroup)\n            {\n                oLeafletObject = oLeafletObject.getLayers()[0];\n            }\n            \n            if (oLeafletObject instanceof L.Polygon)\n            {\n                // For polygon we need to add the first one to the end.\n                if (!isNaN(oCoordList[0].alt))\n                {\n                    oUpdateCoordList.push({\n                        lat: oCoordList[0].lat,\n                        lon: oCoordList[0].lng,\n                        alt: oCoordList[0].alt\n                    });\n                }\n                else\n                {\n                    oUpdateCoordList.push({\n                        lat: oCoordList[0].lat,\n                        lon: oCoordList[0].lng\n                    });\n                }\n            }\n            \n            return oUpdateCoordList;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.KML = leafLet.editor.AbstractEditor.extend(leafLet.internalPrivateClass.KMLEditor());\n","\n/* global leafLet, armyc2, L, emp */\n\nleafLet.internalPrivateClass.AirspaceEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args)\n        {\n            var oOptions = {\n            };\n            L.Util.setOptions(this, oOptions);\n\n            leafLet.editor.AbstractEditor.prototype.initialize.call(this, args);\n        },\n        preapareForDrawOperation: function()\n        {\n            if (this.getFeature() === undefined)\n            {\n                var oGeoJsonData;\n                var cAirspaceType = emp.typeLibrary.airspaceSymbolCode;\n\n                switch (this.options.oEmpDrawEditItem.symbolCode)\n                {\n                    case cAirspaceType.SHAPE3D_CYLINDER:\n                    case cAirspaceType.SHAPE3D_RADARC:\n                        oGeoJsonData = {\n                            symbolCode: this.options.oEmpDrawEditItem.symbolCode,\n                            type: 'Point',\n                            coordinates: []\n                        };\n                        break;\n                    //case cAirspaceType.SHAPE3D_POLYGON:\n                    //case cAirspaceType.SHAPE3D_ORBIT:\n                    //case cAirspaceType.SHAPE3D_ROUTE:\n                    //case cAirspaceType.SHAPE3D_TRACK:\n                    //case cAirspaceType.SHAPE3D_POLYARC:\n                    //case cAirspaceType.SHAPE3D_CURTAIN:\n                    default:\n                        oGeoJsonData = {\n                            symbolCode: this.options.oEmpDrawEditItem.symbolCode,\n                            type: 'LineString',\n                            coordinates: []\n                        };\n                        break;\n                }\n\n                this.options.feature = leafLet.utils.airspace.createAirspace({\n                    item: {\n                        name: this.options.oEmpDrawEditItem.name,\n                        coreId: this.options.oEmpDrawEditItem.coreId,\n                        parentCoreId: this.options.oEmpDrawEditItem.parentCoreId,\n                        visible: true,\n                        featureId: this.options.oEmpDrawEditItem.featureId,\n                        overlayId: this.options.oEmpDrawEditItem.overlayId,\n                        parentId: this.options.oEmpDrawEditItem.parentId,\n                        format: emp3.api.enums.FeatureTypeEnum.GEO_ACM,\n                        data: oGeoJsonData,\n                        properties: this.options.oEmpDrawEditItem.properties\n                    },\n                    instanceInterface: this.getEngineInstanceInterface()\n                });\n                this.addLayer(this.options.feature);\n                this.options.bDestroyFeature = true;\n            }\n            this.preapareForEditOperation();\n        },\n        preapareForEditOperation: function()\n        {\n        },\n        getCoordinateList: function()\n        {\n            return leafLet.utils.geoJson.convertCoordinatesToLatLng(this.getFeature().getData());\n        },\n        setCoordinates: function(oLatLngList)\n        {\n            leafLet.utils.geoJson.convertLatLngListToGeoJson(this.getFeature().getData(), oLatLngList);\n        },\n        updateLeafletObject: function(oCList)\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = oCList || this.getCoordinateList();\n\n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                var oLeafletObject;\n                var cAirspaceType = emp.typeLibrary.airspaceSymbolCode;\n                var oAttributeList = oFeature.getAttributeList();\n\n                oFeature.getProperties()['attributes'] = oAttributeList.getAirspaceAttributeList();\n\n                switch (this.options.oEmpDrawEditItem.symbolCode)\n                {\n                    case cAirspaceType.SHAPE3D_CURTAIN:\n                    case cAirspaceType.SHAPE3D_POLYGON:\n                        var oMapBounds = this.getLeafletMap().getBounds();\n\n                        leafLet.utils.wrapCoordinates(oMapBounds, oCoordList, false);\n                        oLeafletObject = this.getLeafletObject();\n                        oLeafletObject.setLatLngs(oCoordList);\n                        break;\n                    case cAirspaceType.SHAPE3D_CYLINDER:\n                    case cAirspaceType.SHAPE3D_ORBIT:\n                    case cAirspaceType.SHAPE3D_ROUTE:\n                    case cAirspaceType.SHAPE3D_TRACK:\n                    case cAirspaceType.SHAPE3D_RADARC:\n                    case cAirspaceType.SHAPE3D_POLYARC:\n                    default:\n                        oLeafletObject = oFeature._createFeature(oFeature.options);\n                        this.setLeafletObject(oLeafletObject);\n                        break;\n                }\n\n                return true;\n            }\n\n            return false;\n        },\n        doFeatureMove: function(dBearing, dDistance)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oCPList = this.options.oControlPointList;\n            var oCoord;\n            var iCoordIndex;\n\n            for (var iIndex = 0; iIndex < oCPList.length; iIndex++)\n            {\n                iCoordIndex = oCPList[iIndex].getIndex();\n                oCoord = oCPList[iIndex].getPosition();\n                oCoord.moveCoordinate(dBearing, dDistance);\n                oCPList[iIndex].setCPPosition(oCoord);\n                if (oCPList[iIndex].getType() === leafLet.ControlPoint.Type.POSITION_CP)\n                {\n                    oCoordList[iCoordIndex] = oCoord;\n                }\n            }\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject();\n\n            return true;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.Airspace = leafLet.editor.AbstractEditor.extend(leafLet.internalPrivateClass.AirspaceEditor());\n","\n/* global L, leafLet */\n\nleafLet.internalPrivateClass.MilStdDCAutoShapeEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) {\n            var oCoordList;\n            var dDistC1, dDistC2, dDistC3;\n            var Temp;\n            var oBasicCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n            \n            switch (this.getBasicSymbolCode()) {\n                case oBasicCodes.MINIMUM_SAFE_DISTANCE_ZONES:\n                    // The distance between the center (pt0) and\n                    // Pt1 must be less than the distance to pt2 and this\n                    // less than the distance to pt3.\n                    oCoordList = this.getCoordinateList();\n                    dDistC1 = oCoordList[0].distanceTo(oCoordList[1]);\n                    dDistC2 = oCoordList[0].distanceTo(oCoordList[2]);\n                    dDistC3 = oCoordList[0].distanceTo(oCoordList[3]);\n                    if (dDistC1 > dDistC2) {\n                        Temp = oCoordList[1];\n                        oCoordList[1] = oCoordList[2];\n                        oCoordList[2] = Temp;\n                        Temp = dDistC2;\n                        dDistC2 = dDistC1;\n                        dDistC1 = Temp;\n                    }\n                    if (dDistC2 > dDistC3) {\n                        Temp = oCoordList[2];\n                        oCoordList[2] = oCoordList[3];\n                        oCoordList[3] = Temp;\n                        Temp = dDistC3;\n                        dDistC3 = dDistC2;\n                        dDistC2 = Temp;\n                    }\n                    if (dDistC1 > dDistC2) {\n                        Temp = oCoordList[1];\n                        oCoordList[1] = oCoordList[2];\n                        oCoordList[2] = Temp;\n                        Temp = dDistC2;\n                        dDistC2 = dDistC1;\n                        dDistC1 = Temp;\n                    }\n\n                    break;\n            }\n        },\n        assembleControlPoints: function() {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oSymbolDef = this.getSymbolDef();\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            this.updateLeafletObject(oCoordList);\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var oCPPt2, oCPt;\n            var dBearing;\n            var dDist;\n            var iIndex2;\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var oRet = undefined;\n            var oBasicCodes = leafLet.utils.milstd.basicSymbolCode;\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points before and after it.\n                    oRet = [];\n                    \n                    switch (this.getBasicSymbolCode()) {\n                        case oBasicCodes.MINIMUM_SAFE_DISTANCE_ZONES:\n                            if (iIndex === 0) {\n                                // Its the center point.\n                                // We must move all points.\n                                dBearing = oCoordList[0].bearingTo(oEvent.latlng);\n                                dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                                for (iIndex2 = 0; iIndex2 < oCoordList.length; iIndex2++) {\n                                    oRet.push(iIndex2);\n                                    oCoordList[iIndex2].moveCoordinate(dBearing, dDist);\n                                    oCPt = this.getCP(iIndex2);\n                                    oCPt.setCPPosition(oCoordList[iIndex2]);\n                                }\n                            } else if (iIndex === 1) {\n                                // Its pt1. We need to make sure that it does not go beyond pt2.\n                                dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                                if (dDist < oCoordList[0].distanceTo(oCoordList[2])) {\n                                    oRet.push(iIndex);\n                                    oCoordList[iIndex] = oEvent.latlng;\n                                    oCP.setCPPosition(oCoordList[iIndex]);\n                                }\n                            } else if (iIndex === 2) {\n                                // Its pt2. We need to make sure that it does not go beyond pt3 or\n                                // less the pt1.\n                                dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                                if ((dDist < oCoordList[0].distanceTo(oCoordList[3])) &&\n                                        (dDist > oCoordList[0].distanceTo(oCoordList[1]))) {\n                                    oRet.push(iIndex);\n                                    dBearing = oCoordList[0].bearingTo(oEvent.latlng);\n                                    oCoordList[iIndex] = oEvent.latlng;\n                                    oCP.setCPPosition(oCoordList[iIndex]);\n                                }\n                            } else {\n                                // Its pt3. We need to make sure that it does not go less than pt2.\n                                dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                                if (dDist > oCoordList[0].distanceTo(oCoordList[2])) {\n                                    oRet.push(iIndex);\n                                    dBearing = oCoordList[0].bearingTo(oEvent.latlng);\n                                    oCoordList[iIndex] = oEvent.latlng;\n                                    oCP.setCPPosition(oCoordList[iIndex]);\n                                }\n                            }\n                            break;\n                        default:\n                            oRet.push(iIndex);\n                            if ((iIndex === 0) && (oCoordList.length === 2))\n                            {\n                                // If Pt1 is moved we need to move Pt2 relative to Pt1.\n                                oCPPt2 = this.getCP(1);\n                                dBearing = oCoordList[0].bearingTo(oEvent.latlng);\n                                dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                                // Now move Pt1\n                                oCoordList[iIndex].lat = oEvent.latlng.lat;\n                                oCoordList[iIndex].lng = oEvent.latlng.lng;\n                                // And now move Pt2 relative to Pt1\n                                oCoordList[1].moveCoordinate(dBearing, dDist);\n                                oCPPt2.setCPPosition(oCoordList[1]);\n                                oRet.push(1);\n                            }\n                            else\n                            {\n                                oCoordList[iIndex].lat = oEvent.latlng.lat;\n                                oCoordList[iIndex].lng = oEvent.latlng.lng;\n                            }\n\n                            oCP.setCPPosition(oCoordList[iIndex]);\n                            break;\n                    }\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCAutoShape = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCAutoShapeEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.MilStdDCCircularAutoShapeEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        _addRadiusCP: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var oCP;\n            var oCPPosition;\n            var dRange;\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                if (oModifiers.getAMValueCount() > 0)\n                {\n                    dRange = oModifiers.getAMValue(0);\n\n                    // Place the Range CP.\n                    oCPPosition = oCoordList[0].destinationPoint(90, dRange);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.RADIUS_CP,\n                        oCPPosition, 0, 90, dRange);\n                    this.addControlPoint(oCP);\n                }\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oCoordList[0], 0, 0);\n                \n            this.addControlPoint(oCP);\n            \n            this._addRadiusCP(oCoordList);\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            //var oModifiers = oFeature.getMilStdModifiers();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n            \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this._addRadiusCP(oCoordList);\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var dMouseAngle;\n            var dAngle;\n            var dNextRange = Number.MAX_VALUE;\n            var dDist;\n            var oCPPos;\n            var dPrevRange = 0;\n            var oRet = undefined;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var iCPIndex = oCP.getIndex();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length < oSymbolDef.minPoints)\n            {\n                return undefined;\n            }\n\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    oCoordList[0].lat = oEvent.latlng.lat;\n                    oCoordList[0].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[0]);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n                    this._addRadiusCP(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.RADIUS_CP:\n                    dAngle = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n                    \n                    oModifiers.setAMValue(iCPIndex, dDist);\n                    oCPPos = oCoordList[0].destinationPoint(dAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dDist);\n\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCCircularAutoShape = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCCircularAutoShapeEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.MilStdDCCircularRangeFanEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        _addRangeCPs: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var oAMList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.DISTANCE];\n            var oCP;\n            var oCPPosition;\n            var dRange;\n            var iANIndex = 0;\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                for (var iIndex = 0; iIndex < oAMList.length; iIndex++)\n                {\n                    dRange = oAMList[iIndex];\n\n                    // Place the Range CP.\n                    oCPPosition = oCoordList[0].destinationPoint(0, dRange);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.RANGE_CP,\n                        oCPPosition, iIndex, 0, dRange);\n                    this.addControlPoint(oCP);\n                }\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oCoordList[0], 0, 0);\n                \n            this.addControlPoint(oCP);\n            \n            this._addRangeCPs(oCoordList);\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                // With these we add new ranges.\n                var oAMList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.DISTANCE];\n                var dDist = oCoordList[0].distanceTo(oLatLng);\n                var iIndex;\n                var iAMCnt = oModifiers.getAMValueCount();\n\n                if (iAMCnt === 3)\n                {\n                    return undefined;\n                }\n                \n                for (iIndex = 0; iIndex < iAMCnt; iIndex++)\n                {\n                    if (dDist < oModifiers.getAMValue(iIndex))\n                    {\n                        break;\n                    }\n                }\n\n                oAMList.splice(iIndex, 0, dDist);\n                \n                this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                this.updateLeafletObject(oCoordList);\n                this._addRangeCPs(oCoordList);\n                this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n            \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this._addRangeCPs(oCoordList);\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP) {\n/*\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var oAMList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.DISTANCE];\n            var iIndex = oCP.getIndex();\n            \n            // We only delete range CPs and azimuth that create a minimum range.\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.RANGE_CP:\n                    if (oAMList.length > 1)\n                    {\n                        oAMList.splice(iIndex, 1);\n                        \n                        this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                        this.updateLeafletObject(oCoordList);\n                        this._addRangeCPs(oCoordList);\n                        this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    }\n                    break;\n            }\n            return false;\n*/\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var dMouseAngle;\n            var dAngle;\n            var dNextRange = Number.MAX_VALUE;\n            var dDist;\n            var oCPPos;\n            var dPrevRange = 0;\n            var oRet = undefined;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var iCPIndex = oCP.getIndex();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length < oSymbolDef.minPoints)\n            {\n                return undefined;\n            }\n\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    oCoordList[0].lat = oEvent.latlng.lat;\n                    oCoordList[0].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[0]);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                    this._addRangeCPs(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.RANGE_CP:\n                    dAngle = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n                    \n                    // Get the previous range\n                    if (iCPIndex > 0)\n                    {\n                        dPrevRange = oModifiers.getAMValue(iCPIndex - 1);\n                    }\n                    \n                    // Get the next range\n                    if ((iCPIndex + 1) < oModifiers.getAMValueCount())\n                    {\n                        dNextRange = oModifiers.getAMValue(iCPIndex + 1);\n                    }\n                    \n                    if ((dPrevRange < dDist) && (dDist < dNextRange))\n                    {\n                        oModifiers.setAMValue(iCPIndex, dDist);\n                        oCPPos = oCoordList[0].destinationPoint(dAngle, dDist);\n                        oCP.setCPPosition(oCPPos);\n                        oCP.setValue(dDist);\n                        \n                        this.setCoordinates(oCoordList);\n                        this.updateLeafletObject(oCoordList);\n                        this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    }\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCCircularRangeFan = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCCircularRangeFanEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.MilStdDCLineEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        preapareForDrawOperation: function()\n        {\n            if (this.getFeature() === undefined)\n            {\n                var oGeoJsonData = {\n                    symbolCode: this.options.oEmpDrawEditItem.symbolCode,\n                    type: 'LineString',\n                    coordinates: []\n                };\n\n                this.options.feature = new leafLet.typeLibrary.MilStdFeature({\n                    item: {\n                        name: this.options.oEmpDrawEditItem.name,\n                        coreId: this.options.oEmpDrawEditItem.coreId,\n                        parentCoreId: this.options.oEmpDrawEditItem.parentCoreId,\n                        privateInterface: this.options.instanceInterface,\n                        visible: true,\n                        featureId: this.options.oEmpDrawEditItem.featureId,\n                        overlayId: this.options.oEmpDrawEditItem.overlayId,\n                        parentId: this.options.oEmpDrawEditItem.parentId,\n                        format: emp.typeLibrary.featureFormatType.MILSTD,\n                        data: oGeoJsonData,\n                        properties: this.options.oEmpDrawEditItem.properties\n                    },\n                    instanceInterface: this.options.instanceInterface\n                });\n                this.addLayer(this.options.feature);\n                this.options.bDestroyFeature = true;\n            }\n            this.preapareForEditOperation();\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length > 2)\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            //var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length <= oSymbolDef.minPoints)\n            {\n                return false;\n            }\n            \n            oCoordList.splice(iIndex, 1);\n            this.setCoordinates(oCoordList);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this.updateLeafletObject(oCoordList);\n            this._addNewCP();\n            \n            return true;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n\n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._issueCPAddEvent(iNewIndex);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCLine = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCLineEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.MilStdDCPolygonEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        preapareForDrawOperation: function()\n        {\n            if (this.getFeature() === undefined)\n            {\n                var oGeoJsonData = {\n                    symbolCode: this.options.oEmpDrawEditItem.symbolCode,\n                    type: 'LineString',\n                    coordinates: []\n                };\n\n                this.options.feature = new leafLet.typeLibrary.MilStdFeature({\n                    item: {\n                        name: this.options.oEmpDrawEditItem.name,\n                        coreId: this.options.oEmpDrawEditItem.coreId,\n                        parentCoreId: this.options.oEmpDrawEditItem.parentCoreId,\n                        visible: true,\n                        featureId: this.options.oEmpDrawEditItem.featureId,\n                        overlayId: this.options.oEmpDrawEditItem.overlayId,\n                        parentId: this.options.oEmpDrawEditItem.parentId,\n                        format: emp.typeLibrary.featureFormatType.MILSTD,\n                        data: oGeoJsonData,\n                        properties: this.options.oEmpDrawEditItem.properties\n                    },\n                    instanceInterface: this.options.instanceInterface\n                });\n                this.addLayer(this.options.feature);\n                this.options.bDestroyFeature = true;\n            }\n            this.preapareForEditOperation();\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length > 2)\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n\n                // Lets add the new CP.\n                oNewCoord = oCoordList[0].midPointTo(oCoordList[oCoordList.length - 1]);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                        oNewCoord, oCoordList.length, 0);\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length <= oSymbolDef.minPoints)\n            {\n                return false;\n            }\n            \n            oCoordList.splice(iIndex, 1);\n            this.setCoordinates(oCoordList);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this.updateLeafletObject();\n            this._addNewCP();\n            \n            return true;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n\n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._issueCPAddEvent(iNewIndex);\n                    return undefined;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCPolygon = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCPolygonEditor());\n","\n/* global L, leafLet */\n\nleafLet.internalPrivateClass.MilStdDCRectParamAutoShapeEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        _addWidthCP: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                var oWidthPoint;\n                var oFeature = this.getFeature();\n                var oModifiers = oFeature.getMilStdModifiers();\n                var dWidth = oModifiers.getAMValue(1);\n                var dAngle = (oModifiers.getANValue(0) + 0) % 360;\n\n                oWidthPoint = oCoordList[0].destinationPoint(dAngle, dWidth / 2.0);\n                \n                var oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.WIDTH_CP,\n                    oWidthPoint, 0, 0, dWidth);\n\n                this.addControlPoint(oCP);\n            }\n        },\n        _addLengthCP: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                var oLengthPoint;\n                var oFeature = this.getFeature();\n                var oModifiers = oFeature.getMilStdModifiers();\n                var dLength = oModifiers.getAMValue(0);\n                var dAngle = (oModifiers.getANValue(0) + 90) % 360;\n\n                oLengthPoint = oCoordList[0].destinationPoint(dAngle, dLength / 2.0);\n                \n                var oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.LENGTH_CP,\n                    oLengthPoint, 0, 0, dLength);\n\n                this.addControlPoint(oCP);\n            }\n        },\n        _addAttitudeCP: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                var oAttitudePoint;\n                var oFeature = this.getFeature();\n                var oModifiers = oFeature.getMilStdModifiers();\n                var dWidth = Math.round(oModifiers.getAMValue(0) / 2.0);\n                var dAngle = oModifiers.getANValue(0);\n                oAttitudePoint = oCoordList[0].destinationPoint((dAngle + 270) % 360, dWidth);\n                \n                var oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.ATTITUDE_CP,\n                    oAttitudePoint, 0, 0, dAngle);\n\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oCoordList[0], 0, 0);\n                \n            this.addControlPoint(oCP);\n            \n            this._addWidthCP(oCoordList);\n            this._addLengthCP(oCoordList);\n            this._addAttitudeCP(oCoordList);\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n            \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this._addWidthCP(oCoordList);\n                this._addLengthCP(oCoordList);\n                this._addAttitudeCP(oCoordList);\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var oWidthPoint;\n            var dWidth;\n            var dAngle;\n            var dMouseAngle;\n            var oAttitudePoint;\n            var oLengthPoint;\n            var dLength;\n            var oRet = undefined;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length < oSymbolDef.minPoints)\n            {\n                return undefined;\n            }\n\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    oCoordList[0].lat = oEvent.latlng.lat;\n                    oCoordList[0].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[0]);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LENGTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.ATTITUDE_CP);\n                    this._addWidthCP(oCoordList);\n                    this._addLengthCP(oCoordList);\n                    this._addAttitudeCP(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.WIDTH_CP:\n                    dAngle = (oModifiers.getANValue(0) + 0) % 360;\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dWidth = oCoordList[0].distanceTo(oEvent.latlng) * 2;\n                    dWidth = Math.abs(Math.round(dWidth * Math.cos((dMouseAngle - dAngle).toRad())));\n                    oWidthPoint = oCoordList[0].destinationPoint(dAngle, dWidth / 2.0);\n                    oModifiers.setAMValue(1, dWidth);\n                    oCP.setValue(dWidth);\n                    oCP.setCPPosition(oWidthPoint);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.LENGTH_CP:\n                    dAngle = (oModifiers.getANValue(0) + 90) % 360;\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dLength = oCoordList[0].distanceTo(oEvent.latlng) * 2;\n                    dLength = Math.abs(Math.round(dLength * Math.cos((dMouseAngle - dAngle).toRad())));\n                    oLengthPoint = oCoordList[0].destinationPoint(dAngle, dLength / 2.0);\n                    oModifiers.setAMValue(0, dLength);\n                    oCP.setValue(dLength);\n                    oCP.setCPPosition(oLengthPoint);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.ATTITUDE_CP);\n                    this._addAttitudeCP(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.ATTITUDE_CP:\n                    dLength = oModifiers.getAMValue(0) / 2.0;\n                    dAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    oAttitudePoint = oCoordList[0].destinationPoint(dAngle, dLength);\n                    dAngle = (dAngle + 90) % 360;\n                    oModifiers.setANValue(0, dAngle);\n                    oCP.setValue(dAngle);\n                    oCP.setCPPosition(oAttitudePoint);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LENGTH_CP);\n                    this._addWidthCP(oCoordList);\n                    this._addLengthCP(oCoordList);\n                    oRet = [0];\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCRectParamAutoShape = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCRectParamAutoShapeEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.MilStdDCRouteEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        preapareForDrawOperation: function()\n        {\n            if (this.getFeature() === undefined)\n            {\n                var oGeoJsonData = {\n                    symbolCode: this.options.oEmpDrawEditItem.symbolCode,\n                    type: 'LineString',\n                    coordinates: []\n                };\n\n                this.options.feature = new leafLet.typeLibrary.MilStdFeature({\n                    item: {\n                        name: this.options.oEmpDrawEditItem.name,\n                        coreId: this.options.oEmpDrawEditItem.coreId,\n                        parentCoreId: this.options.oEmpDrawEditItem.parentCoreId,\n                        visible: true,\n                        featureId: this.options.oEmpDrawEditItem.featureId,\n                        overlayId: this.options.oEmpDrawEditItem.overlayId,\n                        parentId: this.options.oEmpDrawEditItem.parentId,\n                        format: emp.typeLibrary.featureFormatType.MILSTD,\n                        data: oGeoJsonData,\n                        properties: this.options.oEmpDrawEditItem.properties\n                    },\n                    instanceInterface: this.options.instanceInterface\n                });\n                this.addLayer(this.options.feature);\n                this.options.bDestroyFeature = true;\n            }\n            this.preapareForEditOperation();\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length < 3)\n            {\n                return;\n            }\n            \n            for (iIndex = 1; iIndex < oCoordList.length - 1; iIndex++)\n            {\n                // Lets add the new CP.\n                oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                        oNewCoord, iIndex, 0);\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length < oSymbolDef.minPoints)\n            {\n                iIndex = oCoordList.length;\n                oCoordList.push(oLatLng);\n            }\n            else\n            {\n                // The last point must remain the last.\n                iIndex = oCoordList.length - 1;\n                oCoordList.splice(iIndex, 0, oLatLng);\n            }\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, iIndex, 0);\n                \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length <= oSymbolDef.minPoints)\n            {\n                return false;\n            }\n            \n            if (iIndex === oCoordList.length - 1)\n            {\n                // The last point can not be deleted.\n                return false;\n            }\n            \n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            oCoordList.splice(iIndex, 1);\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject(oCoordList);\n            this._addNewCP();\n            \n            return true;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n\n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._issueCPAddEvent(iNewIndex);\n                    return undefined;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCRoute = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCRouteEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.MilStdDCSectorParamAutoShapeEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        _addRangeCPs: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var oAMList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.DISTANCE];\n            var oANList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.AZIMUTH];\n            var oCP;\n            var oCPPosition;\n            var dRange;\n            var iANIndex = 0;\n            var bMinimumRange = false;\n            var dLeftAzimuth;\n            var dRightAzimuth;\n            var dMidAzimuth;\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                if ((oAMList.length * 2) > oANList.length)\n                {\n                    // There is a minimum range.\n                    bMinimumRange = true;\n                }\n                \n                for (var iIndex = 0; (iIndex < oAMList.length) && (iANIndex < oANList.length); iIndex++)\n                {\n                    dRange = oAMList[iIndex];\n                    dLeftAzimuth = oANList[iANIndex];\n                    dRightAzimuth = oANList[iANIndex + 1];\n\n                    // Place the Range CP.\n                    dMidAzimuth = (dLeftAzimuth + dRightAzimuth) / 2.0;\n                    \n                    if (dLeftAzimuth > dRightAzimuth)\n                    {\n                        dMidAzimuth = (dMidAzimuth + 180) % 360;\n                    }\n                    \n                    oCPPosition = oCoordList[0].destinationPoint(dMidAzimuth, dRange);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.RANGE_CP,\n                        oCPPosition, iIndex, dMidAzimuth, dRange);\n                    this.addControlPoint(oCP);\n\n                    // See if there are azimuth CP in this range.\n                    if (!bMinimumRange || (iIndex !== 0))\n                    {\n                        // There are no azimuth CP in minimum range.\n                        iANIndex += 2;\n                    }\n                }\n            }\n        },\n        _addAzimuthCPs: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var oAMList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.DISTANCE];\n            var oANList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.AZIMUTH];\n            var oCP;\n            var oCPPosition;\n            var dRange;\n            var dPrevRange = 0;\n            var dAzimuthCPDist;\n            var iANIndex = 0;\n            var bMinimumRange = false;\n            var dLeftAzimuth;\n            var dRightAzimuth;\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                if ((oAMList.length * 2) > oANList.length)\n                {\n                    // There is a minimum range.\n                    bMinimumRange = true;\n                }\n                \n                for (var iIndex = 0; (iIndex < oAMList.length) && (iANIndex < oANList.length); iIndex++)\n                {\n                    dRange = oAMList[iIndex];\n                    dLeftAzimuth = oANList[iANIndex];\n                    dRightAzimuth = oANList[iANIndex + 1];\n\n                    // See if there are azimuth CP in this range.\n                    if (bMinimumRange && (iIndex === 0))\n                    {\n                        // There are no azimuth CP in minimum range.\n                        dPrevRange = dRange;\n                        continue;\n                    }\n\n                    dAzimuthCPDist = ((dRange - dPrevRange) / 2.0) + dPrevRange;\n\n                    // Place The left Azimuth point.\n                    oCPPosition = oCoordList[0].destinationPoint(dLeftAzimuth, dAzimuthCPDist);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.AZIMUTH_CP,\n                        oCPPosition, iANIndex, dAzimuthCPDist, dLeftAzimuth);\n                    this.addControlPoint(oCP);\n\n\n                    // Place The right Azimuth point.\n                    oCPPosition = oCoordList[0].destinationPoint(dRightAzimuth, dAzimuthCPDist);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.AZIMUTH_CP,\n                        oCPPosition, iANIndex + 1, dAzimuthCPDist, dRightAzimuth);\n                    this.addControlPoint(oCP);\n                    \n                    iANIndex += 2;\n                    dPrevRange = dRange;\n                }\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oCoordList[0], 0, 0);\n                \n            this.addControlPoint(oCP);\n            \n            this._addRangeCPs(oCoordList);\n            this._addAzimuthCPs(oCoordList);\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var iAzimuthIndex;\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                // With these we add new ranges.\n                var oAMList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.DISTANCE];\n                var oANList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.AZIMUTH];\n                var dDist = oCoordList[0].distanceTo(oLatLng);\n                var iIndex;\n                var iAMCnt = oModifiers.getAMValueCount();\n                var dLeftAzimuth;\n                var dRightAzimuth;\n                var bMinimumRange = false;\n\n                if ((oAMList.length * 2) > oANList.length)\n                {\n                    // There is a minimum range.\n                    bMinimumRange = true;\n                }\n\n                for (iIndex = 0; iIndex < iAMCnt; iIndex++)\n                {\n                    if (dDist < oModifiers.getAMValue(iIndex))\n                    {\n                        break;\n                    }\n                }\n\n                iAzimuthIndex = 0;\n\n                oAMList.splice(iIndex, 0, dDist);\n                dLeftAzimuth = oModifiers.getANValue(iAzimuthIndex);\n                dRightAzimuth = oModifiers.getANValue(iAzimuthIndex + 1);\n                \n                if ((iAzimuthIndex + 2) < oModifiers.getANValueCount())\n                {\n                    iAzimuthIndex += 2;\n                }\n                \n                oANList.splice(iAzimuthIndex, 0, dLeftAzimuth);\n                oANList.splice(iAzimuthIndex + 1, 0, dRightAzimuth);\n                \n                this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                this.removeAllCPByType(leafLet.ControlPoint.Type.AZIMUTH_CP);\n                this.updateLeafletObject(oCoordList);\n                this._addRangeCPs(oCoordList);\n                this._addAzimuthCPs(oCoordList);\n                this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n            \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this._addRangeCPs(oCoordList);\n                this._addAzimuthCPs(oCoordList);\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var oAMList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.DISTANCE];\n            var oANList = oModifiers.oModifiers[leafLet.utils.milstd.Modifiers.AZIMUTH];\n            var iIndex = oCP.getIndex();\n            var bMinimumRange = false;\n            var iAzimuthIndex;\n            \n            if ((oAMList.length * 2) > oANList.length)\n            {\n                // There is a minimum range.\n                bMinimumRange = true;\n            }\n                \n            // We only delete range CPs and azimuth that create a minimum range.\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.RANGE_CP:\n                    if (oAMList.length > 1)\n                    {\n                        oAMList.splice(iIndex, 1);\n                        \n                        if (!bMinimumRange)\n                        {\n                            // Remove the azimuth for the range.\n                            iAzimuthIndex = iIndex * 2;\n                            oANList.splice(iAzimuthIndex, 1);\n                            oANList.splice(iAzimuthIndex, 1);\n                        }\n                        else if ((iIndex !== 0) && (oANList.length > 2))\n                        {\n                            iAzimuthIndex = (iIndex - 1) * 2;\n                            oANList.splice(iAzimuthIndex, 1);\n                            oANList.splice(iAzimuthIndex, 1);\n                        }\n                        \n                        this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                        this.removeAllCPByType(leafLet.ControlPoint.Type.AZIMUTH_CP);\n                        this.updateLeafletObject(oCoordList);\n                        this._addRangeCPs(oCoordList);\n                        this._addAzimuthCPs(oCoordList);\n                        this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    }\n                    break;\n                case leafLet.ControlPoint.Type.AZIMUTH_CP:\n                    if ((oANList.length > 2) && !bMinimumRange)\n                    {\n                        // We can only delete the first two azimuth if there are more azimuth\n                        // and the feature does not have a minimum range.\n                        if (iIndex < 2)\n                        {\n                            oANList.splice(0, 1);\n                            oANList.splice(0, 1);\n                            this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                            this.removeAllCPByType(leafLet.ControlPoint.Type.AZIMUTH_CP);\n                            this.updateLeafletObject(oCoordList);\n                            this._addRangeCPs(oCoordList);\n                            this._addAzimuthCPs(oCoordList);\n                            this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                        }\n                    }\n                    break;\n            }\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var dMouseAngle;\n            var dAngle;\n            var dNextRange = Number.MAX_VALUE;\n            var dDist;\n            var oCPPos;\n            var dPrevRange = 0;\n            var oRet = undefined;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var oModifiers = oFeature.getMilStdModifiers();\n            var iCPIndex = oCP.getIndex();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length < oSymbolDef.minPoints)\n            {\n                return undefined;\n            }\n\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    oCoordList[0].lat = oEvent.latlng.lat;\n                    oCoordList[0].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[0]);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.AZIMUTH_CP);\n                    this._addRangeCPs(oCoordList);\n                    this._addAzimuthCPs(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.RANGE_CP:\n                    dAngle = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n                    \n                    // Get the previous range\n                    if (iCPIndex > 0)\n                    {\n                        dPrevRange = oModifiers.getAMValue(iCPIndex - 1);\n                    }\n                    \n                    // Get the next range\n                    if ((iCPIndex + 1) < oModifiers.getAMValueCount())\n                    {\n                        dNextRange = oModifiers.getAMValue(iCPIndex + 1);\n                    }\n                    \n                    if ((dPrevRange < dDist) && (dDist < dNextRange))\n                    {\n                        oModifiers.setAMValue(iCPIndex, dDist);\n                        oCPPos = oCoordList[0].destinationPoint(dAngle, dDist);\n                        oCP.setCPPosition(oCPPos);\n                        oCP.setValue(dDist);\n                        \n                        this.setCoordinates(oCoordList);\n                        this.updateLeafletObject(oCoordList);\n                        this.removeAllCPByType(leafLet.ControlPoint.Type.AZIMUTH_CP);\n                        this._addAzimuthCPs(oCoordList);\n                        oRet = [0];\n                    }\n                    break;\n                case leafLet.ControlPoint.Type.AZIMUTH_CP:\n                    dDist = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    oCPPos = oCoordList[0].destinationPoint(dMouseAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dMouseAngle);\n                    oModifiers.setANValue(iCPIndex, dMouseAngle);\n\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RANGE_CP);\n                    this._addRangeCPs(oCoordList);\n                    oRet = [0];\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCSectorParamAutoShape = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCSectorParamAutoShapeEditor());\n","\n/* global L, leafLet, armyc2, Infinity */\n\nleafLet.internalPrivateClass.MilStdDCSuperAutoShapeEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        _createWidthCP: function(oCoordList)\n        {\n            var oCP;\n            var oFeature = this.getFeature();\n            var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n            var dBearingPt1Pt2 = oCoordList[0].bearingTo(oCoordList[1]);\n            var dBearingWLine = (dBearingPt1Pt2 + 270.0) % 360;\n            var oIntPoint = oCoordList[0].intersectLines(dBearingPt1Pt2, oCoordList[2], dBearingWLine);\n\n            if (!oIntPoint)\n            {\n                dBearingWLine = (dBearingWLine + 180.0) % 360;\n                oIntPoint = oCoordList[0].intersectLines(dBearingPt1Pt2, oCoordList[2], dBearingWLine);\n            }\n            if (!oIntPoint)\n            {\n                dBearingPt1Pt2 = (dBearingPt1Pt2 + 180.0) % 360;\n                oIntPoint = oCoordList[0].intersectLines(dBearingPt1Pt2, oCoordList[2], dBearingWLine);\n            }\n            if (!oIntPoint)\n            {\n                dBearingWLine = (dBearingWLine + 180.0) % 360;\n                oIntPoint = oCoordList[0].intersectLines(dBearingPt1Pt2, oCoordList[2], dBearingWLine);\n            }\n            if (oIntPoint)\n            {\n                // oIntPoint should never be undefined.\n                var dWidth = Math.round(oCoordList[2].distanceTo(oIntPoint));\n\n                if (sBasicSymbolCode === oBasicSymbolCodes.ROADBLOCK_COMPLETE_EXECUTED)\n                {\n                    dWidth *= 2;\n                }\n\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.WIDTH_CP,\n                    oCoordList[2], 2, 0, dWidth);\n            }\n            \n            return oCP;\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                if ((iIndex === 2) &&\n                    (\n                        (sBasicSymbolCode === oBasicSymbolCodes.FORD_EASY) ||\n                        (sBasicSymbolCode === oBasicSymbolCodes.FORD_DIFFICULT) ||\n                        (sBasicSymbolCode === oBasicSymbolCodes.ROADBLOCK_COMPLETE_EXECUTED)\n                    ))\n                {\n                    oCP = this._createWidthCP(oCoordList);\n                }\n                else\n                {\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.POSITION_CP,\n                        oCoordList[iIndex], iIndex, 0);\n                }\n\n                this.addControlPoint(oCP);\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            if ((oCoordList.length === 3) &&\n                (\n                    (sBasicSymbolCode === oBasicSymbolCodes.FORD_EASY) ||\n                    (sBasicSymbolCode === oBasicSymbolCodes.FORD_DIFFICULT) ||\n                    (sBasicSymbolCode === oBasicSymbolCodes.ROADBLOCK_COMPLETE_EXECUTED)\n                ))\n            {\n                oCP = this._createWidthCP(oCoordList);\n            }\n            else\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oLatLng, oCoordList.length - 1, 0);\n            }\n            \n            this.updateLeafletObject();\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var iIndex = oCP.getIndex();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n\n            if (oCoordList.length <= oSymbolDef.minPoints)\n            {\n                return false;\n            }\n\n            oCoordList.splice(iIndex, 1);\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject(oCoordList);\n            \n            return true;\n        },\n        _moveFordCP: function(oCP, oEvent)\n        {\n            var oMidPoint;\n            var dDist;\n            var dBearingMidPt3;\n            var dNewBearingMidPt3;\n            var dBearingPt1Pt2;\n            var dNewBearingPt1Pt2;\n            var oCP3;\n            var Pt3Coord;\n            var oRet = undefined;\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n            \n            switch (iIndex)\n            {\n                case 0:\n                case 1:\n                    oRet = [iIndex];\n\n                    if (oCoordList.length > 2)\n                    {\n                        // Get the bearing between pt1 pt2, and the mid point.\n                        dBearingPt1Pt2 = oCoordList[0].bearingTo(oCoordList[1]);\n                        oMidPoint = this.getCenterPT(oCoordList[0], oCoordList[1]);\n                        // Get the distance from the mid point to pt3 (the arrow).\n                        dDist = oMidPoint.distanceTo(oCoordList[2]);\n                        if ((dDist < 20.0) || isNaN(dDist) || (dDist === Infinity)) {\n                            return [];\n                        }\n                        // Get the bearing from the mid point and pt3.\n                        dBearingMidPt3 = oMidPoint.bearingTo(oCoordList[2]);\n                        // Update the coordinates of th CP that was moved.\n                        oCoordList[iIndex].lat = oEvent.latlng.lat;\n                        oCoordList[iIndex].lng = oEvent.latlng.lng;\n                        oCP.setCPPosition(oCoordList[iIndex]);\n                        // Now get the new bearing of pt1 pt2. And the new mid point.\n                        dNewBearingPt1Pt2 = oCoordList[0].bearingTo(oCoordList[1]);\n                        oMidPoint = this.getCenterPT(oCoordList[0], oCoordList[1]);\n                        // Compute the new bearing of pt3. And get the coordinates.\n                        dNewBearingMidPt3 = dBearingMidPt3 + (dNewBearingPt1Pt2 - dBearingPt1Pt2);\n                        Pt3Coord = oMidPoint.destinationPoint(dNewBearingMidPt3, dDist);\n                        // Update the CP, the coordinates and the object.\n                        oCoordList[2].lat = Pt3Coord.lat;\n                        oCoordList[2].lng = Pt3Coord.lng;\n                        oCP3 = this.getCP(2);\n                        oCP3.setCPPosition(oCoordList[2]);\n                        oRet.push(2);\n                    }\n                    else\n                    {\n                        // Update the coordinates of th CP that was moved.\n                        oCoordList[iIndex].lat = oEvent.latlng.lat;\n                        oCoordList[iIndex].lng = oEvent.latlng.lng;\n                        oCP.setCPPosition(oCoordList[iIndex]);\n                    }\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    break;\n                case 2:\n                    // Get the mid point.\n                    oMidPoint = this.getCenterPT(oCoordList[0], oCoordList[1]);\n                    // Get the bearing from the mid point and pt3.\n                    dBearingMidPt3 = oMidPoint.bearingTo(oCoordList[2]);\n                    var dBearingMidMouse = oMidPoint.bearingTo(oEvent.latlng);\n                    // Get the distance from the mid point to the mouse.\n                    dDist = oMidPoint.distanceTo(oEvent.latlng);\n                    // Project the MP-Mouse line onto the Mid Pt Pt3 line;\n                    dDist = Math.round(dDist * (Math.cos((dBearingMidMouse - dBearingMidPt3).toRad())));\n                    // Calculate the new position of Pt3.\n                    Pt3Coord = oMidPoint.destinationPoint(dBearingMidPt3, dDist);\n\n                    oCoordList[iIndex].lat = Pt3Coord.lat;\n                    oCoordList[iIndex].lng = Pt3Coord.lng;\n\n                    if (sBasicSymbolCode === oBasicSymbolCodes.ROADBLOCK_COMPLETE_EXECUTED)\n                    {\n                        dDist *= 2;\n                    }\n                    \n                    oCP.setValue(dDist);\n\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    oRet = [iIndex];\n                    break;\n            }\n\n            return oRet;\n        },\n        _moveBlockCP: function(oCP, oEvent)\n        {\n            var oMidPoint;\n            var dDist;\n            var dBearingMidPt3;\n            var dNewBearingMidPt3;\n            var dBearingPt1Pt2;\n            var dNewBearingPt1Pt2;\n            var oCP3;\n            var Pt3Coord;\n            var oRet = undefined;\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (iIndex)\n            {\n                case 0:\n                case 1:\n                    oRet = [iIndex];\n\n                    if (oCoordList.length > 2)\n                    {\n                        // Get the bearing between pt1 pt2, and the mid point.\n                        dBearingPt1Pt2 = oCoordList[0].bearingTo(oCoordList[1]);\n                        oMidPoint = this.getCenterPT(oCoordList[0], oCoordList[1]);\n                        // Get the distance from the mid point to pt3 (the arrow).\n                        dDist = oMidPoint.distanceTo(oCoordList[2]);\n                        \n                        if ((dDist < 20.0) || isNaN(dDist) || (dDist === Infinity)) {\n                            return [];\n                        }\n                        // Get the bearing from the mid point and pt3.\n                        dBearingMidPt3 = oMidPoint.bearingTo(oCoordList[2]);\n                        // Update the coordinates of th CP that was moved.\n                        oCoordList[iIndex].lat = oEvent.latlng.lat;\n                        oCoordList[iIndex].lng = oEvent.latlng.lng;\n                        oCP.setCPPosition(oCoordList[iIndex]);\n                        // Now get the new bearing of pt1 pt2. And the new mid point.\n                        dNewBearingPt1Pt2 = oCoordList[0].bearingTo(oCoordList[1]);\n                        oMidPoint = this.getCenterPT(oCoordList[0], oCoordList[1]);\n                        // Compute the new bearing of pt3. And get the coordinates.\n                        dNewBearingMidPt3 = dBearingMidPt3 + (dNewBearingPt1Pt2 - dBearingPt1Pt2);\n                        Pt3Coord = oMidPoint.destinationPoint(dNewBearingMidPt3, dDist);\n                        // Update the CP, the coordinates and the object.\n                        oCoordList[2].lat = Pt3Coord.lat;\n                        oCoordList[2].lng = Pt3Coord.lng;\n                        oCP3 = this.getCP(2);\n                        oCP3.setCPPosition(oCoordList[2]);\n                        oRet.push(2);\n                    }\n                    else\n                    {\n                        oCoordList[iIndex].lat = oEvent.latlng.lat;\n                        oCoordList[iIndex].lng = oEvent.latlng.lng;\n                        oCP.setCPPosition(oCoordList[iIndex]);\n                    }\n                    \n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    break;\n                case 2:\n                    // Get the bearing between Pt1 and Pt2.\n                    dBearingPt1Pt2 = oCoordList[0].bearingTo(oCoordList[1]);\n                    dBearingPt1Pt2 = ((dBearingPt1Pt2 > 180)? dBearingPt1Pt2 - 360: dBearingPt1Pt2);\n                    // Get the mid point.\n                    oMidPoint = this.getCenterPT(oCoordList[0], oCoordList[1]);\n                    // Get the bearing from the mid point and pt3.\n                    dBearingMidPt3 = oMidPoint.bearingTo(oCoordList[2]);\n                    dBearingMidPt3 = ((dBearingMidPt3 > 180)? dBearingMidPt3 - 360: dBearingMidPt3);\n                    \n                    // Set the bearing to  +90 or -90.\n                    if ((dBearingMidPt3 - dBearingPt1Pt2) >= 0.0)\n                    {\n                        dBearingMidPt3 = dBearingPt1Pt2 + 90.0;\n                    }\n                    else\n                    {\n                        dBearingMidPt3 = dBearingPt1Pt2 + 270;\n                    }\n                    dBearingMidPt3 = (dBearingMidPt3 + 360) % 360;\n                    \n                    var dBearingMidMouse = oMidPoint.bearingTo(oEvent.latlng);\n                    // Get the distance from the mid point to the mouse.\n                    dDist = oMidPoint.distanceTo(oEvent.latlng);\n                    // Project the MP-Mouse line onto the Mid Pt Pt3 line;\n                    dDist = dDist * (Math.cos((dBearingMidMouse - dBearingMidPt3).toRad()));\n                    // Calculate the new position of Pt3.\n                    Pt3Coord = oMidPoint.destinationPoint(dBearingMidPt3, dDist);\n\n                    oCoordList[iIndex].lat = Pt3Coord.lat;\n                    oCoordList[iIndex].lng = Pt3Coord.lng;\n                    \n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    oRet = [iIndex];\n                    break;\n            }\n\n            return oRet;\n        },\n        _moveAmbushCP: function(oCP, oEvent)\n        {\n            var oMidPoint;\n            var dDist;\n            var dBearingMidPt1;\n            var dNewBearingMidPt1;\n            var dBearingPt2Pt3;\n            var dNewBearingPt2Pt3;\n            var oCP1;\n            var Pt1Coord;\n            var oRet = undefined;\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (iIndex)\n            {\n                case 0:\n                    // Get the mid point.\n                    oMidPoint = this.getCenterPT(oCoordList[1], oCoordList[2]);\n                    // Get the bearing from the mid point and pt1.\n                    dBearingMidPt1 = oMidPoint.bearingTo(oCoordList[0]);\n                    var dBearingMidMouse = oMidPoint.bearingTo(oEvent.latlng);\n                    // Get the distance from the mid point to the mouse.\n                    dDist = oMidPoint.distanceTo(oEvent.latlng);\n                    // Project the MP-Mouse line onto the Mid Pt Pt1 line;\n                    dDist = dDist * (Math.cos((dBearingMidMouse - dBearingMidPt1).toRad()));\n                    // Calculate the new position of Pt1.\n                    Pt1Coord = oMidPoint.destinationPoint(dBearingMidPt1, dDist);\n\n                    oCoordList[iIndex].lat = Pt1Coord.lat;\n                    oCoordList[iIndex].lng = Pt1Coord.lng;\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    oRet = [iIndex];\n                    break;\n                case 1:\n                case 2:\n                    // Get the bearing between pt1 pt2, and the mid point.\n                    dBearingPt2Pt3 = oCoordList[1].bearingTo(oCoordList[2]);\n                    oMidPoint = this.getCenterPT(oCoordList[1], oCoordList[2]);\n                    // Get the distance from the mid point to pt1 (the arrow).\n                    dDist = oMidPoint.distanceTo(oCoordList[0]);\n                        \n                    if ((dDist < 20.0) || isNaN(dDist) || (dDist === Infinity)) {\n                        return [];\n                    }\n                    // Get the bearing from the mid point and pt13.\n                    dBearingMidPt1 = oMidPoint.bearingTo(oCoordList[0]);\n                    // Update the coordinates of th CP that was moved.\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    // Now get the new bearing of pt2 pt3. And the new mid point.\n                    dNewBearingPt2Pt3 = oCoordList[1].bearingTo(oCoordList[2]);\n                    oMidPoint = this.getCenterPT(oCoordList[1], oCoordList[2]);\n                    // Compute the new bearing of pt1. And get the coordinates.\n                    dNewBearingMidPt1 = dBearingMidPt1 + (dNewBearingPt2Pt3 - dBearingPt2Pt3);\n                    Pt1Coord = oMidPoint.destinationPoint(dNewBearingMidPt1, dDist);\n                    // Update the CP, the coordinates and the object.\n                    oCoordList[0].lat = Pt1Coord.lat;\n                    oCoordList[0].lng = Pt1Coord.lng;\n                    oCP1 = this.getCP(0);\n                    oCP1.setCPPosition(oCoordList[0]);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    oRet = [0, iIndex];\n                    break;\n            }\n\n            return oRet;\n        },\n        _moveSeizeCP: function(oCP, oEvent)\n        {\n            var oCPPt2;\n            var dBearing;\n            var dDist;\n            var oRet = undefined;\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            //var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n            var i2525Version = oFeature.get2525Version();\n            var oRendererSettings = armyc2.c2sd.renderer.utilities.RendererSettings;\n            \n            if (i2525Version === oRendererSettings.Symbology_2525Bch2_USAS_13_14)\n            {\n                oRet = this._moveCP(oCP, oEvent);\n            }\n            else if ((i2525Version === oRendererSettings.Symbology_2525C ) &&\n                    (oCoordList.length === 3))\n            {\n                oRet = this._moveCP(oCP, oEvent);\n            }\n            else if (oCoordList.length === 4)\n            {\n                switch (iIndex)\n                {\n                    case 0:\n                        oRet = [iIndex];\n                        // If Pt1 is moved we need to move Pt2 relative to Pt1.\n                        oCPPt2 = this.getCP(1);\n                        dBearing = oCoordList[0].bearingTo(oEvent.latlng);\n                        dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                        if ((dDist < 20.0) || isNaN(dDist) || (dDist === Infinity)) {\n                            return [];\n                        }\n                        // Now move Pt1\n                        oCoordList[iIndex].lat = oEvent.latlng.lat;\n                        oCoordList[iIndex].lng = oEvent.latlng.lng;\n                        // And now move Pt2 relative to Pt1\n                        oCoordList[1].moveCoordinate(dBearing, dDist);\n                        oCPPt2.setCPPosition(oCoordList[1]);\n                        oRet.push(1);\n                        \n                        var oCPPt3 = this.getCP(2);\n                        oCoordList[2].moveCoordinate(dBearing, dDist);\n                        oCPPt3.setCPPosition(oCoordList[2]);\n                        oRet.push(2);\n\n                        this.setCoordinates(oCoordList);\n                        oCP.setCPPosition(oCoordList[iIndex]);\n                        this.updateLeafletObject(oCoordList);\n                        break;\n                    case 1:\n                    case 2:\n                    case 3:\n                        oRet = this._moveCP(oCP, oEvent);\n                        break;\n                }\n            }\n            else\n            {\n                oRet = this._moveCP(oCP, oEvent);\n            }\n            \n            return oRet;\n        },\n        _moveCP: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            // We need to update the position of the control point\n            oCoordList[iIndex].lat = oEvent.latlng.lat;\n            oCoordList[iIndex].lng = oEvent.latlng.lng;\n            this.setCoordinates(oCoordList);\n            oCP.setCPPosition(oCoordList[iIndex]);\n            this.updateLeafletObject(oCoordList);\n\n            return [iIndex];\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var oRet = undefined;\n            //var oCoordList = this.getCoordinateList();\n            //var oSymbolDef = this.getSymbolDef();\n            var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            switch (sBasicSymbolCode)\n            {\n                case oBasicSymbolCodes.AMBUSH:\n                    oRet = this._moveAmbushCP(oCP, oEvent);\n                    break;\n                case oBasicSymbolCodes.FORD_EASY:\n                case oBasicSymbolCodes.FORD_DIFFICULT:\n                case oBasicSymbolCodes.ROADBLOCK_COMPLETE_EXECUTED:\n                    oRet = this._moveFordCP(oCP, oEvent);\n                    break;\n                case oBasicSymbolCodes.BLOCK_TASK:\n                    oRet = this._moveBlockCP(oCP, oEvent);\n                    break;\n                case oBasicSymbolCodes.SEIZE:\n                    oRet = this._moveSeizeCP(oCP, oEvent);\n                    break;\n                default:\n                    oRet = this._moveCP(oCP, oEvent);\n                    break;\n            }\n            return oRet;\n        },\n        doFeatureMove: function(dBearing, dDistance) {\n            var oCoordList = this.getCoordinateList();\n            var oCPList = this.options.oControlPointList;\n            var oCoord;\n            var iCoordIndex;\n                    \n            for (var iIndex = 0; iIndex < oCPList.length; iIndex++) {\n                iCoordIndex = oCPList[iIndex].getIndex();\n                oCoord = oCPList[iIndex].getPosition();\n                oCoord.moveCoordinate(dBearing, dDistance);\n                oCPList[iIndex].setCPPosition(oCoord);\n                oCoordList[iCoordIndex] = oCoord;\n            }\n            this.setCoordinates(oCoordList);\n            this.updateLeafletObject();\n\n            return true;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDCSuperAutoShape = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDCSuperAutoShapeEditor());\n","\n/* global L, leafLet */\n\nleafLet.internalPrivateClass.MilStdDC2PointLineEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            this.updateLeafletObject();\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.updateLeafletObject(oCoordList);\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDC2PointLine = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDC2PointLineEditor());\n","\n/* global L, leafLet */\n\nleafLet.internalPrivateClass.MilStdDC2PointRectAutoShapeEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        _addWidthCP: function(oCoordList)\n        {\n            var oSymbolDef = this.getSymbolDef();\n            \n            if (oCoordList.length >= oSymbolDef.minPoints)\n            {\n                var oWidthPoint;\n                var oFeature = this.getFeature();\n                var oModifiers = oFeature.getMilStdModifiers();\n                var dDist = oCoordList[0].distanceTo(oCoordList[1]) / 2.0;\n                var dAngle = oCoordList[0].bearingTo(oCoordList[1]);\n                var oMidPoint = oCoordList[0].destinationPoint(dAngle, dDist);\n                var dWidth = oModifiers.getAMValue(0);\n\n                dAngle -= 90.0;\n                dAngle = (dAngle + 360) % 360;\n                oWidthPoint = oMidPoint.destinationPoint(dAngle, dWidth / 2.0);\n                \n                var oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.WIDTH_CP,\n                    oWidthPoint, 0, 0, dWidth);\n\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            this._addWidthCP(oCoordList);\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oSymbolDef = this.getSymbolDef();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length >= oSymbolDef.maxPoints)\n            {\n                return undefined;\n            }\n\n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                this._addWidthCP(oCoordList)\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addWidthCP(oCoordList);\n                    return [iIndex];\n                case leafLet.ControlPoint.Type.WIDTH_CP:\n                    var oWidthPoint;\n                    var oFeature = this.getFeature();\n                    var oModifiers = oFeature.getMilStdModifiers();\n                    var dDist = oCoordList[0].distanceTo(oCoordList[1]) / 2.0;\n                    var dAngle = oCoordList[0].bearingTo(oCoordList[1]);\n                    var oMidPoint = oCoordList[0].destinationPoint(dAngle, dDist);\n                    var dWidth = Math.round(oMidPoint.distanceTo(oEvent.latlng));\n                    //var dDraggedAngle = oMidPoint.bearingTo(oEvent.latlng);\n\n                    dAngle -= 90.0;\n                    dAngle = (dAngle + 360) % 360;\n\n                    oWidthPoint = oMidPoint.destinationPoint(dAngle, dWidth);\n                    oModifiers.setAMValue(0, dWidth * 2.0);\n                    oCP.setCPPosition(oWidthPoint);\n                    this.updateLeafletObject(oCoordList);\n                    return [];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdDC2PointRectAutoShape = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdDC2PointRectAutoShapeEditor());\n","\n/* global L, leafLet */\n\nleafLet.internalPrivateClass.MilStdSinglePointEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.MilStd.prototype.initialize.call(this, args);\n        },\n        assembleControlPoints: function()\n        {\n            var oCoordList = this.getCoordinateList();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            var oLeafletObject = this.getLeafletObject();\n\n            if (oLeafletObject instanceof L.Marker)\n            {\n                //oLeafletObject.unbindPopup();\n                this.setMarkerPopup();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n\n            if (oCoordList.length !== 0)\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            var oLeafletObject = oFeature._createFeature(oFeature.options);\n\n            this.setLeafletObject(oLeafletObject);\n\n            return undefined;\n        },\n        doFeatureMove: function(dBearing, dDistance)\n        {\n            var oLeafletObject = this.getLeafletObject();\n            var oCoordList = this.getCoordinateList();\n\n            oCoordList[0].moveCoordinate(dBearing, dDistance);\n            this.setCoordinates(oCoordList);\n            oLeafletObject.setLatLng(oCoordList[0]);\n            \n            this.setMarkerPopup();\n            return true;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.MilStdSinglePoint = leafLet.editor.MilStd.extend(leafLet.internalPrivateClass.MilStdSinglePointEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspaceCurtainEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n            }\n        },\n        _addSegmentCP: function()\n        {\n/*\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[iIndex - 1].pointAt3QtrDistanceTo(oCoordList[iIndex]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.SEGMENT_CP,\n                            oNewCoord, iIndex - 1, iIndex);\n                    this.addControlPoint(oCP);\n                }\n            }\n*/\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n                this.removeAllCPByType(leafLet.ControlPoint.Type.SEGMENT_CP);\n                this._addSegmentCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                if (this.updateLeafletObject(oCoordList))\n                {\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this._addNewCP();\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.SEGMENT_CP);\n                    this._addSegmentCP();\n                }\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length <= oFeature.getMinPoints())\n            {\n                return false;\n            }\n            \n            oCoordList.splice(iIndex, 1);\n            this.setCoordinates(oCoordList);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.SEGMENT_CP);\n            this.updateLeafletObject(oCoordList);\n            this._addNewCP();\n            this._addSegmentCP();\n            \n            return true;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n\n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.SEGMENT_CP);\n                    this.updateLeafletObject(oCoordList);\n                    //this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addSegmentCP();\n                    this._issueCPAddEvent(iNewIndex);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.SEGMENT_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addSegmentCP();\n                    return [iIndex];\n                case leafLet.ControlPoint.Type.SEGMENT_CP:\n                    var oCPCoord = oCP.getPosition();\n                    var dBearing = oCPCoord.bearingTo(oEvent.latlng);\n                    var dDist = oCPCoord.distanceTo(oEvent.latlng);\n                    var iSubIndex = oCP.getSubIndex();\n\n                    oCoordList[iIndex].moveCoordinate(dBearing, dDist);\n                    oCoordList[iSubIndex].moveCoordinate(dBearing, dDist);\n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.SEGMENT_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addSegmentCP();\n                    return [iIndex, iSubIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspaceCurtain = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspaceCurtainEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspacePolygonEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n\n                // Lets add the new CP.\n                oNewCoord = oCoordList[0].midPointTo(oCoordList[oCoordList.length - 1]);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                        oNewCoord, oCoordList.length, 0);\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addNewCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                if (this.updateLeafletObject(oCoordList))\n                {\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this._addNewCP();\n                }\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length <= oFeature.getMinPoints())\n            {\n                return false;\n            }\n            \n            oCoordList.splice(iIndex, 1);\n            this.setCoordinates(oCoordList);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this.updateLeafletObject(oCoordList);\n            this._addNewCP();\n            \n            return true;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n\n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    //this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._issueCPAddEvent(iNewIndex);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    //this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspacePolygon = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspacePolygonEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspaceCylinderEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addRadiusCP: function(oCoordList)\n        {\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n            var oCP;\n            var oCPPosition;\n            var dRange;\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                dRange = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n\n                // Place the Range CP.\n                oCPPosition = oCoordList[0].destinationPoint(90, dRange);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.RADIUS_CP,\n                    oCPPosition, 0, 90, dRange);\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oCoordList[0], 0, 0);\n                \n            this.addControlPoint(oCP);\n            \n            this._addRadiusCP(oCoordList);\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            //var oModifiers = oFeature.getMilStdModifiers();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oFeature.getMaxPoints())\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n            \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this._addRadiusCP(oCoordList);\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var dMouseAngle;\n            var dAngle;\n            var dDist;\n            var oCPPos;\n            var oRet = undefined;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var iCPIndex = oCP.getIndex();\n            var oAttributes = oFeature.getAttributes(0);\n\n            if (oCoordList.length < oFeature.getMinPoints())\n            {\n                return undefined;\n            }\n\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    oCoordList[0].lat = oEvent.latlng.lat;\n                    oCoordList[0].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[0]);\n                    this.updateLeafletObject(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n                    this._addRadiusCP(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.RADIUS_CP:\n                    dAngle = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n                    \n                    oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS, dDist);\n                    oCPPos = oCoordList[0].destinationPoint(dAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dDist);\n\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspaceCylinder = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspaceCylinderEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspaceOrbitEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addWidthCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n            var dWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_WIDTH);\n            var sTurn = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_ORBIT_TURN);\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                var Pt1 = oCoordList[0];\n                var Pt2 = oCoordList[1];\n                var dBearing = Pt1.bearingTo(Pt2);\n                var dDist = Pt1.distanceTo(Pt2);\n\n                oNewCoord = Pt1.destinationPoint(dBearing, dDist / 2.0);\n                \n                switch (sTurn)\n                {\n                    case emp.typeLibrary.orbitTurnType.CENTER:\n                        oNewCoord.moveCoordinate((dBearing + 270.0) % 360, dWidth / 2.0);\n                        break;\n                    case emp.typeLibrary.orbitTurnType.RIGHT:\n                        oNewCoord.moveCoordinate((dBearing + 90.0) % 360, dWidth);\n                        break;\n                    case emp.typeLibrary.orbitTurnType.LEFT:\n                        oNewCoord.moveCoordinate((dBearing + 270.0) % 360, dWidth);\n                        break;\n                }\n                \n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.WIDTH_CP,\n                        oNewCoord, iIndex, 0, dWidth);\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                this._addWidthCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length >= oFeature.getMaxPoints())\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                if (this.updateLeafletObject(oCoordList))\n                {\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this._addWidthCP();\n                }\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.WIDTH_CP:\n                    var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n                    var oFeature = this.getFeature();\n                    var oAttributes = oFeature.getAttributes(0);\n                    var dWidth;\n                    var sTurn = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_ORBIT_TURN);\n                    var Pt1 = oCoordList[0];\n                    var Pt2 = oCoordList[1];\n                    var dBearing = Pt1.bearingTo(Pt2);\n                    var dDist = Pt1.distanceTo(Pt2);\n                    var oNewCoord = Pt1.destinationPoint(dBearing, dDist / 2.0);\n                    var oCPPos = oCP.getPosition();\n                    var dMouseBearing = oNewCoord.bearingTo(oEvent.latlng);\n                    \n                    dBearing = oNewCoord.bearingTo(oCPPos);\n                    dDist = oNewCoord.distanceTo(oEvent.latlng);\n                    \n                    var dDelatAngle = Math.abs(dMouseBearing - dBearing);\n                    dDist = Math.round(Math.abs(dDist * Math.cos(dDelatAngle.toRad())));\n\n                    switch (sTurn)\n                    {\n                        case emp.typeLibrary.orbitTurnType.CENTER:\n                            oNewCoord = oNewCoord.destinationPoint(dBearing, dDist);\n                            dWidth = dDist * 2.0;\n                            break;\n                        case emp.typeLibrary.orbitTurnType.RIGHT:\n                        case emp.typeLibrary.orbitTurnType.LEFT:\n                            oNewCoord = oNewCoord.destinationPoint(dBearing, dDist);\n                            dWidth = dDist;\n                            break;\n                    }\n                    \n                    oCP.setCPPosition(oNewCoord);\n                    oCP.setValue(dWidth);\n                    oAttributes.setValue(cAirspaceAttribute.AIRSPACE_WIDTH, dWidth);\n                    this.setCoordinates(oCoordList);\n                    this.updateLeafletObject(oCoordList);\n                    return [];\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addWidthCP();\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspaceOrbit = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspaceOrbitEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspaceRouteEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addWidthCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n            var dWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_WIDTH);\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                var Pt1 = oCoordList[0];\n                var Pt2 = oCoordList[1];\n                var dBearing = Pt1.bearingTo(Pt2);\n                var dDist = Pt1.distanceTo(Pt2);\n\n                oNewCoord = Pt1.destinationPoint(dBearing, dDist / 2.0);\n                oNewCoord.moveCoordinate((dBearing + 270.0) % 360, dWidth / 2.0);\n                \n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.WIDTH_CP,\n                        oNewCoord, iIndex, 0, dWidth);\n                this.addControlPoint(oCP);\n            }\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addWidthCP();\n                this._addNewCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length >= oFeature.getMaxPoints())\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n                \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                if (this.updateLeafletObject(oCoordList))\n                {\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this._addWidthCP();\n                    this._addNewCP();\n                }\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var iIndex = oCP.getIndex();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                oCoordList.splice(iIndex, 1);\n                this.setCoordinates(oCoordList);\n                if (this.updateLeafletObject(oCoordList))\n                {\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this._addWidthCP();\n                    this._addNewCP();\n                }\n                \n                return true;\n            }\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.WIDTH_CP:\n                    var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n                    var oFeature = this.getFeature();\n                    var oAttributes = oFeature.getAttributes(0);\n                    var dWidth;\n                    var sTurn = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_ORBIT_TURN);\n                    var Pt1 = oCoordList[0];\n                    var Pt2 = oCoordList[1];\n                    var dBearing = Pt1.bearingTo(Pt2);\n                    var dDist = Pt1.distanceTo(Pt2);\n                    var oNewCoord = Pt1.destinationPoint(dBearing, dDist / 2.0);\n                    var oCPPos = oCP.getPosition();\n                    var dMouseBearing = oNewCoord.bearingTo(oEvent.latlng);\n                    \n                    dBearing = oNewCoord.bearingTo(oCPPos);\n                    dDist = oNewCoord.distanceTo(oEvent.latlng);\n                    \n                    var dDelatAngle = Math.abs(dMouseBearing - dBearing);\n                    dDist = Math.round(Math.abs(dDist * Math.cos(dDelatAngle.toRad())));\n\n                    oNewCoord = oNewCoord.destinationPoint(dBearing, dDist);\n                    dWidth = dDist * 2.0;\n                    \n                    oCP.setCPPosition(oNewCoord);\n                    oCP.setValue(dWidth);\n                    oAttributes.setValue(cAirspaceAttribute.AIRSPACE_WIDTH, dWidth);\n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    return [];\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    var iNewIndex = oCP.getIndex();\n\n                    this.updateCPIndex(iNewIndex, 1);\n                    oCoordList.splice(iNewIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addWidthCP();\n                    this._addNewCP();\n                    this._issueCPAddEvent(iNewIndex);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addWidthCP();\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspaceRoute = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspaceRouteEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspaceTrackEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addWidthCP: function()\n        {\n            var oCP;\n            var oMidCoord;\n            var iIndex;\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                var Pt1;\n                var Pt2;\n                var dBearing;\n                var dDist;\n                var oAttributes;\n                var dLeftWidth;\n                var dRightWidth;\n                var oNewCoord;\n\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    oAttributes = oFeature.getAttributes(iIndex - 1);\n                    dLeftWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_LEFT_WIDTH);\n                    dRightWidth = oAttributes.getValue(cAirspaceAttribute.AIRSPACE_RIGHT_WIDTH);\n                    Pt1 = oCoordList[iIndex - 1];\n                    Pt2 = oCoordList[iIndex];\n                    dBearing = Pt1.bearingTo(Pt2);\n                    \n                    oMidCoord = Pt1.pointAt3QtrDistanceTo(Pt2);\n                    oNewCoord = oMidCoord.destinationPoint((dBearing + 270.0) % 360, dLeftWidth);\n\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.LEFT_WIDTH_CP,\n                            oNewCoord, iIndex - 1, iIndex, dLeftWidth);\n                    this.addControlPoint(oCP);\n\n                    oNewCoord = oMidCoord.destinationPoint((dBearing + 90.0) % 360, dRightWidth);\n\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.RIGHT_WIDTH_CP,\n                            oNewCoord, iIndex - 1, iIndex, dRightWidth);\n                    this.addControlPoint(oCP);\n                }\n            }\n        },\n        _addNewCP: function()\n        {\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n\n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_WIDTH_CP);\n                this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_WIDTH_CP);\n                this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                this._addWidthCP();\n                this._addNewCP();\n            }\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oAttributeList = oFeature.getAttributeList();\n            var oAttributes;\n            var iIndex = oCoordList.length;\n            \n            if (oCoordList.length >= oFeature.getMaxPoints())\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n\n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, iIndex, 0);\n\n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                oAttributes = oAttributeList.get(iIndex - 1);\n\n                if (!oAttributes)\n                {\n                    if (iIndex === 1)\n                    {\n                        oAttributes = new leafLet.typeLibrary.airspace.Attributes(oFeature.getProperties(), {});\n                        oAttributes.setRequiredAttributes(emp.typeLibrary.airspaceSymbolCode.SHAPE3D_TRACK);\n                    }\n                    else\n                    {\n                        oAttributes = oAttributeList.get(iIndex - 2);\n                        oAttributes = oAttributes.duplicateAttribute();\n                    }\n                    \n                    oAttributeList.add(oAttributes);\n                }\n                \n                if (this.updateLeafletObject(oCoordList))\n                {\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this._addWidthCP();\n                    this._addNewCP();\n                }\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var iIndex = oCP.getIndex();\n            var oAttributeList = oFeature.getAttributeList();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                oCoordList.splice(iIndex, 1);\n                this.setCoordinates(oCoordList);\n                \n                if (iIndex === oAttributeList.length() - 1)\n                {\n                    oAttributeList.remove(iIndex - 1);\n                }\n                else\n                {\n                    oAttributeList.remove(iIndex);\n                }\n\n                if (this.updateLeafletObject(oCoordList))\n                {\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this._addWidthCP();\n                    this._addNewCP();\n                }\n                \n                return true;\n            }\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var oAttributes;\n            var oNewCoord;\n            var iIndex = oCP.getIndex();\n            var iIndex2 = oCP.getSubIndex();\n            var oCoordList = this.getCoordinateList();\n            var cAirspaceAttribute = leafLet.typeLibrary.AirspaceAttribute;\n            var oFeature = this.getFeature();\n            var oAttributeList = oFeature.getAttributeList();\n            \n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.LEFT_WIDTH_CP:\n                case leafLet.ControlPoint.Type.RIGHT_WIDTH_CP:\n                    var dWidth;\n                    var Pt1 = oCoordList[iIndex];\n                    var Pt2 = oCoordList[iIndex2];\n                    var dBearing = Pt1.bearingTo(Pt2);\n                    var dDist;\n                    var oMidCoord = Pt1.pointAt3QtrDistanceTo(Pt2);\n                    var oCPPos = oCP.getPosition();\n                    var dMouseBearing = oMidCoord.bearingTo(oEvent.latlng);\n\n                    oAttributes = oFeature.getAttributes(iIndex);\n                    \n                    dBearing = oMidCoord.bearingTo(oCPPos);\n                    dDist = oMidCoord.distanceTo(oEvent.latlng);\n                    \n                    var dDelatAngle = Math.abs(dMouseBearing - dBearing);\n                    dDist = Math.round(Math.abs(dDist * Math.cos(dDelatAngle.toRad())));\n\n                    oNewCoord = oMidCoord.destinationPoint(dBearing, dDist);\n                    dWidth = dDist;\n                    \n                    oCP.setCPPosition(oNewCoord);\n                    oCP.setValue(dWidth);\n                    \n                    if (oCP.getType() === leafLet.ControlPoint.Type.LEFT_WIDTH_CP)\n                    {\n                        oAttributes.setValue(cAirspaceAttribute.AIRSPACE_LEFT_WIDTH, dWidth);\n                    }\n                    else\n                    {\n                        oAttributes.setValue(cAirspaceAttribute.AIRSPACE_RIGHT_WIDTH, dWidth);\n                    }\n                    \n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    return [];\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_WIDTH_CP);\n\n                    this.updateCPIndex(iIndex, 1);\n                    oCoordList.splice(iIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    \n                    // We need to add a set of attributes for the new segment.\n                    oAttributes = oFeature.getAttributes(iIndex - 1);\n                    oAttributes = oAttributes.duplicateAttribute();\n                    oAttributeList.insert(iIndex, oAttributes);\n                    \n                    this.updateLeafletObject(oCoordList);\n                    this._addWidthCP();\n                    this._issueCPAddEvent(iIndex);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    // and the new control points beore and after it..\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_WIDTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addWidthCP();\n                    return [iIndex];\n            }\n            return undefined;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspaceTrack = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspaceTrackEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspaceRadArcEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addRadiusCP: function(oCoordList)\n        {\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n            var oCP;\n            var oCPPosition;\n            var dOutterRadius;\n            var dInnerRadius;\n            var dLeftAzimuth;\n            var dRightAzimuth;\n            var dMidAzimuth;\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                dOutterRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n                dInnerRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_INNER_RADIUS);\n                dLeftAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n                dRightAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n                \n                dMidAzimuth = (dRightAzimuth + dLeftAzimuth) / 2.0;\n                \n                if (dRightAzimuth < dLeftAzimuth)\n                {\n                    dMidAzimuth = (dMidAzimuth + 180) % 360;\n                }\n\n                // Place the outter CP.\n                oCPPosition = oCoordList[0].destinationPoint(dMidAzimuth, dOutterRadius);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.RADIUS_CP,\n                    oCPPosition, 0, dMidAzimuth, dOutterRadius);\n                this.addControlPoint(oCP);\n\n                // Place the inner CP.\n                oCPPosition = oCoordList[0].destinationPoint(dMidAzimuth, dInnerRadius);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.INNER_RADIUS_CP,\n                    oCPPosition, 0, dMidAzimuth, dInnerRadius);\n                this.addControlPoint(oCP);\n            }\n        },\n        _addAzimuthCP: function(oCoordList)\n        {\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n            var oCP;\n            var oCPPosition;\n            var dOutterRadius;\n            var dInnerRadius;\n            var dAvgRadius;\n            var dLeftAzimuth;\n            var dRightAzimuth;\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                dOutterRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n                dInnerRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_INNER_RADIUS);\n                dLeftAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n                dRightAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n                \n                dAvgRadius = (dOutterRadius + dInnerRadius) / 2.0;\n                \n                // Place the outter CP.\n                oCPPosition = oCoordList[0].destinationPoint(dLeftAzimuth, dAvgRadius);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP,\n                    oCPPosition, 0, dAvgRadius, dLeftAzimuth);\n                this.addControlPoint(oCP);\n\n                // Place the inner CP.\n                oCPPosition = oCoordList[0].destinationPoint(dRightAzimuth, dAvgRadius);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP,\n                    oCPPosition, 0, dAvgRadius, dRightAzimuth);\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            \n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            var oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oCoordList[0], 0, 0);\n                \n            this.addControlPoint(oCP);\n            \n            this._addRadiusCP(oCoordList);\n            this._addAzimuthCP(oCoordList);\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            //var oModifiers = oFeature.getMilStdModifiers();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oFeature.getMaxPoints())\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n            \n            if (this.updateLeafletObject(oCoordList))\n            {\n                this._addRadiusCP(oCoordList);\n                this._addAzimuthCP(oCoordList);\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            return false;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var dMouseAngle;\n            var dAngle;\n            var dDist;\n            var oCPPos;\n            var dOutterRadius;\n            var dInnerRadius;\n            var oRet = undefined;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var iCPIndex = oCP.getIndex();\n            var oAttributes = oFeature.getAttributes(0);\n\n            if (oCoordList.length < oFeature.getMinPoints())\n            {\n                return undefined;\n            }\n\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    oCoordList[0].lat = oEvent.latlng.lat;\n                    oCoordList[0].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[0]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.INNER_RADIUS_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addRadiusCP(oCoordList);\n                    this._addAzimuthCP(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.RADIUS_CP:\n                    dInnerRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_INNER_RADIUS);\n                    dAngle = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n                    \n                    if (dDist <= dInnerRadius)\n                    {\n                        // The outter radius can't be equal or smaller that the inner.\n                        break;\n                    }\n                    \n                    oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS, dDist);\n                    oCPPos = oCoordList[0].destinationPoint(dAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dDist);\n\n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addAzimuthCP(oCoordList);\n                    this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    break;\n                case leafLet.ControlPoint.Type.INNER_RADIUS_CP:\n                    dOutterRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n                    dAngle = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n                    \n                    if (dDist >= dOutterRadius)\n                    {\n                        // The inner radius can't be equal or greaterr than the outter.\n                        break;\n                    }\n                    \n                    oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_INNER_RADIUS, dDist);\n                    oCPPos = oCoordList[0].destinationPoint(dAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dDist);\n\n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addAzimuthCP(oCoordList);\n                    this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    break;\n                case leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP:\n                case leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP:\n                    dDist = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n\n                    oCPPos = oCoordList[0].destinationPoint(dMouseAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dMouseAngle);\n\n                    if (oCP.getType() === leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP)\n                    {\n                        oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_AZIMUTH, dMouseAngle);\n                    }\n                    else\n                    {\n                        oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH, dMouseAngle);\n                    }\n\n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.INNER_RADIUS_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addRadiusCP(oCoordList);\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspaceRadArc = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspaceRadArcEditor());\n","\n/* global L, leafLet, emp */\n\nleafLet.internalPrivateClass.AirspacePolyArcEditor = function()\n{\n    var publicInterface = {\n        initialize: function (args) \n        {\n            //var oOptions = {\n            //};\n            //L.Util.setOptions(this, oOptions);\n            \n            leafLet.editor.Airspace.prototype.initialize.call(this, args);\n        },\n        _addRadiusCP: function(oCoordList)\n        {\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n            var oCP;\n            var oCPPosition;\n            var dRadius;\n            var dLeftAzimuth;\n            var dRightAzimuth;\n            var dMidAzimuth;\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                dRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n                dLeftAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n                dRightAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n                \n                dMidAzimuth = (dRightAzimuth + dLeftAzimuth) / 2.0;\n                \n                if (dRightAzimuth < dLeftAzimuth)\n                {\n                    dMidAzimuth = (dMidAzimuth + 180) % 360;\n                }\n\n                // Place the outter CP.\n                oCPPosition = oCoordList[0].destinationPoint(dMidAzimuth, dRadius);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.RADIUS_CP,\n                    oCPPosition, 0, dMidAzimuth, dRadius);\n                this.addControlPoint(oCP);\n            }\n        },\n        _addAzimuthCP: function(oCoordList)\n        {\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n            var oCP;\n            var oCPPosition;\n            var dRadius;\n            var dLeftAzimuth;\n            var dRightAzimuth;\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                dRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n                dLeftAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n                dRightAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n                \n                // Place the left azimuth  CP.\n                oCPPosition = oCoordList[0].destinationPoint(dLeftAzimuth, dRadius);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP,\n                    oCPPosition, 0, dRadius, dLeftAzimuth);\n                this.addControlPoint(oCP);\n\n                // Place the right azimuth CP.\n                oCPPosition = oCoordList[0].destinationPoint(dRightAzimuth, dRadius);\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP,\n                    oCPPosition, 0, dRadius, dRightAzimuth);\n                this.addControlPoint(oCP);\n            }\n        },\n        _addNewCP: function()\n        {\n            var dRadius;\n            var dLeftAzimuth;\n            var dRightAzimuth;\n            var oCP;\n            var oNewCoord;\n            var iIndex;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n\n            if (oCoordList.length === 0)\n            {\n                return;\n            }\n            \n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                for (iIndex = 1; iIndex < oCoordList.length; iIndex++)\n                {\n                    // Lets add the new CP.\n                    if (iIndex === 1)\n                    {\n                        dRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n                        dRightAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH);\n                        oNewCoord = oCoordList[0].destinationPoint(dRightAzimuth, dRadius);\n                        oNewCoord = oNewCoord.midPointTo(oCoordList[iIndex]);\n                    }\n                    else\n                    {\n                        oNewCoord = oCoordList[iIndex - 1].midPointTo(oCoordList[iIndex]);\n                    }\n                    \n                    oCP = new leafLet.editor.ControlPoint(oFeature,\n                            leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                            oNewCoord, iIndex, 0);\n                    this.addControlPoint(oCP);\n                }\n\n                // Lets add the new CP.\n                dRadius = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS);\n                dLeftAzimuth = oAttributes.getValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_AZIMUTH);\n                oNewCoord = oCoordList[0].destinationPoint(dLeftAzimuth, dRadius);\n                oNewCoord = oNewCoord.midPointTo(oCoordList[oCoordList.length - 1]);\n\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                        leafLet.ControlPoint.Type.NEW_POSITION_CP,\n                        oNewCoord, oCoordList.length, 0);\n                this.addControlPoint(oCP);\n            }\n        },\n        assembleControlPoints: function()\n        {\n            var oFeature = this.getFeature();\n            var oCoordList = this.getCoordinateList();\n            var oCP;\n            \n            if (oCoordList.length < oFeature.getMinPoints())\n            {\n                return;\n            }\n            \n            for (var iIndex = 0; iIndex < oCoordList.length; iIndex++)\n            {\n                oCP = new leafLet.editor.ControlPoint(oFeature,\n                    leafLet.ControlPoint.Type.POSITION_CP,\n                    oCoordList[iIndex], iIndex, 0);\n\n                this.addControlPoint(oCP);\n            }\n            \n            this._addRadiusCP(oCoordList);\n            this._addAzimuthCP(oCoordList);\n            this._addNewCP();\n        },\n        doAddControlPoint: function(oLatLng)\n        {\n            var oCP;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            //var oModifiers = oFeature.getMilStdModifiers();\n            //var sBasicSymbolCode = this.options.sBasicSymbolCode;\n            //var oBasicSymbolCodes = leafLet.utils.milstd.basicSymbolCode;\n\n            if (oCoordList.length >= oFeature.getMinPoints())\n            {\n                return undefined;\n            }\n            \n            oCoordList.push(oLatLng);\n            this.setCoordinates(oCoordList);\n            \n            oCP = new leafLet.editor.ControlPoint(oFeature,\n                leafLet.ControlPoint.Type.POSITION_CP,\n                oLatLng, oCoordList.length - 1, 0);\n            \n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n\n            if (this.updateLeafletObject(oCoordList))\n            {\n                this._addRadiusCP(oCoordList);\n                this._addAzimuthCP(oCoordList);\n                this._addNewCP();\n            }\n\n            return oCP;\n        },\n        doDeleteControlPoint: function(oCP)\n        {\n            var iIndex = oCP.getIndex();\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            \n            if (oCP.getType() !== leafLet.ControlPoint.Type.POSITION_CP)\n            {\n                return false;\n            }\n            \n            if (oCoordList.length <= oFeature.getMinPoints())\n            {\n                return false;\n            }\n            \n            oCoordList.splice(iIndex, 1);\n            this.setCoordinates(oCoordList);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n            this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n            this.updateLeafletObject(oCoordList);\n            this._addNewCP();\n            this._addRadiusCP(oCoordList);\n            this._addAzimuthCP(oCoordList);\n            \n            return true;\n        },\n        doControlPointMoved: function(oCP, oEvent)\n        {\n            var dMouseAngle;\n            var dAngle;\n            var dDist;\n            var oCPPos;\n            var iIndex = oCP.getIndex();\n            var oRet = undefined;\n            var oCoordList = this.getCoordinateList();\n            var oFeature = this.getFeature();\n            var oAttributes = oFeature.getAttributes(0);\n\n            if (oCoordList.length < oFeature.getMinPoints())\n            {\n                return undefined;\n            }\n\n            switch (oCP.getType())\n            {\n                case leafLet.ControlPoint.Type.NEW_POSITION_CP:\n                    // We need to convert the new control point to a position control point\n                    // and add new control points before and after it.\n                    // We need to add the coordiante to our list in the correct position.\n                    this.updateCPIndex(iIndex, 1);\n                    oCoordList.splice(iIndex, 0, oEvent.latlng);\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oEvent.latlng);\n                    oCP.setType(leafLet.ControlPoint.Type.POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addRadiusCP(oCoordList);\n                    this._addAzimuthCP(oCoordList);\n                    this._issueCPAddEvent(iIndex);\n                    break;\n                case leafLet.ControlPoint.Type.POSITION_CP:\n                    // We need to update the position of the control point\n                    oCoordList[iIndex].lat = oEvent.latlng.lat;\n                    oCoordList[iIndex].lng = oEvent.latlng.lng;\n                    this.setCoordinates(oCoordList);\n                    oCP.setCPPosition(oCoordList[iIndex]);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addRadiusCP(oCoordList);\n                    this._addAzimuthCP(oCoordList);\n                    oRet = [0];\n                    break;\n                case leafLet.ControlPoint.Type.RADIUS_CP:\n                    dAngle = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n                    dDist = oCoordList[0].distanceTo(oEvent.latlng);\n                    dDist = Math.abs(Math.round(dDist * Math.cos((dMouseAngle - dAngle).toRad())));\n                    \n                    oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RADIUS, dDist);\n                    oCPPos = oCoordList[0].destinationPoint(dAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dDist);\n\n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addAzimuthCP(oCoordList);\n                    this._issueCPUpdateEvent([], emp.typeLibrary.UpdateEventType.UPDATE);\n                    break;\n                case leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP:\n                case leafLet.ControlPoint.Type.RIGHT_AZIMUTH_CP:\n                    dDist = oCP.getSubIndex();\n                    dMouseAngle = oCoordList[0].bearingTo(oEvent.latlng);\n\n                    oCPPos = oCoordList[0].destinationPoint(dMouseAngle, dDist);\n                    oCP.setCPPosition(oCPPos);\n                    oCP.setValue(dMouseAngle);\n\n                    if (oCP.getType() === leafLet.ControlPoint.Type.LEFT_AZIMUTH_CP)\n                    {\n                        oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_LEFT_AZIMUTH, dMouseAngle);\n                    }\n                    else\n                    {\n                        oAttributes.setValue(leafLet.typeLibrary.AirspaceAttribute.AIRSPACE_RIGHT_AZIMUTH, dMouseAngle);\n                    }\n\n                    this.setCoordinates(oCoordList);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.RADIUS_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.INNER_RADIUS_CP);\n                    this.removeAllCPByType(leafLet.ControlPoint.Type.NEW_POSITION_CP);\n                    this.updateLeafletObject(oCoordList);\n                    this._addNewCP();\n                    this._addRadiusCP(oCoordList);\n                    break;\n            }\n            return oRet;\n        }\n   };\n\n    return publicInterface;\n};\n\nleafLet.editor.AirspacePolyArc = leafLet.editor.Airspace.extend(leafLet.internalPrivateClass.AirspacePolyArcEditor());\n","/*globals emp, L */\n/* global L, leafLet, cmapi */\n\nvar emp = emp || {};\n\nemp.util.milstdColorFix = function (feature) {\n    var oProperties;\n    var oModifiers;\n\n    if (feature.hasOwnProperty('format') && (feature.format === emp.typeLibrary.featureFormatType.MILSTD)) {\n        oProperties = feature.properties;\n        if (oProperties && oProperties.hasOwnProperty('modifiers')) {\n            oModifiers = oProperties.modifiers;\n            if (oModifiers.hasOwnProperty('lineColor')) {\n                oProperties.lineColor = oModifiers.lineColor;\n            }\n            if (oModifiers.hasOwnProperty('lineWidth')) {\n                oProperties.lineWidth = oModifiers.lineWidth;\n            }\n            if (oModifiers.hasOwnProperty('fillColor')) {\n                oProperties.fillColor = oModifiers.fillColor;\n            }\n        }\n    }\n};\n\nemp.engineDefs = emp.engineDefs || {};\nemp.engineDefs.leafletMapEngine = function (args) {\n\n    // engineInterface is the public object returned to caller\n    var engineInterface = emp.map.createEngineTemplate();\n    var bounds;\n    var selectedGeoColor = new cmapi.IGeoColor({\n        red: 0xF0,\n        green: 0xF0,\n        blue: 0\n    });\n\n    var instanceInterface = {\n        bIsV2Core: (args.isV2Core === true) || false,\n        empMapInstance: args.mapInstance,\n        leafletInstance: undefined,\n        bUseProxy: args.useProxy,\n        useProxyForDefault: args.useProxyForDefault,\n        renderingOptimization: {\n          enabled: args.renderingOptimization,\n          midDistanceThreshold: args.midDistanceThreshold,\n          farDistanceThreshold: {\n            value: args.farDistanceThreshold,\n            RED: 'red',\n            BLUE: 'blue',\n            GREEN: 'green',\n            YELLOW: 'yellow',\n            getSVG: function (attributes) {\n              return '<svg preserveAspectRatio=\"none\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\">' +\n                       '<circle cx=\"' + attributes.x + '\" cy=\"' + attributes.y + '\" r=\"' + attributes.radius + '\"' +\n                       ' fill=\"' + attributes.color + '\" stroke=\"' + attributes.color + '\" stroke-width=\"1\"/>' +\n                     '</svg>';\n            }\n          },\n          // This is set to undefined instead of null to account for the case when the map starts at a very low altitude\n          // and a mil symbol icon plot occurs without any other event first. If this is already 'null' the zoneChanged\n          // boolean in the refreshZone() will not change to true which is needed if the afformentioned plot mil std icon\n          // is to be put on the render list in the scheduler.\n          viewInZone: undefined,\n          zoneChanged: false,\n          renderList: {},\n          removeFromRenderList: function (key) {\n            delete this.renderList[key];\n          },\n          addToRenderList: function (key, value) {\n            return this.renderList[key] = value;\n          },\n          isOnRenderList: function (key) {\n            return this.renderList.hasOwnProperty(key);\n          },\n          isRenderListEmpty: function () {\n            return Object.keys(this.renderList).length === 0;\n          },\n          getRenderList: function () {\n            return this.renderList;\n          },\n          refreshZone: function () {\n            var view = instanceInterface.getView();\n\n            this.zoneChanged = false;\n            if (view.altitude >= this.farDistanceThreshold.value) {\n              // Mil-std single point icons are shown as an ellipses colored with the corresponding affiliation and\n              // labels are turned off.\n              if (this.viewInZone !== \"farDistanceZone\") {\n                this.zoneChanged = true;\n                this.viewInZone = \"farDistanceZone\";\n              }\n            } else if (view.altitude >= this.midDistanceThreshold) {\n              // Mil-std single point icons are displayed in normal fashion and labels are turned off.\n              if (this.viewInZone !== \"midDistanceZone\") {\n                this.zoneChanged = true;\n                this.viewInZone = \"midDistanceZone\";\n              }\n            } else {\n              // Mil-std single point icons are displayed in normal fashion and the current label setting state is used.\n              if (this.viewInZone !== null) {\n                this.zoneChanged = true;\n                this.viewInZone = null;\n              }\n            }\n          }\n        },\n        engineParameters: args,\n        selectAttributes: {\n            color: 'F0F000',\n            opacity: 1.0,\n            width: 5\n        },\n        selectLabelStyle: new cmapi.IGeoLabelStyle({\n            color: selectedGeoColor,\n            size: 12,\n            fontFamily: 'Arial'\n        }),\n        defaultLabelStyle: new cmapi.IGeoLabelStyle({\n            color: new cmapi.IGeoColor({\n                red: 0,\n                green: 0,\n                blue: 0\n            }),\n            fontFamily: 'Arial'\n        }),\n        defaultStrokeStyle: {\n            color: '000000',\n            opacity: 1.0,\n            width: 3\n        },\n        sContentCoreId: emp.helpers.id.newGUID(),\n        overlays: {},\n        tacticalGraphics: {},\n        dMaxLabelScale: 10000000,\n        rangeToScaleMultiplier: 10.0 / 3.0,\n        zoomScaleMap: [\n            500000000,\n            250000000,\n            150000000,\n            70000000,\n            35000000,\n            15000000,\n            10000000,\n            4000000,\n            2000000,\n            1000000,\n            500000,\n            250000,\n            150000,\n            70000,\n            35000,\n            15000,\n            8000,\n            4000,\n            2000,\n            1000,\n            500,\n            250,\n            125\n        ],\n        rootOverlayId: undefined,\n        rootOverlay: undefined,\n        mapEngObjectList: {},\n        bInDrawMode: false,\n        bInEditMode: false,\n        oSelectionManager: undefined,\n        oLabelList: [],\n        iMilStdIconSize: 24,\n        oLayerControl: undefined,\n        hTGRenderingTimer: undefined,\n        oGraphicsInViewingArea: [],\n        oCurrentEditor: undefined,\n        oEditTransaction: undefined,\n        oTransactionList: {},\n        oZoomControl: undefined,\n        getLeafletMap: function () {\n            return instanceInterface.leafletInstance;\n        },\n        getProxyURL: function () {\n            return instanceInterface.engineParameters.empProxyURL;\n        },\n        getBasePath: function () {\n            return instanceInterface.engineParameters.engineBasePath;\n        },\n        addEmpObject: function (oEmpObject) {\n            instanceInterface.mapEngObjectList[oEmpObject.getCoreId()] = oEmpObject;\n        },\n        removeEmpObject: function (oEmpObject) {\n            if (instanceInterface.mapEngObjectList[oEmpObject.getCoreId()] !== undefined) {\n                delete instanceInterface.mapEngObjectList[oEmpObject.getCoreId()];\n            }\n        },\n        storeTransaction: function (oTransaction) {\n            if (instanceInterface.oTransactionList[oTransaction.transactionId] === undefined) {\n                instanceInterface.oTransactionList[oTransaction.transactionId] = oTransaction;\n            }\n        },\n        findTransaction: function (oTranID) {\n            return instanceInterface.oTransactionList[oTranID];\n        },\n        findTransactionByIntent: function (sIntent) {\n            var sTranID;\n            var oTransaction;\n            var aRetList = [];\n            var aKeyList = emp.helpers.associativeArray.getKeys(instanceInterface.oTransactionList);\n\n            for (var iIndex = 0; iIndex < aKeyList.length; iIndex++) {\n                sTranID = aKeyList[iIndex];\n                oTransaction = instanceInterface.oTransactionList[sTranID];\n\n                if (oTransaction.intent === sIntent) {\n                    aRetList.push(oTransaction);\n                }\n            }\n\n            return aRetList;\n        },\n        removeTransaction: function (oTranID) {\n            if (instanceInterface.oTransactionList.hasOwnProperty(oTranID)) {\n                delete instanceInterface.oTransactionList[oTranID];\n            }\n        },\n        getEmpObject: function (sCoreId) {\n            if (!sCoreId) {\n                return rootOverlay;\n            }\n\n            return instanceInterface.mapEngObjectList[sCoreId];\n        },\n        handleFeatureClicked: function (oEvent) {\n            var oPointerData = instanceInterface.getView();\n            var button = oEvent.originalEvent.button;\n            var sSelectedID;\n\n            if ((button === 0) &&\n                    !oEvent.originalEvent.altKey &&\n                    !oEvent.originalEvent.shiftkey) {\n                if (emp.util.config.getAutoSelect()) {\n                    if (oEvent.target instanceof leafLet.typeLibrary.Feature) {\n                        // Its a feature selection click.\n\n                        if (oEvent.layer && oEvent.layer.options && oEvent.layer.options.sSubItemID) {\n                            sSelectedID = oEvent.layer.options.sSubItemID;\n                        }\n\n                        if (instanceInterface.oSelectionManager.isSelected(oEvent.target, sSelectedID)) {\n                            if (!oEvent.originalEvent.ctrlKey) {\n                                // Its a single selection.\n                                // We must deselected everything that is selected.\n                                instanceInterface.oSelectionManager.deselectAllFeatures();\n                            } else {\n                                instanceInterface.oSelectionManager.deselectFeature(oEvent.target, sSelectedID);\n                            }\n                        } else {\n                            if (!oEvent.originalEvent.ctrlKey) {\n                                // Its a single selection.\n                                // We must deselected everything that is selected.\n                                instanceInterface.oSelectionManager.deselectAllFeatures();\n                            }\n\n                            instanceInterface.oSelectionManager.selectFeature(oEvent.target, sSelectedID);\n                        }\n                        instanceInterface.oSelectionManager.generateEvent();\n                    }\n                }\n\n                if (!oEvent.originalEvent.ctrlKey) {\n                    if ((oEvent.target instanceof leafLet.typeLibrary.Feature) ||\n                            (oEvent.target instanceof L.MarkerCluster)) {\n                        oPointerData.popupInfo = {\n                            title: oEvent.target.getPopupHeading(oEvent.layer),\n                            content: oEvent.target.getPopupText(oEvent.layer)\n                        };\n                    }\n                }\n            }\n\n            oPointerData.overlayId = oEvent.target.getOverlayId();\n            oPointerData.parentId = oEvent.target.getParentId();\n            oPointerData.featureId = oEvent.target.getFeatureId();\n            oPointerData.target = \"feature\";\n            instanceInterface.generatePointerEvent(oEvent, oPointerData);\n        },\n        // Translate a map scale into a zoom level\n        getLevel: function (scale) {\n            var len = instanceInterface.zoomScaleMap.length,\n                    i,\n                    level = 0;\n            if (scale > instanceInterface.zoomScaleMap[0]) {\n                level = 0;\n            } else if (scale < instanceInterface.zoomScaleMap[len - 1]) {\n                level = len - 1;\n            } else {\n                for (i = 0; i < len - 1; i++) {\n                    if (scale <= instanceInterface.zoomScaleMap[i] && scale > instanceInterface.zoomScaleMap[i + 1]) {\n                        level = i;\n                        break;\n                    } else if (scale < instanceInterface.zoomScaleMap[i] && scale >= instanceInterface.zoomScaleMap[i + 1]) {\n                        level = i + 1;\n                        break;\n                    }\n                }\n            }\n            return level;\n        },\n        // Translate a zoom level into a map scale\n        getScale: function (level) {\n            var len = instanceInterface.zoomScaleMap.length,\n                    i,\n                    scale = instanceInterface.zoomScaleMap[0];\n            if (level < 0) {\n                scale = instanceInterface.zoomScaleMap[0];\n            } else if (level > len - 1) {\n                scale = instanceInterface.zoomScaleMap[len - 1];\n            } else {\n                scale = instanceInterface.zoomScaleMap[level];\n            }\n            return scale;\n        },\n        viewToLookAt: function(view) {\n            var lookAt = {};\n\n            if (view) {\n                lookAt.latitude = view.lat;\n                lookAt.longitude = view.lon;\n                lookAt.altitude = 0;\n                lookAt.tilt = 0;\n                lookAt.heading = 0;\n                lookAt.range = view.range;\n                lookAt.altitudeMode = view.altitudeMode || emp.constant.featureAltitudeModeType.CLAMP_TO_GROUND;\n            }\n\n            return lookAt;\n        },\n        getView: function (oData) {\n            var view = oData || {},\n                    bounds = instanceInterface.leafletInstance.getBounds(),\n                    center = instanceInterface.leafletInstance.getCenter().wrap(),\n                    level = instanceInterface.leafletInstance.getZoom();\n\n            leafLet.utils.convertViewBound(bounds, view);\n\n            view.lat = center.lat;\n            view.lon = center.lng;\n\n            view.bounds = {\n                north: view.north,\n                south: view.south,\n                east: view.east,\n                west: view.west\n            };\n            view.location = {\n                lon: view.lon,\n                lat: view.lat\n            };\n            view.mgrs = emp.geoLibrary.ddToMGRS(view.lat, view.lon);\n            // Translate the map zoom level to a map scale\n            view.scale = instanceInterface.getScale(level);\n            // Convert map scale to camera range\n            view.range = view.scale / instanceInterface.rangeToScaleMultiplier;\n            view.altitude = view.range;\n            view.roll = 0;\n            view.tilt = 0;\n            view.heading = 0;\n\n            view.altitude = view.range;\n            view.tilt = 0;\n            view.roll = 0;\n            view.heading = 0;\n\n            return view;\n        },\n        generatePointerEvent: function (oEvent, oData) {\n            var button = (oEvent.originalEvent ? oEvent.originalEvent.button : 0),\n                    pointer = oData || instanceInterface.getView(),\n                    level = instanceInterface.leafletInstance.getZoom(),\n                    oLL = oEvent.latlng.wrap();\n\n            pointer.lat = oLL.lat;\n            pointer.lon = oLL.lng;\n            pointer.elevation = oData.range;\n\n            switch (button) {\n                case 0:\n                    pointer.button = \"left\";\n                    break;\n                case 1:\n                    pointer.button = \"middle\";\n                    break;\n                case 2:\n                    pointer.button = \"right\";\n                    break;\n            }\n\n            switch (oEvent.type) {\n                case 'click':\n                case 'contextmenu':\n                    pointer.type = emp.typeLibrary.Pointer.EventType.SINGLE_CLICK;\n                    break;\n                case 'dblclick':\n                    pointer.type = emp.typeLibrary.Pointer.EventType.DBL_CLICK;\n                    break;\n                case 'mousedown':\n                    pointer.type = emp.typeLibrary.Pointer.EventType.MOUSEDOWN;\n                    break;\n                case 'mouseup':\n                    pointer.type = emp.typeLibrary.Pointer.EventType.MOUSEUP;\n                    break;\n                case 'mousemove':\n                    pointer.type = emp.typeLibrary.Pointer.EventType.MOVE;\n                    break;\n            }\n\n            if (oEvent.hasOwnProperty('containerPoint')) {\n                pointer.clientX = oEvent.containerPoint.x; // .originalEvent.clientX;\n                pointer.clientY = oEvent.containerPoint.y; // .originalEvent.clientY;\n            } else {\n                var oPoint = instanceInterface.leafletInstance.latLngToContainerPoint(oEvent.latlng);\n                pointer.clientX = oPoint.x;\n                pointer.clientY = oPoint.y;\n            }\n            pointer.screenX = oEvent.originalEvent.pageX; //screenX;\n            pointer.screenY = oEvent.originalEvent.pageY; //screenY;\n\n            if (!pointer.hasOwnProperty('target')) {\n                pointer.target = \"globe\";\n            }\n\n            pointer.altKey = oEvent.originalEvent.altKey;\n            pointer.ctrlKey = oEvent.originalEvent.ctrlKey;\n            pointer.shiftKey = oEvent.originalEvent.shiftkey;\n            pointer.keys = [];\n            if (pointer.altKey) {\n                pointer.keys.push(\"alt\");\n            }\n            if (pointer.ctrlKey) {\n                pointer.keys.push(\"ctrl\");\n            }\n            if (pointer.shiftKey) {\n                pointer.keys.push(\"shift\");\n            }\n            if (pointer.keys.length < 1) {\n                pointer.keys.push(\"none\");\n            }\n\n            instanceInterface.empMapInstance.eventing.Pointer(pointer);\n        },\n        addMapLayer: function (oMap) {\n            if (!instanceInterface.leafletInstance.hasLayer(oMap)) {\n                instanceInterface.leafletInstance.addLayer(oMap);\n            }\n        },\n        removeMapLayer: function (oMap) {\n            if (instanceInterface.leafletInstance.hasLayer(oMap)) {\n                instanceInterface.leafletInstance.removeLayer(oMap);\n            }\n        },\n        scheduleRendering: function () {\n          var sCoreID,\n              i,\n              renderList;\n\n          if (instanceInterface.hTGRenderingTimer) {\n            clearTimeout(instanceInterface.hTGRenderingTimer);\n            instanceInterface.hTGRenderingTimer = undefined;\n          }\n\n          instanceInterface.oGraphicsInViewingArea = [];\n          var oMapBounds = instanceInterface.leafletInstance.getBounds();\n          var oEmpMapBounds = new leafLet.typeLibrary.EmpBoundary(oMapBounds.getSouthWest(), oMapBounds.getNorthEast());\n          var oFeatureBounds = undefined;\n\n          for (sCoreID in instanceInterface.mapEngObjectList) {\n            if (!instanceInterface.mapEngObjectList.hasOwnProperty(sCoreID)) {\n              continue;\n            }\n            var oEmpObject = instanceInterface.mapEngObjectList[sCoreID];\n            if (oEmpObject.getObjectType() === leafLet.typeLibrary.objectType.FEATURE) {\n              // Put it on the list only if it's visible\n              if (oEmpObject.isVisible()) {\n                try {\n                  oFeatureBounds = oEmpObject.getFeatureBounds();\n                  if (oEmpObject.isMilStd()) {\n                    if (oEmpObject.isMultiPointTG()) {\n                      // EMP feature object is a TG. Put it on the list only if it's within the bounds.\n                      if (oFeatureBounds && oFeatureBounds.intersects(oEmpMapBounds)) {\n                        instanceInterface.oGraphicsInViewingArea.push(oEmpObject);\n                      }\n                    } else {\n                      // EMP feature object is a single point icon. Check to see if the view has entered a new zone. If\n                      // it has we want to add the feature to the list. If it hasn't then there is no need to redraw and\n                      // all that needs to occur is a potential update of the positions.\n                      if (instanceInterface.renderingOptimization.zoneChanged &&\n                         !instanceInterface.renderingOptimization.isOnRenderList(sCoreID)) {\n                          instanceInterface.renderingOptimization.addToRenderList(sCoreID, oEmpObject);\n                          instanceInterface.oGraphicsInViewingArea.push(oEmpObject);\n                      } else {\n                        oEmpObject.updateCoordinates(oMapBounds);\n                      }\n                    }\n                  } else if (oEmpObject.isAirspace() || oEmpObject.isAOI() || oEmpObject.isGeoEllipse()) {\n                    // Put it on the list only if it's within the bounds.\n                    if (oFeatureBounds && oFeatureBounds.intersects(oEmpMapBounds)) {\n                      instanceInterface.oGraphicsInViewingArea.push(oEmpObject);\n                    }\n                  } else {\n                    oEmpObject.updateCoordinates(oMapBounds);\n                  }\n                } catch (Ex) {\n                }\n              }\n            }\n          }\n          // Need to check the renderList hash to see if there are any pending items available to re-render.\n          // This condition and course of actions must occur because an event which causes a re-render scheduling can\n          // generate after the onZoomEnd event and potentially cause the previous rendering execution to abort.\n          if (!instanceInterface.renderingOptimization.zoneChanged &&\n              !instanceInterface.renderingOptimization.isRenderListEmpty()) {\n            renderList = instanceInterface.renderingOptimization.getRenderList();\n            for (i in renderList) {\n              instanceInterface.oGraphicsInViewingArea.push(renderList[i]);\n            }\n          }\n          if (instanceInterface.oGraphicsInViewingArea.length > 0) {\n            instanceInterface.hTGRenderingTimer = setTimeout(instanceInterface.RerenderingTimerHdlr, 500);\n          }\n        },\n        RerenderingTimerHdlr: function () {\n          var iIndex = 0,\n              currentGraphic,\n              removedGraphicId;\n\n          while (instanceInterface.oGraphicsInViewingArea.length > 0) {\n            if (iIndex === 100) {\n              instanceInterface.hTGRenderingTimer = setTimeout(instanceInterface.RerenderingTimerHdlr, 100);\n              return;\n            }\n\n            if (instanceInterface.oGraphicsInViewingArea[0].isInEditMode()) {\n              instanceInterface.oCurrentEditor.render();\n            } else {\n              instanceInterface.oGraphicsInViewingArea[0].render();\n            }\n            currentGraphic = instanceInterface.oGraphicsInViewingArea.splice(0, 1);\n            removedGraphicId = currentGraphic[0].options.featureId;\n            if (instanceInterface.renderingOptimization.isOnRenderList(removedGraphicId)) {\n              instanceInterface.renderingOptimization.removeFromRenderList(removedGraphicId);\n            }\n            iIndex++;\n          }\n        },\n        processViewSetTrans: function () {\n            var oTrans;\n            var aViewSetTransList = instanceInterface.findTransactionByIntent(emp.intents.control.VIEW_SET);\n\n            for (var iIndex = 0; iIndex < aViewSetTransList.length; iIndex++) {\n                oTrans = aViewSetTransList[iIndex];\n                instanceInterface.getView(oTrans.items[0]);\n                instanceInterface.removeTransaction(oTrans.transactionId);\n                oTrans.run();\n            }\n        },\n        mapResizeFn: function () {\n            instanceInterface.getLeafletMap()._onResize();\n        },\n        isV2Core: function () {\n            return instanceInterface.bIsV2Core;\n        },\n        setLookAt: function(lookAt) {\n            var range;\n            var tilt;\n            var oMap = instanceInterface.getLeafletMap();\n            var level = oMap.getZoom();\n\n            if (lookAt) {\n                // We project the range on to the vertical so the camera is at the correct altitude but looking down.\n                range = lookAt.altitude + (lookAt.range * Math.cos(lookAt.tilt));\n\n                if (range < instanceInterface.zoomScaleMap[instanceInterface.zoomScaleMap.length - 1]) {\n                    range = instanceInterface.zoomScaleMap[instanceInterface.zoomScaleMap.length - 1];\n                }\n\n                // Leaflet is a 2D map, so we do not need to deal with the altitude.\n\n                try {\n                    oMap.setView(new L.LatLng(lookAt.latitude, lookAt.longitude), level, {animate: false});\n                    if (range && !isNaN(range)) {\n                        level = instanceInterface.getLevel(range * instanceInterface.rangeToScaleMultiplier);\n                        oMap.setZoom(level, {animate: false});\n                    }\n\n                    return true;\n                } catch (err) {\n                }\n            }\n            return false;\n        }\n    };\n\n    engineInterface.initialize.succeed = function () {\n        var oLayerList = [];\n        var oLayerEntry;\n        var oControl;\n        var oLeafletContent;\n        var sCoreId = instanceInterface.sContentCoreId;\n        var myElement = document.getElementById(instanceInterface.engineParameters.container);\n\n        window.addResizeListener(myElement, instanceInterface.mapResizeFn);\n\n        if (bounds !== undefined) {\n            instanceInterface.leafletInstance.fitBounds(bounds);\n        }\n\n        instanceInterface.oSelectionManager = new leafLet.SelectionManager({\n            mapInstance: instanceInterface.empMapInstance\n        });\n        instanceInterface.rootOverlayId = emp.helpers.id.newGUID();\n        instanceInterface.mapEngObjectList = {};\n\n        oLeafletContent = new emp.typeLibrary.Static({\n            name: 'Leaflet Content',\n            featureId: sCoreId,\n            overlayId: emp.storage.getRootGuid(instanceInterface.empMapInstance.mapInstanceId),\n            visible: true,\n            coreId: sCoreId,\n            coreParent: emp.storage.getRootGuid(instanceInterface.empMapInstance.mapInstanceId)\n        });\n        oLayerList.push(oLeafletContent);\n\n        oControl = new L.Control.Scale({\n            position: 'bottomright',\n            maxWidth: 200,\n            imperial: false,\n            metric: true,\n            objectType: leafLet.typeLibrary.objectType.LL_CONTROL,\n            coreId: emp.helpers.id.newGUID()\n        });\n\n        oLayerEntry = new emp.typeLibrary.Static({\n            name: 'Scale Bar',\n            featureId: oControl.getCoreId(),\n            overlayId: sCoreId,\n            visible: true,\n            coreId: oControl.getCoreId(),\n            coreParent: sCoreId\n        });\n        oLayerList.push(oLayerEntry);\n\n        instanceInterface.addEmpObject(oControl);\n        instanceInterface.leafletInstance.addControl(oControl);\n\n        oControl = new L.Control.Zoom({\n            position: 'topright',\n            objectType: leafLet.typeLibrary.objectType.LL_CONTROL,\n            coreId: emp.helpers.id.newGUID()\n        });\n\n        instanceInterface.oZoomControl = oControl;\n\n        oLayerEntry = new emp.typeLibrary.Static({\n            name: 'Zoom Buttons',\n            featureId: oControl.getCoreId(),\n            overlayId: sCoreId,\n            visible: true,\n            coreId: oControl.getCoreId(),\n            coreParent: sCoreId\n        });\n        oLayerList.push(oLayerEntry);\n\n        instanceInterface.addEmpObject(oControl);\n        instanceInterface.leafletInstance.addControl(oControl);\n\n        if (instanceInterface.engineParameters.tileLayer.path\n                && !emp.helpers.isEmptyString(instanceInterface.engineParameters.tileLayer.path)) {\n            var oMainMap;\n\n            if (instanceInterface.engineParameters.tileLayer.path.indexOf(\"{x}\") !== -1) {\n                // The initial map must be a Tile Server and not a WMS server.\n                instanceInterface.engineParameters.tileLayer.properties.instanceInterface = instanceInterface;\n                oMainMap = L.tileLayer(instanceInterface.engineParameters.tileLayer.path,\n                        instanceInterface.engineParameters.tileLayer.properties);\n\n                oLayerEntry = new emp.typeLibrary.Static({\n                    name: 'Default Map',\n                    featureId: oMainMap.getCoreId(),\n                    overlayId: sCoreId,\n                    visible: true,\n                    coreId: oMainMap.getCoreId(),\n                    coreParent: sCoreId\n                });\n                oLayerList.push(oLayerEntry);\n\n                instanceInterface.addEmpObject(oMainMap);\n                instanceInterface.addMapLayer(oMainMap);\n            }\n        }\n\n        if (oLayerList.length > 0) {\n            instanceInterface.empMapInstance.eventing.StaticContent(oLayerList);\n        }\n\n        instanceInterface.rootOverlay = new leafLet.typeLibrary.Overlay({\n            item: {\n                coreId: instanceInterface.rootOverlayId,\n                name: \"root Overlay\",\n                visible: true,\n                properties: {}\n            },\n            instanceInterface: instanceInterface\n        });\n\n        instanceInterface.addEmpObject(instanceInterface.rootOverlay);\n        instanceInterface.leafletInstance.addLayer(instanceInterface.rootOverlay);\n\n        setupEventListeners();\n        /*\n         instanceInterface.oLabelList.push(\"V\");\n         instanceInterface.oLabelList.push(\"L\");\n         instanceInterface.oLabelList.push(\"S\");\n         instanceInterface.oLabelList.push(\"AA\");\n         instanceInterface.oLabelList.push(\"AB\");\n         instanceInterface.oLabelList.push(\"AC\");\n         instanceInterface.oLabelList.push(\"H\");\n         instanceInterface.oLabelList.push(\"M\");\n         instanceInterface.oLabelList.push(\"T\");\n         instanceInterface.oLabelList.push(\"T1\");\n         instanceInterface.oLabelList.push(\"CN\");\n         instanceInterface.oLabelList.push(\"C\");\n         instanceInterface.oLabelList.push(\"F\");\n         instanceInterface.oLabelList.push(\"G\");\n         instanceInterface.oLabelList.push(\"H1\");\n         instanceInterface.oLabelList.push(\"H2\");\n         instanceInterface.oLabelList.push(\"J\");\n         instanceInterface.oLabelList.push(\"K\");\n         instanceInterface.oLabelList.push(\"N\");\n         instanceInterface.oLabelList.push(\"P\");\n         instanceInterface.oLabelList.push(\"W\");\n         instanceInterface.oLabelList.push(\"W1\");\n         instanceInterface.oLabelList.push(\"X\");\n         instanceInterface.oLabelList.push(\"Y\");\n         instanceInterface.oLabelList.push(\"Z\");\n         */\n        instanceInterface.iMilStdIconSize = 24;\n\n        checkMapWidth();\n        if (instanceInterface.renderingOptimization.enabled) {\n            instanceInterface.renderingOptimization.refreshZone();\n        }\n        //notify application that the map is ready to recieve data\n        instanceInterface.empMapInstance.eventing.StatusChange({status: emp.map.states.READY});\n    };\n\n    engineInterface.initialize.fail = function (args) {\n        instanceInterface.empMapInstance.eventing.StatusChange({\n            status: emp.map.states.MAP_INSTANCE_INIT_FAILED\n        });\n    };\n\n    function checkMapWidth() {\n        var oMapBounds;\n        var center;\n        var angularWidth;\n        var iZoom;\n\n        oMapBounds = instanceInterface.leafletInstance.getBounds();\n        center = instanceInterface.leafletInstance.getCenter();\n        angularWidth = Math.abs(oMapBounds.getEast() - oMapBounds.getWest());\n\n        //console.log(\"Deg Wide : \" + angularWidth);\n        // We must make sure we don't zoom out beyond 180 deg width. The render has problems rendering\n        // graphics when the BBox is wider than 180.\n        if (angularWidth >= 180.0) {\n            iZoom = instanceInterface.leafletInstance.getZoom() + 1;\n            instanceInterface.leafletInstance.setView(center, iZoom, {animate: false});\n        }\n    };\n\n    function checkMapCenter() {\n        // Leaflet allows the map to be moved out of view north or south.\n        // This code is here to stop this from happening.\n        var oMapBounds,\n                oNorthWest,\n                oTopLeft,\n                oSouthEast,\n                oBottomRight,\n                $Container,\n                iContainerHeight;\n\n        oMapBounds = instanceInterface.leafletInstance.getBounds();\n\n        oNorthWest = new L.LatLng(oMapBounds.getNorth(), oMapBounds.getWest());\n        oTopLeft = instanceInterface.leafletInstance.latLngToContainerPoint(oNorthWest);\n\n        if (oTopLeft.y > 10) {\n            //console.log(\"TopLeft X:\" + oTopLeft.x + \" Y:\" + oTopLeft.y);\n            oTopLeft.x = 0;\n            instanceInterface.leafletInstance.panBy(oTopLeft, {animate: false});\n        } else {\n            $Container = $(instanceInterface.leafletInstance.getContainer());\n            iContainerHeight = $Container.height();\n            oSouthEast = new L.LatLng(oMapBounds.getSouth(), oMapBounds.getEast());\n            oBottomRight = instanceInterface.leafletInstance.latLngToContainerPoint(oSouthEast);\n\n            if (oBottomRight.y < iContainerHeight) {\n                //console.log(\"BottomRight X:\" + oBottomRight.x + \" Y:\" + oBottomRight.y);\n                oBottomRight.x = 0;\n                oBottomRight.y = oBottomRight.y - iContainerHeight;\n                instanceInterface.leafletInstance.panBy(oBottomRight, {animate: false});\n            }\n        }\n    };\n\n    function setupEventListeners() {\n        function onMouseMove(e) {\n            var eventData = {};\n            eventData.lat = e.latlng.lat;\n            eventData.lon = leafLet.utils.normilizeLongitude(e.latlng.lng);\n            eventData.mgrs = emp.geoLibrary.ddToMGRS(eventData.lat, eventData.lon);\n            eventData.type = emp.typeLibrary.Pointer.EventType.MOVE;\n            instanceInterface.empMapInstance.eventing.Pointer(eventData);\n        }\n\n        function onMoveEnd(e) {\n          var center,\n              mapBounds;\n\n          checkMapCenter();\n          center = instanceInterface.leafletInstance.getCenter();\n          if ((center.lng < -180.0) || (center.lng > 180.0)) {\n            instanceInterface.leafletInstance.setView(center.wrap());\n            return;\n          }\n          if (instanceInterface.renderingOptimization.enabled) {\n            instanceInterface.renderingOptimization.refreshZone();\n          }\n          var view = instanceInterface.getView();\n          var lookAt = instanceInterface.viewToLookAt(view);\n          instanceInterface.scheduleRendering(view);\n          instanceInterface.empMapInstance.eventing.ViewChange(view, lookAt);\n          instanceInterface.processViewSetTrans();\n        }\n\n        function onMapClick(e) {\n            var button = e.originalEvent.button;\n\n            if ((button !== 0) ||\n                    e.originalEvent.altKey ||\n                    !e.originalEvent.ctrlKey ||\n                    e.originalEvent.shiftKey) {\n                instanceInterface.oSelectionManager.deselectAllFeatures();\n                instanceInterface.oSelectionManager.generateEvent();\n            }\n\n            instanceInterface.generatePointerEvent(e, instanceInterface.getView());\n            e.originalEvent.preventDefault();\n        }\n\n        function onZoomEnd(oEvent) {\n          checkMapWidth();\n          //var view = instanceInterface.getView();\n          // lookAt = instanceInterface.viewToLookAt(view);\n\n          //instanceInterface.empMapInstance.eventing.ViewChange(view, lookAt);\n          //instanceInterface.processViewSetTrans();\n        }\n\n        function onViewReset(e) {\n          //checkMapWidth();\n          //instanceInterface.scheduleRendering();\n        }\n\n        function onMouseUpDown(e) {\n            instanceInterface.generatePointerEvent(e, instanceInterface.getView());\n            e.originalEvent.preventDefault();\n        }\n\n        instanceInterface.leafletInstance.on('mousemove', onMouseMove);\n        instanceInterface.leafletInstance.on('moveend', onMoveEnd);\n        instanceInterface.leafletInstance.on('mousedown', onMouseUpDown);\n        instanceInterface.leafletInstance.on('mouseup', onMouseUpDown);\n        instanceInterface.leafletInstance.on('contextmenu', onMapClick);\n        instanceInterface.leafletInstance.on('click', onMapClick);\n        instanceInterface.leafletInstance.on('viewreset', onViewReset);\n        instanceInterface.leafletInstance.on('zoomend', onZoomEnd);\n    }\n    /*\n     // The plugin to do the screen capture requires that leaflet be\n     // set L_PREFER_CANVAS = true; which causes all L.Path\n     // derived types to fail to generate events.\n     // Therefore the current version will not support screenshots.\n\n     engineInterface.capture.screenshot = function (transaction) {\n\n     transaction.pause();\n     //var box2d = map.getBounds();\n\n     function doImage(err, canvas) {\n\n     transaction.items[0].dataUrl = canvas.toDataURL();\n     transaction.run();\n\n     }\n     leafletImage(instanceInterface.leafletInstance, doImage);\n     };\n     */\n\n    //engineInterface.status = {};\n    engineInterface.status.get = function (transaction) {\n        var status = new emp.typeLibrary.Status({\n            intent: transaction.intent,\n            status: getStatus()\n        });\n        //console.log(\"get status\");\n        transaction.items[0] = status;\n\n        return true;\n    };\n\n    engineInterface.status.reset = function () {\n        //console.log(\"reset status\");\n    };\n\n    engineInterface.state.destroy = function () {\n        var oEmpObject;\n        var myElement = document.getElementById(instanceInterface.engineParameters.container);\n\n        window.removeResizeListener(myElement, instanceInterface.mapResizeFn);\n\n        var sKeys = emp.helpers.associativeArray.getKeys(instanceInterface.mapEngObjectList);\n\n        for (var iIndex = 0; iIndex < sKeys.length; iIndex++) {\n            oEmpObject = instanceInterface.mapEngObjectList[sKeys[iIndex]];\n            if (oEmpObject) {\n                switch (oEmpObject.getObjectType()) {\n                    case leafLet.typeLibrary.objectType.LL_CONTROL:\n                        if (oEmpObject._map) {\n                            instanceInterface.getLeafletMap().removeControl(oEmpObject);\n                        }\n                        break;\n                    case leafLet.typeLibrary.objectType.LL_DEFAULT_MAP:\n                        instanceInterface.removeMapLayer(oEmpObject);\n                        break;\n                    default:\n                        oEmpObject.destroy();\n                        break;\n                }\n                instanceInterface.removeEmpObject(oEmpObject);\n            }\n        }\n\n        instanceInterface.leafletInstance.remove();\n        instanceInterface.leafletInstance = undefined;\n        instanceInterface.oSelectionManager.destroy();\n        instanceInterface.oSelectionManager = undefined;\n        instanceInterface.oLabelList = [];\n        instanceInterface.oLayerControl = undefined;\n        instanceInterface.oGraphicsInViewingArea = [];\n        instanceInterface.mapEngObjectList = undefined;\n        instanceInterface.rootOverlayId = undefined;\n        instanceInterface.rootOverlay = undefined;\n    };\n\n    engineInterface.visibility.set = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n\n            if (item.coreId === instanceInterface.sContentCoreId) {\n                // The leaflet content does not really exist.\n                continue;\n            }\n            try {\n                var oObject = instanceInterface.mapEngObjectList[item.coreId];\n\n                if (oObject !== undefined) {\n                    switch (oObject.getObjectType()) {\n                        case leafLet.typeLibrary.objectType.LL_CONTROL:\n                            if (item.visible) {\n                                if (!oObject._map) {\n                                    instanceInterface.getLeafletMap().addControl(oObject);\n                                }\n                            } else {\n                                if (oObject._map) {\n                                    instanceInterface.getLeafletMap().removeControl(oObject);\n                                }\n                            }\n                            break;\n                        case leafLet.typeLibrary.objectType.LL_DEFAULT_MAP:\n                            if (item.visible) {\n                                instanceInterface.addMapLayer(oObject);\n                            } else {\n                                instanceInterface.removeMapLayer(oObject);\n                            }\n                            break;\n                        default:\n                            oObject.setVisibility(item);\n                            break;\n                    }\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"Object \" + item.coreId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                    continue;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.overlay.add = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n\n            try {\n                var oNewOverlay = new leafLet.typeLibrary.Overlay({\n                    item: item,\n                    instanceInterface: instanceInterface\n                });\n\n                if (oNewOverlay.getParentCoreId() === undefined) {\n                    // The parent is the root overlay.\n                    instanceInterface.rootOverlay.addChildObject(oNewOverlay);\n                } else if (instanceInterface.mapEngObjectList.hasOwnProperty(oNewOverlay.getParentCoreId())) {\n                    // The parent exists.\n                    var oParentOverlay = instanceInterface.mapEngObjectList[oNewOverlay.getParentCoreId()];\n\n                    oParentOverlay.addChildObject(oNewOverlay);\n                } else {\n                    // A map engine does not have to create a parent overlay if it does not exists.\n                    // The parent does not exists.\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"Parent overlay \" + item.parentId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                    continue;\n                }\n\n                instanceInterface.addEmpObject(oNewOverlay);\n\n                if (oNewOverlay.isClusterActive()) {\n                    oNewOverlay.activateCluster();\n                } else if (oNewOverlay.hasClusterDef()) {\n                    oNewOverlay.clusterActivate();\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.overlay.remove = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n            try {\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    // The overlay exists.\n                    var oParentOverlay;\n                    var oOverlay = instanceInterface.mapEngObjectList[item.coreId];\n\n                    if (item.parentCoreId === undefined) {\n                        // The parent is the root.\n                        oParentOverlay = instanceInterface.rootOverlay;\n                    } else {\n                        oParentOverlay = instanceInterface.mapEngObjectList[item.parentCoreId];\n                    }\n\n                    oParentOverlay.removeChildObject(oOverlay);\n                    oOverlay.destroy();\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"Overlay \" + item.overlayId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.overlay.update = function (transaction) {\n        var oaItems = transaction.items;\n        var oOverlay;\n        var oItem;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            oItem = oaItems[iIndex];\n            try {\n                oOverlay = instanceInterface.getEmpObject(oItem.coreId);\n\n                if (oOverlay) {\n                    // The overlay exists.\n                    if (oItem.hasOwnProperty('parentId') &&\n                            (oItem.parentId !== oOverlay.getParentId())) {\n                        // Its being re-parented.\n                        var oParentOverlay = oOverlay.getParentObject();\n                        var oNewParent;\n\n                        if (!oParentOverlay) {\n                            transaction.fail(new emp.typeLibrary.Error({\n                                coreId: oItem.coreId,\n                                level: emp.typeLibrary.Error.level.MAJOR,\n                                message: \"Current Parent Overlay \" + oOverlay.getParentId() + \" not found.\"\n                            }));\n                            iIndex--;\n                            continue;\n                        }\n\n                        if (oItem.parentId) {\n                            oNewParent = instanceInterface.getEmpObject(oItem.parentId);\n                        } else {\n                            // If parentId is present but equal null\n                            // its being moved to the root.\n                            oNewParent = instanceInterface.rootOverlay;\n                        }\n\n                        if (!oNewParent) {\n                            transaction.fail(new emp.typeLibrary.Error({\n                                coreId: oItem.coreId,\n                                level: emp.typeLibrary.Error.level.MAJOR,\n                                message: \"New Parent Overlay \" + oItem.parentId + \" not found.\"\n                            }));\n                            iIndex--;\n                            continue;\n                        }\n\n                        oParentOverlay.removeChildObject(oOverlay);\n                        oNewParent.addChildObject(oOverlay);\n                    }\n\n                    if (oItem.hasOwnProperty('name') &&\n                            (oItem.name !== oOverlay.getName())) {\n                        oOverlay.setName(oItem.name);\n                    }\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: oItem.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"Overlay \" + oItem.overlayId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: oItem.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.overlay.clear = function (transaction) {\n        var i,\n                len = transaction.items.length,\n                items = transaction.items,\n                item,\n                overlay;\n\n        for (i = 0; i < len; i++) {\n            try {\n                item = items[i];\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    overlay = instanceInterface.mapEngObjectList[item.coreId];\n                    overlay.clearChildren();\n                }\n            } catch (err) {\n                transaction.fail([new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        message: \"An error occurred while attempting to clear an overlay with the id \" + item.coreId + \" : \",\n                        level: emp.typeLibrary.Error.level.MINOR,\n                        jsError: err\n                    })]);\n                i--;\n            }\n        }\n    };\n\n    engineInterface.overlay.style = function (transaction) {\n        var oaItems = transaction.items;\n        var oOverlay;\n        var oItem;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            oItem = oaItems[iIndex];\n            try {\n                oOverlay = instanceInterface.getEmpObject(oItem.coreId);\n\n                if (oOverlay) {\n                    oOverlay.setStyle(oItem.type, oItem.properties);\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: oItem.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"Overlay \" + oItem.overlayId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: oItem.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.overlay.cluster.set = function (transaction) {\n        var oOverlay;\n        var oItem = transaction.items[0];\n\n        if (oItem === undefined) {\n            transaction.fail([{\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Set transaction with no data.\"\n                }]);\n            return;\n        }\n\n        oOverlay = instanceInterface.mapEngObjectList[oItem.getCoreId()];\n\n        if (!oOverlay) {\n            transaction.fail([{\n                    coreId: oItem.getCoreId(),\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Set transaction overlay not found.\"\n                }]);\n            return;\n        }\n\n        oOverlay.clusterSet(oItem);\n    };\n\n    engineInterface.overlay.cluster.activate = function (transaction) {\n        var oOverlay;\n        var oItem = transaction.items[0];\n\n        if (oItem === undefined) {\n            transaction.fail([{\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Activate transaction with no data.\"\n                }]);\n            return;\n        }\n\n        oOverlay = instanceInterface.mapEngObjectList[oItem.getCoreId()];\n\n        if (!oOverlay) {\n            transaction.fail([{\n                    coreId: oItem.getCoreId(),\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Activate transaction overlay not found.\"\n                }]);\n            return;\n        }\n\n        oOverlay.clusterActivate();\n    };\n\n    engineInterface.overlay.cluster.deactivate = function (transaction) {\n        var oOverlay;\n        var oItem = transaction.items[0];\n\n        if (oItem === undefined) {\n            transaction.fail([{\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Deactivate transaction with no data.\"\n                }]);\n            return;\n        }\n\n        oOverlay = instanceInterface.mapEngObjectList[oItem.getCoreId()];\n\n        if (!oOverlay) {\n            transaction.fail([{\n                    coreId: oItem.getCoreId(),\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Deactivate transaction overlay not found.\"\n                }]);\n            return;\n        }\n\n        oOverlay.clusterDeactivate();\n    };\n\n    engineInterface.overlay.cluster.remove = function (transaction) {\n        var oOverlay;\n        var oItem = transaction.items[0];\n\n        if (oItem === undefined) {\n            transaction.fail([{\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Remove transaction with no data.\"\n                }]);\n            return;\n        }\n\n        oOverlay = instanceInterface.mapEngObjectList[oItem.getCoreId()];\n\n        if (!oOverlay) {\n            transaction.fail([{\n                    coreId: oItem.getCoreId(),\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Overlay Cluster Remove transaction overlay not found.\"\n                }]);\n            return;\n        }\n\n        oOverlay.clusterRemove();\n    };\n\n    engineInterface.view.set = function (transaction) {\n        var item = transaction.items[0],\n                oMap = instanceInterface.getLeafletMap(),\n                level = oMap.getZoom(),\n                bZoom = ((item.zoom === true) ? true : ((typeof (item.zoom) === 'number') && (item.zoom > 0)) ? true : false);\n\n        try {\n            if (item.location) {\n                oMap.setView(new L.LatLng(item.location.lat, item.location.lon), level, {animate: false});\n                if (item.range && !isNaN(item.range)) {\n                    level = instanceInterface.getLevel(item.range * instanceInterface.rangeToScaleMultiplier);\n                    oMap.setZoom(level, {animate: false});\n                }\n            } else if (item.bounds) {\n                var southWest = L.latLng(item.bounds.south, item.bounds.west),\n                        northEast = L.latLng(item.bounds.north, item.bounds.east),\n                        bounds = L.latLngBounds(southWest, northEast);\n\n                oMap.fitBounds(bounds);\n                if (item.range && !isNaN(item.range)) {\n                    level = instanceInterface.getLevel(item.range * instanceInterface.rangeToScaleMultiplier);\n                    oMap.setZoom(level, {animate: false});\n                }\n            } else if (item.featureId || item.overlayId) {\n                //result = goToLocationById(item);\n                var oEmpObject = instanceInterface.mapEngObjectList[item.coreId];\n\n                if (oEmpObject !== undefined) {\n                    if (oEmpObject.getObjectType() === leafLet.typeLibrary.objectType.OVERLAY) {\n                        // We need to check to see if it has features in it.\n                        if (!oEmpObject.hasFeatures()) {\n                            transaction.fail(new emp.typeLibrary.Error({\n                                coreId: item.coreId,\n                                level: emp.typeLibrary.Error.level.MINOR,\n                                message: \"Overlay \" + oEmpObject.options.name + \" is empty.\"\n                            }));\n                            return;\n                        }\n                    }\n                    var oEmpBounds = oEmpObject.getFeatureBounds();\n\n                    if (oEmpBounds) {\n                        if (bZoom) {\n                            if (oEmpBounds.getCenterWidth() < 16093) {\n                                oEmpBounds.setCenterWidth(16093);\n                            }\n                            oMap.fitBounds(new L.LatLngBounds(oEmpBounds.getSouthWest(), oEmpBounds.getNorthEast()), {animate: false});\n                        } else {\n                            var oCenter = oEmpBounds.getCenter();\n                            oMap.setView(new L.LatLng(oCenter.lat, oCenter.lng), level, {animate: false});\n                        }\n                    }\n                }\n            }\n//            else if (item.range || (item.zoom !== false)) {\n            else if (item.range) {\n                level = instanceInterface.getLevel(item.range * instanceInterface.rangeToScaleMultiplier);\n                oMap.setZoom(level, {animate: false});\n            }\n\n            instanceInterface.getView(transaction.items[0]);\n        } catch (err) {\n            transaction.fail([new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    message: \"An error occurred while attempting to set the map view: \",\n                    level: emp.typeLibrary.Error.level.MINOR,\n                    jsError: err\n                })]);\n        }\n    };\n\n    engineInterface.view.get = function (transaction) {\n        var failList = [];\n\n        try {\n            instanceInterface.getView(transaction.items[0]);\n        } catch (err) {\n            failList.push(new emp.typeLibrary.Error({\n                coreId: transaction.items[0].coreId,\n                message: \"An error occurred while getting the maps view: \",\n                level: emp.typeLibrary.Error.level.MINOR,\n                jsError: err\n            }));\n            transaction.fail(failList);\n        }\n        return true;\n    };\n\n    engineInterface.feature.add = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n\n            try {\n                var oNewFeature;\n\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    // Its an update\n                    oNewFeature = instanceInterface.mapEngObjectList[item.coreId];\n\n                    oNewFeature.updateFeature(item);\n\n                    if (oNewFeature.isInEditMode()) {\n                        instanceInterface.oCurrentEditor.render();\n                    }\n                } else {\n                    switch (item.format) {\n                        case emp.typeLibrary.featureFormatType.MILSTD:\n                            if (instanceInterface.isV2Core()) {\n                                emp.util.milstdColorFix(item);\n                            }\n                            oNewFeature = new leafLet.typeLibrary.MilStdFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.KML:\n                            oNewFeature = new leafLet.typeLibrary.KMLFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.GEOJSON:\n                        case emp.typeLibrary.featureFormatType.GEO_POINT:\n                        case emp.typeLibrary.featureFormatType.GEO_PATH:\n                        case emp.typeLibrary.featureFormatType.GEO_POLYGON:\n                            if (leafLet.utils.geoJson.isAOI(item)) {\n                                oNewFeature = new leafLet.typeLibrary.AOIFeature({\n                                    item: item,\n                                    instanceInterface: instanceInterface\n                                });\n                            } else {\n                                oNewFeature = new leafLet.typeLibrary.GeoJsonFeature({\n                                    item: item,\n                                    instanceInterface: instanceInterface\n                                });\n                            }\n                            break;\n                        case emp.typeLibrary.featureFormatType.AIRSPACE:\n                            oNewFeature = leafLet.utils.airspace.createAirspace({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.IMAGE:\n                            oNewFeature = new leafLet.typeLibrary.ImageFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.GEO_TEXT:\n                            oNewFeature = new leafLet.typeLibrary.GeoTextFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.GEO_RECTANGLE:\n                            oNewFeature = new leafLet.typeLibrary.GeoRectangleFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.GEO_SQUARE:\n                            oNewFeature = new leafLet.typeLibrary.GeoSquareFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.GEO_CIRCLE:\n                            oNewFeature = new leafLet.typeLibrary.GeoCircleFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        case emp.typeLibrary.featureFormatType.GEO_ELLIPSE:\n                            oNewFeature = new leafLet.typeLibrary.GeoEllipseFeature({\n                                item: item,\n                                instanceInterface: instanceInterface\n                            });\n                            break;\n                        default:\n                            throw new Error(item.format + \" features are not yet supported.\");\n                            //break;\n                    }\n\n                    if (instanceInterface.mapEngObjectList.hasOwnProperty(oNewFeature.getParentCoreId())) {\n                        // The parent exists.\n                        var oParentOverlay = instanceInterface.mapEngObjectList[oNewFeature.getParentCoreId()];\n\n                        oParentOverlay.addChildObject(oNewFeature);\n                    } else {\n                        // A map engine no longer has to create the parent overlay if it does not exists.\n                        // The parent does not exists.\n                        transaction.fail(new emp.typeLibrary.Error({\n                            coreId: item.coreId,\n                            level: emp.typeLibrary.Error.level.MAJOR,\n                            message: \"Parent \" + item.parentId + \" does not exists.\"\n                        }));\n                        iIndex--;\n                        continue;\n                    }\n\n                    instanceInterface.addEmpObject(oNewFeature);\n\n                    if (item.zoom && !instanceInterface.bInDrawMode && !instanceInterface.bInEditMode) {\n                        var oEmpBounds = oNewFeature.getFeatureBounds();\n\n                        if (oEmpBounds.getCenterWidth() < 16093) {\n                            oEmpBounds.setCenterWidth(16093);\n                        }\n                        instanceInterface.leafletInstance.fitBounds(new L.LatLngBounds(oEmpBounds.getSouthWest(), oEmpBounds.getNorthEast()));\n                    }\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.feature.remove = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n            try {\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    // The feature exists.\n                    var oParentOverlay;\n                    var oFeature = instanceInterface.mapEngObjectList[item.coreId];\n\n                    if (oFeature.isInEditMode()) {\n                        instanceInterface.oCurrentEditor.cancelEdit();\n                        instanceInterface.oCurrentEditor.destroy();\n                        instanceInterface.bInEditMode = false;\n                        instanceInterface.oCurrentEditor = undefined;\n                        instanceInterface.oEditTransaction.run();\n                        instanceInterface.oEditTransaction = undefined;\n                    }\n\n                    if (item.parentCoreId === undefined) {\n                        // The parent is the root.\n                        oParentOverlay = instanceInterface.rootOverlay;\n                    } else {\n                        oParentOverlay = instanceInterface.mapEngObjectList[item.parentCoreId];\n                    }\n\n                    if (oParentOverlay) {\n                        oParentOverlay.removeChildObject(oFeature);\n                        oFeature.destroy();\n                    } else {\n                        transaction.fail(new emp.typeLibrary.Error({\n                            coreId: item.coreId,\n                            level: emp.typeLibrary.Error.level.MAJOR,\n                            message: \"Parent of feature \" + item.featureId + \" was not found.\"\n                        }));\n                        iIndex--;\n                    }\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"Feature \" + item.featureId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.feature.update = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n\n            try {\n                var oFeature;\n\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    // Its an update\n                    oFeature = instanceInterface.mapEngObjectList[item.coreId];\n\n                    if (item.name) {\n                        // The Name is changing.\n                        oFeature.updateFeature(item);\n\n                        if (oFeature.isInEditMode()) {\n                            instanceInterface.oCurrentEditor.render();\n                        }\n                    }\n\n                    if (item.destCoreParent !== undefined) {\n                        // Its being re-parented.\n                        var oOldParent = instanceInterface.mapEngObjectList[item.parentCoreId];\n                        var oNewParent = instanceInterface.mapEngObjectList[item.destCoreParent];\n\n                        oOldParent.removeChildObject(oFeature);\n                        oNewParent.addChildObject(oFeature);\n                    }\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"feature \" + item.featureId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                    continue;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.draw.begin = function (transaction) {\n        var oDrawItem = transaction.items[0];\n        var oOriginalFeature = oDrawItem.originFeature;\n        var oFeature;\n\n        if (oOriginalFeature) {\n            oFeature = instanceInterface.mapEngObjectList[oOriginalFeature.coreId];\n        }\n\n        switch (oDrawItem.type.toLowerCase()) {\n            case \"point\":\n            //case emp.typeLibrary.featureFormatType.GEO_POINT:\n                instanceInterface.oCurrentEditor = new leafLet.editor.GeoJson({\n                    geoJsonType: 'Point',\n                    transaction: transaction,\n                    EmpDrawEditItem: oDrawItem,\n                    feature: oFeature,\n                    instanceInterface: instanceInterface\n                });\n                break;\n            case \"line\":\n            case emp.typeLibrary.featureFormatType.GEO_PATH:\n                instanceInterface.oCurrentEditor = new leafLet.editor.GeoJson({\n                    geoJsonType: 'LineString',\n                    transaction: transaction,\n                    EmpDrawEditItem: oDrawItem,\n                    feature: oFeature,\n                    instanceInterface: instanceInterface\n                });\n                break;\n            case \"polygon\":\n            //case emp.typeLibrary.featureFormatType.GEO_POLYGON:\n                instanceInterface.oCurrentEditor = new leafLet.editor.GeoJson({\n                    geoJsonType: 'Polygon',\n                    transaction: transaction,\n                    EmpDrawEditItem: oDrawItem,\n                    feature: oFeature,\n                    instanceInterface: instanceInterface\n                });\n                break;\n            case \"airspace\":\n                instanceInterface.oCurrentEditor = leafLet.utils.airspace.createEditor(instanceInterface,\n                        transaction, oDrawItem, oFeature);\n                break;\n            case \"milstd\":\n                instanceInterface.oCurrentEditor = leafLet.utils.milstd.createEditor(instanceInterface,\n                        transaction, oDrawItem, oFeature);\n                break;\n            default:\n                break;\n        }\n\n        if (instanceInterface.oCurrentEditor) {\n            transaction.pause();\n            instanceInterface.bInDrawMode = true;\n            instanceInterface.oEditTransaction = transaction;\n        }\n    };\n\n    engineInterface.draw.end = function (transaction) {\n        if (instanceInterface.oEditTransaction.transactionId === transaction.items[0].transactionId) {\n            instanceInterface.oCurrentEditor.endEdit();\n            instanceInterface.oCurrentEditor.destroy();\n            instanceInterface.bInDrawMode = false;\n            instanceInterface.oCurrentEditor = undefined;\n            instanceInterface.oEditTransaction.run();\n            instanceInterface.oEditTransaction = undefined;\n        }\n    };\n\n    engineInterface.draw.cancel = function (transaction) {\n        if (instanceInterface.oEditTransaction.transactionId === transaction.items[0].transactionId) {\n            instanceInterface.oCurrentEditor.cancelEdit();\n            instanceInterface.oCurrentEditor.destroy();\n            instanceInterface.bInDrawMode = false;\n            instanceInterface.oCurrentEditor = undefined;\n            instanceInterface.oEditTransaction.run();\n            instanceInterface.oEditTransaction = undefined;\n        }\n    };\n\n    engineInterface.edit.begin = function (transaction) {\n        var oEditItem = transaction.items[0];\n        var oFeature;\n\n        oFeature = instanceInterface.mapEngObjectList[oEditItem.coreId];\n\n        if (oFeature === undefined) {\n            transaction.fail([{\n                    coreId: oEditItem.coreId,\n                    message: \"Feature not found.\",\n                    level: emp.typeLibrary.Error.level.MAJOR\n                }]);\n        } else if (!oFeature.isEditable()) {\n            transaction.fail([{\n                    coreId: oEditItem.coreId,\n                    message: \"This feature can not be edited.\",\n                    level: emp.typeLibrary.Error.level.MAJOR\n                }]);\n        } else {\n            switch (oFeature.getFormat()) {\n                case emp.typeLibrary.featureFormatType.GEOJSON:\n                case emp.typeLibrary.featureFormatType.GEO_POINT:\n                case emp.typeLibrary.featureFormatType.GEO_PATH:\n                case emp.typeLibrary.featureFormatType.GEO_POLYGON:\n                    if (emp.helpers.isAOI(oFeature.options)) {\n                        instanceInterface.oCurrentEditor = new leafLet.editor.AOI({\n                            transaction: transaction,\n                            EmpDrawEditItem: oEditItem,\n                            feature: oFeature,\n                            instanceInterface: instanceInterface\n                        });\n                    } else {\n                        instanceInterface.oCurrentEditor = new leafLet.editor.GeoJson({\n                            transaction: transaction,\n                            EmpDrawEditItem: oEditItem,\n                            feature: oFeature,\n                            instanceInterface: instanceInterface\n                        });\n                    }\n                    break;\n                case emp.typeLibrary.featureFormatType.KML:\n                    instanceInterface.oCurrentEditor = new leafLet.editor.KML({\n                        transaction: transaction,\n                        EmpDrawEditItem: oEditItem,\n                        feature: oFeature,\n                        instanceInterface: instanceInterface\n                    });\n                    break;\n                case emp.typeLibrary.featureFormatType.MILSTD:\n                    instanceInterface.oCurrentEditor = leafLet.utils.milstd.createEditor(instanceInterface,\n                            transaction, oEditItem, oFeature);\n                    break;\n                case emp.typeLibrary.featureFormatType.AIRSPACE:\n                    instanceInterface.oCurrentEditor = leafLet.utils.airspace.createEditor(instanceInterface,\n                            transaction, oEditItem, oFeature);\n                    break;\n/*\n                case emp.typeLibrary.featureFormatType.GEO_POINT:\n                    instanceInterface.oCurrentEditor = new leafLet.editor.GeoPoint({\n                        transaction: transaction,\n                        EmpDrawEditItem: oEditItem,\n                        feature: oFeature,\n                        instanceInterface: instanceInterface\n                    });\n                    break;\n*/\n                default:\n                    break;\n            }\n        }\n\n        if (instanceInterface.oCurrentEditor) {\n            transaction.pause();\n            instanceInterface.bInEditMode = true;\n            instanceInterface.oEditTransaction = transaction;\n            instanceInterface.oSelectionManager.deselectAllFeatures();\n            instanceInterface.oSelectionManager.selectFeature(oFeature);\n            instanceInterface.oSelectionManager.generateEvent();\n        }\n    };\n\n    engineInterface.edit.end = function (transaction) {\n        if (instanceInterface.oEditTransaction.transactionId === transaction.items[0].transactionId) {\n            instanceInterface.oCurrentEditor.endEdit();\n            instanceInterface.oCurrentEditor.destroy();\n            instanceInterface.bInEditMode = false;\n            instanceInterface.oCurrentEditor = undefined;\n            instanceInterface.oEditTransaction.run();\n            instanceInterface.oEditTransaction = undefined;\n        }\n    };\n\n    engineInterface.edit.cancel = function (transaction) {\n        if (instanceInterface.oEditTransaction.transactionId === transaction.items[0].transactionId) {\n            instanceInterface.oCurrentEditor.cancelEdit();\n            instanceInterface.oCurrentEditor.destroy();\n            instanceInterface.bInEditMode = false;\n            instanceInterface.oCurrentEditor = undefined;\n            instanceInterface.oEditTransaction.run();\n            instanceInterface.oEditTransaction = undefined;\n        }\n    };\n\n    engineInterface.selection.set = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n\n            try {\n                var oFeature;\n\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    oFeature = instanceInterface.mapEngObjectList[item.coreId];\n\n                    if (item.select) {\n                        instanceInterface.oSelectionManager.selectFeature(oFeature, item.selectedId);\n                    } else {\n                        instanceInterface.oSelectionManager.deselectFeature(oFeature, item.selectedId);\n                    }\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"feature \" + item.featureId + \" does not exists.\"\n                    }));\n                    iIndex--;\n                    continue;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n        instanceInterface.oSelectionManager.resetEventData();\n    };\n    engineInterface.navigation = engineInterface.navigation || {};\n    engineInterface.navigation.enable = function (transaction) {\n        var enabled;\n        if (transaction && transaction.items) {\n            enabled = transaction.items[0];\n\n            if (enabled.lock && instanceInterface.oZoomControl._map) {\n                instanceInterface.leafletInstance.dragging.disable();\n                instanceInterface.leafletInstance.scrollWheelZoom.disable();\n                instanceInterface.oZoomControl.removeFrom(instanceInterface.leafletInstance);\n            } else if (!enabled.lock && (instanceInterface.oZoomControl._map === null)){\n                instanceInterface.oZoomControl.addTo(instanceInterface.leafletInstance);\n                instanceInterface.leafletInstance.scrollWheelZoom.enable();\n                // Default to enabling mouse navigation to avoid an error state where user cannot interact with the map\n                instanceInterface.leafletInstance.dragging.enable();\n            }\n        }\n        transaction.run();\n    };\n\n    engineInterface.settings.mil2525.icon.size.set = function (transaction) {\n        var oEmpObject;\n        var sCoreId;\n\n        instanceInterface.iMilStdIconSize = transaction.items[0];\n\n        try {\n            for (sCoreId in instanceInterface.mapEngObjectList) {\n                if (!instanceInterface.mapEngObjectList.hasOwnProperty(sCoreId)) {\n                    continue;\n                }\n                oEmpObject = instanceInterface.mapEngObjectList[sCoreId];\n\n                if ((oEmpObject.getObjectType() === leafLet.typeLibrary.objectType.FEATURE) &&\n                        (oEmpObject.getFormat() === emp.typeLibrary.featureFormatType.MILSTD) &&\n                        !oEmpObject.isMultiPointTG()) {\n                    oEmpObject.updateIconSize();\n                }\n            }\n        } catch (Ex) {\n            new emp.typeLibrary.Error({\n                level: emp.typeLibrary.Error.level.MAJOR,\n                message: Ex.name + \": \" + Ex.message,\n                jsError: Ex\n            });\n        }\n    };\n\n    engineInterface.settings.mil2525.icon.labels.set = function (transaction) {\n        var oEmpObject;\n        var sCoreId;\n\n        try {\n            var sTemp = JSON.stringify(transaction.items[0]);\n            instanceInterface.oLabelList = JSON.parse(sTemp);\n\n            for (sCoreId in instanceInterface.mapEngObjectList) {\n                if (!instanceInterface.mapEngObjectList.hasOwnProperty(sCoreId)) {\n                    continue;\n                }\n                oEmpObject = instanceInterface.mapEngObjectList[sCoreId];\n\n                if ((oEmpObject instanceof leafLet.typeLibrary.MilStdFeature) && !oEmpObject.isMultiPointTG()) {\n                    oEmpObject.updateFeature({bUpdateGraphic: true});\n                }\n            }\n        } catch (Ex) {\n            new emp.typeLibrary.Error({\n                level: emp.typeLibrary.Error.level.MAJOR,\n                message: Ex.name + \": \" + Ex.message,\n                jsError: Ex\n            });\n        }\n    };\n\n    engineInterface.wms.add = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n\n            try {\n                var oNewWMS;\n\n                if (instanceInterface.isV2Core()) {\n                    item.useProxy = emp.util.config.getUseProxySetting();\n                }\n\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    // Its an update\n                    oNewWMS = instanceInterface.mapEngObjectList[item.coreId];\n\n                    oNewWMS.updateWMS(item);\n                } else {\n                    oNewWMS = new leafLet.typeLibrary.WMS({\n                        item: item,\n                        instanceInterface: instanceInterface\n                    });\n\n                    if (instanceInterface.mapEngObjectList.hasOwnProperty(oNewWMS.getParentCoreId())) {\n                        // The parent exists.\n                        var oParentOverlay = instanceInterface.mapEngObjectList[oNewWMS.getParentCoreId()];\n\n                        oParentOverlay.addChildObject(oNewWMS);\n                    } else {\n                        // The parent does not exists.\n                        item.createParent();\n                        if (instanceInterface.mapEngObjectList.hasOwnProperty(oNewWMS.getParentCoreId())) {\n                            // The parent exists.\n                            var oParentOverlay = instanceInterface.mapEngObjectList[oNewWMS.getParentCoreId()];\n\n                            oParentOverlay.addChildObject(oNewWMS);\n                        } else {\n                            transaction.fail(new emp.typeLibrary.Error({\n                                coreId: item.coreId,\n                                level: emp.typeLibrary.Error.level.MAJOR,\n                                message: \"Parent \" + oNewWMS.getParentCoreId() + \" does not exists.\"\n                            }));\n                            iIndex--;\n                            continue;\n                        }\n                    }\n\n                    instanceInterface.addEmpObject(oNewWMS);\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.wms.remove = function (transaction) {\n        var oaItems = transaction.items;\n\n        for (var iIndex = 0; iIndex < oaItems.length; iIndex++) {\n            var item = oaItems[iIndex];\n            try {\n                if (instanceInterface.mapEngObjectList.hasOwnProperty(item.coreId)) {\n                    // The feature exists.\n                    var oParentOverlay;\n                    var oFeature = instanceInterface.mapEngObjectList[item.coreId];\n\n                    if (item.parentCoreId === undefined) {\n                        // The parent is the root.\n                        oParentOverlay = instanceInterface.rootOverlay;\n                    } else {\n                        oParentOverlay = instanceInterface.mapEngObjectList[item.parentCoreId];\n                    }\n\n                    oParentOverlay.removeChildObject(oFeature);\n                    oFeature.destroy();\n                } else {\n                    transaction.fail(new emp.typeLibrary.Error({\n                        coreId: item.coreId,\n                        level: emp.typeLibrary.Error.level.MAJOR,\n                        message: \"WMS \" + item.id + \" does not exists.\"\n                    }));\n                    iIndex--;\n                }\n            } catch (Ex) {\n                transaction.fail(new emp.typeLibrary.Error({\n                    coreId: item.coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: Ex.name + \": \" + Ex.message,\n                    jsError: Ex\n                }));\n                iIndex--;\n            }\n        }\n    };\n\n    engineInterface.view.getLatLonFromXY = function (transaction) {\n        var item;\n        var oLatLng;\n        var oPoint;\n\n        for (var i = 0; i < transaction.items.length; i += 1) {\n            item = transaction.items[i];\n\n            oPoint = new L.Point(item.x, item.y);\n            oLatLng = instanceInterface.leafletInstance.containerPointToLatLng(oPoint);\n\n            if (oLatLng) {\n                item.lat = oLatLng.lat;\n                item.lon = oLatLng.lng;\n            }\n        }\n    };\n\n    engineInterface.view.getXYFromLatLon = function (transaction) {\n        var item;\n        var oLatLng;\n        var oPoint;\n\n        for (var i = 0; i < transaction.items.length; i += 1) {\n            item = transaction.items[i];\n\n            oLatLng = new L.LatLng(item.lat, item.lon);\n\n            oPoint = instanceInterface.leafletInstance.latLngToContainerPoint(oLatLng);\n\n            if (oPoint) {\n                item.x = oPoint.x;\n                item.y = oPoint.y;\n            }\n        }\n    };\n\n    engineInterface.lookAt.set = function(transaction) {\n        var iIndex;\n\n        for (iIndex = 0; iIndex < transaction.items.length; iIndex += 1) {\n            if (instanceInterface.setLookAt(transaction.items[iIndex])) {\n                iIndex++;\n            } else {\n                transaction.fail([{\n                    coreId: transaction.items[iIndex].coreId,\n                    level: emp.typeLibrary.Error.level.MAJOR,\n                    message: \"Fail to set LookAt.\"\n                }]);\n            }\n        }\n    };\n\n    engineInterface.map.config = function (transaction) {\n      var iIndex,\n          prop,\n          previousRenderSettings = {\n            enabled: instanceInterface.renderingOptimization.enabled,\n            midDistanceThreshold: instanceInterface.renderingOptimization.midDistanceThreshold,\n            farDistanceThreshold: instanceInterface.renderingOptimization.farDistanceThreshold.value\n          },\n          newConfig;\n\n      for (iIndex = 0; iIndex < transaction.items.length; iIndex += 1) {\n        newConfig = transaction.items[0];\n        try {\n          for (prop in newConfig) {\n            switch (prop) {\n              case \"renderingOptimization\":\n                if (typeof newConfig[prop] !== 'boolean') {\n                  throw new Error(\"'renderingOptimization' property must be of Boolean type.\");\n                }\n                instanceInterface.renderingOptimization.enabled = newConfig[prop];\n                break;\n              case \"midDistanceThreshold\":\n                if (typeof newConfig[prop] !== 'number') {\n                  throw new Error(\"'midDistanceThreshold' property must be of Number type.\");\n                }\n                instanceInterface.renderingOptimization.midDistanceThreshold = newConfig[prop];\n                break;\n              case \"farDistanceThreshold\":\n                if (typeof newConfig[prop] !== 'number') {\n                  throw new Error(\"'farDistanceThreshold' property must be of Number type.\");\n                }\n                instanceInterface.renderingOptimization.farDistanceThreshold.value = newConfig[prop];\n                break;\n              case \"brightness\":\n                break;\n            }\n          }\n          if (previousRenderSettings.enabled) {\n            // In both of these cases a change has occurred from the previous state of the configuration attributes which\n            // must trigger a re-render of the graphics. If previous attributes haven't changed then no re-render should\n            // occur.\n            if (!instanceInterface.renderingOptimization.enabled) {\n              instanceInterface.renderingOptimization.viewInZone = undefined;\n              instanceInterface.renderingOptimization.zoneChanged = true;\n              instanceInterface.scheduleRendering();\n              instanceInterface.renderingOptimization.zoneChanged = false;\n            } else if (previousRenderSettings.midDistanceThreshold !== instanceInterface.renderingOptimization.midDistanceThreshold ||\n                       previousRenderSettings.farDistanceThreshold !== instanceInterface.renderingOptimization.farDistanceThreshold.value) {\n              instanceInterface.renderingOptimization.refreshZone();\n              instanceInterface.scheduleRendering();\n              instanceInterface.renderingOptimization.zoneChanged = false;\n            }\n          } else {\n            // If the previous enabled state is false and set to true a re-render must occur. Although the far and mid\n            // distance threshold values can change, a re-render is only necessary when the enabled property is set to\n            // true.\n            if (instanceInterface.renderingOptimization.enabled) {\n              instanceInterface.renderingOptimization.refreshZone();\n              instanceInterface.scheduleRendering();\n              instanceInterface.renderingOptimization.zoneChanged = false;\n            }\n          }\n          transaction.run();\n        } catch (e) {\n          transaction.fail(new emp.typeLibrary.Error({\n            coreId: newConfig.coreId,\n            level: emp.typeLibrary.Error.level.MAJOR,\n            message: e.name + \": \" + e.message,\n            jsError: e\n          }));\n          iIndex--;\n        }\n      }\n    };\n\n    engineInterface.implementation.displayName = \"Leaflet Map Engine\";\n    engineInterface.implementation.version = \"34.0\";\n\n    var sGenericHelpText =\n            \"<table style='width:100%;padding-top: 10px; border:1px solid #4a4a4a;' >\" +\n            \"<thead>\" +\n            \"<tr style='border:1px solid #4a4a4a;'>\" +\n            \"<th style='border:1px solid #4a4a4a; padding:5px; collapse:collapse;width:40%'>Action</th>\" +\n            \"<th style='border:1px solid #4a4a4a; padding:5px; collapse:collapse;width:25%'>Ctrl Point</th>\" +\n            \"<th style='border:1px solid #4a4a4a; padding:5px; collapse:collapse;width:35%'>Mouse/ Key</th>\" +\n            \"</tr>\" +\n            \"</thead>\" +\n            \"<tbody>\" +\n            \"<tr style='border:0px;'>\" +\n            \"<td colspan='3' style='padding: 0px;'>\" +\n            \"<div style='overflow:auto; width:100%;'>\" +\n            \"<table style='border:1px solid #4a4a4a; collapse:collapse;width:100%;' >\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; width:40%' >Drag laterally to alter the Lat/Long of vertex</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; width:25%;color:blue;vertical-align:middle;text-align:center'>Blue</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; width:35%'>Mouse left button drag</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; ' >Drag to alter width</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; color:lightgrey;vertical-align:middle;text-align:center'>Grey</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '>Mouse left button drag</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; ' >Drag to alter radius</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; color:grey;vertical-align:middle;text-align:center'>Dark Grey</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '>Mouse left button drag</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; ' >Drag to alter angle</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; color:yellow;vertical-align:middle;text-align:center;vertical-align:middle;text-align:center'>Yellow</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '>Mouse left button drag</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; ' >Drag laterally to alter shape's side Lat/Long</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; color:cyan;vertical-align:middle;text-align:center'>Cyan</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '>Mouse left button drag</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; ' >Add new vertex</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; vertical-align:middle;text-align:center'></td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '>left click at location</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; ' >Remove selected vertex</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; color:blue;vertical-align:middle;text-align:center'>blue</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '>Double left click</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; ' >Drag laterally to alter shape's position</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '></td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px; '>Mouse left button drag on feature</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px;' >Complete the edit session</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px;vertical-align:middle;text-align:center'></td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px;'>Click the Finish button</td>\" +\n            \"</tr>\" +\n            \"<tr>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px;' >Cancel the edit session</td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px;vertical-align:middle;text-align:center'></td>\" +\n            \"<td style='border:1px solid #4a4a4a;padding:5px;'>Click the Cancel button</td>\" +\n            \"</tr>\" +\n            \"</table>\" +\n            \"</div>\" +\n            \"</td>\" +\n            \"</tr>\" +\n            \"</tbody>\" +\n            \"</table>\";\n\n    engineInterface.implementation.help.edit = sGenericHelpText;\n\n    engineInterface.implementation.help.draw = sGenericHelpText;\n\n    engineInterface.capabilities.projection.flat = false;\n    engineInterface.capabilities.mapType.type2D = true;\n    //engineInterface.capabilities.mapType.type2_5D = false;\n    //engineInterface.capabilities.mapType.type3D = false;\n    engineInterface.capabilities.formats.GEOJSON_BASIC.plot = true;\n    engineInterface.capabilities.formats.GEOJSON_BASIC.draw = true;\n    engineInterface.capabilities.formats.GEOJSON_BASIC.edit = true;\n    engineInterface.capabilities.formats.GEOJSON_FULL.plot = true;\n    //engineInterface.capabilities.formats.GEOJSON_FULL.draw = false;\n    //engineInterface.capabilities.formats.GEOJSON_FULL.edit = false;\n    engineInterface.capabilities.formats.WMS.version_1_1 = true;\n    engineInterface.capabilities.formats.WMS.version_1_3 = true;\n    //engineInterface.capabilities.formats.WMS.elevationData = false;\n\n    engineInterface.capabilities.formats.KML_BASIC.plot = true;\n    //engineInterface.capabilities.formats.KML_BASIC.draw = false;\n    engineInterface.capabilities.formats.KML_BASIC.edit = true;\n\n    engineInterface.capabilities.formats.KML_COMPLEX.plot = true;\n    //engineInterface.capabilities.formats.KML_COMPLEX.draw = false;\n    //engineInterface.capabilities.formats.KML_COMPLEX.edit = false;\n\n    engineInterface.capabilities.formats.IMAGE.plot = true;\n    //engineInterface.capabilities.formats.IMAGE.edit = false;\n\n    engineInterface.capabilities.formats.MILSTD.version2525B.plot = true;\n    engineInterface.capabilities.formats.MILSTD.version2525B.draw = true;\n    engineInterface.capabilities.formats.MILSTD.version2525B.edit = true;\n\n    engineInterface.capabilities.formats.MILSTD.version2525C.plot = true;\n    engineInterface.capabilities.formats.MILSTD.version2525C.draw = true;\n    engineInterface.capabilities.formats.MILSTD.version2525C.edit = true;\n\n    engineInterface.capabilities.formats.AIRSPACE.plot = true;\n    engineInterface.capabilities.formats.AIRSPACE.draw = true;\n    engineInterface.capabilities.formats.AIRSPACE.edit = true;\n\n    engineInterface.capabilities.formats.AOI.plot = true;\n    engineInterface.capabilities.formats.AOI.draw = false;\n    engineInterface.capabilities.formats.AOI.edit = true;\n\n    engineInterface.capabilities.formats.ArcGIS = false;\n    engineInterface.capabilities.overlayClustering = true;\n\n    engineInterface.capabilities.settings.milstd.iconSize = true;\n    engineInterface.capabilities.settings.milstd.labelOption = true;\n\n    engineInterface.capabilities.settings.iconSize = false;\n    // return the engineInterface object as a new engineTemplate instance\n\n    try {\n        var center;\n        var level = 0;\n        var southWest = L.latLng(-90.0, -180.0);\n        var northEast = L.latLng(90.0, 180.0);\n        var maxBounds = L.latLngBounds(southWest, northEast);\n\n        if (args.initialExtent !== undefined) {\n            if (args.initialExtent.hasOwnProperty('centerLat')) {\n                center = new L.LatLng(args.initialExtent.centerLat, args.initialExtent.centerLon);\n\n                if (args.initialExtent.hasOwnProperty('range')) {\n                    level = instanceInterface.getLevel(args.initialExtent.range * instanceInterface.rangeToScaleMultiplier);\n                } else if (args.initialExtent.hasOwnProperty('scale')) {\n                    level = instanceInterface.getLevel(args.initialExtent.scale);\n                }\n            } else {\n                center = new L.LatLng(0, 0);\n                var southWest = L.latLng(args.initialExtent.south, args.initialExtent.west),\n                        northEast = L.latLng(args.initialExtent.north, args.initialExtent.east);\n\n                bounds = L.latLngBounds(southWest, northEast);\n            }\n        } else {\n            center = new L.LatLng(0, 0);\n        }\n        // L is the global ref to Leaflet\n        instanceInterface.leafletInstance = L.map(args.container, {\n            worldCopyJump: false,\n            zoomControl: false,\n            //zoomAnimation: false,\n            minZoom: 1,\n            center: center,\n            zoom: level,\n            //maxBounds : maxBounds,\n            boxZoom: false,\n            trackResize: false,\n            attributionControl: false,\n            doubleClickZoom: false,\n            scrollWheelZoom: true\n        });\n\n        if ((instanceInterface.leafletInstance === undefined) || (instanceInterface.leafletInstance === null)) {\n            throw \"Leaflet creation failed.\";\n        }\n\n        instanceInterface.leafletInstance.whenReady(function () {\n            setTimeout(engineInterface.initialize.succeed, 100);\n        });\n        //emp.map.engineDirect = {name: \"leaflet\", ref: instanceInterface.leafletInstance};\n        $('.leaflet-container').css('cursor', 'pointer');\n    } catch (err) {\n        setTimeout(engineInterface.initialize.fail, 0);\n    }\n    return engineInterface;\n};\n"]}